<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.2">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="BNS430" classname="BNS430" inheritanceid="" position="absolute 0 0 1000 616" titletext="보너스카드(P-조정-포인트조정)" onload="BNS430_onload">
    <Layout>
      <Static id="Static05" class="sta_WFDA_B" position="absolute 313 545 628 571" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static46" class="sta_WFDA_B" position="absolute 662 545 788 571" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static45" class="sta_WFDA_B" position="absolute 854 545 980 571" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static20" class="sta_WFDA_B" position="absolute 854 471 980 497" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static35" class="sta_POP_titleBG" position="absolute 10 647 990 685" text="" visible="false"/>
      <Static id="Static27" class="sta_WFDA_B" position="absolute 102 471 232 497" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static32" class="sta_WFDA_B" position="absolute 20 570 980 596" style="padding:0 0 0 95; align:left middle; " onclick="Static32_onclick" text=""/>
      <Static id="Static13" class="sta_WFDA_B" position="absolute 664 496 789 522" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static16" class="sta_WFDA_B" position="absolute 854 496 980 522" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static18" class="sta_WFDA_B" position="absolute 664 471 790 497" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static08" class="sta_WFDA_B" position="absolute 102 496 232 522" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static67" class="sta_WFDA_B" position="absolute 102 446 583 472" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static14" class="sta_WFSA_BG" position="absolute 20 206 980 238" text="" onclick="Static14_onclick"/>
      <Static id="Static72" text="카드현황" class="sta_WF_subtitle" position="absolute 26 39 195 51"/>
      <Grid id="grd_pojo_list" taborder="1" binddataset="ds_card_list" position="absolute 20 58 980 200" oncellclick="grd_pojo_list_oncellclick" cellsizingtype="both" onheadclick="grd_pojo_list_onheadclick">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="30"/>
              <Column size="130"/>
              <Column size="120"/>
              <Column size="60"/>
              <Column size="70"/>
              <Column size="70"/>
              <Column size="70"/>
              <Column size="80"/>
              <Column size="120"/>
              <Column size="80"/>
              <Column size="60"/>
              <Column size="80"/>
              <Column size="80"/>
            </Columns>
            <Rows>
              <Row size="24" band="head"/>
              <Row size="24"/>
            </Rows>
            <Band id="head">
              <Cell text="선택"/>
              <Cell col="1" text="카드번호"/>
              <Cell col="2" text="유형"/>
              <Cell col="3" text="상태"/>
              <Cell col="4" text="일반포인트"/>
              <Cell col="5" text="특별포인트"/>
              <Cell col="6" text="제휴포인트"/>
              <Cell col="7" text="본등록일"/>
              <Cell col="8" text="발급채널"/>
              <Cell col="9" text="시스템등록일"/>
              <Cell col="10" text="등록채널"/>
              <Cell col="11" text="카드마스터"/>
              <Cell col="12" text="시리얼"/>
            </Band>
            <Band id="body">
              <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
              <Cell col="1" text="bind:CRD_NO" mask="####-####-####-####"/>
              <Cell col="2" style="align:left;" text="bind:CRD_TP_CD_NM"/>
              <Cell col="3" style="align:center middle;" text="bind:CRD_ST_CD_NM"/>
              <Cell col="4" style="align:right middle;" text="bind:CRD_GNRL_PT"/>
              <Cell col="5" style="align:right middle;" text="bind:CRD_SPCL_PT"/>
              <Cell col="6" style="align:right middle;" text="bind:CRD_CPRT_PT"/>
              <Cell col="7" text="bind:RREG_PBLC_DT"/>
              <Cell col="8" style="align:left middle;" text="bind:PBLC_APLY_DIV_CD_NM"/>
              <Cell col="9" text="bind:INPUT_DT" mask="####-##-##" maskchar=" "/>
              <Cell col="10" text="bind:APRV_CHNL_DIV_CD_NM"/>
              <Cell col="11"/>
              <Cell col="12"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
      <Static id="Static00" text="구매이력" class="sta_WF_subtitle" position="absolute 26 248 195 260"/>
      <Button id="btn_srch" taborder="2" text="조회" class="btn_WFSA_P" position="absolute 911 212 971 232" onclick="btn_srch_onclick"/>
      <Calendar id="cal_00" taborder="4" dateformat="yyyy-MM-dd" class="cal_WFSA" position="absolute 79 212 199 232"/>
      <Static id="Static12" text="기간" class="sta_WFSA_label" position="absolute 37 216 97 228" titletext="보너스카드"/>
      <Calendar id="cal_01" taborder="5" dateformat="yyyy-MM-dd" class="cal_WFSA" position="absolute 220 212 340 232"/>
      <Static id="Static11" text="~" position="absolute 204 214 219 226"/>
      <Static id="Static01" text="제휴사" class="sta_WFSA_label" position="absolute 406 216 466 228" titletext="보너스카드"/>
      <Combo id="cmb_gubun" taborder="6" class="cmb_WFSA" position="absolute 475 212 675 232"/>
      <Grid id="grd_his_list" taborder="7" position="absolute 20 265 980 415" cellsizingtype="both" onheadclick="grd_his_list_onheadclick" binddataset="ds_his_list" oncellclick="grd_his_list_oncellclick">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="70"/>
              <Column size="130"/>
              <Column size="70"/>
              <Column size="60"/>
              <Column size="120"/>
              <Column size="120"/>
              <Column size="60"/>
              <Column size="60"/>
              <Column size="60"/>
              <Column size="60"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="60"/>
              <Column size="60"/>
              <Column size="60"/>
              <Column size="60"/>
              <Column size="0"/>
              <Column size="60"/>
              <Column size="60"/>
              <Column size="60"/>
            </Columns>
            <Rows>
              <Row size="24" band="head"/>
              <Row size="24"/>
            </Rows>
            <Band id="head">
              <Cell text="처리일시"/>
              <Cell col="1" text="카드번호"/>
              <Cell col="2" text="채널"/>
              <Cell col="3" text="적립구분"/>
              <Cell col="4" text="발생사유"/>
              <Cell col="5" text="가맹점"/>
              <Cell col="6" text="일반"/>
              <Cell col="7" text="특별"/>
              <Cell col="8" text="제휴"/>
              <Cell col="9" text="합계"/>
              <Cell col="10"/>
              <Cell col="11" text="가용P"/>
              <Cell col="12" text="유종"/>
              <Cell col="13" text="금액"/>
              <Cell col="14" text="단가"/>
              <Cell col="15" text="주유량"/>
              <Cell col="16" text="상세구분"/>
              <Cell col="17" text="총누적P"/>
              <Cell col="18" text="소멸일"/>
              <Cell col="19" text="결제유형"/>
            </Band>
            <Band id="body">
              <Cell style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:PRO_DAY" mask="####-##-##"/>
              <Cell col="1" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:CRD_NO" mask="####-####-####-####"/>
              <Cell col="2" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:CHANNEL"/>
              <Cell col="3" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:SLIP_DIV_CODE_NAME"/>
              <Cell col="4" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:REA_GUBUN"/>
              <Cell col="5" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:FRCH_NM"/>
              <Cell col="6" style="align:right;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:GEN_PT"/>
              <Cell col="7" style="align:right;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:SP_PT"/>
              <Cell col="8" style="align:right;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:FRCH_PT"/>
              <Cell col="9" style="align:right;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:POINT"/>
              <Cell col="10" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:APPRV_NO"/>
              <Cell col="11" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:A_POINT"/>
              <Cell col="12" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:OIL_NM"/>
              <Cell col="13" style="align:right;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:MONEY"/>
              <Cell col="14" style="align:right;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:DANGA"/>
              <Cell col="15" style="align:right;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:OIL_QTY"/>
              <Cell col="16" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:DTL_GUBUN"/>
              <Cell col="17" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:T_POINT"/>
              <Cell col="18" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:END_DAY"/>
              <Cell col="19" style="align:left;color:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );color2:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );selectcolor:EXPR(ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;적립취소&quot;||ds_his_list.getColumn(currow,'SLIP_DIV_CODE_NAME') == &quot;사용취소&quot;?&quot;orangered&quot;:&quot;#333333ff&quot; );" text="bind:CASH_GUBUN"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
      <Static id="Static02" text="P조정" class="sta_WF_subtitle" position="absolute 27 427 196 439"/>
      <Static id="Static61" text="카드번호" class="sta_WFDA_labelB" position="absolute 20 446 103 472"/>
      <Edit id="edt_c1" taborder="8" position="absolute 105 449 170 469" readonly="true"/>
      <Edit id="edt_c2" taborder="9" position="absolute 172 449 237 469" readonly="true"/>
      <Edit id="edt_c3" taborder="10" position="absolute 239 449 304 469" readonly="true"/>
      <Edit id="edt_c4" taborder="11" position="absolute 306 449 371 469" readonly="true"/>
      <Static id="Static03" class="sta_WFDA_B" position="absolute 313 471 583 497" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static04" text="가맹점" class="sta_WFDA_labelB" position="absolute 231 471 314 497"/>
      <Combo id="Combo08" taborder="12" innerdataset="Dataset00" datacolumn="Column0" position="absolute 667 449 923 469"/>
      <Edit id="edt_bmk" taborder="13" position="absolute 316 548 574 568" maxlength="50"/>
      <Static id="Static07" text="일반포인트" class="sta_WFDA_labelB" position="absolute 20 471 103 497"/>
      <Edit id="edt_gnr_pt" taborder="14" position="absolute 105 474 221 494" inputtype="digit" maxlength="8" ontextchanged="edt_gnr_pt_ontextchanged" ontextchange="fn_edt_chd"/>
      <Static id="Static10" class="sta_WFDA_B" position="absolute 664 446 980 472" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Edit id="edt_srch1" taborder="15" position="absolute 316 474 552 494" oneditclick="Edit05_oneditclick" readonly="true"/>
      <Static id="Static15" text="유종" class="sta_WFDA_labelB" position="absolute 582 496 665 522"/>
      <Edit id="edt_mon_tot" taborder="17" position="absolute 865 499 970 519" ontextchanged="cal_ontextchanged" inputtype="number"/>
      <Static id="Static17" text="금액" class="sta_WFDA_labelB" position="absolute 780 496 863 522"/>
      <Edit id="edt_oil" taborder="18" position="absolute 667 474 772 494" inputtype="number"/>
      <Static id="Static19" text="주유량" class="sta_WFDA_labelB" position="absolute 582 471 665 497" onclick="Static19_onclick"/>
      <Edit id="edt_mon_gnr" taborder="19" position="absolute 865 474 970 494" ontextchanged="cal_ontextchanged" inputtype="number"/>
      <Static id="Static21" text="단가(주유)" class="sta_WFDA_labelB" position="absolute 780 471 863 497" onclick="Static21_onclick"/>
      <Static id="Static22" text="특별포인트" class="sta_WFDA_labelB" position="absolute 20 496 103 522"/>
      <Static id="Static23" class="sta_WFDA_B" position="absolute 102 521 232 547" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static24" text="상세사유" class="sta_WFDA_labelB" position="absolute 231 496 314 522"/>
      <Static id="Static25" class="sta_WFDA_B" position="absolute 313 496 583 522" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Edit id="edt_sp_pt" taborder="20" position="absolute 105 499 221 519" maxlength="8" inputtype="digit" oneditclick="edt_sp_pt_oneditclick"/>
      <Static id="Static26" text="제휴포인트" class="sta_WFDA_labelB" position="absolute 20 521 103 547"/>
      <Static id="Static28" text="제휴사" class="sta_WFDA_labelB" position="absolute 231 521 314 547" onclick="Static28_onclick"/>
      <Static id="Static29" class="sta_WFDA_B" position="absolute 313 521 583 547" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Edit id="edt_file" taborder="21" position="absolute 105 573 574 593" readonly="true"/>
      <Combo id="cmb_dtl" taborder="22" innerdataset="Dataset00" datacolumn="Column0" position="absolute 316 499 574 519" onitemchanged="cmb_dtl_onitemchanged"/>
      <Static id="Static30" text="적립/사용" class="sta_WFDA_labelB" position="absolute 20 546 103 572"/>
      <Static id="Static31" class="sta_WFDA_B" position="absolute 102 546 232 572" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Combo id="cmb_save_use" taborder="25" position="absolute 105 549 221 569" onitemchanged="cmb_save_use_onitemchanged"/>
      <CheckBox id="check_mail" taborder="30" text="보고" position="absolute 652 418 715 438" style="buttonalign:right middle;align:left middle;" onclick="check_mail_onclick" visible="false"/>
      <Edit id="edt_frch_pt" taborder="31" position="absolute 105 524 221 544" inputtype="digit" maxlength="8"/>
      <Static id="Static34" text="P-조정(포인트조정)" class="sta_POP_title" position="absolute 26 658 276 673" visible="false"/>
      <Static id="Static09" text="발생사유" class="sta_WFDA_labelB" position="absolute 582 446 665 472"/>
      <Static id="Static36" text="총         건" position="absolute 912 41 980 53"/>
      <Static id="sta_row1" position="absolute 926 41 958 53" style="align:right top; " text=""/>
      <Static id="Static38" text="총         건" position="absolute 911 248 979 260"/>
      <Static id="sta_row2" position="absolute 925 248 957 260" style="align:right top; " text=""/>
      <Button id="btn_save" taborder="33" text="저장" position="absolute 847 422 907 442" onclick="btn_point"/>
      <Button id="btn_find" taborder="36" text="파일찾기" class="btn_WFDA_B" position="absolute 826 574 896 592" onclick="btn_find_onclick"/>
      <Button id="btn_cancel" taborder="37" text="파일취소" class="btn_WFDA_B" position="absolute 899 574 969 592" onclick="btn_cancel_onclick"/>
      <Static id="his_data_h" position="absolute 717 219 816 230" visible="false" text=""/>
      <Div id="Div00" taborder="38" style="background:#ffffff00; border:0 double #dcdcdcff #ffffffff; " position="absolute 6 649 992 685" visible="false">
        <Layout/>
      </Div>
      <Button id="btn_close" taborder="32" text="Button00" class="btn_POP_close" position="absolute 956 659 969 671" onclick="btn_close_onclick" visible="false"/>
      <Combo id="cmb_reason" taborder="39" position="absolute 667 449 970 469" onitemchanged="cmb_reason_onitemchanged"/>
      <Static id="Static37" text="비고" class="sta_WFDA_labelB" position="absolute 231 545 314 571"/>
      <Static id="Static39" text="금액" class="sta_WFDA_labelB" position="absolute 780 545 863 571"/>
      <Edit id="edt_mon" taborder="41" position="absolute 865 548 970 568" inputtype="number"/>
      <Static id="Static40" text="수량" class="sta_WFDA_labelB" position="absolute 582 545 665 571"/>
      <Edit id="edt_num" taborder="42" position="absolute 667 548 772 568" inputtype="number"/>
      <Static id="Static41" class="sta_WFDA_B" position="absolute 664 520 789 546" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Static id="Static42" class="sta_WFDA_B" position="absolute 854 520 980 546" style="padding:0 0 0 95; align:left middle; " text=""/>
      <Edit id="edt_good" taborder="43" position="absolute 667 523 753 543" oneditclick="Edit02_oneditclick" readonly="true"/>
      <Static id="Static43" text="상품" class="sta_WFDA_labelB" position="absolute 582 520 665 546"/>
      <Edit id="edt_frch_mon" taborder="44" position="absolute 865 523 970 543" inputtype="number"/>
      <Static id="Static44" text="단가(제휴)" class="sta_WFDA_labelB" position="absolute 780 520 863 546"/>
      <Button id="btn_save_cancel" taborder="45" text="삭제" position="absolute 911 422 971 442" onclick="btn_save_cancel_onclick"/>
      <Button id="Btn_WebIdSrchMod" taborder="46" onclick="Btn_WebIdSrchMod_onclick" class="btn_WFDA_srch" position="absolute 556 475 574 492"/>
      <Edit id="edt_srch2" taborder="47" oneditclick="Edit05_oneditclick" position="absolute 316 524 552 544" readonly="true"/>
      <Button id="Btn_WebIdSrchMod00" taborder="48" onclick="Btn_WebIdSrchMod2_onclick" class="btn_WFDA_srch" position="absolute 556 525 574 542"/>
      <Static id="Static47" text="증빙파일" class="sta_WFDA_labelB" position="absolute 20 571 103 596"/>
      <Combo id="cmb_oil" taborder="49" position="absolute 667 499 772 519" class="cmb_WFSA" onitemchanged="cal_ontextchanged"/>
      <Button id="btn_clear" taborder="50" text="초기화" position="absolute 783 422 843 442" onclick="btn_clear_onclick"/>
      <Static id="Static06" text="고객번호" onclick="Static00_onclick" class="sta_TF_label02" position="absolute 12 12 92 26" style="font:dotum,9,bold; "/>
      <Edit id="Edt_PopCustNo" taborder="51" readonly="true" position="absolute 85 8 165 28"/>
      <Static id="Static33" text="고객명" onclick="Static00_onclick" class="sta_TF_label02" position="absolute 186 12 266 26" style="font:dotum,9,bold; "/>
      <Edit id="Edt_PopCustNm" taborder="52" readonly="true" position="absolute 247 8 327 28"/>
      <Edit id="hid_gsg" taborder="53" readonly="true" position="absolute 783 212 848 232" visible="false"/>
      <Edit id="del_pro_day" taborder="54" readonly="true" position="absolute 467 419 532 439" visible="false"/>
      <Static id="Static48" text="카드번호" class="sta_WFSA_label" position="absolute 681 8 741 20"/>
      <MaskEdit id="Msk_CrdNo" taborder="55" text="    -    -    -    " type="string" mask="####-####-####-####" maskchar=" " onkeyup="Msk_CrdNo_onkeyup" oneditclick="Msk_CrdNo_oneditclick" class="mae_WFSA" position="absolute 746 4 871 24" style="padding:0 0 0 3; align:left middle; "/>
      <Button id="Btn_Srch_one" taborder="56" text="조회" class="btn_WFSA_P" position="absolute 912 4 972 24" onclick="Btn_Srch_one_onclick"/>
      <Button id="Btn_WebIdSrchMod01" taborder="57" onclick="Btn_WebIdSrchMod3_onclick" class="btn_WFDA_srch" position="absolute 756 524 774 541"/>
    </Layout>
    <Script type="xscript4.0"><![CDATA[include "LIB::CommonLib.xjs"

var SVC_IF_URL 	= "XinterfaceAction.do?method=CommonInterface";

var mod_time;
var mod_data;
var edt_srch1_cd;
var edt_srch2_cd;
var p_flag=1;
var re_flag;
var gsg_point_use=0;

//------------------------------------------------------------------------------------------
// 닫기
//------------------------------------------------------------------------------------------

function btn_close_onclick(obj:Button,  e:ClickEventInfo)
{

	this.close();
	 
}

//------------------------------------------------------------------------------------------
//  화면초기화
//------------------------------------------------------------------------------------------
function BNS430_onload(obj:Form, e:LoadEventInfo)
{

	cal_01.value 		= getToday();
	cal_00.value 	= AddMonth(getToday(),-3);
	
	setDefaultValue();
	
	ds_card_list.copyData(this.parent.opener.parent.parent.all["Tab_CrdInfo"]["tabpage1"]["ds_crd_info"],false);
	
	ds_cust_info.copyData(this.parent.opener.parent.parent.all["ds_cust_info"],false);
	
	Edt_PopCustNo.value = ds_cust_info.getColumn(0,"IO_CUST_NO");
	Edt_PopCustNm.value = ds_cust_info.getColumn(0,"OT_CUST_NM");
			
	ds_card_list.filter(" CRD_ST_CD == 01 ");
		
	sta_row1.text=grd_pojo_list.rowcount;
		

}



//------------------------------------------------------------------------------------------
// 셀클릭
//------------------------------------------------------------------------------------------
function grd_pojo_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{

	del_pro_day.value="";
	if(e.col == 0 ){
		if(e.oldrow != e.row){
			ds_card_list.setColumn(e.oldrow,"CHK",0);			
			ds_card_list.setColumn(e.row,"CHK",1);
		
		}
		
	}
	
	cmb_reason.value="";


	if(ds_card_list.getColumn(e.row,"CHK")==1){

		delete_readonly(false);	
		delete_popup(true);

		edt_c1.value=ds_card_list.getColumn(e.row,"CRD_NO").substring(0,4);
		edt_c2.value=ds_card_list.getColumn(e.row,"CRD_NO").substring(4,8);
		edt_c3.value=ds_card_list.getColumn(e.row,"CRD_NO").substring(8,12);
		edt_c4.value=ds_card_list.getColumn(e.row,"CRD_NO").substring(12,16);

		ds_srch.setColumn(0,"CRD_NO",ds_card_list.getColumn(e.row,"CRD_NO"));

		cmb_reason_onitemchanged();

	}
	
}

//------------------------------------------------------------------------------------------
//  인터페이스 셋팅
//------------------------------------------------------------------------------------------
function fn_setIfEnvDs(ObjDs,IfKnd,ReqMthd,ReqId,ResHd,ResCol,ResRec,ResCdNm,ResMsg1,ResMsg2,UptDsNm)
{
	var ObjEnvDs = "";
	
	if (typeof ObjDs == "string"){
	
		ObjEnvDs= eval(ObjDs);
		
	}else{
	
		ObjEnvDs = ObjDs;
		
	}
	
	fun_ds_srch(ObjEnvDs, "IF_KIND",IfKnd);
	fun_ds_srch(ObjEnvDs, "REQ_SERVICE_METHOD",ReqMthd);
	fun_ds_srch(ObjEnvDs, "REQ_SERVICE_ID",ReqId);	
	fun_ds_srch(ObjEnvDs, "RES_HEADER_SECTION",ResHd);
	fun_ds_srch(ObjEnvDs, "RES_COLUMN_SECTION",ResCol);
	fun_ds_srch(ObjEnvDs, "RES_RECORD_SECTION",ResRec);
	fun_ds_srch(ObjEnvDs, "RES_CODE_NAME",ResCdNm);
	fun_ds_srch(ObjEnvDs, "RES_MSG1_NAME",ResMsg1);
	fun_ds_srch(ObjEnvDs, "RES_MSG2_NAME",ResMsg2);
	fun_ds_srch(ObjEnvDs, "UPDATE_DATASET_NAME",UptDsNm);			
	
}

//------------------------------------------------------------------------------------------
// 이력 조회
//------------------------------------------------------------------------------------------
function btn_srch_onclick(obj:Button,  e:ClickEventInfo)
{
	hid_gsg.value="";

	var strCompDt = AddMonth(cal_00.value,3);

	if(strCompDt < cal_01.value){
	
			cf_Alert("COME0019","3개월");
			return;
			
	}

	p_flag=1; // GSG 불가
	re_flag="0";

	if(cmb_gubun.value=="" || cmb_gubun.value==null){
	

		if(cal_00.value=="" || cal_01.value=="" || cal_00.value==null || cal_01.value==null){
			cf_Alert("COME0003","기간");
			return;
		}
	
		if(ds_card_list.findRow("CHK","1")=="-1"){	
			new_search(); //고객 구매이력 조회
			return;
		}
	
		if(ds_cust_info.getColumn(0,"OT_GRP_AGR_YN")=="Y"){
	
			p_flag=1;
	
			ds_if_grppt_env.clearData();
			ds_if_grppt_data.clearData();
			ds_if_grppt_common.clearData();
			ds_if_grppt_header.clearData();
			ds_if_grppt_column.clearData();
			ds_if_grppt_record.clearData();	
		
			// 환경DS 세팅
			fn_setIfEnvDs(ds_if_grppt_env,"WAS","ptGrpptSelC01.do","","STP_PT_GRPPT_SEL_C01_Rsp","","OT_OUT_CURSOR","","","","");

			fun_ds_srch(ds_if_grppt_data,"req_chnl_code","610050");
			fun_ds_srch(ds_if_grppt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
			fun_ds_srch(ds_if_grppt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
			fun_ds_srch(ds_if_grppt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
					
		

			fun_ds_srch(ds_if_grppt_data, "in_cust_no","");			
			fun_ds_srch(ds_if_grppt_data, "in_card_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value);
			fun_ds_srch(ds_if_grppt_data, "in_from_date",cal_00.value);
			fun_ds_srch(ds_if_grppt_data, "in_to_date",cal_01.value);						
		

			fun_ds_srch(ds_if_grppt_data, "in_page_no","0");
			fun_ds_srch(ds_if_grppt_data, "in_page_size","0");
		
			var	strSvcID = "IF_CSC_ITRT_133";
			var	strURL = SVC_IF_URL;	
			var	strInDatasets = "INTERFACE_ENV=ds_if_grppt_env:a INTERFACE_DATA=ds_if_grppt_data:a";
			var	strOutDatasets = "ds_if_grppt_common=DS_COMMON ds_if_grppt_header=DS_HEADER ds_if_grppt_column=DS_COLUMN ds_if_grppt_record=DS_RECORD";
			var	strArgument = "";
			var strCallbackFunc = "fn_callBack";
			var strProcessBar = true;
			
			cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
		}else{
			
			
			p_flag=3;			// 적립포인트조회
	
			ds_if_trnpt_env.clearData();
			ds_if_trnpt_data.clearData();
			ds_if_trnpt_common.clearData();
			ds_if_trnpt_header.clearData();
			ds_if_trnpt_column.clearData();
			ds_if_trnpt_record.clearData();
			
			// 환경DS 세팅
			fn_setIfEnvDs(ds_if_trnpt_env,"WAS","ptTrnptSelC08.do","","STP_PT_TRNPT_SEL_C01_Rsp","","OT_OUT_CURSOR","","","","");		
					
			fun_ds_srch(ds_if_trnpt_data,"req_chnl_code","610050");
			fun_ds_srch(ds_if_trnpt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
			fun_ds_srch(ds_if_trnpt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
			fun_ds_srch(ds_if_trnpt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
			
	
			fun_ds_srch(ds_if_trnpt_data, "in_search_key","2");	
			fun_ds_srch(ds_if_trnpt_data, "in_crd_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value);
			fun_ds_srch(ds_if_trnpt_data, "in_strt_dt",cal_00.value);
			fun_ds_srch(ds_if_trnpt_data, "in_end_dt",cal_01.value);						
		 
						
			var	strSvcID = "IF_CSC_ITRT_081";
			var	strURL = SVC_IF_URL;	
			var	strInDatasets = "INTERFACE_ENV=ds_if_trnpt_env:a INTERFACE_DATA=ds_if_trnpt_data:a";
			var	strOutDatasets = "ds_if_trnpt_common=DS_COMMON ds_if_trnpt_header=DS_HEADER ds_if_trnpt_column=DS_COLUMN ds_if_trnpt_record=DS_RECORD";
			var	strArgument = "";
			var strCallbackFunc = "fn_callBack";
			var strProcessBar = true;
			
			cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
		}
		
	}else{
	
		p_flag=2;
	
		if(cal_00.value=="" || cal_01.value=="" || cal_00.value==null || cal_01.value==null){
				
			cf_Alert("COME0003","기간");
			return;
				
		}
			
	
		getDsName = this.getOwnerFrame().getDsArgument;
	
		ds_if_GSG_grppt_env.clearData();
		ds_if_GSG_grppt_data.clearData();
		ds_if_GSG_grppt_common.clearData();
		ds_if_GSG_grppt_header.clearData();
		ds_if_GSG_grppt_column.clearData();
		ds_if_GSG_grppt_record.clearData();	
	
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_GSG_grppt_env,"WAS","ptGsgGrpptSelC01.do","","STP_GSG_GRPPT_SEL_C01_Rsp","","OT_OUT_CURSOR","","","","");

		fun_ds_srch(ds_if_GSG_grppt_data,"req_chnl_code","610050");
		fun_ds_srch(ds_if_GSG_grppt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_GSG_grppt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_GSG_grppt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
					
		

		fun_ds_srch(ds_if_GSG_grppt_data, "in_cust_no",getDsName.getColumn(0,"CUST_NO"));						
		fun_ds_srch(ds_if_GSG_grppt_data, "in_from_date",cal_00.value);
		fun_ds_srch(ds_if_GSG_grppt_data, "in_to_date",cal_01.value);							
		
		
		fun_ds_srch(ds_if_GSG_grppt_data, "in_cco_code",cmb_gubun.value);						
							
				
		fun_ds_srch(ds_if_GSG_grppt_data, "in_page_no","0");
		fun_ds_srch(ds_if_GSG_grppt_data, "in_page_size","0");
	
		
		var	strSvcID = "IF_CSC_ITRT_158";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_GSG_grppt_env:a INTERFACE_DATA=ds_if_GSG_grppt_data:a";
		var	strOutDatasets = "ds_if_GSG_grppt_common=DS_COMMON ds_if_GSG_grppt_header=DS_HEADER ds_if_GSG_grppt_column=DS_COLUMN ds_if_GSG_grppt_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		
		
	
	}
}

//------------------------------------------------------------------------------------------
//  체크(메일)
//------------------------------------------------------------------------------------------
function check_mail_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (check_mail.value=="1"){
		cf_Alert("BNSI0004");
	
	}
}

//------------------------------------------------------------------------------------------
//  화면 콤보
//------------------------------------------------------------------------------------------
function setDefaultValue(){


	var arrCombo           = ["cmb_oil","cmb_dtl","cmb_save_use","cmb_reason","cmb_gubun"];    									//콤보ID
    var arrSearchKey       = ["OLZ36","OLZ60","NW056","OLZ70","OLZ23"];               							//공통코드-대분류코드
    var arrListMode        = ["TY","TY","TN","TY","TY"];                    							//CTN : [코드] 코드명  , TY : 코드명,  TN: 초기값무시
    var arrOptionRowValue  = [",",",",",",",",",일반"];                  								//코드상단에 로우추가후 전체, 공백

	setComboList(arrCombo, arrSearchKey, arrListMode, arrOptionRowValue);     					//공통콤보가져오기	

}

//------------------------------------------------------------------------------------------
//  파일 찾기
//------------------------------------------------------------------------------------------
function btn_find_onclick(obj:Button,  e:ClickEventInfo)
{
	
	var vFile_up = FileDialog00.open("file upload",FileDialog.ILOAD,"%MYDOCUMENT%");
	
	
	if (vFile_up){		
		var rtn = HttpObject00.upload(G_SMILE2WEB + "UploadServlet",FileDialog.LOAD,vFile_up,false);	
	}	
	
	vFile_up.close();		
}


//------------------------------------------------------------------------------------------
//  	파일업로드 콜백
//------------------------------------------------------------------------------------------
function HttpObject00_onload(obj:HttpObject, e:HttpObjLoadEventInfo)
{

	if(e.errorcode < 0){
		cf_Alert("COME0009");  //첨부파일 올리는중 에러가 발생하였습니다.	
	}else{		
	}

	var fileSplit = e.errormsg.split('|');	
	var row = ds_FILELIST.addRow();
	
	ds_FILELIST.setColumn(row,"FILE_SEQ", row + 1 );         //파일SEQ
	ds_FILELIST.setColumn(row,"FILE_NM", fileSplit[1] );     //파일명
	ds_FILELIST.setColumn(row,"FILE_SZ", fileSplit[2] );     //사이즈	
	ds_FILELIST.setColumn(row,"FILE_PHYSNM", fileSplit[3] ); //실제파일명
	ds_FILELIST.setColumn(row,"FILE_PATH", fileSplit[4] );	 //실제패스명
	
}


//------------------------------------------------------------------------------------------
//  	업로드 바
//------------------------------------------------------------------------------------------	
function HttpObject00_onstatus(obj:HttpObject, e:HttpObjStatusEventInfo)
{

	ProgressBar00.pos = e.status;
	
}

//------------------------------------------------------------------------------------------
//  파일 취소
//------------------------------------------------------------------------------------------
function btn_cancel_onclick(obj:Button,  e:ClickEventInfo)
{

	ds_FILELIST.deleteRow(ds_FILELIST.rowposition);
	
}

function grd_pojo_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{

	cf_gridSort(obj, e);
	
}

function grd_his_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{

	cf_gridSort(obj, e);
	
}

//------------------------------------------------------------------------------------------
//  포인트 조정 
//------------------------------------------------------------------------------------------

function btn_point(obj:Button,  e:ClickEventInfo)
{
	
	var a = GetUserInfo("gUSR_GRD_CD");
		
	var sumPV = parseInt(edt_gnr_pt.value)+parseInt(edt_sp_pt.value)+parseInt(edt_frch_pt.value);
	
	//상담사 1만 취소는 가능하게
	if(cmb_save_use.value=="01"){
		if( (sumPV>9999) 
			&& a != "A" 
			&& a != "B" 
			&& a != "C"
			&& a != "D"
			&& a != "K"
			&& a != "L"
			&& a != "N"){	
			
			//trace("+" + GetUserInfo("gUSR_GRD_CD")+ "+");
		cf_Alert("COME0002","10000(P) 이상 조정 할수 없습니다.");
		return;
		}
	}
	
	if(getTrim(cmb_save_use.value)==""){
	
		cf_Alert("COME0002","발생사유는 필수 입니다.");
		return;
	
	}
	
	if(cmb_reason.value=="0100" || cmb_reason.value=="0068" || cmb_reason.value=="0025" || cmb_reason.value=="0005" || cmb_reason.value=="0004" || cmb_reason.value=="0006" || cmb_reason.value=="9999"){      //오일로정산	
		
		if(getTrim(edt_gnr_pt.value)=="" || getTrim(edt_gnr_pt.value)=="0"){
		
			cf_Alert("COME0002","일반포인트가 없습니다.");
			return;
			
		}else if(getTrim(edt_srch1.value)==""){
		
			cf_Alert("COME0002","가맹점을 선택하셔야 합니다.");
			return;
			
		}else if(getTrim(edt_oil.value)==""){
		
			cf_Alert("COME0002","주유량을 입력하셔야 합니다.");
			return;
			
		}else if(getTrim(edt_mon_gnr.value)==""){
		
			cf_Alert("COME0002","단가를 입력하셔야 합니다.");
			return;
			
		}else if(getTrim(cmb_oil.value)==""){
		
			cf_Alert("COME0002","유종을 선택하셔야 합니다.");
			return;
			
		}else if(getTrim(edt_mon_tot.value)==""){
		
			cf_Alert("COME0002","금액을 입력하셔야 합니다.");
			return;
		}
	
	}
	
	if(cmb_reason.value=="0007" ){      //특별포인트
		
		if(getTrim(edt_sp_pt.value)=="" || getTrim(edt_sp_pt.value)=="0"){
		
			cf_Alert("COME0002","특별포인트가 없습니다.");
			return;
			
		}else if(getTrim(cmb_dtl.value)==""){
		
			cf_Alert("COME0002","상세사유를 선택하셔야 합니다.");
			return;
			
		}
	
	}
	
	if(cmb_reason.value=="0008"){      //제휴포인트 누락	
		
		/*
		if(edt_c1.value+edt_c2.value == 01906106){  //다음일경우
			
					if(edt_c3.value+edt_c4.value>"01999999"){ //&& edt_c3.value+edt_c4.value<04000000
					  if(edt_c3.value+edt_c4.value<"04000000"){
							
							if(getTrim(edt_srch1.value)!=""){     //가맹점일 경우
							
							if(getTrim(edt_gnr_pt.value)=="0" && getTrim(edt_sp_pt.value)=="0" && getTrim(edt_frch_pt.value)=="0"){
							cf_Alert("COME0002","포인트를 입력하셔야 합니다.");
							return;
							}
							
								if(getTrim(edt_oil.value)==""){								
									cf_Alert("COME0002","주유량을 입력하셔야 합니다.");
									return;
								}else if(getTrim(edt_mon_gnr.value)==""){
									cf_Alert("COME0002","단가를 입력하셔야 합니다.");
									return;
								}else if(getTrim(cmb_oil.value)==""){
									cf_Alert("COME0002","유종을 선택하셔야 합니다.");
									return;
								}else if(getTrim(edt_mon_tot.value)==""){
									cf_Alert("COME0002","금액을 입력하셔야 합니다.");
									return;
								}							
							
							}else if(getTrim(edt_srch2.value)!=""){  //제휴사일 경우
							
							if(getTrim(edt_gnr_pt.value)=="0" && getTrim(edt_sp_pt.value)=="0" && getTrim(edt_frch_pt.value)=="0"){
							cf_Alert("COME0002","포인트를 입력하셔야 합니다.");
							return;
							}							
							
								if(getTrim(edt_good.value)==""){								
									cf_Alert("COME0002","상품을 입력하셔야 합니다.");
									return;
								}else if(getTrim(edt_frch_mon.value)==""){
									cf_Alert("COME0002","단가를 입력하셔야 합니다.");
									return;
								}else if(getTrim(edt_num.value)==""){
									cf_Alert("COME0002","수량을 선택하셔야 합니다.");
									return;
								}else if(getTrim(edt_mon.value)==""){
									cf_Alert("COME0002","금액을 입력하셔야 합니다.");
									return;
								}
							
							}
					
						}
					}
							
			}else if(edt_c1.value+edt_c2.value == 01905100){  //다음일경우
			
					if(edt_c3.value+edt_c4.value>"19000000"){ //&& edt_c3.value+edt_c4.value<04000000
					  if(edt_c3.value+edt_c4.value<"20000000"){
					
					if(getTrim(edt_srch1.value)!=""){     //가맹점일 경우
							
							if(getTrim(edt_gnr_pt.value)=="0" && getTrim(edt_sp_pt.value)=="0" && getTrim(edt_frch_pt.value)=="0"){
							cf_Alert("COME0002","포인트를 입력하셔야 합니다.");
							return;
							}							
							
								if(getTrim(edt_oil.value)==""){								
									cf_Alert("COME0002","주유량을 입력하셔야 합니다.");
									return;
								}else if(getTrim(edt_mon_gnr.value)==""){
									cf_Alert("COME0002","단가를 입력하셔야 합니다.");
									return;
								}else if(getTrim(cmb_oil.value)==""){
									cf_Alert("COME0002","유종을 선택하셔야 합니다.");
									return;
								}else if(getTrim(edt_mon_tot.value)==""){
									cf_Alert("COME0002","금액을 입력하셔야 합니다.");
									return;
								}							
							
							}else if(getTrim(edt_srch2.value)!=""){  //제휴사일 경우
							
							if(getTrim(edt_gnr_pt.value)=="0" && getTrim(edt_sp_pt.value)=="0" && getTrim(edt_frch_pt.value)=="0"){
							cf_Alert("COME0002","포인트를 입력하셔야 합니다.");
							return;
							}							
							
								if(getTrim(edt_good.value)==""){								
									cf_Alert("COME0002","상품을 입력하셔야 합니다.");
									return;
								}else if(getTrim(edt_frch_mon.value)==""){
									cf_Alert("COME0002","단가를 입력하셔야 합니다.");
									return;
								}else if(getTrim(edt_num.value)==""){
									cf_Alert("COME0002","수량을 선택하셔야 합니다.");
									return;
								}else if(getTrim(edt_mon.value)==""){
									cf_Alert("COME0002","금액을 입력하셔야 합니다.");
									return;
								}
							
							}
							
						}
					}
							
			}else{
			*/
			
		if(getTrim(edt_gnr_pt.value)=="0" && getTrim(edt_sp_pt.value)=="0" && getTrim(edt_frch_pt.value)=="0"){
		
			cf_Alert("COME0002","포인트를 입력하셔야 합니다.");
			return;
			
		}else if(getTrim(edt_gnr_pt.value)==""){
		
			cf_Alert("COME0002","일반포인트가 없습니다.");
			return;
			
		}else if(getTrim(edt_sp_pt.value)==""){
		
			cf_Alert("COME0002","특별포인트가 없습니다.");
			return;
			
		}else if(getTrim(edt_frch_pt.value)==""){
		
			cf_Alert("COME0002","제휴포인트가 없습니다.");
			return;
			
		}else if(getTrim(edt_srch2.value)==""){
		
			cf_Alert("COME0002","제휴사를 선택 하셔야 합니다.");
			return;
			
		}else if(getTrim(edt_frch_pt.value)==""){
		
			cf_Alert("COME0002","제휴포인트가 없습니다.");
			return;
			
		}else if(getTrim(edt_good.value)==""){
		
			cf_Alert("COME0002","상품이 없습니다.");
			return;
			
		}else if(getTrim(edt_mon.value)==""){
		
			cf_Alert("COME0002","금액이 없습니다.");
			return;
							
				// 차후 상품을 추가해야함		
				
		}
	
	}
	
	if(cmb_reason.value=="0008"){
		//★일반포인트 입력부분이 diable일 경우 제휴P조정함수로 아닐경우 P조정함수로..
		if(edt_srch1.enable==false){
		
			btn_save_gr_onclick();
			return;
			
		}
		else if(edt_srch2.enable==false){
		
		
		}			
		btn_save_onclick();
		
		return;
		
	}
	
	/*
	else if(ds_his_list.getColumn(ds_his_list.rowposition,"CHNL_SUB_CO_CODE")=="9100"){
		
		btn_save_gr_onclick(); //제휴P조정
		return;
		
	}else if(ds_his_list.getColumn(ds_his_list.rowposition,"CHNL_SUB_CO_CODE")=="6100"){
		
		btn_save_onclick();   //P조정
		return;
		
	}*/
	
	else if(edt_srch2.value=="" || edt_srch2.value==null){
		
		if(edt_mon_tot.value==null || edt_mon_tot.value==""){
			
			edt_mon_tot.value=0;
		
		}
		
		btn_save_onclick();
		return;
		
	}else{
	
	cf_Alert("COME0002","P조정을 할수 없는 상태입니다.");
	
		if(edt_mon.value==null || edt_mon.value==""){
		
		edt_mon.value=0;
		
		}
		
		//btn_save_gr_onclick();
		
	}
	
}

//------------------------------------------------------------------------------------------
//  포인트 조정 시작
//------------------------------------------------------------------------------------------

function btn_save_onclick(obj:Button,  e:ClickEventInfo)
{
	if(edt_c1.value=="" || edt_c2.value=="" || edt_c3.value=="" || edt_c4.value=="" ||
	edt_c1.value==null || edt_c2.value==null || edt_c3.value==null || edt_c4.value==null ){
	
		cf_Alert("COME0002","포인트 조정할 카드를 선택하셔야 합니다.");
		return;
		
	}
	
	if(cmb_reason.value==null || cmb_reason.value==""){
	
		cf_Alert("COME0002","포인트 조정 발생사유를 입력 하셔야 합니다.");
		return;
		
	}	
		
	if(edt_gnr_pt.value==0 && edt_frch_pt.value==0 && edt_sp_pt.value==0) {
		cf_Alert("COME0002","조정할 포인트를 입력 하셔야 합니다.");
		return;
		
	}			
	
	if(edt_srch1.enable==false){
	
		edt_srch1_cd="610050";
		
	}
		
	var objDate = new Date();
	var currentYear = objDate.getFullYear().toString();
	var currentMonth  = objDate.getMonth()+1;
	var currentDay = objDate.getDate();
	
	if (currentMonth<10){
	
		currentMonth="0"+currentMonth;
		
	}	
	if (currentDay<10){
	
		currentDay="0"+currentDay;
		
	}
	
	var currentHour = objDate.getHours();
	
	if (currentHour<10){
	
		currentHour="0"+currentHour;
		
	}	
		
	var currentMin = objDate.getMinutes();
	
	if (currentMin<10){
	
		currentMin="0"+currentMin;
		
	}	
		
	var currentSec = objDate.getSeconds();
	
	if (currentSec<10){
	
		currentSec="0"+currentSec;
		
	}	
		
	var nextNum = getTrim(GetUserInfo("gUSR_ID"))+currentMin+currentSec;
	var nextNumData = currentYear+currentMonth+currentDay+currentHour+currentMin+currentSec+currentSec+currentSec;
	
	mod_time = getMSToday();
	mod_data = mod_time.substr(0,17);
	
	
	ds_if_point_save_env.clearData();
	ds_if_point_save_data.clearData();
	ds_if_point_save_common.clearData();
	ds_if_point_save_header.clearData();
	ds_if_point_save_column.clearData();
	ds_if_point_save_record.clearData();	
	
		
	fun_ds_srch(ds_if_point_save_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_point_save_env, "REQ_SERVICE_METHOD", 	"ptMdfyInsC01.do"); 
	fun_ds_srch(ds_if_point_save_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_point_save_env, "RES_HEADER_SECTION", 	""); //xml상위 헤더항목
	fun_ds_srch(ds_if_point_save_env, "RES_COLUMN_SECTION", 	""); 
	fun_ds_srch(ds_if_point_save_env, "RES_RECORD_SECTION", 	"STP_PT_MDFY_INS_C01_Rsp"); 

	fun_ds_srch(ds_if_point_save_data,"req_chnl_code","610050");
	fun_ds_srch(ds_if_point_save_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_point_save_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_point_save_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
	fun_ds_srch(ds_if_point_save_data,"in_crd_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value);
		
	//fun_ds_srch(ds_if_point_save_data,"in_frch_cd",edt_srch1.value);
	
	if(edt_srch1_cd==null || edt_srch1_cd==""){
	
		cf_Alert("COME0002","가맹점을 선택 하셔야 합니다.");
		return;
		
	}
				
	fun_ds_srch(ds_if_point_save_data,"in_frch_cd",edt_srch1_cd);
		
	if(edt_gnr_pt.value==null || edt_gnr_pt.value==""){
	
		edt_gnr_pt.value="0";
		
	}
	
	if(edt_sp_pt.value==null || edt_sp_pt.value==""){
	
		edt_sp_pt.value="0";
		
	}
	
	if(edt_frch_pt.value==null || edt_frch_pt.value==""){
	
		edt_frch_pt.value="0";
		
	}		
	
	if(cmb_save_use.value=="02" || cmb_save_use.value=="03"){
		
		if(edt_gnr_pt.value>0){
		
			edt_gnr_pt.value="-"+edt_gnr_pt.value;
			
		}
		
		if(edt_sp_pt.value>0){	
		
			edt_sp_pt.value="-"+edt_sp_pt.value;
			
		}
	
		if(edt_frch_pt.value>0){		
		
			edt_frch_pt.value="-"+edt_frch_pt.value;			
			
		}	
	}		
		
	
	fun_ds_srch(ds_if_point_save_data,"in_aprv_seq",nextNum);
	fun_ds_srch(ds_if_point_save_data,"in_gnrl_pt",edt_gnr_pt.value);
	fun_ds_srch(ds_if_point_save_data,"in_spcl_pt",edt_sp_pt.value);
	fun_ds_srch(ds_if_point_save_data,"in_cprt_pt",edt_frch_pt.value);
	fun_ds_srch(ds_if_point_save_data,"in_rsv_use_div_cd",cmb_save_use.value);
	fun_ds_srch(ds_if_point_save_data,"in_sale_dtime",mod_data);
	fun_ds_srch(ds_if_point_save_data,"in_remark",edt_bmk.value);

	if(cmb_reason.value=="0100"){
	
		fun_ds_srch(ds_if_point_save_data,"in_chnl_div_cd","01");
		
	}else{
	
		fun_ds_srch(ds_if_point_save_data,"in_chnl_div_cd","02");
		
	}
	
	//값이 없을경우 0으로 디폴트 셋팅
		
	if(getTrim(cmb_oil.value)=="" && getTrim(cmb_reason.value)!="0007"){
	
		fun_ds_srch(ds_if_point_save_data,"in_prod_cd","0");
		
	}else{
	
		fun_ds_srch(ds_if_point_save_data,"in_prod_cd",cmb_oil.value);
	
	}
		
	if(getTrim(edt_oil.value)==""){
	
		fun_ds_srch(ds_if_point_save_data,"in_qty","0");
	
	}else{
		
		fun_ds_srch(ds_if_point_save_data,"in_qty",edt_oil.value);
	
	}
		
	if(getTrim(edt_mon_gnr.value)==""){
	
		fun_ds_srch(ds_if_point_save_data,"in_uprc","0");
		
	}else{
	
		fun_ds_srch(ds_if_point_save_data,"in_uprc",edt_mon_gnr.value);
		
	}
		
	if(getTrim(edt_mon_tot.value)==""){
	
		fun_ds_srch(ds_if_point_save_data,"in_amt","0");
		
	}else{
	
		fun_ds_srch(ds_if_point_save_data,"in_amt",edt_mon_tot.value);	
		
	}
		
			
	fun_ds_srch(ds_if_point_save_data,"in_detl_cd",cmb_dtl.value);		
		
	fun_ds_srch(ds_if_point_save_data,"in_alt_chnl_div_cd","02");
	fun_ds_srch(ds_if_point_save_data,"in_tr_ocur_rsn_cd",cmb_reason.value);
	fun_ds_srch(ds_if_point_save_data,"in_inpt_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_point_save_data,"in_inpt_user_ip",getTrim(GetUserInfo("gLGIN_IP")));				
		
	fun_ds_srch(ds_if_point_save_data,"in_tr_ocur_rsn_cntt",edt_bmk.value);
	fun_ds_srch(ds_if_point_save_data,"in_remark",edt_bmk.value);
		
	//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_FROM","20091001");
	//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_TO","20101201");		
							
	var	strSvcID = "IF_CSC_ITRT_078";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_point_save_env:a INTERFACE_DATA=ds_if_point_save_data:a";
	var	strOutDatasets = "ds_if_point_save_common=DS_COMMON ds_if_point_save_header=DS_HEADER ds_if_point_save_column=DS_COLUMN ds_if_point_save_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	//trace(ds_if_point_save_data.saveXML());
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);

	
}


//------------------------------------------------------------------------------------------
//  제휴 포인트 조정 시작
//------------------------------------------------------------------------------------------

function btn_save_gr_onclick(){

	getDsName = this.getOwnerFrame().getDsArgument;
	
	/*if(p_flag=="1"){
	cf_Alert("COME0002","포인트 조정이 불가한 이력입니다.");
	return;
	}*/

	if(edt_c1.value=="" || edt_c2.value=="" || edt_c3.value=="" || edt_c4.value=="" ||

		edt_c1.value==null || edt_c2.value==null || edt_c3.value==null || edt_c4.value==null ){
		cf_Alert("COME0002","포인트 조정할 카드를 선택하셔야 합니다.");
		return;
		
	}
	
	if(cmb_reason.value==null || cmb_reason.value==""){
	
		cf_Alert("COME0002","포인트 조정 발생사유를 입력 하셔야 합니다.");
		return;
		
	}		
	
	/*
	if(edt_gnr_pt.value==0 && edt_frch_pt.value==0 && edt_sp_pt.value==0) {
	cf_Alert("COME0002","조정할 포인트를 입력 하셔야 합니다.");
	return;
	}		
	*/	
	
	/*
	if(edt_srch1.enable==false){
		
		edt_srch2_cd="110403";
		
	}
	*/	
	
	var objDate = new Date();
	var currentYear = objDate.getFullYear().toString();
	var currentMonth  = objDate.getMonth()+1;
	var currentDay = objDate.getDate();
	
	if (currentMonth<10){
	
		currentMonth="0"+currentMonth;
		
	}	
	
	if (currentDay<10){
	
		currentDay="0"+currentDay;
		
	}
	
	var currentHour = objDate.getHours();
	
	if (currentHour<10){
	
		currentHour="0"+currentHour;
		
	}	
		
	var currentMin = objDate.getMinutes();
	
	if (currentMin<10){
	
		currentMin="0"+currentMin;
		
	}		
	
	var currentSec = objDate.getSeconds();
	
	if (currentSec<10){
	
		currentSec="0"+currentSec;
		
	}	
		
	var nextNum = getTrim(GetUserInfo("gUSR_ID"))+currentMin+currentSec;
	var nextNumData = currentYear+currentMonth+currentDay+currentHour+currentMin+currentSec+currentSec+currentSec;
	
	mod_time = getMSToday();
	mod_data = mod_time.substr(0,17);
		
	ds_if_point_save_gr_env.clearData();
	ds_if_point_save_gr_data.clearData();
	ds_if_point_save_gr_common.clearData();
	ds_if_point_save_gr_header.clearData();
	ds_if_point_save_gr_column.clearData();
	ds_if_point_save_gr_record.clearData();	
	
		
	
	fun_ds_srch(ds_if_point_save_gr_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_point_save_gr_env, "REQ_SERVICE_METHOD", 	"ptGsgMdfyInsC01.do"); 
	fun_ds_srch(ds_if_point_save_gr_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_point_save_gr_env, "RES_HEADER_SECTION", 	"STP_GSG_MDFY_INS_C01_Rsp"); //xml상위 헤더항목
	fun_ds_srch(ds_if_point_save_gr_env, "RES_COLUMN_SECTION", 	""); 
	fun_ds_srch(ds_if_point_save_gr_env, "RES_RECORD_SECTION", 	"STP_GSG_MDFY_INS_C01_Rsp"); 

	fun_ds_srch(ds_if_point_save_gr_data,"req_chnl_code","610050");
	fun_ds_srch(ds_if_point_save_gr_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_point_save_gr_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_point_save_gr_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
	fun_ds_srch(ds_if_point_save_gr_data,"in_crd_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value);
		
	
	//fun_ds_srch(ds_if_point_save_data,"in_frch_cd",edt_srch1.value);
	//	if(edt_srch2_cd==null || edt_srch2_cd==""){
	//		cf_Alert("COME0002","가맹점을 선택 하셔야 합니다.");
	//		return;
	//	}
			
	if(ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_FRNCHSE_CODE")!=null){
	
		fun_ds_srch(ds_if_point_save_gr_data,"in_frch_cd",ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_FRNCHSE_CODE"));
		
	}else{
		
		fun_ds_srch(ds_if_point_save_gr_data,"in_frch_cd",edt_srch2_cd);		
	}
		
	//Null 기본값 셋팅	
	if(edt_gnr_pt.value==null || edt_gnr_pt.value==""){
	
		edt_gnr_pt.value="0";
		
	}
	
	if(edt_sp_pt.value==null || edt_sp_pt.value==""){
	
		edt_sp_pt.value="0";
		
	}
	
	if(edt_frch_pt.value==null || edt_frch_pt.value==""){
	
		edt_frch_pt.value="0";
		
	}		
		
		
		
		
	fun_ds_srch(ds_if_point_save_gr_data,"in_cust_no",getDsName.getColumn(0,"CUST_NO")); //고객번호
	fun_ds_srch(ds_if_point_save_gr_data,"in_crd_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value); //카드번호
		
	fun_ds_srch(ds_if_point_save_gr_data,"in_point_clas_cd","03"); //포인트발생구분코드
	fun_ds_srch(ds_if_point_save_gr_data,"in_tr_ocur_rsn_cd",cmb_reason.value); //거래발생사유코드
	fun_ds_srch(ds_if_point_save_gr_data,"in_tr_ocur_rsn_cntt",edt_bmk.value); //거래발생사유내용
	fun_ds_srch(ds_if_point_save_gr_data,"in_detl_cd",cmb_dtl.value); //상세구분
		
	/*
	fun_ds_srch(ds_if_point_save_gr_data,"in_prod_cd",ds_his_list.getColumn(ds_his_list.rowposition,"OIL_CODE")); //상품코드
	fun_ds_srch(ds_if_point_save_gr_data,"in_qty",ds_his_list.getColumn(ds_his_list.rowposition,"OIL_QTY"));
	fun_ds_srch(ds_if_point_save_gr_data,"in_uprc",ds_his_list.getColumn(ds_his_list.rowposition,"DANGA"));
	fun_ds_srch(ds_if_point_save_gr_data,"in_amt",ds_his_list.getColumn(ds_his_list.rowposition,"MONEY"));		
	*/
		
	if(edt_good.value==null || edt_good.value==""){
	
		cf_Alert("COME0002","상품코드가 존재하지 않습니다.");
		return;
		
	}else{
	
		fun_ds_srch(ds_if_point_save_gr_data,"in_prod_cd",edt_good.value); //상품코드
		
	}
		
	if(edt_num.value==null || edt_num.value==""){
	
		fun_ds_srch(ds_if_point_save_gr_data,"in_qty","0");
		
	}else{
	
		fun_ds_srch(ds_if_point_save_gr_data,"in_qty",edt_num.value);
		
	}
		
	if(edt_frch_mon.value==null || edt_frch_mon.value==""){
	
		fun_ds_srch(ds_if_point_save_gr_data,"in_uprc","0");
		
	}else{
	
		fun_ds_srch(ds_if_point_save_gr_data,"in_uprc",edt_frch_mon.value);
		
	}
		
	if(edt_mon.value==null || edt_mon.value==""){
	
		fun_ds_srch(ds_if_point_save_gr_data,"in_amt","0");		
		
	}else{
	
		fun_ds_srch(ds_if_point_save_gr_data,"in_amt",edt_mon.value);		
		
	}	
		
		
	/*
		if(edt_gnr_pt.value=="0"){
		fun_ds_srch(ds_if_point_save_gr_data,"in_gnrl_pt",edt_gnr_pt.value);
		}else{
		edt_gnr_pt.value="-"+edt_gnr_pt.value;
		fun_ds_srch(ds_if_point_save_gr_data,"in_gnrl_pt",edt_gnr_pt.value);
		}
		
		if(edt_frch_pt.value=="0"){
		fun_ds_srch(ds_if_point_save_gr_data,"in_spcl_pt",edt_frch_pt.value);
		}else{
		edt_frch_pt.value="-"+edt_frch_pt.value;
		fun_ds_srch(ds_if_point_save_gr_data,"in_spcl_pt",edt_frch_pt.value);
		}
		
		if(edt_sp_pt.value=="0"){
		fun_ds_srch(ds_if_point_save_gr_data,"in_cprt_pt",edt_sp_pt.value);
		}else{
		edt_sp_pt.value="-"+edt_sp_pt.value;
		fun_ds_srch(ds_if_point_save_gr_data,"in_cprt_pt",edt_sp_pt.value);
		}
	
	*/
		
	
		
	fun_ds_srch(ds_if_point_save_gr_data,"in_gnrl_pt",edt_gnr_pt.value);
	fun_ds_srch(ds_if_point_save_gr_data,"in_spcl_pt",edt_sp_pt.value);
	fun_ds_srch(ds_if_point_save_gr_data,"in_cprt_pt",edt_frch_pt.value);
		
		
	//fun_ds_srch(ds_if_point_save_gr_data,"in_gnrl_pt","5000");
	//fun_ds_srch(ds_if_point_save_gr_data,"in_spcl_pt","5000");
	//fun_ds_srch(ds_if_point_save_gr_data,"in_cprt_pt","5000");
		
	//fun_ds_srch(ds_if_point_save_gr_data,"in_remark",edt_bmk.value);
	
	fun_ds_srch(ds_if_point_save_gr_data,"in_chnl_div_cd","02");
	fun_ds_srch(ds_if_point_save_gr_data,"in_alt_chnl_div_cd","02");
	
	//fun_ds_srch(ds_if_point_save_gr_data,"in_sale_dtime",mod_data);
		
		/*
		if(cmb_save_use.value=="01"){
		fun_ds_srch(ds_if_point_save_gr_data,"in_rsv_use_div_cd","03");
		}else if(cmb_save_use.value=="03"){
		fun_ds_srch(ds_if_point_save_gr_data,"in_rsv_use_div_cd","01");
		}
		*/
		
	if(cmb_reason.value=="0008" && cmb_save_use.value=="01"){
	
		fun_ds_srch(ds_if_point_save_gr_data,"in_rsv_use_div_cd","51"); //+
		
	}else{
		
		fun_ds_srch(ds_if_point_save_gr_data,"in_rsv_use_div_cd","52"); //-
	
		}
		
		//역부호
	
	if(ds_if_point_save_gr_data.getColumn(0,"in_rsv_use_div_cd")=="52"){
	
		
		if(edt_gnr_pt.value>0){
	
			edt_gnr_pt.value="-"+edt_gnr_pt.value;
			
		}
		
		if(edt_sp_pt.value>0){	
		
			edt_sp_pt.value="-"+edt_sp_pt.value;
			
		}
		
		if(edt_frch_pt.value>0){		
		
			edt_frch_pt.value="-"+edt_frch_pt.value;			
			
		}	
		
	}
	
		// 이전 테스트소스
		/*
		if(cmb_save_use.value=="01"){
		fun_ds_srch(ds_if_point_save_gr_data,"in_rsv_use_div_cd","02");
		}else if(cmb_save_use.value=="02"){
		fun_ds_srch(ds_if_point_save_gr_data,"in_rsv_use_div_cd","01");
		}else if(cmb_save_use.value=="03"){
		fun_ds_srch(ds_if_point_save_gr_data,"in_rsv_use_div_cd","04");
		}else if(cmb_save_use.value=="04"){
		fun_ds_srch(ds_if_point_save_gr_data,"in_rsv_use_div_cd","03");
		}		
		*/
			
		//fun_ds_srch(ds_if_point_save_gr_data,"in_aprv_seq",ds_his_list.getColumn(ds_his_list.rowposition,"CHASING_NO"));		
		
	mod_time = getMSToday();
	mod_data = mod_time.substr(0,15);
				
	fun_ds_srch(ds_if_point_save_gr_data,"in_sale_dtime",mod_data);		
				
	fun_ds_srch(ds_if_point_save_gr_data,"in_inpt_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_point_save_gr_data,"in_inpt_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
	//fun_ds_srch(ds_if_point_save_gr_data,"in_aprv_seq",nextNum);		
	//fun_ds_srch(ds_if_point_save_gr_data,"in_alt_chnl_div_cd","02");		
		
	//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_FROM","20091001");
	//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_TO","20101201");		

	fun_ds_srch(ds_if_point_save_data,"in_tr_ocur_rsn_cntt",edt_bmk.value);
	fun_ds_srch(ds_if_point_save_data,"in_remark",edt_bmk.value);					
	
	//trace("Input = " + ds_if_point_save_gr_data.saveXML());
	
	var	strSvcID = "IF_CSC_ITRT_159";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_point_save_gr_env:a INTERFACE_DATA=ds_if_point_save_gr_data:a";
	var	strOutDatasets = "ds_if_point_save_gr_common=DS_COMMON ds_if_point_save_gr_header=DS_HEADER ds_if_point_save_gr_column=DS_COLUMN ds_if_point_save_gr_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
		
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
	
	 //edt_gnr_pt.value=="";
	 //edt_sp_pt.value=="";
	 //edt_frch_pt.value=="";
		
}



//------------------------------------------------------------------------------------------
// 권한 이상의 포인트 조정시 쪽지 발송
//------------------------------------------------------------------------------------------
function Btn_send_onclick(sumP,center_rmk)
{/*
	//if (!cf_Confirm("TSSI0001", "쪽지"))	return;  //!@ 을(를) 발송하시겠습니까?
		
	//필수값체크
	if(!cf_chk_data(Edt_dtlnm, "수신인")) return;
	if(!cf_chk_data(Edt_dtltitle, "제목")) return;
	if(!cf_chk_data(Txa_dtldesc, "내용")) return;

	//길이체크
	if(!cf_size_Alert(ds_dpch_in, ds_dpch_in.rowposition , "TITE" , Edt_dtltitle , 100)) return;
	if(!cf_size_Alert(ds_dpch_in, ds_dpch_in.rowposition , "DPCH_CTT" , Txa_dtldesc , 4000)) return;
	
	//값입력
	//cf_trace("ds_set_param.saveXML()",ds_set_param.saveXML());
	//수신인이 여러명일때
	if (ds_set_param.rowcount > 0){
		for (var i=0; i< ds_set_param.rowcount; i++){
			ds_recv_in.addRow();
			ds_recv_in.setColumn(i,  "RECV_ID", ds_set_param.getColumn(i,"USR_ID") );
		}
	}
	*/
	

	fun_ds_srch(ds_dpch_in, "TITE", "권한이상의 포인트조정 발생");	
	fun_ds_srch(ds_dpch_in, "DPCH_CTT", "고객번호 "+Edt_PopCustNo.value+"님께 "+sumP+"P 포인트 조정이 발생하였습니다." + "\n"+
	" 비고 : " + center_rmk);	
	
	
	fun_ds_srch(ds_recv_in, "RECV_ID", GetConfig("CENTER_SUPER"));	
	
	
	var	strSvcID = "C1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=ds_dpch_in:a INSERT_1_IDATA=ds_recv_in:a SEQSRCH_IDATA=ds_SEQ:a"; 
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=COM241.Set_MSG_DPCH_INSERT INSERT_1_ID=COM241.Set_MSG_RECV_INSERT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	

}


//------------------------------------------------------------------------------------------
//콜백함수
//------------------------------------------------------------------------------------------
function fn_callBack(svcid,strErrCode,strErrMsg){

	edt_srch1_cd="";
	edt_srch2_cd="";
	//trace("svcid = " + svcid);
	switch(svcid){
		case "IF_CSC_ITRT_061" :
		
			sta_row1.text=ds_if_crd_pblc_record.rowcount;
			
			if(ds_if_crd_pblc_record.rowcount>0){
			
				for(i=0;i<ds_if_crd_pblc_record.rowcount;i++){	
					
					ds_card_list.addRow();
					ds_card_list.setColumn(i,"CRD_NO",ds_if_crd_pblc_record.getColumn(i,"CRD_NO"));
					ds_card_list.setColumn(i,"CRD_TP_CD_NM",ds_if_crd_pblc_record.getColumn(i,"CRD_TP_CD_NM"));
					ds_card_list.setColumn(i,"CRD_ST_CD",ds_if_crd_pblc_record.getColumn(i,"CRD_ST_CD"));
					ds_card_list.setColumn(i,"CRD_ST_CD_NM",ds_if_crd_pblc_record.getColumn(i,"CRD_ST_CD_NM"));
					ds_card_list.setColumn(i,"CRD_GNRL_PT",ds_if_crd_pblc_record.getColumn(i,"CRD_GNRL_PT"));
					ds_card_list.setColumn(i,"CRD_SPCL_PT",ds_if_crd_pblc_record.getColumn(i,"CRD_SPCL_PT"));
					ds_card_list.setColumn(i,"CRD_CPRT_PT",ds_if_crd_pblc_record.getColumn(i,"CRD_CPRT_PT"));
					ds_card_list.setColumn(i,"RREG_PBLC_DT",ds_if_crd_pblc_record.getColumn(i,"RREG_PBLC_DT"));
					ds_card_list.setColumn(i,"PBLC_APLY_DIV_CD_NM",ds_if_crd_pblc_record.getColumn(i,"PBLC_APLY_DIV_CD_NM"));
					ds_card_list.setColumn(i,"INPUT_DT",ds_if_crd_pblc_record.getColumn(i,"INPUT_DT"));
					ds_card_list.setColumn(i,"APRV_CHNL_DIV_CD_NM",ds_if_crd_pblc_record.getColumn(i,"APRV_CHNL_DIV_CD_NM"));
					
				}
							
			}else{
			
				ds_card_list.clearData();
			
			}
			
			break;
			
		case "C1" :
		
			cf_trace("ds_dpch_in.saveXML()", ds_dpch_in.saveXML());
			cf_trace("ds_recv_in.saveXML()", ds_recv_in.saveXML());
			
			cf_Alert("COMI0008", "조정한도를 초과하여 관리자에게 내역");	// !@ 이(가) 발송되었습니다.
			
			break;
			
		case "IF_CSC_ITRT_078" :
			
			//trace(ds_if_point_save_record.saveXML());
			var sumP = parseInt(edt_gnr_pt.value)+parseInt(edt_sp_pt.value)+parseInt(edt_frch_pt.value);
			var center_rmk = edt_bmk.value;
			if(ds_if_point_save_record.getColumn(0,"OT_RESPON_CODE")=="00000"){
				
				//btn_re_srch_onclick();
				
				cf_Alert("COME0002","포인트 조정되었습니다.");
				//성공된건중 한도 이상인것만 쪽지 발송
				if(sumP>29999){								
					Btn_send_onclick(sumP,center_rmk);
				}
			
				point_hist_078(); //DB저장
				
			}else{
			
				cf_Alert("COME0002",ds_if_point_save_record.getColumn(0,"OT_RES_MSG"));
			
			}
			
			if(edt_file.value==null || edt_file.value=="" ){
						
			}else{
			
				fn_file_in();
			}		
			btn_clear_onclick();
			
			//fn_saveBizProc();
			
			break;				
			
		case "IF_CSC_ITRT_159" :
			
			if(ds_if_point_save_gr_record.getColumn(0,"OT_RESPON_CODE")=="00000"){
				
				cf_Alert("COME0002","포인트 조정되었습니다.");
				var sumP = parseInt(edt_gnr_pt.value)+parseInt(edt_sp_pt.value)+parseInt(edt_frch_pt.value);
				var center_rmk = edt_bmk.value;
				
				//성공된건중 한도 이상인것만 쪽지 발송
				if(sumP>29999){					
					Btn_send_onclick(sumP,center_rmk);
				}
				
				point_hist_159(); //DB저장
				
			}else{
			
				cf_Alert("COME0002",ds_if_point_save_gr_record.getColumn(0,"OT_RES_MSG"));
				
			}
			
			if(edt_file.value==null || edt_file.value=="" ){
						
			}else{			
				fn_file_in();			
			}			
			btn_clear_onclick();

			//fn_saveBizProc();
			
			break;				
				
		case "IF_CSC_ITRT_158" :
		
			if(re_flag=="0"){
				
				if (ds_if_GSG_grppt_record.rowcount < 1){
					
					cf_Alert("COMI0006");  //조회된건이없습니다.
				
				}
			}
			
			ds_his_list.clearData();
				
			hid_gsg.value=cmb_gubun.value;
				
				
			for (i=0 ; ds_if_GSG_grppt_record.rowcount>i ; i++){
						
			
				ds_his_list.addRow();
								
				ds_his_list.setColumn(i,"PRO_DAY",ds_if_GSG_grppt_record.getColumn(i,'INPUT_DATE_TIME'));
				ds_his_list.setColumn(i,"CRD_NO",ds_if_GSG_grppt_record.getColumn(i,'CARD_NO'));
				ds_his_list.setColumn(i,"CHANNEL",ds_if_GSG_grppt_record.getColumn(i,'CHNL_SUB_CO_CODE_NAME'));
				ds_his_list.setColumn(i,"DTL_GUBUN",ds_if_GSG_grppt_record.getColumn(i,'TRANS_RSN_CODE_NAME'));
				ds_his_list.setColumn(i,"REA_GUBUN",ds_if_GSG_grppt_record.getColumn(i,'TRANS_RSN_CODE_NAME'));
				ds_his_list.setColumn(i,"REA_GUBUN_CD",ds_if_GSG_grppt_record.getColumn(i,'TRANS_RSN_CODE'));
				
				ds_his_list.setColumn(i,"FRCH_NM",ds_if_GSG_grppt_record.getColumn(i,'FRNCHSE_DIV_CODE_NAME'));
				ds_his_list.setColumn(i,"OIL_NM",ds_if_GSG_grppt_record.getColumn(i,'PROD_DESCTN'));
				ds_his_list.setColumn(i,"OIL_CODE",ds_if_GSG_grppt_record.getColumn(i,'PROD_CODE'));
				ds_his_list.setColumn(i,"MONEY",ds_if_GSG_grppt_record.getColumn(i,'SALE_AMT'));
				ds_his_list.setColumn(i,"DANGA",ds_if_GSG_grppt_record.getColumn(i,'UNITPRC'));
				ds_his_list.setColumn(i,"OIL_QTY",ds_if_GSG_grppt_record.getColumn(i,'CNT'));
				ds_his_list.setColumn(i,"POINT",ds_if_GSG_grppt_record.getColumn(i,'OCCUR_PT'));
			
				//ds_his_list.setColumn(i,"A_POINT",ds_if_grppt_record.getColumn(i,'OT_TOT_REST_PT'));
				//ds_his_list.setColumn(i,"T_POINT",ds_if_grppt_record.getColumn(i,'OT_TOT_REST_PT'));
				
				ds_his_list.setColumn(i,"SLIP_DIV_CODE_NAME",ds_if_GSG_grppt_record.getColumn(i,'SLIP_DIV_CODE_NAME'));				
				ds_his_list.setColumn(i,"SLIP_DIV_CODE",ds_if_GSG_grppt_record.getColumn(i,'SLIP_DIV_CODE'));				
				ds_his_list.setColumn(i,"SUB_CO_FRNCHSE_CODE",ds_if_GSG_grppt_record.getColumn(i,"SUB_CO_FRNCHSE_CODE"));
				ds_his_list.setColumn(i,"GEN_PT",ds_if_GSG_grppt_record.getColumn(i,"GEN_RSV_PT"));
				ds_his_list.setColumn(i,"FRCH_PT",ds_if_GSG_grppt_record.getColumn(i,"CPRT_RSV_PT"));
				ds_his_list.setColumn(i,"SP_PT",ds_if_GSG_grppt_record.getColumn(i,"SPECIAL_RSV_PT"));
				
				ds_his_list.setColumn(i,"APPRV_DATE",ds_if_GSG_grppt_record.getColumn(i,"APPRV_DATE"));
				
				ds_his_list.setColumn(i,"SUB_CO_APPRV_DATE",ds_if_GSG_grppt_record.getColumn(i,"SUB_CO_APPRV_DATE"));
				ds_his_list.setColumn(i,"APPRV_NO",ds_if_GSG_grppt_record.getColumn(i,"APPRV_NO"));
				ds_his_list.setColumn(i,"APPRV_DATE_TIME",ds_if_GSG_grppt_record.getColumn(i,"APPRV_DATE_TIME"));
				ds_his_list.setColumn(i,"SUB_CO_TRANS_DATE",ds_if_GSG_grppt_record.getColumn(i,"SUB_CO_TRANS_DATE"));
				ds_his_list.setColumn(i,"SUB_CO_TRANS_TIME",ds_if_GSG_grppt_record.getColumn(i,"SUB_CO_TRANS_TIME"));
				ds_his_list.setColumn(i,"CHASING_NO",ds_if_GSG_grppt_record.getColumn(i,"CHASING_NO"));
				ds_his_list.setColumn(i,"CHNL_SUB_CO_CODE",ds_if_GSG_grppt_record.getColumn(i,"CHNL_SUB_CO_CODE"));
				
				
				//ds_his_list.setColumn(i,"A_POINT",ds_if_grppt_record.getColumn(i,''));
				//ds_his_list.setColumn(i,"T_POINT",ds_if_grppt_record.getColumn(i,''));
				//ds_his_list.setColumn(i,"END_DAY",ds_if_grppt_record.getColumn(i,''));
				//ds_his_list.setColumn(i,"CASH_GUBUN",ds_if_grppt_record.getColumn(i,''));
								
				}				
					
				sta_row2.text=ds_his_list.rowcount;							
				ds_his_list.rowposition=0;
		
			break;				
			
		case "IF_CSC_ITRT_133" :
			
			trace("######"+ds_if_grppt_record.saveXML());
			
			
			//컬럼셋팅
			
			if(re_flag=="0"){
			
				if (ds_if_grppt_record.rowcount < 1){
					
					cf_Alert("COMI0006");  //조회된건이없습니다.
				
				}
			}
			ds_his_list.clearData();
			
			for (i=0 ; ds_if_grppt_record.rowcount>i ; i++){
				
				ds_his_list.addRow();
				
				ds_his_list.setColumn(i,"PRO_DAY",ds_if_grppt_record.getColumn(i,'SUB_CO_TRANS_DATE'));
				ds_his_list.setColumn(i,"CRD_NO",ds_if_grppt_record.getColumn(i,'CARD_NO'));
				ds_his_list.setColumn(i,"CHANNEL",ds_if_grppt_record.getColumn(i,'CHNL_SUB_CO_CODE_NAME'));
				ds_his_list.setColumn(i,"DTL_GUBUN",ds_if_grppt_record.getColumn(i,'TRANS_RSN_CODE_NAME'));
				ds_his_list.setColumn(i,"REA_GUBUN",ds_if_grppt_record.getColumn(i,'TRANS_RSN_CODE_NAME'));
				ds_his_list.setColumn(i,"FRCH_NM",ds_if_grppt_record.getColumn(i,'SUB_CO_FRNCHSE_CODE_NAME'));
				ds_his_list.setColumn(i,"FRCH_CD",ds_if_grppt_record.getColumn(i,'SUB_CO_FRNCHSE_CODE'));
				ds_his_list.setColumn(i,"OIL_NM",ds_if_grppt_record.getColumn(i,'PROD_CODE_NAME'));
				ds_his_list.setColumn(i,"PROD_CODE",ds_if_grppt_record.getColumn(i,'PROD_CODE'));
				ds_his_list.setColumn(i,"MONEY",ds_if_grppt_record.getColumn(i,'SALE_AMT'));
				ds_his_list.setColumn(i,"DANGA",ds_if_grppt_record.getColumn(i,'UNITPRC'));
				ds_his_list.setColumn(i,"REA_GUBUN_CD",ds_if_grppt_record.getColumn(i,'TRANS_RSN_CODE'));
				
				ds_his_list.setColumn(i,"OIL_QTY",ds_if_grppt_record.getColumn(i,'CNT'));
				
				ds_his_list.setColumn(i,"POINT",ds_if_grppt_record.getColumn(i,'OCCUR_PT'));
				ds_his_list.setColumn(i,"A_POINT",ds_if_grppt_record.getColumn(i,'OT_TOT_REST_PT'));
				ds_his_list.setColumn(i,"T_POINT",ds_if_grppt_record.getColumn(i,'OT_TOT_REST_PT'));
				ds_his_list.setColumn(i,"APPRV_NO",ds_if_grppt_record.getColumn(i,'APPRV_NO'));
				ds_his_list.setColumn(i,"SLIP_DIV_CODE_NAME",ds_if_grppt_record.getColumn(i,'SLIP_DIV_CODE_NAME'));
				ds_his_list.setColumn(i,"TRANS_RSN_CODE",ds_if_grppt_record.getColumn(i,'TRANS_RSN_CODE'));
				ds_his_list.setColumn(i,"SUB_CO_APPRV_NO",ds_if_grppt_record.getColumn(i,'SUB_CO_APPRV_NO'));
				ds_his_list.setColumn(i,"APPRV_DATE_TIME",ds_if_grppt_record.getColumn(i,'APPRV_DATE_TIME'));
				ds_his_list.setColumn(i,"SLIP_DIV_CODE",ds_if_grppt_record.getColumn(i,'SLIP_DIV_CODE'));				
				
				ds_his_list.setColumn(i,"GEN_PT",ds_if_grppt_record.getColumn(i,'GEN_RSV_PT'));
				ds_his_list.setColumn(i,"FRCH_PT",ds_if_grppt_record.getColumn(i,'CPRT_RSV_PT'));
				ds_his_list.setColumn(i,"SP_PT",ds_if_grppt_record.getColumn(i,'SPECIAL_RSV_PT'));
				ds_his_list.setColumn(i,"CHNL_SUB_CO_CODE",ds_if_grppt_record.getColumn(i,"CHNL_SUB_CO_CODE"));
				ds_his_list.setColumn(i,"SUB_CO_TRANS_TIME",ds_if_grppt_record.getColumn(i,"SUB_CO_TRANS_TIME"));
				
								
				
				//ds_his_list.setColumn(i,"A_POINT",ds_if_grppt_record.getColumn(i,''));
				//ds_his_list.setColumn(i,"T_POINT",ds_if_grppt_record.getColumn(i,''));
				//ds_his_list.setColumn(i,"END_DAY",ds_if_grppt_record.getColumn(i,''));
				//ds_his_list.setColumn(i,"CASH_GUBUN",ds_if_grppt_record.getColumn(i,''));
								
			}					
			
			sta_row2.text=ds_his_list.rowcount;	
			ds_his_list.rowposition=0;
					
			break;
			
		case "IF_CSC_ITRT_081" :
		
			//cf_trace("ds_dpch_in.saveXML()", ds_dpch_in.saveXML());
			//cf_trace("ds_recv_in.saveXML()", ds_recv_in.saveXML());
			
			if(re_flag=="0"){
			
				if (ds_if_trnpt_record.rowcount < 1){
				
					cf_Alert("COMI0006");  //조회된건이없습니다.
				
				}
			}
			
			ds_his_list.clearData();
			
			for (i=0 ; ds_if_trnpt_record.rowcount>i ; i++){
				
				ds_his_list.addRow();
				
				ds_his_list.setColumn(i,"PRO_DAY",ds_if_trnpt_record.getColumn(i,'APRV_DT'));
				ds_his_list.setColumn(i,"CRD_NO",ds_if_trnpt_record.getColumn(i,'CRD_NO'));
				ds_his_list.setColumn(i,"CHANNEL",ds_if_trnpt_record.getColumn(i,'CHNL_DIV_NM'));
				ds_his_list.setColumn(i,"DTL_GUBUN",ds_if_trnpt_record.getColumn(i,'TR_OCUR_RSN_CNTT'));
				ds_his_list.setColumn(i,"REA_GUBUN",ds_if_trnpt_record.getColumn(i,'TR_OCUR_RSN_NM'));
				ds_his_list.setColumn(i,"REA_GUBUN_CD",ds_if_trnpt_record.getColumn(i,'TR_OCUR_RSN_CD'));
				ds_his_list.setColumn(i,"FRCH_NM",ds_if_trnpt_record.getColumn(i,'SUB_CO_FRNCHSE_CODE_NAME'));
				ds_his_list.setColumn(i,"OIL_NM",ds_if_trnpt_record.getColumn(i,'PROD_CD_NM'));
				ds_his_list.setColumn(i,"OIL_CD",ds_if_trnpt_record.getColumn(i,'PROD_CD'));
				
				ds_his_list.setColumn(i,"MONEY",ds_if_trnpt_record.getColumn(i,'AMT'));
				ds_his_list.setColumn(i,"DANGA",ds_if_trnpt_record.getColumn(i,'UPRC'));
				ds_his_list.setColumn(i,"OIL_QTY",ds_if_trnpt_record.getColumn(i,'QTY'));
				ds_his_list.setColumn(i,"POINT",ds_if_trnpt_record.getColumn(i,'OCCUR_PT'));
				
				ds_his_list.setColumn(i,"A_POINT",ds_if_trnpt_record.getColumn(i,'USBL_PT'));
				ds_his_list.setColumn(i,"T_POINT",ds_if_trnpt_record.getColumn(i,'TOT_ACUM_PT'));
				
				//ds_his_list.setColumn(i,"END_DAY",ds_if_trnpt_record.getColumn(i,''));
				
				ds_his_list.setColumn(i,"CASH_GUBUN",ds_if_trnpt_record.getColumn(i,'PAYM_TP_NM'));
				ds_his_list.setColumn(i,"APPRV_NO",ds_if_trnpt_record.getColumn(i,'APRV_NO'));
				ds_his_list.setColumn(i,"SLIP_DIV_CODE_NAME",ds_if_trnpt_record.getColumn(i,'SLIP_DIV_CODE_NAME'));		
				ds_his_list.setColumn(i,"APPRV_DATE_TIME",ds_if_trnpt_record.getColumn(i,'APRV_TMDAY'));
				ds_his_list.setColumn(i,"SLIP_DIV_CODE",ds_if_trnpt_record.getColumn(i,'RSV_USE_DIV_CD'));
				ds_his_list.setColumn(i,"SLIP_DIV_CODE_NAME",ds_if_trnpt_record.getColumn(i,'RSV_USE_DIV_NM'));						
				ds_his_list.setColumn(i,"FRCH_NM",ds_if_trnpt_record.getColumn(i,'FRCH_NM'));	
				ds_his_list.setColumn(i,"POINT",ds_if_trnpt_record.getColumn(i,'BAL_PT'));
				ds_his_list.setColumn(i,"CHNL_SUB_CO_CODE",ds_if_trnpt_record.getColumn(i,"CHNL_SUB_CO_CODE"));
				ds_his_list.setColumn(i,"GEN_PT",ds_if_trnpt_record.getColumn(i,'GNRL_PT'));
				ds_his_list.setColumn(i,"FRCH_PT",ds_if_trnpt_record.getColumn(i,'CPRT_PT'));
				ds_his_list.setColumn(i,"SP_PT",ds_if_trnpt_record.getColumn(i,'SPCL_PT'));
				ds_his_list.setColumn(i,"SALE_DT",ds_if_trnpt_record.getColumn(i,'SALE_DT'));
				ds_his_list.setColumn(i,"SALE_TMDAY",ds_if_trnpt_record.getColumn(i,'SALE_TMDAY'));
										
			}					
			
			sta_row2.text=ds_his_list.rowcount;		
			ds_his_list.rowposition=0;					
			
						
			break;
		
		case "IF_CSC_ITRT_079" :
		
			if(ds_if_point_cancel_record.getColumn(0,"OT_RESPON_CODE")=="00000"){
				
				cf_Alert("COME0002","P-조정 취소 되었습니다.");
		
					//btn_re_srch_onclick();
					
				point_hist_079(); //DB저장
				
			}else{
			
				cf_Alert("COME0002",ds_if_point_cancel_record.getColumn(0,"OT_RES_MSG"));
			
			}
			
			btn_clear_onclick();
			
			break;
			
		case "AFILE" :
		
				cf_Alert("COME0002","첨부파일저장");
				
			break;	
					
		default : break;				
		
	}
}


//------------------------------------------------------------------------------------------
//  포인트 계산
//------------------------------------------------------------------------------------------
//★주유항목 입력시 처리되는 함수
function cal_ontextchanged()
{

	edt_oil.enable=true;
	edt_mon_gnr.enable=true;

	if(cmb_reason.value=="0100"){
	
		return;
	//★경정비999511 편의점999911은 제외
	}else if(cmb_oil.value=="999511" || cmb_oil.value=="999911"){

		//edt_gnr_pt.value="";
		//edt_oil.value="";
		//edt_mon_gnr.value="";
		//edt_mon_tot.value="";		
			
		edt_oil.value=0;
		edt_mon_gnr.value=0;
			
		edt_oil.enable=false;
		edt_mon_gnr.enable=false;
		
		
	}else if(edt_mon_gnr.value!="" && cmb_oil.text!=""){
		
		edt_oil.enable=true;
		edt_mon_gnr.enable=true;
		
		edt_oil.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value,2);
		
			
	}
			
	cal_ontextchanged2();
			
	if(edt_oil.text=="NaN"){
	
		edt_oil.value="";
		edt_gnr_pt.value="";
		
	}else if(edt_oil.text=="Infinity"){
	
		edt_oil.value="";
		edt_gnr_pt.value="";
			
	}
			
}
//------------------------------------------------------------------------------------------
// 자리 올림 함수
//------------------------------------------------------------------------------------------
function pointCeil(n,n2){

	return Math.ceil(n,n2);
 
}


//------------------------------------------------------------------------------------------
//  유종별 계산
//------------------------------------------------------------------------------------------
function cal_ontextchanged2()
{
	
	
	//세부설정
	
	if(edt_mon_gnr.value!="" && cmb_oil.text!=""){
		
		//★휘발유 0.5유황경유 고급휘발유   EV: EV100
		if(cmb_oil.value=="066011" || cmb_oil.value=="120111" || cmb_oil.value=="061011" || cmb_oil.value=="EV100"){
		
			edt_oil.enable=true;
			edt_mon_gnr.enable=true;
			
			//★발생사유코드가 주유내역누락-모바일, New 빼고 나머지 경우 5PT
			if(cmb_reason.value == "0004" || cmb_reason.value == "0005" || cmb_reason.value == "0006"
			   || cmb_reason.value == "0007" || cmb_reason.value == "0008" || cmb_reason.value == "0025"
			   || cmb_reason.value == "0068" || cmb_reason.value == "0006" || cmb_reason.value == "0100"
			   || cmb_reason.value == "0200" || cmb_reason.value == "9999")
			   {
				edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*5,0);
				
			//★발생사유코드가 주유내역 누락-모바일인 경우 7PT
			}else if(cmb_reason.value == "0072"){
				edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*7,0);
				
			}else if(cmb_reason.value == "0082"){ 
				if(cmb_oil.value == "EV100"){//★EV 발생사유코드가 주유내역누락(New)인 경우 3PT 20210609 김순화책임
					edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*3,0);
				}else{ //★발생사유코드가 주유내역누락(New)인 경우 2PT
					edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*2,0);
			   	}
			}else if(cmb_reason.value == "0083"){ //발생사유코드 3배적립_특별포인트 누락인 경우 2PT
				edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*2,0);
				edt_sp_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*4,0);
			}else if(cmb_reason.value == "0085"){ //발생사유코드 3배적립_특별포인트 누락인 경우 5PT
				edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*5,0);
				edt_sp_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*10,0);
			}else if(cmb_reason.value == "0087"){ //발생사유코드 바로주유내역 포인트 조정일 경우 3PT
				edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*3,0);
			}else if(cmb_reason.value == "0088"){ //발생사유코드 일반주유내역 포인트 조정일 경우 1PT
				edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*1,0);
			}
			
		//★부탄(LPG) 기존 3PT 유지
		}else if(cmb_oil.value=="012011"){
			edt_oil.enable=true;
			edt_mon_gnr.enable=true;
			
			if(cmb_reason.value == "0083" || cmb_reason.value == "0085"){ //발생사유코드 3배적립_특별포인트 누락인 경우 3PT
				
				edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*3,0);
				edt_sp_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*6,0);
				
			}else {
			
				edt_gnr_pt.value=pointCeil(edt_mon_tot.value/edt_mon_gnr.value*3,0);
			}
			
		}else if(cmb_oil.value=="999511" || cmb_oil.value=="999911"){
		
		/*
		edt_gnr_pt.value="";
		edt_oil.value="";
		edt_oil.enable=false;
		edt_mon_gnr.enable=false;
		*/
		
		}else{
		
			edt_oil.enable=true;
			edt_mon_gnr.enable=true;
			edt_gnr_pt.value="";
		
		}
		
	}
	
}


function cmb_dtl_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{

	if(cmb_dtl.text!=""){
	
		edt_sp_pt.value=250;
		
	}else{
	
		edt_sp_pt.value="";
		
	}
	
}


function Btn_WebIdSrchMod_onclick(obj:Button,  e:ClickEventInfo)
{

	ds_get_param.clearData();
	ds_set_param.clearData();
		
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

	PopupDialog("BNS431","BNS::BNS431.xfdl", -1, -1, 972, 539, false, -1, arrParam, false, false, true, false);
	
	if(ds_set_param.rowcount > 0){
	
		edt_srch1.value = ds_set_param.getColumn(ds_set_param.rowposition,"FRCH_NM");
		edt_srch1_cd = ds_set_param.getColumn(ds_set_param.rowposition,"FRCH_CD");	
			
		edt_srch2.enable=false;
		Btn_WebIdSrchMod00.enable=false;
			
		edt_good.enable=false;
		edt_frch_mon.enable=false;
		edt_num.enable=false;
		edt_mon.enable=false;
		
	}
	
}

function Btn_WebIdSrchMod2_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_get_param.clearData();
	ds_set_param.clearData();
		
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

	PopupDialog("BNS432","BNS::BNS432.xfdl", -1, -1, 972, 539, false, -1, arrParam, false, false, true, false);
	
	if(ds_set_param.rowcount > 0){
	
		edt_srch2.value = ds_set_param.getColumn(ds_set_param.rowposition,"CCO_CODE_NAME");
		edt_srch2_cd = ds_set_param.getColumn(ds_set_param.rowposition,"FRNCHSE_CODE");		
		//edt_good.value = ds_set_param.getColumn(ds_set_param.rowposition,"CCO_CODE");		
		
		edt_srch1.enable=false;
		Btn_WebIdSrchMod.enable=false;
			
		edt_oil.enable=false;
		edt_mon_gnr.enable=false;
		cmb_oil.enable=false;
		edt_mon_tot.enable=false;
		
	}
	
}

/**
 * 
 */ 
function Btn_WebIdSrchMod3_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_get_param.clearData();
	ds_set_param.clearData();
		
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

	PopupDialog("BNS433","BNS::BNS433.xfdl", -1, -1, 972, 539, false, -1, arrParam, false, false, true, false);
	
	if(ds_set_param.rowcount > 0){
	
		edt_good.value = ds_set_param.getColumn(ds_set_param.rowposition,"CODE");		
		
		edt_srch1.enable=false;
		Btn_WebIdSrchMod.enable=false;
			
		edt_oil.enable=false;
		edt_mon_gnr.enable=false;
		cmb_oil.enable=false;
		edt_mon_tot.enable=false;
		
	}
	
}

function cls(){

	edt_gnr_pt.value="0";
	edt_srch1.value="";
	edt_oil.value="0";
	edt_mon_gnr.value="0";
	edt_sp_pt.value="0";
	cmb_dtl.value="";
	cmb_oil.value="";
	edt_mon_tot.value="0";
	edt_frch_pt.value="0";
	edt_srch2.value="";
	edt_good.value="";
	edt_frch_mon.value="";
	edt_num.value="";
	edt_mon.value="";
	
	edt_srch1.enable=true;
	Btn_WebIdSrchMod.enable=true;
	
	edt_srch2.enable=true;
	Btn_WebIdSrchMod00.enable=true;
	
	hid_gsg.value="";

}


//P-조정 상태변경
function cmb_reason_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	gsg_point_use=0;
	
	cmb_dtl.enable=false;
	
	if(edt_c1.value=="" || edt_c1.value==null){
	
		cf_Alert("COME0002","카드를 먼저 선택 하셔야 합니다.");
		cmb_reason.value="";
		
		return;
	
	}
	
	/*
	edt_gnr_pt.enable=true;
	edt_srch1.enable=true;
	Btn_WebIdSrchMod.enable=true;
	edt_oil.enable=true;
	edt_mon_gnr.enable=true;
	edt_sp_pt.enable=true;
	cmb_dtl.enable=true;
	cmb_oil.enable=true;
	edt_mon_tot.enable=true;
	edt_frch_pt.enable=true;
	edt_srch2.enable=true;
	Btn_WebIdSrchMod00.enable=true;
	edt_good.enable=true;
	edt_frch_mon.enable=true;
	edt_bmk.enable=true;
	edt_num.enable=true;
	edt_mon.enable=true;
	*/
	
	cls();
		
	edt_gnr_pt.enable=false;
	edt_srch1.enable=false;
	Btn_WebIdSrchMod.enable=false;
	edt_oil.enable=false;
	edt_mon_gnr.enable=false;
	edt_sp_pt.enable=false;
	cmb_dtl.enable=false;
	cmb_oil.enable=false;
	edt_mon_tot.enable=false;
	edt_frch_pt.enable=false;
	edt_srch2.enable=false;
	Btn_WebIdSrchMod00.enable=false;
	edt_good.enable=false;
	edt_frch_mon.enable=false;
	edt_num.enable=false;
	edt_mon.enable=false;
	
	
	var ds_cmb_point = eval(cmb_save_use.innerdataset);
	

	if(cmb_reason.value=="0100"){
	
		ds_cmb_point.filter("CODE == '03' ");	
		
	}else if(cmb_reason.value=="0006"){	
	
		ds_cmb_point.filter("CODE == '01' || CODE == '02'");
		
	}else if(cmb_reason.value=="0068"){
	
		ds_cmb_point.filter("CODE == '01' || CODE == '02'");	
		
	}else{
	
		ds_cmb_point.filter("CODE == '01' || CODE == '02'");
		
	}
	
	if(cmb_reason.value=="0025" || cmb_reason.value=="0004" || cmb_reason.value=="0072" || cmb_reason.value=="0082" || cmb_reason.value=="0087" || cmb_reason.value=="0088"){
	
		edt_gnr_pt.enable=true;
		edt_srch1.enable=true;
		Btn_WebIdSrchMod.enable=true;
		edt_oil.enable=true;
		edt_mon_gnr.enable=true;
		cmb_oil.enable=true;
		edt_mon_tot.enable=true;
	}
	
	//else if(cmb_reason.value=="0005" || cmb_reason.value=="0006"){
	//	edt_gnr_pt.enable=true;
	//}
		
	else if(cmb_reason.value=="0100" || cmb_reason.value=="0068" || cmb_reason.value=="0005" || cmb_reason.value=="0006" || cmb_reason.value=="9999"){
		
		edt_gnr_pt.enable=true;
		edt_srch1.enable=true;
		Btn_WebIdSrchMod.enable=true;
		edt_oil.enable=true;
		edt_mon_gnr.enable=true;
		edt_sp_pt.enable=false;
		cmb_dtl.enable=false;
		cmb_oil.enable=true;
		edt_mon_tot.enable=true;
		edt_frch_pt.enable=false;
		edt_srch2.enable=false;
		Btn_WebIdSrchMod00.enable=false;
		edt_good.enable=false;
		edt_frch_mon.enable=false;
		edt_bmk.enable=true;
		edt_num.enable=false;
		edt_mon.enable=false;
		
	}else if(cmb_reason.value=="0007"){
	
		edt_gnr_pt.enable=false;
		edt_srch1.enable=false;
		Btn_WebIdSrchMod.enable=false;
		edt_oil.enable=false;
		edt_mon_gnr.enable=false;
		edt_sp_pt.enable=true;
		cmb_dtl.enable=true;
		cmb_oil.enable=false;
		edt_mon_tot.enable=false;
		edt_frch_pt.enable=false;
		edt_srch2.enable=false;
		Btn_WebIdSrchMod00.enable=false;
		edt_good.enable=false;
		edt_frch_mon.enable=false;
		edt_bmk.enable=true;
		edt_num.enable=false;
		edt_mon.enable=false;
		
	}else if(cmb_reason.value=="0008"){
	
		/*
		//다음 다이렉트 카드일경우 밸리데이션 체크해야함
	    if(edt_c1.value+edt_c2.value == 01906106){
		
				if(edt_c3.value+edt_c4.value>"01999999"){ //&& edt_c3.value+edt_c4.value<04000000
				  if(edt_c3.value+edt_c4.value<"04000000"){
				
				edt_sp_pt.enable=false;
				cmb_dtl.enable=false;
			//	edt_frch_pt.readonly=true;
					gsg_point_use=1;
					}
				}
						
		}else if(edt_c1.value+edt_c2.value == 01905100){
		
				if(edt_c3.value+edt_c4.value>"19000000"){ //&& edt_c3.value+edt_c4.value<04000000
				  if(edt_c3.value+edt_c4.value<"20000000"){
				
				edt_sp_pt.enable=false;
				cmb_dtl.enable=false;
			//	edt_frch_pt.readonly=true;
					gsg_point_use=1;
					}
				}
						
		}
			

		//위내용은 다음구분용임, 아래는 실제 조정 구분
		if(gsg_point_use==1){
		
	edt_gnr_pt.enable=true;
	edt_srch1.enable=true;
	Btn_WebIdSrchMod.enable=true;
	edt_oil.enable=true;
	edt_mon_gnr.enable=true;
	edt_sp_pt.enable=false;
	cmb_dtl.enable=false;
	cmb_oil.enable=true;
	edt_mon_tot.enable=true;
	edt_frch_pt.enable=true;
	edt_srch2.enable=true;
	Btn_WebIdSrchMod00.enable=true;
	edt_good.enable=true;
	edt_frch_mon.enable=true;
	edt_bmk.enable=true;
	edt_num.enable=true;
	edt_mon.enable=true;
	*/	
	//}else{
		
		edt_gnr_pt.enable=false;
		edt_srch1.enable=false;	
		Btn_WebIdSrchMod.enable=false;
		edt_oil.enable=false;
		edt_mon_gnr.enable=false;
		edt_sp_pt.enable=false;
		cmb_dtl.enable=false;
		cmb_oil.enable=false;
		edt_mon_tot.enable=false;
		edt_frch_pt.enable=true;
		edt_srch2.enable=true;
		Btn_WebIdSrchMod00.enable=true;
		edt_good.enable=true;
		edt_frch_mon.enable=false;
		edt_bmk.enable=true;
		edt_num.enable=false;
		edt_mon.enable=true;
	//}
	
	}else if(cmb_reason.value=="0083" || cmb_reason.value=="0085"){		 //3배적립_일반특별포인트 누락 2016.10.11 스마트 카드 추가 2016.10.27
		
		edt_gnr_pt.enable=true;
		edt_srch1.enable=true;
		Btn_WebIdSrchMod.enable=true;
		edt_oil.enable=true;
		edt_mon_gnr.enable=true;
		edt_sp_pt.enable=false;
		cmb_dtl.enable=false;
		cmb_oil.enable=true;
		edt_mon_tot.enable=true;
		edt_frch_pt.enable=false;
		edt_srch2.enable=false;
		Btn_WebIdSrchMod00.enable=false;
		edt_good.enable=false;
		edt_frch_mon.enable=false;
		edt_bmk.enable=true;
		edt_num.enable=false;
		edt_mon.enable=false;
	
	}else if(cmb_reason.value=="0084" || cmb_reason.value=="0086"){		//3배적립_특별포인트 누락 2016.10.11 / 스마트 카드 추가 2016.10.27
	
		edt_gnr_pt.enable=false;
		edt_srch1.enable=false;
		Btn_WebIdSrchMod.enable=false;
		edt_oil.enable=false;
		edt_mon_gnr.enable=false;
		edt_sp_pt.enable=false;
		cmb_dtl.enable=false;
		cmb_oil.enable=false;
		edt_mon_tot.enable=false;
		edt_frch_pt.enable=false;
		edt_srch2.enable=false;
		Btn_WebIdSrchMod00.enable=false;
		edt_good.enable=false;
		edt_frch_mon.enable=false;
		edt_bmk.enable=true;
		edt_num.enable=false;
		edt_mon.enable=false;
	
	
	}else{
	
		edt_gnr_pt.enable=true;
		edt_srch1.enable=false;
		Btn_WebIdSrchMod.enable=false;
		edt_oil.enable=true;
		edt_mon_gnr.enable=true;
		edt_sp_pt.enable=true;
		cmb_dtl.enable=true;
		cmb_oil.enable=true;
		edt_mon_tot.enable=true;
		edt_frch_pt.enable=true;
		edt_srch2.enable=true;
		Btn_WebIdSrchMod00.enable=true;
		edt_good.enable=true;
		edt_frch_mon.enable=true;
		edt_bmk.enable=true;
		edt_num.enable=true;
		edt_mon.enable=true;
	}
	
}


function cmb_save_use_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//alert(cmb_save_use.value); //적립 01
}


//포인트조정삭제
function btn_save_cancel_onclick(obj:Button,  e:ClickEventInfo)
{

	if(ds_his_list.rowcount=="0" || ds_his_list.rowposition=="-1"){
	
		cf_Alert("COME0002","구매이력을 선택하셔야 합니다.");
		return;
		
	}

	if(getTrim(del_pro_day.value)==""){
		
		cf_Alert("COME0002","구매이력을 선택하셔야 합니다.");
		return;
		
	}
	
	del_pro_day.value="";


	//통합고객의경우
	if(ds_cust_info.getColumn(0,"OT_GRP_AGR_YN")=="Y"){
		
		if(getTrim(hid_gsg.value)!=""){
		
			// GSG조회의 경우
			getDsName = this.getOwnerFrame().getDsArgument;
	
			var objDate = new Date();
			var currentYear = objDate.getFullYear().toString();
			var currentMonth  = objDate.getMonth()+1;
			var currentDay = objDate.getDate();
	
			if (currentMonth<10){
			
				currentMonth="0"+currentMonth;
				
			}	
			
			if (currentDay<10){
			
				currentDay="0"+currentDay;
				
			}
			
			var currentHour = objDate.getHours();
			
			if (currentHour<10){
			
				currentHour="0"+currentHour;
				
			}	
				
			var currentMin = objDate.getMinutes();
			
			if (currentMin<10){
			
				currentMin="0"+currentMin;
				
			}	
				
			var currentSec = objDate.getSeconds();
			
			if (currentSec<10){
			
				currentSec="0"+currentSec;
				
			}	
				
			var nextNum = getTrim(GetUserInfo("gUSR_ID"))+currentMin+currentSec;
			var nextNumData = currentYear+currentMonth+currentDay+currentHour+currentMin+currentSec+currentSec+currentSec;
			
			mod_time = getMSToday();
			mod_data = mod_time.substr(0,17);
		
			ds_if_point_save_gr_env.clearData();
			ds_if_point_save_gr_data.clearData();
			ds_if_point_save_gr_common.clearData();
			ds_if_point_save_gr_header.clearData();
			ds_if_point_save_gr_column.clearData();
			ds_if_point_save_gr_record.clearData();	
		
			
			
			fun_ds_srch(ds_if_point_save_gr_env, "IF_KIND", 			"WAS");
			fun_ds_srch(ds_if_point_save_gr_env, "REQ_SERVICE_METHOD", 	"ptGsgMdfyInsC01.do"); //공통이 어디까지?
			fun_ds_srch(ds_if_point_save_gr_env, "REQ_SERVICE_ID", 		"");
			fun_ds_srch(ds_if_point_save_gr_env, "RES_HEADER_SECTION", 	"STP_GSG_MDFY_INS_C01_Rsp"); //xml상위 헤더항목
			fun_ds_srch(ds_if_point_save_gr_env, "RES_COLUMN_SECTION", 	""); 
			fun_ds_srch(ds_if_point_save_gr_env, "RES_RECORD_SECTION", 	"STP_GSG_MDFY_INS_C01_Rsp"); 

			fun_ds_srch(ds_if_point_save_gr_data,"req_chnl_code","610050");
			fun_ds_srch(ds_if_point_save_gr_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
			fun_ds_srch(ds_if_point_save_gr_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
			fun_ds_srch(ds_if_point_save_gr_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
			
		
		
			//fun_ds_srch(ds_if_point_save_data,"in_frch_cd",edt_srch1.value);
			//	if(edt_srch2_cd==null || edt_srch2_cd==""){
			//		cf_Alert("COME0002","가맹점을 선택 하셔야 합니다.");
			//		return;
			//	}
			
	
			if(edt_gnr_pt.value==null || edt_gnr_pt.value==""){
			
				edt_gnr_pt.value="0";
				
			}
			
			if(edt_sp_pt.value==null || edt_sp_pt.value==""){
			
				edt_sp_pt.value="0";
				
			}
			
			if(edt_frch_pt.value==null || edt_frch_pt.value==""){
			
				edt_frch_pt.value="0";
				
			}		
								
			
			fun_ds_srch(ds_if_point_save_gr_data,"in_cust_no",getDsName.getColumn(0,"CUST_NO")); //고객번호
			fun_ds_srch(ds_if_point_save_gr_data,"in_crd_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value); //카드번호
			
			fun_ds_srch(ds_if_point_save_gr_data,"in_point_clas_cd","03"); //포인트발생구분코드
			fun_ds_srch(ds_if_point_save_gr_data,"in_tr_ocur_rsn_cd",cmb_reason.value); //거래발생사유코드
			fun_ds_srch(ds_if_point_save_gr_data,"in_tr_ocur_rsn_cntt",edt_bmk.value); //거래발생사유내용
			//fun_ds_srch(ds_if_point_save_gr_data,"in_detl_cd",cmb_dtl.value); //상세구분
				
			
			fun_ds_srch(ds_if_point_save_gr_data,"in_prod_cd","0"); //상품코드
			fun_ds_srch(ds_if_point_save_gr_data,"in_qty","0");
			fun_ds_srch(ds_if_point_save_gr_data,"in_uprc","0");
			fun_ds_srch(ds_if_point_save_gr_data,"in_amt","0");		
				
								
			fun_ds_srch(ds_if_point_save_gr_data,"in_sale_dtime",ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_TRANS_DATE")+""+ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_TRANS_TIME")+"000000");		
				
			fun_ds_srch(ds_if_point_save_gr_data,"in_inpt_user_id",getTrim(GetUserInfo("gUSR_ID")));
			fun_ds_srch(ds_if_point_save_gr_data,"in_inpt_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
			//fun_ds_srch(ds_if_point_save_gr_data,"in_aprv_seq",nextNum);		
			//fun_ds_srch(ds_if_point_save_gr_data,"in_alt_chnl_div_cd","02");		
			
			//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_FROM","20091001");
			//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_TO","20101201");	
			
			fun_ds_srch(ds_if_point_save_gr_data,"in_gnrl_pt",edt_gnr_pt.value);
			fun_ds_srch(ds_if_point_save_gr_data,"in_spcl_pt",edt_sp_pt.value);
			fun_ds_srch(ds_if_point_save_gr_data,"in_cprt_pt",edt_frch_pt.value);
			fun_ds_srch(ds_if_point_save_gr_data,"in_frch_cd",ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_FRNCHSE_CODE"));
		 
		 	fun_ds_srch(ds_if_point_save_gr_data,"in_apprv_date",ds_his_list.getColumn(ds_his_list.rowposition,"APPRV_DATE"));
		 	fun_ds_srch(ds_if_point_save_gr_data,"in_apprv_no",ds_his_list.getColumn(ds_his_list.rowposition,"APPRV_NO"));
				
			trace(">>>>>>>>>>>>>>>>>>>>"+ds_if_point_save_gr_data.saveXML());
						
								
			var	strSvcID = "IF_CSC_ITRT_159";
			var	strURL = SVC_IF_URL;	
			var	strInDatasets = "INTERFACE_ENV=ds_if_point_save_gr_env:a INTERFACE_DATA=ds_if_point_save_gr_data:a";
			var	strOutDatasets = "ds_if_point_save_gr_common=DS_COMMON ds_if_point_save_gr_header=DS_HEADER ds_if_point_save_gr_column=DS_COLUMN ds_if_point_save_gr_record=DS_RECORD";
			var	strArgument = "";
			var strCallbackFunc = "fn_callBack";
			var strProcessBar = true;
			
			cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
		
	
		}else if(p_flag==1 && ds_his_list.getColumn(ds_his_list.rowposition,"CHNL_SUB_CO_CODE")=="6100"){
	
			if(edt_c1.value=="" || edt_c2.value=="" || edt_c3.value=="" || edt_c4.value=="" ||
			edt_c1.value==null || edt_c2.value==null || edt_c3.value==null || edt_c4.value==null ){
				
				cf_Alert("COME0002","삭제할 구매이력을 선택하셔야 합니다.");
				return;
				
			}
			/*
			if(cmb_reason.value==null || cmb_reason.value==""){
			cf_Alert("COME0002","포인트 삭제 발생사유를 입력 하셔야 합니다.");
					return;
			}		
			*/
	
			var objDate = new Date();
			var currentYear = objDate.getFullYear().toString();
			var currentMonth  = objDate.getMonth()+1;
			var currentDay = objDate.getDate();
	
			if (currentMonth<10){
			
				currentMonth="0"+currentMonth;
				
			}	
			
			if (currentDay<10){
			
				currentDay="0"+currentDay;
				
			}
			
			var currentHour = objDate.getHours();
			
			if (currentHour<10){
			
				currentHour="0"+currentHour;
				
			}	
				
			var currentMin = objDate.getMinutes();
			
			if (currentMin<10){
			
				currentMin="0"+currentMin;
				
			}	
				
			var currentSec = objDate.getSeconds();
			
			if (currentSec<10){
			
				currentSec="0"+currentSec;
				
			}	
				
			var nextNum = getTrim(GetUserInfo("gUSR_ID"))+currentMin+currentSec;
			var nextNumData = currentYear+currentMonth+currentDay+currentHour+currentMin+currentSec+currentSec+currentSec;
			
			
			ds_if_point_cancel_env.clearData();
			ds_if_point_cancel_data.clearData();
			ds_if_point_cancel_common.clearData();
			ds_if_point_cancel_header.clearData();
			ds_if_point_cancel_column.clearData();
			ds_if_point_cancel_record.clearData();	
		
			
			
			fun_ds_srch(ds_if_point_cancel_env, "IF_KIND", 			"WAS");
			fun_ds_srch(ds_if_point_cancel_env, "REQ_SERVICE_METHOD", 	"ptMdfyCnclC01.do"); //공통이 어디까지?
			fun_ds_srch(ds_if_point_cancel_env, "REQ_SERVICE_ID", 		"");
			fun_ds_srch(ds_if_point_cancel_env, "RES_HEADER_SECTION", 	"STP_PT_MDFY_CNCL_C01_Rsp"); //xml상위 헤더항목
			fun_ds_srch(ds_if_point_cancel_env, "RES_COLUMN_SECTION", 	""); 
			fun_ds_srch(ds_if_point_cancel_env, "RES_RECORD_SECTION", 	"STP_PT_MDFY_CNCL_C01_Rsp"); 

			fun_ds_srch(ds_if_point_cancel_data,"req_chnl_code","610050");
			fun_ds_srch(ds_if_point_cancel_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
			fun_ds_srch(ds_if_point_cancel_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
			fun_ds_srch(ds_if_point_cancel_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
							
			
			fun_ds_srch(ds_if_point_cancel_data,"in_chnl_div_cd","02");
		
			var aprv_trim = ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_TRANS_TIME");		
		
			fun_ds_srch(ds_if_point_cancel_data,"in_sale_dtime",ds_his_list.getColumn(ds_his_list.rowposition,"PRO_DAY")+""+aprv_trim);
		
			//fun_ds_srch(ds_if_point_cancel_data,"in_rsv_use_div_cd","02");
			
			fun_ds_srch(ds_if_point_cancel_data,"in_crd_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value);
						
		
			if(ds_cust_info.getColumn(0,"OT_GRP_AGR_YN")=="Y"){
				
				if(cmb_reason.value=="0100"){
					fun_ds_srch(ds_if_point_cancel_data,"in_aprv_seq",ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_APPRV_NO").substr(4,8));
					fun_ds_srch(ds_if_point_cancel_data,"in_chnl_div_cd","01");
				}else{
					fun_ds_srch(ds_if_point_cancel_data,"in_aprv_seq",ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_APPRV_NO"));
				}
			
			}else{
		
				fun_ds_srch(ds_if_point_cancel_data,"in_aprv_seq",ds_his_list.getColumn(ds_his_list.rowposition,"APPRV_NO"));
		
			}
		
			fun_ds_srch(ds_if_point_cancel_data,"in_alt_chnl_div_cd","02");
			
			if(ds_his_list.getColumn(ds_his_list.rowposition,"REA_GUBUN_CD")==null || ds_his_list.getColumn(ds_his_list.rowposition,"REA_GUBUN_CD")==""){
				
				cf_Alert("COME0002","삭제 할수 없는 이력 입니다.");
				return;
				
			}else{
				
				fun_ds_srch(ds_if_point_cancel_data,"in_tr_ocur_rsn_cd",ds_his_list.getColumn(ds_his_list.rowposition,"REA_GUBUN_CD"));
		
			}
		
			fun_ds_srch(ds_if_point_cancel_data,"in_inpt_user_id",getTrim(GetUserInfo("gUSR_ID")));
			fun_ds_srch(ds_if_point_cancel_data,"in_inpt_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
			
		
			
												
			var	strSvcID = "IF_CSC_ITRT_079";
			var	strURL = SVC_IF_URL;	
			var	strInDatasets = "INTERFACE_ENV=ds_if_point_cancel_env:a INTERFACE_DATA=ds_if_point_cancel_data:a";
			var	strOutDatasets = "ds_if_point_cancel_common=DS_COMMON ds_if_point_cancel_header=DS_HEADER ds_if_point_cancel_column=DS_COLUMN ds_if_point_cancel_record=DS_RECORD";
			var	strArgument = "";
			var strCallbackFunc = "fn_callBack";
			var strProcessBar = true;
			
			cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
			
		}else{
		
			cf_Alert("COME0002","삭제 할수 없는 이력 입니다.");
				
		}
	} //그룹동의여부 Y
	
	else{ //그룹동의여부 N
	
		if(edt_c1.value=="" || edt_c2.value=="" || edt_c3.value=="" || edt_c4.value=="" ||
			
			edt_c1.value==null || edt_c2.value==null || edt_c3.value==null || edt_c4.value==null ){
			cf_Alert("COME0002","구매이력을 선택하셔야 합니다.");
		
			return;
			
		}
	
		/*
		if(cmb_reason.value==null || cmb_reason.value==""){
		cf_Alert("COME0002","포인트 삭제 발생사유를 입력 하셔야 합니다.");
		return;
		}		
		*/
		
		var objDate = new Date();
		var currentYear = objDate.getFullYear().toString();
		var currentMonth  = objDate.getMonth()+1;
		var currentDay = objDate.getDate();
		
		if (currentMonth<10){
		
			currentMonth="0"+currentMonth;
			
		}	
		
		if (currentDay<10){
		
			currentDay="0"+currentDay;
			
		}
		
		var currentHour = objDate.getHours();
		
		if (currentHour<10){
		
			currentHour="0"+currentHour;
			
		}		
		
		var currentMin = objDate.getMinutes();
		
		if (currentMin<10){
		
			currentMin="0"+currentMin;
			
		}	
			
		var currentSec = objDate.getSeconds();
		
		if (currentSec<10){
		
			currentSec="0"+currentSec;
			
		}		
		
		var nextNum = getTrim(GetUserInfo("gUSR_ID"))+currentMin+currentSec;
		var nextNumData = currentYear+currentMonth+currentDay+currentHour+currentMin+currentSec+currentSec+currentSec;
		
		
		ds_if_point_cancel_env.clearData();
		ds_if_point_cancel_data.clearData();
		ds_if_point_cancel_common.clearData();
		ds_if_point_cancel_header.clearData();
		ds_if_point_cancel_column.clearData();
		ds_if_point_cancel_record.clearData();	
	
		
		
		fun_ds_srch(ds_if_point_cancel_env, "IF_KIND", 			"WAS");
		fun_ds_srch(ds_if_point_cancel_env, "REQ_SERVICE_METHOD", 	"ptMdfyCnclC01.do"); //공통이 어디까지?
		fun_ds_srch(ds_if_point_cancel_env, "REQ_SERVICE_ID", 		"");
		fun_ds_srch(ds_if_point_cancel_env, "RES_HEADER_SECTION", 	"STP_PT_MDFY_CNCL_C01_Rsp"); //xml상위 헤더항목
		fun_ds_srch(ds_if_point_cancel_env, "RES_COLUMN_SECTION", 	""); 
		fun_ds_srch(ds_if_point_cancel_env, "RES_RECORD_SECTION", 	"STP_PT_MDFY_CNCL_C01_Rsp"); 

		fun_ds_srch(ds_if_point_cancel_data,"req_chnl_code","610050");
		fun_ds_srch(ds_if_point_cancel_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_point_cancel_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_point_cancel_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
						
		
		fun_ds_srch(ds_if_point_cancel_data,"in_chnl_div_cd","02");
		
		var aprv_trim = ds_his_list.getColumn(ds_his_list.rowposition,"SALE_TMDAY");		
		
		fun_ds_srch(ds_if_point_cancel_data,"in_sale_dtime",ds_his_list.getColumn(ds_his_list.rowposition,"PRO_DAY")+""+aprv_trim);
		
		//fun_ds_srch(ds_if_point_cancel_data,"in_rsv_use_div_cd","02");
		
		fun_ds_srch(ds_if_point_cancel_data,"in_crd_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value);
						
		
		if(ds_cust_info.getColumn(0,"OT_GRP_AGR_YN")=="Y"){
		
		
			if(cmb_reason.value=="0100"){
		
				fun_ds_srch(ds_if_point_cancel_data,"in_aprv_seq",ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_APPRV_NO").substr(4,8));
			
			}else{
				
				fun_ds_srch(ds_if_point_cancel_data,"in_aprv_seq",ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_APPRV_NO"));
			
			}
						
		}else{
		
			fun_ds_srch(ds_if_point_cancel_data,"in_aprv_seq",ds_his_list.getColumn(ds_his_list.rowposition,"APPRV_NO"));
		
		}
		
		fun_ds_srch(ds_if_point_cancel_data,"in_alt_chnl_div_cd","02");
		
		if(ds_his_list.getColumn(ds_his_list.rowposition,"REA_GUBUN_CD")==null || ds_his_list.getColumn(ds_his_list.rowposition,"REA_GUBUN_CD")==""){
		
			cf_Alert("COME0002","삭제 할수 없는 이력 입니다.");
			return;
		
		}else{
			
			fun_ds_srch(ds_if_point_cancel_data,"in_tr_ocur_rsn_cd",ds_his_list.getColumn(ds_his_list.rowposition,"REA_GUBUN_CD"));
		
		}
		
		fun_ds_srch(ds_if_point_cancel_data,"in_inpt_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_point_cancel_data,"in_inpt_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
		//오일로 
		
		if(cmb_reason.value=="0100"){
		
			fun_ds_srch(ds_if_point_cancel_data,"in_chnl_div_cd","01");		
		
		}else{
			
			fun_ds_srch(ds_if_point_cancel_data,"in_chnl_div_cd","02");				
		
		}
		
			
		if(cmb_save_use.value=="01"){
		
			fun_ds_srch(ds_if_point_cancel_data,"in_rsv_use_div_cd","02"); //-
			
		}else if(cmb_save_use.value=="03"){
		
			fun_ds_srch(ds_if_point_cancel_data,"in_rsv_use_div_cd","04"); //-
			
		}
											
											
		var	strSvcID = "IF_CSC_ITRT_079";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_point_cancel_env:a INTERFACE_DATA=ds_if_point_cancel_data:a";
		var	strOutDatasets = "ds_if_point_cancel_common=DS_COMMON ds_if_point_cancel_header=DS_HEADER ds_if_point_cancel_column=DS_COLUMN ds_if_point_cancel_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
		
	}
		
		
		
}


function grd_his_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	//alert(ds_his_list.getColumn(ds_his_list.rowposition,"APPRV_NO"));
	//alert(ds_his_list.getColumn(ds_his_list.rowposition,"CHNL_SUB_CO_CODE"));	
	//cmb_reason.enable=false;
	
	if(cmb_reason.value == "0084" || cmb_reason.value == "0086"){	//특별포인트 적립일 경우 2016.10.14
		
		edt_sp_pt.value=(ds_his_list.getColumn(ds_his_list.rowposition,"GEN_PT")*2);
		
		edt_mon_tot.value=ds_his_list.getColumn(ds_his_list.rowposition,"MONEY");
		edt_oil.value=ds_his_list.getColumn(ds_his_list.rowposition,"OIL_QTY");
		edt_mon_gnr.value=ds_his_list.getColumn(ds_his_list.rowposition,"DANGA");
		
		cmb_oil.value="999999";			//특별포인트 적립의 경우 상품(유종) 코드 기타로 셋팅
		
	}else {
	
		delete_enable(true);
		
		delete_readonly(true);	
		delete_popup(false);
			
		ds_his_list.getColumn(ds_his_list.rowposition,"APPRV_NO");
		
		edt_c1.value=ds_his_list.getColumn(ds_his_list.rowposition,"CRD_NO").substr(0,4);
		edt_c2.value=ds_his_list.getColumn(ds_his_list.rowposition,"CRD_NO").substr(4,4);
		edt_c3.value=ds_his_list.getColumn(ds_his_list.rowposition,"CRD_NO").substr(8,4);
		edt_c4.value=ds_his_list.getColumn(ds_his_list.rowposition,"CRD_NO").substr(12,4);
		
		//cmb_reason.value=9999;
		
		cmb_save_use.value=ds_his_list.getColumn(ds_his_list.rowposition,"SLIP_DIV_CODE");	
		del_pro_day.value=ds_his_list.getColumn(ds_his_list.rowposition,"PRO_DAY");
		
		if(p_flag=="1"){
		
			cls();
		
			edt_gnr_pt.value=ds_his_list.getColumn(ds_his_list.rowposition,"GEN_PT");
			edt_sp_pt.value=ds_his_list.getColumn(ds_his_list.rowposition,"SP_PT");
			edt_frch_pt.value=ds_his_list.getColumn(ds_his_list.rowposition,"FRCH_PT");
			
		
			if(ds_cust_info.getColumn(0,"OT_GRP_AGR_YN")=="Y"){	
				
				cmb_oil.value=ds_his_list.getColumn(ds_his_list.rowposition,"PROD_CODE");
					
			}else{
			
				cmb_oil.value=ds_his_list.getColumn(ds_his_list.rowposition,"OIL_CD");
					
			}
				
			edt_mon_tot.value=ds_his_list.getColumn(ds_his_list.rowposition,"MONEY");
			edt_oil.value=ds_his_list.getColumn(ds_his_list.rowposition,"OIL_QTY");
			edt_mon_gnr.value=ds_his_list.getColumn(ds_his_list.rowposition,"DANGA");
		
			if(ds_his_list.getColumn(ds_his_list.rowposition,"CHNL_SUB_CO_CODE")=="9100"){
				
				edt_srch2.value=ds_his_list.getColumn(ds_his_list.rowposition,"FRCH_NM");
				edt_srch2_cd=ds_his_list.getColumn(ds_his_list.rowposition,"FRCH_CD");
					
			}else{
				
				edt_srch1.value=ds_his_list.getColumn(ds_his_list.rowposition,"FRCH_NM");
				edt_srch1_cd=ds_his_list.getColumn(ds_his_list.rowposition,"FRCH_CD");
			}
				
			if(ds_cust_info.getColumn(0,"OT_GRP_AGR_YN")=="Y"){	
				
				cmb_reason.value=ds_his_list.getColumn(ds_his_list.rowposition,"TRANS_RSN_CODE");
				
			}else{
			
				cmb_reason.value=ds_his_list.getColumn(ds_his_list.rowposition,"REA_GUBUN_CD");
				
			}	
		
		}else if(p_flag=="2"){
		
			cls();
		
			edt_gnr_pt.value=ds_his_list.getColumn(ds_his_list.rowposition,"GEN_PT");
			edt_sp_pt.value=ds_his_list.getColumn(ds_his_list.rowposition,"SP_PT");
			edt_frch_pt.value=ds_his_list.getColumn(ds_his_list.rowposition,"FRCH_PT");
			edt_good.value=ds_his_list.getColumn(ds_his_list.rowposition,"OIL_NM");
			edt_mon.value=ds_his_list.getColumn(ds_his_list.rowposition,"MONEY");
			edt_num.value=ds_his_list.getColumn(ds_his_list.rowposition,"OIL_QTY");
			edt_frch_mon.value=ds_his_list.getColumn(ds_his_list.rowposition,"DANGA");
			edt_srch2.value=ds_his_list.getColumn(ds_his_list.rowposition,"FRCH_NM");
			edt_srch2_cd=ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_FRNCHSE_CODE");
		
			cmb_reason.value=ds_his_list.getColumn(ds_his_list.rowposition,"TRANS_RSN_CODE");
				
			//......먼가해야하는데..
				
		}else if(p_flag=="3"){ //적립포인트
		
			cls();
				
			edt_gnr_pt.value=ds_his_list.getColumn(ds_his_list.rowposition,"GEN_PT");
			edt_sp_pt.value=ds_his_list.getColumn(ds_his_list.rowposition,"SP_PT");
			edt_frch_pt.value=ds_his_list.getColumn(ds_his_list.rowposition,"FRCH_PT");
			cmb_oil.value=ds_his_list.getColumn(ds_his_list.rowposition,"OIL_CD");
			edt_mon.value=ds_his_list.getColumn(ds_his_list.rowposition,"MONEY");
			edt_num.value=ds_his_list.getColumn(ds_his_list.rowposition,"OIL_QTY");
			edt_frch_mon.value=ds_his_list.getColumn(ds_his_list.rowposition,"DANGA");
			edt_srch2.value=ds_his_list.getColumn(ds_his_list.rowposition,"FRCH_NM");
			edt_srch2_cd=ds_his_list.getColumn(ds_his_list.rowposition,"SUB_CO_FRNCHSE_CODE");
		
			cmb_reason.value=ds_his_list.getColumn(ds_his_list.rowposition,"TRANS_RSN_CODE");
				
			//......먼가해야하는데..
			
		}
		
	}
	
	//cmb_reason.enable=false;

}


//------------------------------------------------------------------------------------------
// 첨부파일 저장
//------------------------------------------------------------------------------------------
function fn_file_in(){
		
	//alert(mod_time);
		
	getDsName = this.getOwnerFrame().getDsArgument;
	
	mod_data = mod_time.substr(0,17)+"000";
	
	ds_if_hist_file.clearData();
	
	fun_ds_srch(ds_if_hist_file, "PGM_ID","BNS430");
	fun_ds_srch(ds_if_hist_file, "CUST_ID",getDsName.getColumn(0,"CUST_NO"));
	
//	fun_ds_srch(ds_if_hist_file, "CRD_NO",);
//	fun_ds_srch(ds_if_hist_file, "ADJ_BEF_PINT",edt_one_pa.value);
//	fun_ds_srch(ds_if_hist_file, "ADJ_AF_PINT",edt_month_pa.value);
	
	
	
	fun_ds_srch(ds_if_hist_file, "PROC_DTM",mod_data);
	
	
	var	strSvcID = "AFILE";
	var	strURL = SVC_USR_URL;
//	var	strURL = SVC_SEND_URL;
//	var	strInDatasets = "FILELIST=ds_file:a";
	var	strInDatasets = "INSERT_0_IDATA=ds_FILELIST:a INSERT_1_IDATA=ds_if_hist_file SEQSRCH_IDATA=ds_SEQ2:a";
	//var	strInDatasets = "INSERT_0_IDATA=ds_bns_srch:a SEQSRCH_IDATA=ds_SEQ:a INSERT_1_IDATA=ds_alarm:a"; 
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=BNS430.Set_APND_FILE_INSERT INSERT_1_ID=BNS430.Set_IF_APND_FILE_INSERT";
	//var	strArgument = "INSERT_0_ID=BNS290.Set_BNS_INSERT INSERT_1_ID=Common.Set_AlamInf_INSERT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		
	
}


// 업무처리정보등록
function fn_saveBizProc()
{

	var getDsName  = this.getOwnerFrame().getDsArgument;

	//alert(this.opener.parent.parent.all["Tab_CntctHistInfo"]["tabpage1"].all["ds_cnsl_seq_out"]);
	var objCnslDs  = this.opener.parent.parent.all["Tab_CntctHistInfo"]["tabpage1"].all["ds_cnsl_seq_out"];
	var strCnslSeq = "";
	
	if(objCnslDs.rowcount  > 0){
	
		strCnslSeq = objCnslDs.getColumn(0,"CNSL_SEQ_NO")
		
	}

	var obj = new Object();	
	
	obj.PGM_ID 		= "BNS430";
	obj.CUST_ID 	= getDsName.getColumn(0,"CUST_NO");
	obj.CRD_NO 		= "";
	obj.PROC_ATM 	= "";
	obj.CNSL_SEQ_NO = strCnslSeq;
	obj.USR_ID 		= gds_User.getColumn(gds_User.rowposition,"GBL_USR_ID");
	
	setBizProcInfo(obj);
	
	var	strSvcID = "C3";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=gds_BizProcInfo:a"; 
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=Common.Set_BizProcInfo_INSERT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	
}


function setBizProcInfo(arrObj){

	gds_BizProcInfo.clearData();
	
	var row = gds_BizProcInfo.addRow();
	
	gds_BizProcInfo.setColumn(row, "PGM_ID" 		, arrObj.PGM_ID);
	gds_BizProcInfo.setColumn(row, "CUST_ID" 		, arrObj.CUST_ID);
	gds_BizProcInfo.setColumn(row, "CRD_NO" 		, arrObj.CRD_NO);
	gds_BizProcInfo.setColumn(row, "PROC_ATM" 		, arrObj.PROC_ATM);
	gds_BizProcInfo.setColumn(row, "CNSL_SEQ_NO" 	, arrObj.CNSL_SEQ_NO);
	gds_BizProcInfo.setColumn(row, "USR_ID" 		, arrObj.USR_ID);
	
	trace(gds_BizProcInfo.saveXML());
	
}


function btn_clear_onclick(obj:Button,  e:ClickEventInfo)
{
	gsg_point_use=0;
	
	ds_card_list.setColumn(ds_card_list.findRow("CHK","1"),"CHK","0");
			
	cmb_reason.enable=true;
	cmb_reason.value="";
	edt_gnr_pt.enable=true;
	edt_srch1.enable=true;
	Btn_WebIdSrchMod.enable=true;
	edt_oil.enable=true;
	edt_mon_gnr.enable=true;
	edt_sp_pt.enable=true;
	cmb_dtl.enable=true;
	cmb_oil.enable=true;
	edt_mon_tot.enable=true;
	edt_frch_pt.enable=true;
	edt_srch2.enable=true;
	Btn_WebIdSrchMod00.enable=true;
	edt_good.enable=true;
	edt_frch_mon.enable=true;
	edt_bmk.enable=true;
	edt_num.enable=true;
	edt_mon.enable=true;
	
	edt_c1.value="";
	edt_c2.value="";
	edt_c3.value="";
	edt_c4.value="";
	
	cls();
	
	btn_find.enable=true;
	btn_cancel.enable=true;
	btn_save.enable=true;
		
}

function new_search(){


	getDsName = this.getOwnerFrame().getDsArgument;

	if(ds_cust_info.getColumn(0,"OT_GRP_AGR_YN")=="Y"){
	
		ds_if_grppt_env.clearData();
		ds_if_grppt_data.clearData();
		ds_if_grppt_common.clearData();
		ds_if_grppt_header.clearData();
		ds_if_grppt_column.clearData();
		ds_if_grppt_record.clearData();	
	
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_grppt_env,"WAS","ptGrpptSelC01.do","","STP_PT_GRPPT_SEL_C01_Rsp","","OT_OUT_CURSOR","","","","");

		fun_ds_srch(ds_if_grppt_data,"req_chnl_code","610050");
		fun_ds_srch(ds_if_grppt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_grppt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_grppt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
					
		
		//fun_ds_srch(ds_if_grppt_data, "in_cust_no",objDsCust.getColumn(0,"IO_CUST_NO"));
		// 테스트용
		fun_ds_srch(ds_if_grppt_data, "in_cust_no",getDsName.getColumn(0,"CUST_NO"));			
		//fun_ds_srch(ds_if_grppt_data, "in_card_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value);
		fun_ds_srch(ds_if_grppt_data, "in_from_date",cal_00.value);
		fun_ds_srch(ds_if_grppt_data, "in_to_date",cal_01.value);						
		
		//	fun_ds_srch(ds_if_grppt_data, "in_cust_no","");
		//	fun_ds_srch(ds_if_grppt_data, "in_card_no",strSelCrdNo);
			
		
		//fun_ds_srch(ds_if_grppt_data, "in_from_date",Cal_SrchFrmDt.value);
		//fun_ds_srch(ds_if_grppt_data, "in_to_date",Cal_SrchToDt.value);
		
		fun_ds_srch(ds_if_grppt_data, "in_page_no","0");
		fun_ds_srch(ds_if_grppt_data, "in_page_size","0");
	
		var	strSvcID = "IF_CSC_ITRT_133";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_grppt_env:a INTERFACE_DATA=ds_if_grppt_data:a";
		var	strOutDatasets = "ds_if_grppt_common=DS_COMMON ds_if_grppt_header=DS_HEADER ds_if_grppt_column=DS_COLUMN ds_if_grppt_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	}
		
	else{
			
		// 적립포인트조회
	
		ds_if_trnpt_env.clearData();
		ds_if_trnpt_data.clearData();
		ds_if_trnpt_common.clearData();
		ds_if_trnpt_header.clearData();
		ds_if_trnpt_column.clearData();
		ds_if_trnpt_record.clearData();
		
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_trnpt_env,"WAS","ptTrnptSelC08.do","","STP_PT_TRNPT_SEL_C01_Rsp","","OT_OUT_CURSOR","","","","");		
				
		fun_ds_srch(ds_if_trnpt_data,"req_chnl_code","610050");
		fun_ds_srch(ds_if_trnpt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_trnpt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_trnpt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
			
		/*
		fun_ds_srch(ds_if_trnpt_data, "in_search_key","1");
		
		fun_ds_srch(ds_if_trnpt_data, "in_head_rs_bz_no","380221");
		fun_ds_srch(ds_if_trnpt_data, "in_tail_rs_bz_no","1234567");
		fun_ds_srch(ds_if_trnpt_data, "in_strt_dt","20080101");
		fun_ds_srch(ds_if_trnpt_data, "in_end_dt","20080331");						
	
		*/
		fun_ds_srch(ds_if_trnpt_data, "in_search_key","1");
		
		fun_ds_srch(ds_if_trnpt_data, "in_cust_no",getDsName.getColumn(0,"CUST_NO"));
		fun_ds_srch(ds_if_trnpt_data, "in_strt_dt",cal_00.value);
		fun_ds_srch(ds_if_trnpt_data, "in_end_dt",cal_01.value);						
		 
				
		//fun_ds_srch(ds_if_trnpt_data, "in_head_rs_bz_no",getTrim(objDsCust.getColumn(0,"OT_HEAD_RS_BZ_NO")));
		//fun_ds_srch(ds_if_trnpt_data, "in_tail_rs_bz_no",getTrim(objDsCust.getColumn(0,"OT_TAIL_RS_BZ_NO")));
		//fun_ds_srch(ds_if_trnpt_data, "in_crd_no",strSelCrdNo);		
		//fun_ds_srch(ds_if_trnpt_data, "in_strt_dt",Cal_SrchFrmDt.value);
		//fun_ds_srch(ds_if_trnpt_data, "in_end_dt",Cal_SrchToDt.value);
		//fun_ds_srch(ds_if_trnpt_data, "in_rsv_use_div_cd",Cmb_SaveDiv.value);			// 적립사용구분
		//fun_ds_srch(ds_if_trnpt_data, "in_frch_div_cd",Cmb_Affil.value);				// 가맹점구분
						
		var	strSvcID = "IF_CSC_ITRT_081";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_trnpt_env:a INTERFACE_DATA=ds_if_trnpt_data:a";
		var	strOutDatasets = "ds_if_trnpt_common=DS_COMMON ds_if_trnpt_header=DS_HEADER ds_if_trnpt_column=DS_COLUMN ds_if_trnpt_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	
	}

}


//------------------------------------------------------------------------------------------
// 이력 재조회
//------------------------------------------------------------------------------------------
function btn_re_srch_onclick(obj:Button,  e:ClickEventInfo)
{

	re_flag="1";

	if(cmb_gubun.value=="" || cmb_gubun.value==null){
	

		if(cal_00.value=="" || cal_01.value=="" || cal_00.value==null || cal_01.value==null){
	
			cf_Alert("COME0003","기간");
			return;
	
		}
	
		if(ds_card_list.findRow("CHK","1")=="-1"){	
	
			new_search(); //고객 구매이력 조회
			return;
			
		}
	
		if(ds_cust_info.getColumn(0,"OT_GRP_AGR_YN")=="Y"){
	
			p_flag=1;
		
			ds_if_grppt_env.clearData();
			ds_if_grppt_data.clearData();
			ds_if_grppt_common.clearData();
			ds_if_grppt_header.clearData();
			ds_if_grppt_column.clearData();
			ds_if_grppt_record.clearData();	
		
			// 환경DS 세팅
			fn_setIfEnvDs(ds_if_grppt_env,"WAS","ptGrpptSelC01.do","","STP_PT_GRPPT_SEL_C01_Rsp","","OT_OUT_CURSOR","","","","");

			fun_ds_srch(ds_if_grppt_data,"req_chnl_code","610050");
			fun_ds_srch(ds_if_grppt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
			fun_ds_srch(ds_if_grppt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
			fun_ds_srch(ds_if_grppt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
						
			
			//fun_ds_srch(ds_if_grppt_data, "in_cust_no",objDsCust.getColumn(0,"IO_CUST_NO"));

			fun_ds_srch(ds_if_grppt_data, "in_cust_no","");			
			fun_ds_srch(ds_if_grppt_data, "in_card_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value);
			fun_ds_srch(ds_if_grppt_data, "in_from_date",cal_00.value);
			fun_ds_srch(ds_if_grppt_data, "in_to_date",cal_01.value);						
			
			//	fun_ds_srch(ds_if_grppt_data, "in_cust_no","");
			//	fun_ds_srch(ds_if_grppt_data, "in_card_no",strSelCrdNo);
				
			
			//fun_ds_srch(ds_if_grppt_data, "in_from_date",Cal_SrchFrmDt.value);
			//fun_ds_srch(ds_if_grppt_data, "in_to_date",Cal_SrchToDt.value);
		
			fun_ds_srch(ds_if_grppt_data, "in_page_no","0");
			fun_ds_srch(ds_if_grppt_data, "in_page_size","0");
		
			var	strSvcID = "IF_CSC_ITRT_133";
			var	strURL = SVC_IF_URL;	
			var	strInDatasets = "INTERFACE_ENV=ds_if_grppt_env:a INTERFACE_DATA=ds_if_grppt_data:a";
			var	strOutDatasets = "ds_if_grppt_common=DS_COMMON ds_if_grppt_header=DS_HEADER ds_if_grppt_column=DS_COLUMN ds_if_grppt_record=DS_RECORD";
			var	strArgument = "";
			var strCallbackFunc = "fn_callBack";
			var strProcessBar = true;
			
			cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
			
		}
		else{
			
			
			p_flag=1;
	// 적립포인트조회
	
			ds_if_trnpt_env.clearData();
			ds_if_trnpt_data.clearData();
			ds_if_trnpt_common.clearData();
			ds_if_trnpt_header.clearData();
			ds_if_trnpt_column.clearData();
			ds_if_trnpt_record.clearData();
			
			// 환경DS 세팅
			fn_setIfEnvDs(ds_if_trnpt_env,"WAS","ptTrnptSelC08.do","","STP_PT_TRNPT_SEL_C01_Rsp","","OT_OUT_CURSOR","","","","");		
					
			fun_ds_srch(ds_if_trnpt_data,"req_chnl_code","610050");
			fun_ds_srch(ds_if_trnpt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
			fun_ds_srch(ds_if_trnpt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
			fun_ds_srch(ds_if_trnpt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
				
			/*
			fun_ds_srch(ds_if_trnpt_data, "in_search_key","1");
		
			fun_ds_srch(ds_if_trnpt_data, "in_head_rs_bz_no","380221");
			fun_ds_srch(ds_if_trnpt_data, "in_tail_rs_bz_no","1234567");
			fun_ds_srch(ds_if_trnpt_data, "in_strt_dt","20080101");
			fun_ds_srch(ds_if_trnpt_data, "in_end_dt","20080331");						
			*/
			fun_ds_srch(ds_if_trnpt_data, "in_search_key","2");
		
			fun_ds_srch(ds_if_trnpt_data, "in_crd_no",edt_c1.value+""+edt_c2.value+""+edt_c3.value+""+edt_c4.value);
			fun_ds_srch(ds_if_trnpt_data, "in_strt_dt",cal_00.value);
			fun_ds_srch(ds_if_trnpt_data, "in_end_dt",cal_01.value);						
		 
				
			//fun_ds_srch(ds_if_trnpt_data, "in_head_rs_bz_no",getTrim(objDsCust.getColumn(0,"OT_HEAD_RS_BZ_NO")));
			//fun_ds_srch(ds_if_trnpt_data, "in_tail_rs_bz_no",getTrim(objDsCust.getColumn(0,"OT_TAIL_RS_BZ_NO")));
			//fun_ds_srch(ds_if_trnpt_data, "in_crd_no",strSelCrdNo);		
			//fun_ds_srch(ds_if_trnpt_data, "in_strt_dt",Cal_SrchFrmDt.value);
			//fun_ds_srch(ds_if_trnpt_data, "in_end_dt",Cal_SrchToDt.value);
			//fun_ds_srch(ds_if_trnpt_data, "in_rsv_use_div_cd",Cmb_SaveDiv.value);			// 적립사용구분
			//fun_ds_srch(ds_if_trnpt_data, "in_frch_div_cd",Cmb_Affil.value);				// 가맹점구분
						
			var	strSvcID = "IF_CSC_ITRT_081";
			var	strURL = SVC_IF_URL;	
			var	strInDatasets = "INTERFACE_ENV=ds_if_trnpt_env:a INTERFACE_DATA=ds_if_trnpt_data:a";
			var	strOutDatasets = "ds_if_trnpt_common=DS_COMMON ds_if_trnpt_header=DS_HEADER ds_if_trnpt_column=DS_COLUMN ds_if_trnpt_record=DS_RECORD";
			var	strArgument = "";
			var strCallbackFunc = "fn_callBack";
			var strProcessBar = true;
			
			cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
		}
		
	}else{
	
		//alert("GSG GROUP 구매이력 조회");
	
		p_flag=2;
	
		if(cal_00.value=="" || cal_01.value=="" || cal_00.value==null || cal_01.value==null){
		
			cf_Alert("COME0003","기간");
			return;
		
		}
			
	
		getDsName = this.getOwnerFrame().getDsArgument;
	
		ds_if_GSG_grppt_env.clearData();
		ds_if_GSG_grppt_data.clearData();
		ds_if_GSG_grppt_common.clearData();
		ds_if_GSG_grppt_header.clearData();
		ds_if_GSG_grppt_column.clearData();
		ds_if_GSG_grppt_record.clearData();	
	
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_GSG_grppt_env,"WAS","ptGsgGrpptSelC01.do","","STP_GSG_GRPPT_SEL_C01_Rsp","","OT_OUT_CURSOR","","","","");

		fun_ds_srch(ds_if_GSG_grppt_data,"req_chnl_code","610050");
		fun_ds_srch(ds_if_GSG_grppt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_GSG_grppt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_GSG_grppt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
					
		
		//fun_ds_srch(ds_if_grppt_data, "in_cust_no",objDsCust.getColumn(0,"IO_CUST_NO"));
		
		fun_ds_srch(ds_if_GSG_grppt_data, "in_cust_no",getDsName.getColumn(0,"CUST_NO"));						
		fun_ds_srch(ds_if_GSG_grppt_data, "in_from_date",cal_00.value);
		fun_ds_srch(ds_if_GSG_grppt_data, "in_to_date",cal_01.value);							
		
		//fun_ds_srch(ds_if_GSG_grppt_data, "in_cco_code","");						
		fun_ds_srch(ds_if_GSG_grppt_data, "in_cco_code",cmb_gubun.value);						
								
		
		//	fun_ds_srch(ds_if_grppt_data, "in_cust_no","");
		//	fun_ds_srch(ds_if_grppt_data, "in_card_no",strSelCrdNo);
			
		
		//fun_ds_srch(ds_if_grppt_data, "in_from_date",Cal_SrchFrmDt.value);
		//fun_ds_srch(ds_if_grppt_data, "in_to_date",Cal_SrchToDt.value);
	
		fun_ds_srch(ds_if_GSG_grppt_data, "in_page_no","0");
		fun_ds_srch(ds_if_GSG_grppt_data, "in_page_size","0");
	
		var	strSvcID = "IF_CSC_ITRT_158";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_GSG_grppt_env:a INTERFACE_DATA=ds_if_GSG_grppt_data:a";
		var	strOutDatasets = "ds_if_GSG_grppt_common=DS_COMMON ds_if_GSG_grppt_header=DS_HEADER ds_if_GSG_grppt_column=DS_COLUMN ds_if_GSG_grppt_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		
		
	}
}

/* 포인트 조정 예전 소스(저장 IF) validation용
function save()	{

		if (Trim(ps.point_reason.value).length == 0)
		{
			alert("발생사유를 선택하십시요.");
			return;
		}
		if (ps.proc_date.value.length > 0)
		{
			if(ps.point_reason.value == "0006" && (ps.general.value < 0 || ps.special.value < 0 || ps.cooper.value < 0))
			{
				alert("포인트가 '-'인 것은 부정고객포인트 삭감을 할 수 없습니다.");
				return;
			}
			if (ps.point_reason.value == "0006" || ps.point_reason.value == "0100") //부정고객포인트 삭감 || OILRO
			{
				if (Trim(ps.general.value) != Trim(ps.old_general.value)) {
						alert("일반 포인트를 수정할 수 없습니다");
						ps.general.value = ps.old_general.value;
						return;
				}
			}
			else{
				alert("포인트 조정내역은 수정할 수 없습니다.");
				return;
			}
		}

		if (ps.point_reason.value == "0004" || ps.point_reason.value == "0005" || ps.point_reason.value == "0006"){
				if (Trim(ps.general.value) == "" || ps.general.value == "0") {
						alert("일반 포인트를 입력하십시요");
						ps.special.value = "";
						ps.cooper.value = "";
						return;
				}
		}else if (ps.point_reason.value == "0007"){
				if (Trim(ps.special.value) == "" || ps.special.value == "0") {
						alert("특별 포인트를 입력하십시요");
						ps.general.value = "";
						ps.cooper.value = "";
						return;
				}
		}else if (ps.point_reason.value == "0008" || ps.point_reason.value == "0009"){
				if (Trim(ps.cooper.value) == "" || ps.cooper.value == "0") {
						alert("제휴 포인트를 입력하십시요");
						ps.special.value = "";
						ps.general.value = "";
						return;
				}
				// 발생사유가 [제휴포인트누락]의 경우 제휴사가 설정되어 있지 않은 경우
				// 주유소 코드를 설정하고 주유소코드도 설정되어 있지 않은 경으는 "610050"을 설정한다
				if (Trim(ps.corp_code.value) == "") {
					alert("제휴사를 선택하십시오.");
					return;
					//if (Trim(ps.ss_code.value) != ""){
					//	ps.corp_code.value = ps.ss_code.value;
					//}else{
					//	ps.corp_code.value = "610050";
					//}
				}else{
					ps.ss_code.value = ps.corp_code.value;
				}
		}
		// 2006.05.16.....P환가변경으로 일반 상담사 조정한도 5000-->20000으로 수정됨
		// 2009.07.14.....슈퍼바이져 요청으로 일반 상담사 조정 한도 20000--> 10000으로 수정함
		if (<%=!userinfoSB.getUserAuth().equals("A") && !userinfoSB.getUserAuth().equals("J")%>){
			if (ps.general.value*1 + ps.special.value*1 + ps.cooper.value*1 > 10000)
			{
					alert("10,000점 이상은 관리자만 처리할 수 있습니다.");
					alert("userinfoSB.getUserAuth()="+userinfoSB.getUserAuth()+"입니다.");
					return;

			}
		}
		
			
		

		// Oilro 추가 ---------------------------------------------
		if (ps.point_reason.value == "0100")
		{
			if (<%=!userinfoSB.getUserAuth().equals("A") && !userinfoSB.getUserAuth().equals("J")%>)
			{
				alert("OILRO 포인트 조정은 관리자만 처리할 수 있습니다.");
				return;
			} //inpyo 추가(050808)

			  if (ps.prod_code.value =="") {
			    alert("포인트 사용에 대한 포인트조정은 유종을 선택하여야 합니다.");
			    return;
			  }


			  if (ps.ss_code.value =="") {
			    alert("포인트 사용에 대한 포인트조정은 가맹점(주유소)을 선택하여야 합니다.");
			    return;
			  }

			  if (ps.acum_use_clas_select.value =="") {
			    alert("포인트사용 / 포인트사용취소 중 하나를 선택해 주세요");
			    return;
			  }
			  if(ps.acum_use_clas_select.value != "03" && ps.acum_use_clas_select.value != "04")
			  {
			    alert("OILRO는 포인트사용 / 포인트사용취소 중 선택 할 수 있습니다.");
			    return;
			  } //inpyo(050926)
	   		  if(ps.proc_date.value.length > 0)
			  {
			  	if(ps.acum_use_clas_select.value == "03")
			  	{
				  	alert("포인트 사용 취소만 선택할 수 있습니다");
				  	return;
			  	}
			  	else if(ps.acum_use_clas_select.value == "04")
			  	{
			  		if(ps.general.value > 0)
			  		{
			  			alert("이미 포인트 사용 취소된 상태입니다.");
			  			return;
			  		}
			  	}
			  }
			  else
			  {
				  if(ps.acum_use_clas_select.value == "03" && (ps.general.value > 0 || ps.special.value > 0 || ps.cooper.value > 0))
				  {
				  	alert("포인트 사용은 '-'값만 입력할 수 있습니다.");
				  	return;
				  }
				  if(ps.acum_use_clas_select.value == "04" && (ps.general.value < 0 || ps.special.value < 0 || ps.cooper.value < 0))
				  {
				  	alert("포인트 사용취소는  '+'값만 입력할 수 있습니다.");
				  	return;
				  }
			   }
			  if((Trim(ps.general.value) == "" || ps.general.value == "0") && (Trim(ps.special.value) == "" || ps.special.value == "0")
			  	&& (Trim(ps.cooper.value) == "" || ps.cooper.value == "0"))
			  {
			    alert("조정할 포인트를 입력하십시요.");
			    return;
			  } //inpyo(050926)

			  if(ps.prod_amt.value == ""){
			  	alert("주유금액을 입력해주세요.");
			  	return;
			  }

			  ps.acum_use_clas.value = ps.acum_use_clas_select.value;
	  // alert(ps.acum_use_clas.value);
			// alert("Oilro");
			// return;
		}
		// Oilro 끝 ---------------------------------------------
		//콜센터 포인트 조정 ================================================================
		// Oilro 추가 ---------------------------------------------
		else if (ps.point_reason.value == "0068")
		{
			if (ps.acum_use_clas_select.value =="") {
			    alert("포인트 적립 취소를 선택해 주세요");
			    return;
			}
			if(ps.acum_use_clas_select.value != "02")
			{
			    alert("콜센터 포인트 조정은 포인트 적립 취소만 선택 할 수 있습니다.");
			    return;
			}
	   		if(ps.acum_use_clas_select.value == "02" && (ps.general.value > 0 || ps.special.value > 0 || ps.cooper.value > 0))
			{
			 	alert("콜센터 포인트 조정은 '-'값만 입력할 수 있습니다.");
			  	return;
			}

			if((Trim(ps.general.value) == "" || ps.general.value == "0") && (Trim(ps.special.value) == "" || ps.special.value == "0")
			  	&& (Trim(ps.cooper.value) == "" || ps.cooper.value == "0"))
			{
			    alert("조정할 포인트를 입력하십시요.");
			    return;
			}

			ps.acum_use_clas.value = ps.acum_use_clas_select.value;

		}
		//콜센터 포인트 조정 끝 ==============================================================
		else
		{//OILRO 이외에는 '포인트 적립' / '포익트 적립 취소'만 사용 가능
			  if(ps.acum_use_clas_select.value != "01" && ps.acum_use_clas_select.value != "02")	//발생사유
			  {
			    alert("포인트적립 / 포인트적립취소 중 반드시 하나를 선택해야 합니다.");
			    return;
			  }
			  if(ps.acum_use_clas_select.value == "01" && (ps.general.value < 0 || ps.special.value < 0 || ps.cooper.value < 0))
			  {
			  	alert("포인트 적립은 '+'값만 입력할 수 있습니다.");
			  	return;
			  }
			  if(ps.acum_use_clas_select.value == "02" && (ps.general.value > 0 || ps.special.value > 0 || ps.cooper.value > 0))
			  {
			  	alert("포인트 적립 취소는 '-'값만 입력할 수 있습니다.");
			  	return;
			  }


			  ps.acum_use_clas.value = ps.acum_use_clas_select.value;
		}

		ps.resident_no.value = parent.frames[0].document.form1.resident_no.value;
		ps.card_no.value = ps.card_no1.value + ps.card_no2.value + ps.card_no3.value + ps.card_no4.value;
		ps.general.value = remove_str(ps.general.value,",");
		ps.special.value = remove_str(ps.special.value,",");
		ps.cooper.value = remove_str(ps.cooper.value,",");
		if ((ps.general.value*1 + ps.special.value*1 + ps.cooper.value*1 > 0) && ps.point_reason.value != "0006"&& ps.card_no.value.length < 16)
		{
			alert("카드번호를 입력하십시요.");
			return;
		}
		if(ps.point_reason.value == "0100" && ps.card_no.value.length < 16)
		{
			alert("카드번호를 입력하십시요.");
			return;
		}
		if (Trim(ps.card_no.value).length < 16)	ps.card_no.value = "";

		// 주유소정보를 필수로 한다. 박완규
		// 발생사유가 [포인주조정(Oilro정산],[주유내역누락]일경우 주유소코드 필수
		if ((ps.point_reason.value=="0100" || ps.point_reason.value=="0004") && ps.ss_code.value =="") {
			alert("가맹점(주유소)을 선택하십시오.");
			return;
		}

//		if(ps.point_reason.value == "0008"){
//			if(ps.corp_code.value == ""){
//				alert("제휴사를 선택하십시오.");
//				return;
//			}else{
//				ps.ss_code.value = ps.corp_code.value;
//			}
//		}

		// 적립/사용구분이 "포인트 적립 취소"일 경우는 주유소 코드에 "610050"를 설정한다
		if(ps.acum_use_clas_select.value == "02"){
			ps.ss_code.value = "610050";
		}

		if(ps.ss_code.value ==""){
			ps.ss_code.value = "610050";
		}

		ps.sg.value ="add";
		ps.target="bottom";
		ps.action = "/servlet/com.lgc.bonu.PointAdjustS";
		ps.submit();
	}
	*/

/* 포인트 저장 취소 IF (기존 Smile 검증용)
function del()	{

		ps = document.form1;
		ps.resident_no.value = parent.frames[0].document.form1.resident_no.value;
		if (ps.channel_class.value == "")
		{
			alert("삭제 대상을 선택하십시요.");
			return;
		}

		// 동의고객일 경우 체크
		if(ps.cust_gubun.value == "Y"){
			if (ps.channel_class.value == "7100" || ps.channel_class.value == "8100"){
				alert("칼텍스 거래가 아닙니다.");
				return;
			}

		//	if (ps.ss_code.value != "610010" && ps.ss_code.value != "1702" && ps.ss_code.value != "1590")
		//	{
		//		alert("취소할 수 없는 거래입니다.");
		//		return;
		//	}
		}else{	// 일반고객의 경우 체크  by gslee 20100608 구POS(09) && ps.channel_class.value != "09" 추가
			if (ps.channel_class.value != "01" && ps.channel_class.value != "02" && ps.channel_class.value != "07" && ps.channel_class.value != "08"  && ps.channel_class.value != "09" && ps.channel_class.value != "11" && ps.channel_class.value != "61")
			{
				alert("취소할 수 없는 거래입니다.");
				return;
			}
		}

		if(ps.acum_use_clas.value == "02") //포인트 적립 취소
		{
			alert("포인트 적립 취소는 삭제할 수 없습니다.");
			return;
		}

		if(ps.acum_use_clas.value == "04") //포인트 사용 취소
		{
			alert("포인트 사용 취소는 삭제할 수 없습니다.");
			return;
		}

		if (ps.point_reason.value == "0100"){
			ps.channel_class.value="01";
		}else{
			ps.channel_class.value="02";
		}

		if (!confirm("삭제 하시겠습니까?")){
			return;
		}

		ps.sg.value ="cancel";
		ps.target="bottom";
		ps.action = "/servlet/com.lgc.bonu.PointAdjustS";
		ps.submit();
	}
	*/

function edt_srch1_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
	edt_srch2.enable=false;
	Btn_WebIdSrchMod00.enable=false;
	
}

function edt_srch2_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{

	edt_srch1.enable=false;
	Btn_WebIdSrchMod.enable=false;
	
}

function delete_readonly(bln_del){

	////edt_c1.readonly=bln_del;
	////edt_c2.readonly=bln_del;
	////edt_c3.readonly=bln_del;
	////edt_c4.readonly=bln_del;

	edt_gnr_pt.readonly=bln_del;
	edt_srch1.readonly=bln_del;
	edt_oil.readonly=bln_del;
	edt_mon_gnr.readonly=bln_del;
	edt_sp_pt.readonly=bln_del;
	cmb_dtl.readonly=bln_del;
	cmb_oil.readonly=bln_del;
	edt_mon_tot.readonly=bln_del;
	edt_frch_pt.readonly=bln_del;
	
	//edt_srch2.readonly=bln_del;
	//edt_good.readonly=bln_del;
	
	edt_frch_mon.readonly=bln_del;
	edt_num.readonly=bln_del;
	edt_mon.readonly=bln_del;
	edt_bmk.readonly=bln_del;
	cmb_save_use.readonly=bln_del;	
	
	//edt_srch1.readonly=bln_del;
	
	cmb_reason.readonly=bln_del;		
	edt_srch2.readonly=bln_del;
	
}

function delete_popup(bln_del_p){

	Btn_WebIdSrchMod.visible=bln_del_p;
	Btn_WebIdSrchMod00.visible=bln_del_p;
	btn_save.enable=bln_del_p;
	btn_find.enable=bln_del_p;
	btn_cancel.enable=bln_del_p;
	
}

//전체 활성화 / 비활성화
function delete_enable(bln_del){

	edt_c1.enable=bln_del;
	edt_c2.enable=bln_del;
	edt_c3.enable=bln_del;
	edt_c4.enable=bln_del;
	edt_gnr_pt.enable=bln_del;
	edt_srch1.enable=bln_del;
	edt_oil.enable=bln_del;
	edt_mon_gnr.enable=bln_del;
	edt_sp_pt.enable=bln_del;
	cmb_dtl.enable=bln_del;
	cmb_oil.enable=bln_del;
	edt_mon_tot.enable=bln_del;
	edt_frch_pt.enable=bln_del;
	edt_srch2.enable=bln_del;
	edt_good.enable=bln_del;
	edt_frch_mon.enable=bln_del;
	edt_num.enable=bln_del;
	edt_mon.enable=bln_del;
	edt_bmk.enable=bln_del;
	cmb_save_use.enable=bln_del;	
	edt_srch1.enable=bln_del;
	cmb_reason.enable=bln_del;
		
	edt_srch2.enable=bln_del;
	
}

function point_hist_078(){


	var objDate = new Date();
	var currentYear = objDate.getFullYear().toString();
	var currentMonth  = objDate.getMonth()+1;
	var currentDay = objDate.getDate();
	
	if (currentMonth<10){
	
		currentMonth="0"+currentMonth;
		
	}	
	
	if (currentDay<10){
	
		currentDay="0"+currentDay;
		
	}
	
	var currentHour = objDate.getHours();
	
	if (currentHour<10){
	
		currentHour="0"+currentHour;
		
	}	
		
	var currentMin = objDate.getMinutes();
	
	if (currentMin<10){
	
		currentMin="0"+currentMin;
	}		
	
	var currentSec = objDate.getSeconds();
	
	if (currentSec<10){
	
		currentSec="0"+currentSec;
		
	}

	fun_ds_srch(ds_if_point_save_data, "SEQ_NO", getTrim(GetUserInfo("gUSR_ID"))+""+currentYear+""+currentMonth+""+currentDay+""+currentHour+""+currentMin+""+currentSec);	

	var	strSvcID = "V_1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=ds_if_point_save_data:a";
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=BNS430.Set_LOG_078";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		

	ds_if_point_save_data.deleteColumn("SEQ_NO");

}


function point_hist_079(){


	var objDate = new Date();
	var currentYear = objDate.getFullYear().toString();
	var currentMonth  = objDate.getMonth()+1;
	var currentDay = objDate.getDate();
	
	if (currentMonth<10){
	
		currentMonth="0"+currentMonth;
		
	}	
	
	if (currentDay<10){
	
		currentDay="0"+currentDay;
		
	}
	
	var currentHour = objDate.getHours();
	
	if (currentHour<10){
	
		currentHour="0"+currentHour;
		
	}	
		
	var currentMin = objDate.getMinutes();
	
	if (currentMin<10){
	
		currentMin="0"+currentMin;
		
	}	
		
	var currentSec = objDate.getSeconds();
	
	if (currentSec<10){
	
		currentSec="0"+currentSec;
		
	}

	fun_ds_srch(ds_if_point_cancel_data, "SEQ_NO", getTrim(GetUserInfo("gUSR_ID"))+""+currentYear+""+currentMonth+""+currentDay+""+currentHour+""+currentMin+""+currentSec);	

	var	strSvcID = "V_2";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=ds_if_point_cancel_data:a";
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=BNS430.Set_LOG_079";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		

	ds_if_point_cancel_data.deleteColumn("SEQ_NO");

}

function point_hist_159(){


	var objDate = new Date();
	var currentYear = objDate.getFullYear().toString();
	var currentMonth  = objDate.getMonth()+1;
	var currentDay = objDate.getDate();
	
	if (currentMonth<10){
	
		currentMonth="0"+currentMonth;
		
	}	
	
	if (currentDay<10){
	
		currentDay="0"+currentDay;
		
	}
	
	var currentHour = objDate.getHours();
	
	if (currentHour<10){
	
		currentHour="0"+currentHour;
		
	}	
		
	var currentMin = objDate.getMinutes();
	
	if (currentMin<10){
	
		currentMin="0"+currentMin;
		
	}	
		
	var currentSec = objDate.getSeconds();
	
	if (currentSec<10){
	
		currentSec="0"+currentSec;
		
	}

	fun_ds_srch(ds_if_point_save_gr_data, "SEQ_NO", getTrim(GetUserInfo("gUSR_ID"))+""+currentYear+""+currentMonth+""+currentDay+""+currentHour+""+currentMin+""+currentSec);	

	var	strSvcID = "V_1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=ds_if_point_save_gr_data:a";
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=BNS430.Set_LOG_159";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		

	ds_if_point_save_gr_data.deleteColumn("SEQ_NO");
	

}

function Btn_Srch_one_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_if_crd_pblc_env.clearData();
	ds_if_crd_pblc_data.clearData();
	ds_if_crd_pblc_common.clearData();
	ds_if_crd_pblc_header.clearData();
	ds_if_crd_pblc_column.clearData();
	ds_if_crd_pblc_record.clearData();
	
	ds_card_list.clearData();
	
	// IF ENV DS
	fn_setIfEnvDs(ds_if_crd_pblc_env,"WAS","cmCrdpblcSelC03.do","","STP_CM_CRDPBLC_SEL_C03_Rsp","","OT_OUT_CURSOR");
		
	fun_ds_srch(ds_if_crd_pblc_data, "req_chnl_code","610050");
	fun_ds_srch(ds_if_crd_pblc_data, "input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_crd_pblc_data, "input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_crd_pblc_data, "input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
	fun_ds_srch(ds_if_crd_pblc_data, "in_cust_no",getTrim(Edt_PopCustNo.value));
	fun_ds_srch(ds_if_crd_pblc_data, "in_crd_no",getTrim(Msk_CrdNo.value));
	fun_ds_srch(ds_if_crd_pblc_data, "in_flag","3");		
	
	var	strSvcID = "IF_CSC_ITRT_061";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_crd_pblc_env:a INTERFACE_DATA=ds_if_crd_pblc_data:a";
	var	strOutDatasets = "ds_if_crd_pblc_common=DS_COMMON ds_if_crd_pblc_header=DS_HEADER ds_if_crd_pblc_column=DS_COLUMN ds_if_crd_pblc_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	
}

/*
 * 일반 포인트 입력(특별포인트 입력시 수정)
 */ 
function edt_gnr_pt_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
	if(cmb_reason.value=="0083" || cmb_reason.value=="0085"){
		//alert("특별포인트 조정");
		//alert("조정 포인트 "+edt_gnr_pt.value * 2);
		edt_sp_pt.value = edt_gnr_pt.value * 2;

	}
}


function fn_edt_chd(obj:Edit,  e:TextChangeEventInfo)
{
	
}
]]></Script>
    <Objects>
      <Dataset id="ds_card_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="NO" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="CUST_NO" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="CRD_TP_CD" type="STRING" size="256"/>
          <Column id="CRD_TP_CD_NM" type="STRING" size="256"/>
          <Column id="CRD_ST_CD" type="STRING" size="256"/>
          <Column id="CRD_ST_CD_NM" type="STRING" size="256"/>
          <Column id="GNRL_PT" type="STRING" size="256"/>
          <Column id="SPCL_PT" type="STRING" size="256"/>
          <Column id="CPRT_PT" type="STRING" size="256"/>
          <Column id="CRD_TOT_PT" type="STRING" size="256"/>
          <Column id="RREG_PBLC_DT" type="STRING" size="256"/>
          <Column id="PBLC_APLY_DIV_CD" type="STRING" size="256"/>
          <Column id="PBLC_APLY_DIV_CD_NM" type="STRING" size="256"/>
          <Column id="REG_PBLC_DT" type="STRING" size="256"/>
          <Column id="REG_PBLC_DIV_CD" type="STRING" size="256"/>
          <Column id="REG_PBLC_DIV_CD_NM" type="STRING" size="256"/>
          <Column id="MOD_USER_ID" type="STRING" size="256"/>
          <Column id="CRD_MASTER" type="STRING" size="256"/>
          <Column id="SERIAL" type="STRING" size="256"/>
          <Column id="INPUT_DT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_srch" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CRD_NO" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CRD_NO"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_FILELIST" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SEQ_NO" type="STRING" size="256"/>
          <Column id="FILE_KIND_CD" type="STRING" size="256"/>
          <Column id="FILE_PATH" type="STRING" size="256"/>
          <Column id="FILE_NM" type="STRING" size="256"/>
          <Column id="FILE_SEQ" type="STRING" size="256"/>
          <Column id="FILE_PHYSNM" type="STRING" size="256"/>
          <Column id="FILE_SZ" type="STRING" size="256"/>
          <Column id="RSV_SEQ_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <FileDialog defaultextention="false" filter="All(*.*)|*.*|" filterindex="0" id="FileDialog00"/>
      <HttpObject asyncflag="false" id="HttpObject00" retry="3" onload="HttpObject00_onload" onstatus="HttpObject00_onstatus" timeout="30000"/>
      <Dataset id="ds_dpch_in" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="NOTE_SEQ_NO" type="STRING" size="256"/>
          <Column id="TITE" type="STRING" size="256"/>
          <Column id="DPCH_CTT" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CRD_NO"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_recv_in" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="NOTE_SEQ_NO" type="STRING" size="256"/>
          <Column id="RECV_ID" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CRD_NO"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_if_trnpt_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_trnpt_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_trnpt_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_trnpt_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_trnpt_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_trnpt_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHNL_DIV_CD" type="STRING" size="256"/>
          <Column id="CHNL_DIV_NM" type="STRING" size="256"/>
          <Column id="SALE_DTIME" type="STRING" size="256"/>
          <Column id="SALE_DTIME_UI" type="STRING" size="256"/>
          <Column id="APRV_SEQ" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_CD" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_NM" type="STRING" size="256"/>
          <Column id="PCKT_TP_CD" type="STRING" size="256"/>
          <Column id="PCKT_TP_NM" type="STRING" size="256"/>
          <Column id="FRCH_CD" type="STRING" size="256"/>
          <Column id="FRCH_NM" type="STRING" size="256"/>
          <Column id="ENTR_NO" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="CUST_NO" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="PAYM_TP_CD" type="STRING" size="256"/>
          <Column id="PAYM_TP_NM" type="STRING" size="256"/>
          <Column id="APRV_DT" type="STRING" size="256"/>
          <Column id="APRV_TMDAY" type="STRING" size="256"/>
          <Column id="APRV_NO" type="STRING" size="256"/>
          <Column id="OAPRV_DT" type="STRING" size="256"/>
          <Column id="OAPRV_NO" type="STRING" size="256"/>
          <Column id="PROD_CD" type="STRING" size="256"/>
          <Column id="PROD_CD_NM" type="STRING" size="256"/>
          <Column id="QTY" type="STRING" size="256"/>
          <Column id="UPRC" type="STRING" size="256"/>
          <Column id="AMT" type="STRING" size="256"/>
          <Column id="GNRL_PT" type="STRING" size="256"/>
          <Column id="SPCL_PT" type="STRING" size="256"/>
          <Column id="CPRT_PT" type="STRING" size="256"/>
          <Column id="BAL_PT" type="STRING" size="256"/>
          <Column id="USBL_PT" type="STRING" size="256"/>
          <Column id="TOT_ACUM_PT" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_CD" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_NM" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_CNTT" type="STRING" size="256"/>
          <Column id="TRSF_APLY_NO" type="STRING" size="256"/>
          <Column id="ERR_OCUR_RSN_CD" type="STRING" size="256"/>
          <Column id="ERR_OCUR_RSN_NM" type="STRING" size="256"/>
          <Column id="SALE_DT" type="STRING" size="256"/>
          <Column id="SALE_TMDAY" type="STRING" size="256"/>
          <Column id="COM_PCKT_ORG_CD" type="STRING" size="256"/>
          <Column id="COM_PCKT_ORG_NM" type="STRING" size="256"/>
          <Column id="CHAS_NO" type="STRING" size="256"/>
          <Column id="CRD_REST_PT" type="STRING" size="256"/>
          <Column id="CUST_REST_PT" type="STRING" size="256"/>
          <Column id="RSNO_TR_YN" type="STRING" size="256"/>
          <Column id="INPT_DTIME" type="STRING" size="256"/>
          <Column id="INPT_DTIME_UI" type="STRING" size="256"/>
          <Column id="INPT_USER_ID" type="STRING" size="256"/>
          <Column id="INPT_IP" type="STRING" size="256"/>
          <Column id="MOD_DTIME" type="STRING" size="256"/>
          <Column id="MOD_DTIME_UI" type="STRING" size="256"/>
          <Column id="MOD_USER_ID" type="STRING" size="256"/>
          <Column id="MOD_IP" type="STRING" size="256"/>
          <Column id="DTL_SEQ" type="STRING" size="256"/>
          <Column id="OCUR_PT_DIV_CD" type="STRING" size="256"/>
          <Column id="OCUR_PT_DIV_NM" type="STRING" size="256"/>
          <Column id="CAMP_ID" type="STRING" size="256"/>
          <Column id="OFR_ID" type="STRING" size="256"/>
          <Column id="CAMP_PT" type="STRING" size="256"/>
          <Column id="WIN_RSULT_CD" type="STRING" size="256"/>
          <Column id="WIN_RSULT_NM" type="STRING" size="256"/>
          <Column id="DTL_CPRT_PT" type="STRING" size="256"/>
          <Column id="DTL_SPCL_PT" type="STRING" size="256"/>
          <Column id="SPCL_PT_CD" type="STRING" size="256"/>
          <Column id="SPCL_PT_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_grppt_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_grppt_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_grppt_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_grppt_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_grppt_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_grppt_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHNAPPRV_DATE" type="STRING" size="256"/>
          <Column id="APPRV_NO" type="STRING" size="256"/>
          <Column id="SUB_CO_FRNCHSE_CODE" type="STRING" size="256"/>
          <Column id="SUB_CO_FRNCHSE_CODE_NAME" type="STRING" size="256"/>
          <Column id="SUB_CO_APPRV_DATE" type="STRING" size="256"/>
          <Column id="SUB_CO_APPRV_NO" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="INTGR_CUST_NO" type="STRING" size="256"/>
          <Column id="CHNL_SUB_CO_CODE" type="STRING" size="256"/>
          <Column id="CHNL_SUB_CO_CODE_NAME" type="STRING" size="256"/>
          <Column id="SLIP_DIV_CODE" type="STRING" size="256"/>
          <Column id="SLIP_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="TRANS_RSN_CODE" type="STRING" size="256"/>
          <Column id="TRANS_RSN_CODE_NAME" type="STRING" size="256"/>
          <Column id="PROD_CODE" type="STRING" size="256"/>
          <Column id="PROD_CODE_NAME" type="STRING" size="256"/>
          <Column id="PROD_DESCTN" type="STRING" size="256"/>
          <Column id="PYMT_PATTERN_CODE" type="STRING" size="256"/>
          <Column id="PYMT_PATTERN_CODE_NAME" type="STRING" size="256"/>
          <Column id="PACKET_PATTERN_CODE" type="STRING" size="256"/>
          <Column id="PACKET_PATTERN_CODE_NAME" type="STRING" size="256"/>
          <Column id="APPRV_DATE_TIME" type="STRING" size="256"/>
          <Column id="SUB_CO_TRANS_DATE" type="STRING" size="256"/>
          <Column id="SUB_CO_TRANS_TIME" type="STRING" size="256"/>
          <Column id="OCCUR_PT" type="STRING" size="256"/>
          <Column id="GEN_RSV_PT" type="STRING" size="256"/>
          <Column id="SPECIAL_RSV_PT" type="STRING" size="256"/>
          <Column id="CPRT_RSV_PT" type="STRING" size="256"/>
          <Column id="VANISH_INTEND_DATE" type="STRING" size="256"/>
          <Column id="CNT" type="STRING" size="256"/>
          <Column id="UNITPRC" type="STRING" size="256"/>
          <Column id="SALE_AMT" type="STRING" size="256"/>
          <Column id="CANCEL_DIV_CODE" type="STRING" size="256"/>
          <Column id="CANCEL_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="ORN_APPRV_DATE" type="STRING" size="256"/>
          <Column id="ORN_APPRV_NO" type="STRING" size="256"/>
          <Column id="ORN_SUB_CO_TRANS_DATE" type="STRING" size="256"/>
          <Column id="ORN_SUB_CO_APPRV_DATE" type="STRING" size="256"/>
          <Column id="ORN_SUB_CO_APPRV_NO" type="STRING" size="256"/>
          <Column id="CHASING_NO" type="STRING" size="256"/>
          <Column id="RELATION_NO" type="STRING" size="256"/>
          <Column id="INTGR_CAMPAIGN_CODE" type="STRING" size="256"/>
          <Column id="CAMPAIGN_VEST_PT" type="STRING" size="256"/>
          <Column id="OFFER_CODE" type="STRING" size="256"/>
          <Column id="PRZ_RSLT_CODE" type="STRING" size="256"/>
          <Column id="INPUT_DATE_TIME" type="STRING" size="256"/>
          <Column id="INPUT_USER_ID" type="STRING" size="256"/>
          <Column id="RES_NO" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
          <Column id="BIZ_NO" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CODE" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="SUB_CO_ORDER_NO" type="STRING" size="256"/>
          <Column id="CARD_MEDIA_DIV_CODE" type="STRING" size="256"/>
          <Column id="CARD_MEDIA_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="TAXFL_DIV_CODE" type="STRING" size="256"/>
          <Column id="TAXFL_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="SUPPPRC" type="STRING" size="256"/>
          <Column id="VAT" type="STRING" size="256"/>
          <Column id="VOLUNTEER_AMT" type="STRING" size="256"/>
          <Column id="MAIN_APPRV_NO" type="STRING" size="256"/>
          <Column id="OT_TOT_REST_PT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_his_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PRO_DAY" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="CHANNEL" type="STRING" size="256"/>
          <Column id="DTL_GUBUN" type="STRING" size="256"/>
          <Column id="REA_GUBUN" type="STRING" size="256"/>
          <Column id="FRCH_NM" type="STRING" size="256"/>
          <Column id="OIL_NM" type="STRING" size="256"/>
          <Column id="MONEY" type="STRING" size="256"/>
          <Column id="DANGA" type="STRING" size="256"/>
          <Column id="OIL_QTY" type="STRING" size="256"/>
          <Column id="POINT" type="STRING" size="256"/>
          <Column id="A_POINT" type="STRING" size="256"/>
          <Column id="T_POINT" type="STRING" size="256"/>
          <Column id="END_DAY" type="STRING" size="256"/>
          <Column id="CASH_GUBUN" type="STRING" size="256"/>
          <Column id="APPRV_NO" type="STRING" size="256"/>
          <Column id="SLIP_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="TRANS_RSN_CODE" type="STRING" size="256"/>
          <Column id="ORN_APPRV_NO" type="STRING" size="256"/>
          <Column id="SUB_CO_APPRV_NO" type="STRING" size="256"/>
          <Column id="APPRV_DATE_TIME" type="STRING" size="256"/>
          <Column id="SLIP_DIV_CODE" type="STRING" size="256"/>
          <Column id="CUST_NO" type="STRING" size="256"/>
          <Column id="OIL_CODE" type="STRING" size="256"/>
          <Column id="SUB_CO_FRNCHSE_CODE" type="STRING" size="256"/>
          <Column id="GEN_PT" type="STRING" size="256"/>
          <Column id="FRCH_PT" type="STRING" size="256"/>
          <Column id="SP_PT" type="STRING" size="256"/>
          <Column id="APPRV_DATE" type="STRING" size="256"/>
          <Column id="SUB_CO_TRANS_TIME" type="STRING" size="256"/>
          <Column id="SUB_CO_TRANS_DATE" type="STRING" size="256"/>
          <Column id="CHASING_NO" type="STRING" size="256"/>
          <Column id="FRCH_CD" type="STRING" size="256"/>
          <Column id="REA_GUBUN_CD" type="STRING" size="256"/>
          <Column id="CHNL_SUB_CO_CODE" type="STRING" size="256"/>
          <Column id="SALE_TMDAY" type="STRING" size="256"/>
          <Column id="SALE_DT" type="STRING" size="256"/>
          <Column id="OIL_CD" type="STRING" size="256"/>
          <Column id="PROD_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_get_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TR_PHONE" type="STRING" size="256"/>
          <Column id="TR_CALLBACK" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="TR_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_set_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FRCH_CD1" type="STRING" size="256"/>
          <Column id="FRCH_CD2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cust_info" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_save_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_save_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_save_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_save_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_save_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_save_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_cancel_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_cancel_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_cancel_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_cancel_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_cancel_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_cancel_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SEQ" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="QUERY_ID" type="STRING" size="256"/>
          <Column id="COLUMN_ID" type="STRING" size="256"/>
          <Column id="DS1" type="STRING" size="256"/>
          <Column id="DS2" type="STRING" size="256"/>
          <Column id="DS3" type="STRING" size="256"/>
          <Column id="SEQ_TITLE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="QUERY_ID">Common.Get_SEQ_SELECT</Col>
            <Col id="COLUMN_ID">NOTE_SEQ_NO</Col>
            <Col id="DS1">INSERT_0_IDATA</Col>
            <Col id="DS2">INSERT_1_IDATA</Col>
            <Col id="DS3"/>
            <Col id="SEQ_TITLE">BNS430</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_if_hist_file" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="RSV_SEQ_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SEQ2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="QUERY_ID" type="STRING" size="256"/>
          <Column id="COLUMN_ID" type="STRING" size="256"/>
          <Column id="DS1" type="STRING" size="256"/>
          <Column id="DS2" type="STRING" size="256"/>
          <Column id="DS3" type="STRING" size="256"/>
          <Column id="SEQ_TITLE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="QUERY_ID">Common.Get_SEQ_SELECT</Col>
            <Col id="COLUMN_ID">RSV_SEQ_NO</Col>
            <Col id="DS1">INSERT_0_IDATA</Col>
            <Col id="DS2">INSERT_1_IDATA</Col>
            <Col id="DS3"/>
            <Col id="SEQ_TITLE">BNS430</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_if_GSG_grppt_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_GSG_grppt_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_GSG_grppt_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_GSG_grppt_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_GSG_grppt_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_GSG_grppt_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHNAPPRV_DATE" type="STRING" size="256"/>
          <Column id="APPRV_NO" type="STRING" size="256"/>
          <Column id="SUB_CO_FRNCHSE_CODE" type="STRING" size="256"/>
          <Column id="SUB_CO_FRNCHSE_CODE_NAME" type="STRING" size="256"/>
          <Column id="SUB_CO_APPRV_DATE" type="STRING" size="256"/>
          <Column id="SUB_CO_APPRV_NO" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="INTGR_CUST_NO" type="STRING" size="256"/>
          <Column id="CHNL_SUB_CO_CODE" type="STRING" size="256"/>
          <Column id="CHNL_SUB_CO_CODE_NAME" type="STRING" size="256"/>
          <Column id="SLIP_DIV_CODE" type="STRING" size="256"/>
          <Column id="SLIP_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="TRANS_RSN_CODE" type="STRING" size="256"/>
          <Column id="TRANS_RSN_CODE_NAME" type="STRING" size="256"/>
          <Column id="PROD_CODE" type="STRING" size="256"/>
          <Column id="PROD_CODE_NAME" type="STRING" size="256"/>
          <Column id="PROD_DESCTN" type="STRING" size="256"/>
          <Column id="PYMT_PATTERN_CODE" type="STRING" size="256"/>
          <Column id="PYMT_PATTERN_CODE_NAME" type="STRING" size="256"/>
          <Column id="PACKET_PATTERN_CODE" type="STRING" size="256"/>
          <Column id="PACKET_PATTERN_CODE_NAME" type="STRING" size="256"/>
          <Column id="APPRV_DATE_TIME" type="STRING" size="256"/>
          <Column id="SUB_CO_TRANS_DATE" type="STRING" size="256"/>
          <Column id="SUB_CO_TRANS_TIME" type="STRING" size="256"/>
          <Column id="OCCUR_PT" type="STRING" size="256"/>
          <Column id="GEN_RSV_PT" type="STRING" size="256"/>
          <Column id="SPECIAL_RSV_PT" type="STRING" size="256"/>
          <Column id="CPRT_RSV_PT" type="STRING" size="256"/>
          <Column id="VANISH_INTEND_DATE" type="STRING" size="256"/>
          <Column id="CNT" type="STRING" size="256"/>
          <Column id="UNITPRC" type="STRING" size="256"/>
          <Column id="SALE_AMT" type="STRING" size="256"/>
          <Column id="CANCEL_DIV_CODE" type="STRING" size="256"/>
          <Column id="CANCEL_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="ORN_APPRV_DATE" type="STRING" size="256"/>
          <Column id="ORN_APPRV_NO" type="STRING" size="256"/>
          <Column id="ORN_SUB_CO_TRANS_DATE" type="STRING" size="256"/>
          <Column id="ORN_SUB_CO_APPRV_DATE" type="STRING" size="256"/>
          <Column id="ORN_SUB_CO_APPRV_NO" type="STRING" size="256"/>
          <Column id="CHASING_NO" type="STRING" size="256"/>
          <Column id="RELATION_NO" type="STRING" size="256"/>
          <Column id="INTGR_CAMPAIGN_CODE" type="STRING" size="256"/>
          <Column id="CAMPAIGN_VEST_PT" type="STRING" size="256"/>
          <Column id="OFFER_CODE" type="STRING" size="256"/>
          <Column id="PRZ_RSLT_CODE" type="STRING" size="256"/>
          <Column id="INPUT_DATE_TIME" type="STRING" size="256"/>
          <Column id="INPUT_USER_ID" type="STRING" size="256"/>
          <Column id="RES_NO" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
          <Column id="BIZ_NO" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CODE" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="SUB_CO_ORDER_NO" type="STRING" size="256"/>
          <Column id="CARD_MEDIA_DIV_CODE" type="STRING" size="256"/>
          <Column id="CARD_MEDIA_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="TAXFL_DIV_CODE" type="STRING" size="256"/>
          <Column id="TAXFL_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="SUPPPRC" type="STRING" size="256"/>
          <Column id="VAT" type="STRING" size="256"/>
          <Column id="VOLUNTEER_AMT" type="STRING" size="256"/>
          <Column id="MAIN_APPRV_NO" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
          <Column id="APPRV_DATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_save_gr_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_save_gr_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_save_gr_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_save_gr_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_save_gr_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_save_gr_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_crd_pblc_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_crd_pblc_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_crd_pblc_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_crd_pblc_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_crd_pblc_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CUST_NO" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="PBLC_APLY_DIV_CD" type="STRING" size="256"/>
          <Column id="PBLC_APLY_DIV_CD_NM" type="STRING" size="256"/>
          <Column id="RREG_PBLC_DT" type="STRING" size="256"/>
          <Column id="CRD_ST_CD" type="STRING" size="256"/>
          <Column id="CRD_ST_CD_NM" type="STRING" size="256"/>
          <Column id="PBLC_SS_CD" type="STRING" size="256"/>
          <Column id="PBLC_SS_CD_NM" type="STRING" size="256"/>
          <Column id="CPRT_ST_CD" type="STRING" size="256"/>
          <Column id="CPRT_ST_CD_NM" type="STRING" size="256"/>
          <Column id="VLID_YM" type="STRING" size="256"/>
          <Column id="MOD_USER_ID" type="STRING" size="256"/>
          <Column id="CRD_TP_YN" type="STRING" size="256"/>
          <Column id="CRD_TP_CD" type="STRING" size="256"/>
          <Column id="CRD_TP_CD_NM" type="STRING" size="256"/>
          <Column id="RS_BZ_NO" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="NKNM" type="STRING" size="256"/>
          <Column id="EML_ADDR" type="STRING" size="256"/>
          <Column id="ADDR_ERR_YN" type="STRING" size="256"/>
          <Column id="MTR_SS_CD" type="STRING" size="256"/>
          <Column id="MTR_SS_CD_NM" type="STRING" size="256"/>
          <Column id="MTR_SS_TPHN_NO" type="STRING" size="256"/>
          <Column id="VIP_CUST_YN" type="STRING" size="256"/>
          <Column id="WRNG_ST_CD" type="STRING" size="256"/>
          <Column id="WRNG_ST_CD_NM" type="STRING" size="256"/>
          <Column id="WRNG_REG_DT" type="STRING" size="256"/>
          <Column id="CUST_DIV_CD" type="STRING" size="256"/>
          <Column id="CUST_DIV_CD_NM" type="STRING" size="256"/>
          <Column id="CUST_ST_CD" type="STRING" size="256"/>
          <Column id="CUST_ST_CD_NM" type="STRING" size="256"/>
          <Column id="HOME_PHONE" type="STRING" size="256"/>
          <Column id="WORK_PHONE" type="STRING" size="256"/>
          <Column id="MOBIL" type="STRING" size="256"/>
          <Column id="CRD_GNRL_PT" type="STRING" size="256"/>
          <Column id="CRD_SPCL_PT" type="STRING" size="256"/>
          <Column id="CRD_CPRT_PT" type="STRING" size="256"/>
          <Column id="CRD_TOT_PT" type="STRING" size="256"/>
          <Column id="CRD_USABLE_POINT" type="STRING" size="256"/>
          <Column id="CRD_TOT_ACUM_PT" type="STRING" size="256"/>
          <Column id="CUST_GNRL_PT" type="STRING" size="256"/>
          <Column id="CUST_SPCL_PT" type="STRING" size="256"/>
          <Column id="CUST_CPRT_PT" type="STRING" size="256"/>
          <Column id="CUST_TOT_PT" type="STRING" size="256"/>
          <Column id="PSNG_GRD" type="STRING" size="256"/>
          <Column id="PSNG_GRD_NM" type="STRING" size="256"/>
          <Column id="TON5_ABV_CARG_GRD" type="STRING" size="256"/>
          <Column id="TON5_ABV_CARG_GRD_NM" type="STRING" size="256"/>
          <Column id="TON5_BLW_CARG_GRD" type="STRING" size="256"/>
          <Column id="TON5_BLW_CARG_GRD_NM" type="STRING" size="256"/>
          <Column id="FSTR_SS_CD" type="STRING" size="256"/>
          <Column id="FSTR_SS_CD_NM" type="STRING" size="256"/>
          <Column id="AGRM_APRV_CD" type="STRING" size="256"/>
          <Column id="AGRM_APRV_CD_NM" type="STRING" size="256"/>
          <Column id="APRV_DTIME" type="STRING" size="256"/>
          <Column id="APRV_CHNL_DIV_CD" type="STRING" size="256"/>
          <Column id="APRV_CHNL_DIV_CD_NM" type="STRING" size="256"/>
          <Column id="INPUT_DT" type="STRING" size="256"/>
          <Column id="INPUT_CHNL" type="STRING" size="256"/>
          <Column id="CRD_MASTER" type="STRING" size="256"/>
          <Column id="SERIAL" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_crd_pblc_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="edt_file" propid="value" datasetid="ds_FILELIST" columnid="FILE_NM"/>
    </Bind>
  </Form>
</FDL>
