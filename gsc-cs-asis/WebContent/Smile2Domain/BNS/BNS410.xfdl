<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.2">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="BNS410" classname="BNS340" inheritanceid="" position="absolute 0 0 1630 265" titletext="구매이력" onload="BNS410_onload">
    <Script type="xscript4.0"><![CDATA[/********************************************************************************** 
 *****	구매이력
***********************************************************************************/

include "LIB::CommonLib.xjs";
var SVC_IF_URL 	= "XinterfaceAction.do?method=CommonInterface";
var strSelMaxQtyYn = "N";

//엑셀 다운로드 고객 
var gCustId = "";
var gUsrId =  getTrim(GetUserInfo("gUSR_ID"));
var gUsrNm =  getTrim(GetUserInfo("gUSR_NM"));
var gLginIp =  getTrim(GetUserInfo("gLGIN_IP"));

var sAccNo = "BNS410";   ////개인정보접촉이력 일련번호

function BNS410_onload(obj:Form, e:LoadEventInfo)
{
	fn_setDefaultValue();
}

function fn_setDefaultValue()
{
	// 콤보세팅	
    var arrCombo           = ["Cmb_SaveDiv","Cmb_UseOilKnd","Cmb_Chnl","Cmb_Affil"];    	//콤보ID
    var arrSearCHKey       = ["OLZ01","OLZ36","OLZ24","OLZ41"];               				//공통코드-대분류코드
    var arrListMode        = ["TY","TY","TY","TY","TY"];                    						//CTN : [코드] 코드명  , TY : 코드명,  TN: 초기값무시
    var arrOptionRowValue  = [",전체",",전체",",전체",",전체",",전체"];                  			//코드상단에 로우추가후 전체, 공백    

	setComboList(arrCombo, arrSearCHKey, arrListMode, arrOptionRowValue);
}

// 상담관리 고객조회를 통해서만 호출(고객이 새로 조회되면 초기화시킨다.)
function fn_srchNewCust()
{
	fn_initData();
	Rdo_SrchDiv_onitemchanged();
	fn_clearFormData();	
	
	Cal_SrchToDt.value 		= getToday();
	Cal_SrchFrmDt.value 	= AddMonth(getToday(),-3);	
	
	Grd_BuyHist.visible = true;
	Grd_PayHist.visible = false;
	Grd_ChargeHist.visible = false;
	Grd_EventPoint.visible = false;
	
	
}

function fn_srchFormData()
{
	var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
					
	//건수표시	
	if(objDsCust.getColumn(0,"IO_CUST_NO") == ""){
		fn_initData();
		objCntStt.text	= "";	
	}else{	
//		Cal_SrchToDt.value 		= getToday();
//		Cal_SrchFrmDt.value 	= AddMonth(getToday(),-3);	
		objCntStt.text	= ds_rsv_hist_out.rowcount;			
	}
}

// 초기화
function fn_initData()
{
	Msk_TotRflPay.value		= "0";
	Msk_TotRflAmnt.value	= "0";
	Msk_TotPt.value			= "0";
	Cal_SrchFrmDt.value		= "";
	Cal_SrchToDt.value		= "";
	Cmb_SaveDiv.value		= "";
	Cmb_UseOilKnd.value		= "";
	Cmb_Chnl.value			= "";
	Cmb_Affil.value			= "";
	Rdo_SrchDiv.value 		= 1;
	Cal_SrchToDt.value 		= getToday();
	Cal_SrchFrmDt.value 	= AddMonth(getToday(),-3);
	Msk_BefTotAmt1.value	= "";
	Msk_BefTotAmt2.value	= "";
	Msk_BefTotAmt3.value	= "";
	strSelMaxQtyYn			= "N";	
}

function fn_clearFormData()
{
	var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];
	objCntStt.text	= "";	
	ds_rsv_hist_out.clearData();	
	ds_if_payhist_record.clearData();
	ds_charge_hist_record.clearData();
	
	
	Grd_BuyHist.visible = true;
	Grd_PayHist.visible = false;
	Grd_ChargeHist.visible = false;
	Grd_EventPoint.visible = false;
	
	Msk_TotRflPay.value		= "0";
	Msk_TotRflAmnt.value	= "0";
	Msk_TotPt.value			= "0";
	Cal_SrchToDt.value 		= "";
	Cal_SrchFrmDt.value 	= "";
	
	Stt_TotRflAmnt00.visible = false;
	Stt_TotRflAmnt2.visible = false;
	Stt_TotRflAmnt3.visible = false;
			
	Msk_BefTotAmt1.visible = false;
	Msk_BefTotAmt2.visible = false;
	Msk_BefTotAmt3.visible = false;
	
}

// 조회조건 비교를 위한 DS 세팅
function fn_setSrchCond()
{
	var objDsCrd	= this.parent.parent.all["Tab_CrdInfo"]["tabpage2"].all["ds_crd_info"];
	var intSelRow	= objDsCrd.findRow("CHK",1);
	var strSelCrdNo	= "";
	if(intSelRow != -1){
		strSelCrdNo = objDsCrd.getColumn(intSelRow,"CRD_NO").replace("-","");	
	}
	
	ds_srch_cond.clearData();
	ds_srch_cond.addRow();
	ds_srch_cond.setColumn(0,"FROM_DT",Cal_SrchFrmDt.value);
	ds_srch_cond.setColumn(0,"TO_DT",Cal_SrchToDt.value);
	ds_srch_cond.setColumn(0,"RSV_USE_DIV",Cmb_SaveDiv.value);
	ds_srch_cond.setColumn(0,"PROD_DIV",Cmb_UseOilKnd.value);
	ds_srch_cond.setColumn(0,"CHNL_DIV",Cmb_Chnl.value);
	ds_srch_cond.setColumn(0,"FRNCHSE_DIV",Cmb_Affil.value);
	ds_srch_cond.setColumn(0,"RDO_DIV",Rdo_SrchDiv.value);
	ds_srch_cond.setColumn(0,"CUR_PAGE","1");
	ds_srch_cond.setColumn(0,"CRD_NO",strSelCrdNo);
}

// 조회버튼클릭
function Btn_Srch_onclick(obj:Button,  e:ClickEventInfo)
{
	
	sta_bw1.value="";
	sta_bw2.value="";
	sta_bw3.value="";
	
	Grd_BuyHist.visible = true;
	Grd_PayHist.visible = false;
	Grd_ChargeHist.visible = false;
	Grd_EventPoint.visible = false;
	
	//EV 충전이력 관련 텍스트 초기화
	Stt_TotRflAmnt00.visible = false;
	Stt_TotRflAmnt2.visible = false;
	Stt_TotRflAmnt3.visible = false;
			
	Msk_BefTotAmt1.visible = false;
	Msk_BefTotAmt2.visible = false;
	Msk_BefTotAmt3.visible = false;

	var objFlgDs	= this.parent.parent.all["ds_srch_flg"];		
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];	
			
	// 고객 조회여부 체크
	
	
	//objDsCust.setColumn(0,"IO_CUST_NO","G010836813");
	
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");
		objCntStt.text	= "";				
		return;
	}	
	if(getTrim(objFlgDs.getColumn(0,"FRCH_YN")) == "Y"){
		cf_Alert("BNSE0040","구매이력 조회");	
		return;	
	}

	if(!fn_ChkValid())	return;
	
	Msk_TotRflPay.value 	= "";
	Msk_TotRflAmnt.value 	= "";
	Msk_TotPt.value			= "";
		
	// 주민조회, 카드조회 기간이 3개월을 넘지 않도록 함
	if(Rdo_SrchDiv.value == "1" || Rdo_SrchDiv.value == "2"){		
		var strCompDt = AddMonth(Cal_SrchFrmDt.value,3);
		if(strCompDt < Cal_SrchToDt.value){
			cf_Alert("COME0019","3개월");
			//return;
		}
	
		// 조회조건저장
		fn_setSrchCond();
		ds_srch_cond.setColumn(0,"MORE_YN","N");
		ds_srch_cond.setColumn(0,"EXCEL_YN","N");				
		
		// 적립, 그룹 인터페이스조회
		fn_srchCurrentInfo();
	}
	
	// BW주민, BW카드 기간이 2년을 넘지 않도록 함
	if(Rdo_SrchDiv.value == "3" || Rdo_SrchDiv.value == "4"){		
		var strCompDt = AddMonth(Cal_SrchFrmDt.value,12);
		if(strCompDt < Cal_SrchToDt.value){
			cf_Alert("COME0019","1년");
			return;
		}
		// 조회조건저장
		fn_setSrchCond();
		ds_srch_cond.setColumn(0,"MORE_YN","N");
		ds_srch_cond.setColumn(0,"EXCEL_YN","N");						

		// BW 총카운트 조회
		
		fn_srchPastCntInfo();				

	}		
}

// BW 엑셀은 BW인터페이스의 모든페이지를 조회한다.
function fn_srchBwExcel()
{
	if(!fn_ChkValid())	return;
	
	var strCompDt = AddMonth(Cal_SrchFrmDt.value,12);	
	if(strCompDt < Cal_SrchToDt.value){
		cf_Alert("COME0019","1년");
		return;
	}	
	
	var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];	
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];	
	var objDsCrd	= this.parent.parent.all["Tab_CrdInfo"]["tabpage2"].all["ds_crd_info"];	
	var intSelRow	= objDsCrd.findRow("CHK",1);
	var strSelCrdNo	= "";
	if(intSelRow != -1){
		strSelCrdNo = objDsCrd.getColumn(intSelRow,"CRD_NO").replace("-","");	
	}
	
	// 조회조건 변경여부		
	var strCondChngYn = "N";

	if(Cal_SrchFrmDt.value != ds_srch_cond.getColumn(0,"FROM_DT")){
		strCondChngYn = "Y";
	}
	if(Cal_SrchToDt.value != ds_srch_cond.getColumn(0,"TO_DT")){
		strCondChngYn = "Y";
	}	
	if(Cmb_SaveDiv.value != ds_srch_cond.getColumn(0,"RSV_USE_DIV")){
		strCondChngYn = "Y";
	}
	if(Cmb_UseOilKnd.value != ds_srch_cond.getColumn(0,"PROD_DIV")){
		strCondChngYn = "Y";
	}
	if(Cmb_Chnl.value != ds_srch_cond.getColumn(0,"CHNL_DIV")){
		strCondChngYn = "Y";
	}
	if(Cmb_Affil.value != ds_srch_cond.getColumn(0,"FRNCHSE_DIV")){
		strCondChngYn = "Y";
	}
	if(Rdo_SrchDiv.value != ds_srch_cond.getColumn(0,"RDO_DIV")){
		strCondChngYn = "Y";
	}
	if(strSelCrdNo != ds_srch_cond.getColumn(0,"CRD_NO")){
		strCondChngYn = "Y";
	}	
						
	
	// 조건이 바뀌지 않은 경우	
	if(strCondChngYn == "N"){			
		if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// BW 로열티 총카운트	
			var intTotCnt = parseInt(ds_if_bwcnt_intg_header.getColumn(0,"OT_LISTCOUNT"));
			var intTotPage = Math.ceil(intTotCnt / 100);	
		}else{
			var intTotCnt = parseInt(ds_if_bwcnt_cptv_header.getColumn(0,"OT_LISTCOUNT"));
			var intTotPage = Math.ceil(intTotCnt / 100);		
		}
						
		if(parseInt(ds_srch_cond.getColumn(0,"CUR_PAGE")) < intTotPage){
			objCntStt.text = "";		
			ds_srch_cond.setColumn(0,"CUR_PAGE",(parseInt(ds_srch_cond.getColumn(0,"CUR_PAGE")) + 1).toString());
			ds_srch_cond.setColumn(0,"MORE_YN","Y");
			ds_srch_cond.setColumn(0,"EXCEL_YN","Y");			
			fn_srchPastListInfo();				
		}else{
					
			var sPerTCd ; 
			var sPerTDt = "ICCS_CSC 구매 이력 다운로드(BW)";  // 수행업무 상세내용
			var sCalFun = "Btn_Excel_onclick()";  // 호출함수명 	
			var sInqCon = gfn_getStringFromDataset(ds_srch_cond); //조회 조건은 고객번호 
			var sInqCnt = ds_rsv_hist_out.rowcount;  // 조회건수		
			var sInCustNo = "CUST_ID="+objDsCust.getColumn(0,"IO_CUST_NO") ;
				
			var cnt = fn_exel_Doenhis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);	
			
			//상세사유가 없으면 다운로드 안됨.
			if(cnt < 1){
				alert("상세 사유를 선택하십시요.");
				return;
			}							
					
			GridExportExcel(Grd_BuyHist, ExportObject00, "sheet1");												
		}				
	// 조건이 바뀌었을 경우 새로 조회함.
	}else{
		fn_setSrchCond();
		ds_srch_cond.setColumn(0,"MORE_YN","Y");
		ds_srch_cond.setColumn(0,"EXCEL_YN","Y");		
		ds_rsv_hist_out.clearData();
		objCntStt.text = "";
		
		// BW 총카운트 조회
		fn_srchPastCntInfo();						
	}
}

// Validation 체크
function fn_ChkValid()
{
	this.parent.parent.all["Tab_CrdInfo"].tabindex = 1;	
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];
	var objDsCrd	= this.parent.parent.all["Tab_CrdInfo"]["tabpage2"].all["ds_crd_info"];
	var intSelRow	= objDsCrd.findRow("CHK",1);	
	
	if(Rdo_SrchDiv.value == ""){
		cf_Alert("COME0008","조회구분");		
		return false;
	}
				
//////////	// 주민조회, BW주민
//////////	if(Rdo_SrchDiv.value == "1" || Rdo_SrchDiv.value == "3"){
//////////		if(getTrim(objDsCust.getColumn(0,"OT_RS_BZ_NO").replace("-","")) == ""){
//////////			cf_Alert("BNSE0028");
//////////			return false;
//////////		}		
//////////	}	 
	
	// 카드조회, BW카드(전체카드 탭에서 선택한 카드번호가 있는지 확인)
	if(Rdo_SrchDiv.value == "2" || Rdo_SrchDiv.value == "4"){
		if(intSelRow == -1){
			cf_Alert("COME0008","카드");			
			return false;
		}
	}
	
	// 기간필수입력 체크
	if(!cf_chk_data(Cal_SrchFrmDt,"기간")) return false;
	if(!cf_chk_data(Cal_SrchToDt,"기간")) return false;	
		
	return true;		
}

// MORE버튼 클릭시
function Btn_More_onclick(obj:Button,  e:ClickEventInfo)
{
	var objDsCrd	= this.parent.parent.all["Tab_CrdInfo"]["tabpage2"].all["ds_crd_info"];
	var intSelRow	= objDsCrd.findRow("CHK",1);
	var strSelCrdNo	= "";
	if(intSelRow != -1){
		strSelCrdNo = objDsCrd.getColumn(intSelRow,"CRD_NO").replace("-","");	
	}
	
	// 조회조건비교
	if(Cal_SrchFrmDt.value != ds_srch_cond.getColumn(0,"FROM_DT")){
		cf_Alert("BNSE0035","기간");
		Cal_SrchFrmDt.setFocus();
		return;
	}
	if(Cal_SrchToDt.value != ds_srch_cond.getColumn(0,"TO_DT")){
		cf_Alert("BNSE0035","기간");
		Cal_SrchToDt.setFocus();
		return;
	}	
	if(Cmb_SaveDiv.value != ds_srch_cond.getColumn(0,"RSV_USE_DIV")){
		cf_Alert("BNSE0035","적립구분");
		Cmb_SaveDiv.setFocus();
		return;
	}
	if(Cmb_UseOilKnd.value != ds_srch_cond.getColumn(0,"PROD_DIV")){
		cf_Alert("BNSE0035","사용유종");
		Cmb_UseOilKnd.setFocus();
		return;
	}
	if(Cmb_Chnl.value != ds_srch_cond.getColumn(0,"CHNL_DIV")){
		cf_Alert("BNSE0035","채널");
		Cmb_Chnl.setFocus();
		return;
	}
	if(Cmb_Affil.value != ds_srch_cond.getColumn(0,"FRNCHSE_DIV")){
		cf_Alert("BNSE0035","가맹점");
		Cmb_Affil.setFocus();
		return;
	}
	if(Rdo_SrchDiv.value != ds_srch_cond.getColumn(0,"RDO_DIV")){
		cf_Alert("BNSE0035","조회구분");
		return;
	}
	if(strSelCrdNo != ds_srch_cond.getColumn(0,"CRD_NO")){
		cf_Alert("BNSE0035","카드번호");
		return;	
	}
	
	ds_srch_cond.setColumn(0,"CUR_PAGE",(parseInt(ds_srch_cond.getColumn(0,"CUR_PAGE")) + 1).toString());
	ds_srch_cond.setColumn(0,"MORE_YN","Y");
	ds_srch_cond.setColumn(0,"EXCEL_YN","N");	
	fn_srchPastListInfo();
	
}

// 업무처리정보등록(구매이력조회 후)
function fn_saveBizProc()
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];	
	var objCnslDs  	= this.parent.parent.all["Tab_CntctHistInfo"]["tabpage1"].all["ds_cnsl_seq_out"];	
	var strCnslSeq 	= "";
	var strCrdNo	= "";			
	
	if(objCnslDs.rowcount  > 0){
		strCnslSeq = objCnslDs.getColumn(0,"CNSL_SEQ_NO")
	}
	
	if(Rdo_SrchDiv.value == "2" || Rdo_SrchDiv == "4"){	
		var objDsCrd	= this.parent.parent.all["Tab_CrdInfo"]["tabpage2"].all["ds_crd_info"];
		var intSelRow	= objDsCrd.findRow("CHK",1);
		strCrdNo		= objDsCrd.getColumn(intSelRow,"CRD_NO");
	}

	var obj = new Object();	
	obj.PGM_ID 		= "BNS410";
	obj.CUST_ID 	= objDsCust.getColumn(0,"IO_CUST_NO");
	obj.CRD_NO 		= strCrdNo;
	obj.PROC_ATM 	= "";
	obj.CNSL_SEQ_NO = strCnslSeq;
	obj.USR_ID 		= getTrim(GetUserInfo("gUSR_ID"));
	
	setBizProcInfo(obj);
	
	var	strSvcID = "C1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=gds_BizProcInfo:a"; 
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=Common.Set_BizProcInfo_INSERT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	
}

// 업무처리정보 Set
function setBizProcInfo(arrObj){

	gds_BizProcInfo.clearData();
	
	var row = gds_BizProcInfo.addRow();
	gds_BizProcInfo.setColumn(row, "PGM_ID" 		, arrObj.PGM_ID);
	gds_BizProcInfo.setColumn(row, "CUST_ID" 		, arrObj.CUST_ID);
	gds_BizProcInfo.setColumn(row, "CRD_NO" 		, arrObj.CRD_NO);
	gds_BizProcInfo.setColumn(row, "PROC_ATM" 		, arrObj.PROC_ATM);
	gds_BizProcInfo.setColumn(row, "CNSL_SEQ_NO" 	, arrObj.CNSL_SEQ_NO);
	gds_BizProcInfo.setColumn(row, "USR_ID" 		, arrObj.USR_ID);
	
//	trace(gds_BizProcInfo.saveXML());
}

// 인터페이스 환경 DS 세팅
function fn_setIfEnvDs(ObjDs,IfKnd,ReqMthd,ReqId,ResHd,ResCol,ResRec)
{
	var ObjEnvDs = "";
	
	if (typeof ObjDs == "string"){
		//ObjEnvDs= eval(ObjDs);
		ObjEnvDs = (function(){eval(ObjDs);}());
	}else{
		ObjEnvDs = ObjDs;
	}

	fun_ds_srch(ObjEnvDs, "IF_KIND",IfKnd);
	fun_ds_srch(ObjEnvDs, "REQ_SERVICE_METHOD",ReqMthd);
	fun_ds_srch(ObjEnvDs, "REQ_SERVICE_ID",ReqId);	
	fun_ds_srch(ObjEnvDs, "RES_HEADER_SECTION",ResHd);
	fun_ds_srch(ObjEnvDs, "RES_COLUMN_SECTION",ResCol);
	fun_ds_srch(ObjEnvDs, "RES_RECORD_SECTION",ResRec);			
}

/********************************************************************************** 
 *****	인터페이스조회
***********************************************************************************/
// 주민조회, 카드조회
function fn_srchCurrentInfo()
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var objDsCrd	= this.parent.parent.all["Tab_CrdInfo"]["tabpage2"].all["ds_crd_info"];
	var intSelRow	= objDsCrd.findRow("CHK",1);
	var strSelCrdNo	= "";
	if(intSelRow != -1){
		strSelCrdNo = objDsCrd.getColumn(intSelRow,"CRD_NO").replace("-","");	
	}
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// 통합회원(그룹포인트조회)

		ds_if_grppt_env.clearData();
		ds_if_grppt_data.clearData();
		ds_if_grppt_common.clearData();
		ds_if_grppt_header.clearData();
		ds_if_grppt_column.clearData();
		ds_if_grppt_record.clearData();
		ds_rsv_hist_out.clearData();			
	
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_grppt_env,"WAS","ptGrpptSelC01.do","","STP_PT_GRPPT_SEL_C01_Rsp","","OT_OUT_CURSOR");

		fun_ds_srch(ds_if_grppt_data,"req_chnl_code","610050");
		fun_ds_srch(ds_if_grppt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_grppt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_grppt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
					
		if(Rdo_SrchDiv.value == "1"){
			fun_ds_srch(ds_if_grppt_data, "in_cust_no",objDsCust.getColumn(0,"IO_CUST_NO"));						
			fun_ds_srch(ds_if_grppt_data, "in_card_no","");									
		}else{
			fun_ds_srch(ds_if_grppt_data, "in_cust_no","");
			fun_ds_srch(ds_if_grppt_data, "in_card_no",strSelCrdNo);
			
		}			
		fun_ds_srch(ds_if_grppt_data, "in_from_date",Cal_SrchFrmDt.value);
		fun_ds_srch(ds_if_grppt_data, "in_to_date",Cal_SrchToDt.value);
		fun_ds_srch(ds_if_grppt_data, "in_page_no","0");
		fun_ds_srch(ds_if_grppt_data, "in_page_size","0");
	   
		var	strSvcID = "IF_CSC_ITRT_133";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_grppt_env:a INTERFACE_DATA=ds_if_grppt_data:a";
		var	strOutDatasets = "ds_if_grppt_common=DS_COMMON ds_if_grppt_header=DS_HEADER ds_if_grppt_column=DS_COLUMN ds_if_grppt_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
			
	}else{		// 기존회원(적립포인트조회)
		ds_if_trnpt_env.clearData();
		ds_if_trnpt_data.clearData();
		ds_if_trnpt_common.clearData();
		ds_if_trnpt_header.clearData();
		ds_if_trnpt_column.clearData();
		ds_if_trnpt_record.clearData();
		ds_rsv_hist_out.clearData();		
		
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_trnpt_env,"WAS","ptTrnptSelC08.do","","STP_PT_TRNPT_SEL_C08_Rsp","","OT_OUT_CURSOR");
				
		fun_ds_srch(ds_if_trnpt_data,"req_chnl_code","610050");
		fun_ds_srch(ds_if_trnpt_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_trnpt_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_trnpt_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
			
		if(Rdo_SrchDiv.value == "1"){
			fun_ds_srch(ds_if_trnpt_data, "in_search_key","1");
			fun_ds_srch(ds_if_trnpt_data, "in_cust_no",getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
			fun_ds_srch(ds_if_trnpt_data, "in_crd_no","");	
		}else{
			fun_ds_srch(ds_if_trnpt_data, "in_search_key","2");
			fun_ds_srch(ds_if_trnpt_data, "in_cust_no","");
			fun_ds_srch(ds_if_trnpt_data, "in_crd_no",strSelCrdNo);	
		} 				
		fun_ds_srch(ds_if_trnpt_data, "in_strt_dt",Cal_SrchFrmDt.value);
		fun_ds_srch(ds_if_trnpt_data, "in_end_dt",Cal_SrchToDt.value);
		fun_ds_srch(ds_if_trnpt_data, "in_rsv_use_div_cd",getTrim(Cmb_SaveDiv.value));			// 적립사용구분
		fun_ds_srch(ds_if_trnpt_data, "in_frch_div_cd",getTrim(Cmb_Affil.value));				// 가맹점구분
						
		var	strSvcID = "IF_CSC_ITRT_081";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_trnpt_env:a INTERFACE_DATA=ds_if_trnpt_data:a";
		var	strOutDatasets = "ds_if_trnpt_common=DS_COMMON ds_if_trnpt_header=DS_HEADER ds_if_trnpt_column=DS_COLUMN ds_if_trnpt_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);				
	}
}

// BW주민, BW카드 총카운트
function fn_srchPastCntInfo()
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var objDsCrd	= this.parent.parent.all["Tab_CrdInfo"]["tabpage2"].all["ds_crd_info"];
	var intSelRow	= objDsCrd.findRow("CHK",1);
	var strSelCrdNo	= "";
	if(intSelRow != -1){
		strSelCrdNo = objDsCrd.getColumn(intSelRow,"CRD_NO").replace("-","");	
	}
	
	
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// BW 로열티 총카운트
		ds_if_bwcnt_intg_env.clearData();
		ds_if_bwcnt_intg_data.clearData();
		ds_if_bwcnt_intg_common.clearData();
		ds_if_bwcnt_intg_header.clearData();
		ds_if_bwcnt_intg_column.clearData();
		ds_if_bwcnt_intg_record.clearData();	
	
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_bwcnt_intg_env,"SAP","","CallCSC_BWGSLPCNT_RNI","CallCSC_BWGSLPCNT_RNIResult","","");

		fun_ds_srch(ds_if_bwcnt_intg_data,"REQ_CHNL_CODE","610050");
		fun_ds_srch(ds_if_bwcnt_intg_data,"INPUT_USER_ID",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_bwcnt_intg_data,"INPUT_USER_NM",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_bwcnt_intg_data,"INPUT_USER_IP",getTrim(GetUserInfo("gLGIN_IP")));
					
		if(Rdo_SrchDiv.value == "3"){
			fun_ds_srch(ds_if_bwcnt_intg_data, "IN_CUST_NO",objDsCust.getColumn(0,"OT_INTG_CUST_NO"));
			fun_ds_srch(ds_if_bwcnt_intg_data, "IN_CARD_NO","");
			fun_ds_srch(ds_if_bwcnt_intg_data, "IN_FLAG","A");
									
		}else{
			fun_ds_srch(ds_if_bwcnt_intg_data, "IN_CUST_NO","");
			fun_ds_srch(ds_if_bwcnt_intg_data, "IN_CARD_NO",strSelCrdNo);			
			fun_ds_srch(ds_if_bwcnt_intg_data, "IN_FLAG","C");						
		}
					
		fun_ds_srch(ds_if_bwcnt_intg_data,"IN_FROM_DATE",Cal_SrchFrmDt.value);
		fun_ds_srch(ds_if_bwcnt_intg_data,"IN_TO_DATE",Cal_SrchToDt.value);
		
		//TEST
		//fun_ds_srch(ds_if_bwcnt_intg_data, "IN_CUST_NO","");
		//fun_ds_srch(ds_if_bwcnt_intg_data, "IN_CARD_NO","1019150042893024");
		//fun_ds_srch(ds_if_bwcnt_intg_data,"IN_FROM_DATE","20150101");
		//fun_ds_srch(ds_if_bwcnt_intg_data,"IN_TO_DATE","20150104");
		
		
		//trace("1)CallCSC_BWGSLPCNT_RNI====>"+TodayTime()+ds_if_bwcnt_intg_data.saveXML());
		
		
	
		var	strSvcID = "IF_CSC_BW_003";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bwcnt_intg_env:a INTERFACE_DATA=ds_if_bwcnt_intg_data:a";
		var	strOutDatasets = "ds_if_bwcnt_intg_common=DS_COMMON ds_if_bwcnt_intg_header=DS_HEADER ds_if_bwcnt_intg_column=DS_COLUMN ds_if_bwcnt_intg_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBackBwCnt";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);					

	}else{													// BW 캡티브 총카운트
		ds_if_bwcnt_cptv_env.clearData();
		ds_if_bwcnt_cptv_data.clearData();
		ds_if_bwcnt_cptv_common.clearData();
		ds_if_bwcnt_cptv_header.clearData();
		ds_if_bwcnt_cptv_column.clearData();
		ds_if_bwcnt_cptv_record.clearData();	
	
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_bwcnt_cptv_env,"SAP","","CallCSC_BWCAPCNT_RNI","CallCSC_BWCAPCNT_RNIResult","","");

		fun_ds_srch(ds_if_bwcnt_cptv_data,"REQ_CHNL_CODE","610050");
		fun_ds_srch(ds_if_bwcnt_cptv_data,"INPUT_USER_ID",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_bwcnt_cptv_data,"INPUT_USER_NM",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_bwcnt_cptv_data,"INPUT_USER_IP",getTrim(GetUserInfo("gLGIN_IP")));
					
		if(Rdo_SrchDiv.value == "3"){
			fun_ds_srch(ds_if_bwcnt_cptv_data, "IN_CUST_NO",objDsCust.getColumn(0,"IO_CUST_NO"));		
			fun_ds_srch(ds_if_bwcnt_cptv_data, "IN_CARD_NO","");
			fun_ds_srch(ds_if_bwcnt_cptv_data, "IN_FLAG","A");
									
		}else{
			fun_ds_srch(ds_if_bwcnt_cptv_data, "IN_CUST_NO","");
			fun_ds_srch(ds_if_bwcnt_cptv_data, "IN_CARD_NO",strSelCrdNo);			
			fun_ds_srch(ds_if_bwcnt_cptv_data, "IN_FLAG","C");						
		}
					
		fun_ds_srch(ds_if_bwcnt_cptv_data,"IN_FROM_DATE",Cal_SrchFrmDt.value);
		fun_ds_srch(ds_if_bwcnt_cptv_data,"IN_TO_DATE",Cal_SrchToDt.value);
	
		var	strSvcID = "IF_CSC_BW_001";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bwcnt_cptv_env:a INTERFACE_DATA=ds_if_bwcnt_cptv_data:a";
		var	strOutDatasets = "ds_if_bwcnt_cptv_common=DS_COMMON ds_if_bwcnt_cptv_header=DS_HEADER ds_if_bwcnt_cptv_column=DS_COLUMN ds_if_bwcnt_cptv_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBackBwCnt";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);				
	}	
}

// BW 주민, 카드 리스트
function fn_srchPastListInfo()
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var objDsCrd	= this.parent.parent.all["Tab_CrdInfo"]["tabpage2"].all["ds_crd_info"];
	var intSelRow	= objDsCrd.findRow("CHK",1);
	var strSelCrdNo	= "";
	if(intSelRow != -1){
		strSelCrdNo = objDsCrd.getColumn(intSelRow,"CRD_NO").replace("-","");	
	}
	
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// BW 로열티 총카운트
		ds_if_bwlist_intg_env.clearData();
		ds_if_bwlist_intg_data.clearData();
		ds_if_bwlist_intg_common.clearData();
		ds_if_bwlist_intg_header.clearData();
		ds_if_bwlist_intg_column.clearData();
		ds_if_bwlist_intg_record.clearData();
		ds_bw_page_list.clearData();
	
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_bwlist_intg_env,"SAP","","CallCSC_BWGSLLST_RNI","CallCSC_BWGSLLST_RNIResult","","OT_RESULT");

		fun_ds_srch(ds_if_bwcnt_cptv_data,"REQ_CHNL_CODE","610050");
		fun_ds_srch(ds_if_bwcnt_cptv_data,"INPUT_USER_ID",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_bwcnt_cptv_data,"INPUT_USER_NM",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_bwcnt_cptv_data,"INPUT_USER_IP",getTrim(GetUserInfo("gLGIN_IP")));
					
		if(Rdo_SrchDiv.value == "3"){
			fun_ds_srch(ds_if_bwlist_intg_data, "IN_CUST_NO",objDsCust.getColumn(0,"OT_INTG_CUST_NO"));		
			fun_ds_srch(ds_if_bwlist_intg_data, "IN_CARD_NO","");
			fun_ds_srch(ds_if_bwlist_intg_data, "IN_FLAG","A");
									
		}else{
			fun_ds_srch(ds_if_bwlist_intg_data, "IN_CUST_NO","");
			fun_ds_srch(ds_if_bwlist_intg_data, "IN_CARD_NO",strSelCrdNo);			
			fun_ds_srch(ds_if_bwlist_intg_data, "IN_FLAG","C");						
		}
					
		fun_ds_srch(ds_if_bwlist_intg_data,"IN_FROM_DATE",Cal_SrchFrmDt.value);
		fun_ds_srch(ds_if_bwlist_intg_data,"IN_TO_DATE",Cal_SrchToDt.value);
		fun_ds_srch(ds_if_bwlist_intg_data,"IN_CURRENTPAGE",ds_srch_cond.getColumn(0,"CUR_PAGE"));		
		
		
		//TEST
		//fun_ds_srch(ds_if_bwlist_intg_data, "IN_CUST_NO","");
		//fun_ds_srch(ds_if_bwlist_intg_data, "IN_CARD_NO","1019150042893024");
		//fun_ds_srch(ds_if_bwlist_intg_data,"IN_FROM_DATE","20150101");
		//fun_ds_srch(ds_if_bwlist_intg_data,"IN_TO_DATE","20150104");
		//trace(ds_if_bwlist_intg_data.saveXML());	
	
		var	strSvcID = "IF_CSC_BW_004";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bwlist_intg_env:a INTERFACE_DATA=ds_if_bwlist_intg_data:a";
		var	strOutDatasets = "ds_if_bwlist_intg_common=DS_COMMON ds_if_bwlist_intg_header=DS_HEADER ds_if_bwlist_intg_column=DS_COLUMN ds_if_bwlist_intg_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBackBwList";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);					

	}else{													// BW 캡티브 총카운트
		ds_if_bwlist_cptv_env.clearData();
		ds_if_bwlist_cptv_data.clearData();
		ds_if_bwlist_cptv_common.clearData();
		ds_if_bwlist_cptv_header.clearData();
		ds_if_bwlist_cptv_column.clearData();
		ds_if_bwlist_cptv_record.clearData();
		ds_bw_page_list.clearData();			
	
		// 환경DS 세팅
		fn_setIfEnvDs(ds_if_bwlist_cptv_env,"SAP","","CallCSC_BWCAPLST_RNI","CallCSC_BWCAPLST_RNIResult","","OT_RESULT");

		fun_ds_srch(ds_if_bwcnt_cptv_data,"REQ_CHNL_CODE","610050");
		fun_ds_srch(ds_if_bwcnt_cptv_data,"INPUT_USER_ID",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_bwcnt_cptv_data,"INPUT_USER_NM",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_bwcnt_cptv_data,"INPUT_USER_IP",getTrim(GetUserInfo("gLGIN_IP")));
					
		if(Rdo_SrchDiv.value == "3"){
			fun_ds_srch(ds_if_bwlist_cptv_data, "IN_CUST_NO",objDsCust.getColumn(0,"IO_CUST_NO"));
			fun_ds_srch(ds_if_bwlist_cptv_data, "IN_CARD_NO","");
			fun_ds_srch(ds_if_bwlist_cptv_data, "IN_FLAG","A");
									
		}else{
			fun_ds_srch(ds_if_bwlist_cptv_data, "IN_CUST_NO","");
			fun_ds_srch(ds_if_bwlist_cptv_data, "IN_CARD_NO",strSelCrdNo);			
			fun_ds_srch(ds_if_bwlist_cptv_data, "IN_FLAG","C");						
		}
					
		fun_ds_srch(ds_if_bwlist_cptv_data,"IN_FROM_DATE",Cal_SrchFrmDt.value);
		fun_ds_srch(ds_if_bwlist_cptv_data,"IN_TO_DATE",Cal_SrchToDt.value);
		fun_ds_srch(ds_if_bwlist_cptv_data,"IN_CURRENTPAGE",ds_srch_cond.getColumn(0,"CUR_PAGE"));		
	
		var	strSvcID = "IF_CSC_BW_002";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bwlist_cptv_env:a INTERFACE_DATA=ds_if_bwlist_cptv_data:a";
		var	strOutDatasets = "ds_if_bwlist_cptv_common=DS_COMMON ds_if_bwlist_cptv_header=DS_HEADER ds_if_bwlist_cptv_column=DS_COLUMN ds_if_bwlist_cptv_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBackBwList";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);				
	}	
}

/********************************************************************************** 
 *****	콜백처리
***********************************************************************************/

// 콜백처리
function fn_callBack(svcid,strErrCode,strErrMsg)
{	 	
	// 업무처리정보등록
	if(svcid == "C1"){
	}
	
	// 적립포인트조회
	if(svcid == "IF_CSC_ITRT_081"){
		var strHttpCd 	= ds_if_trnpt_common.getColumn(ds_if_trnpt_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_trnpt_common.getColumn(ds_if_trnpt_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_trnpt_header.getColumn(ds_if_trnpt_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_trnpt_header.getColumn(ds_if_trnpt_header.rowposition,"OT_RES_MSG");
		
		if(strHttpCd=="0"){
			if(strRtnCd=="00000"){
				fn_saveBizProc();
				var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];
				//건수표시	
				objCntStt.text	= ds_if_trnpt_record.rowcount;				
				if(ds_if_trnpt_record.rowcount < 1){
					cf_Alert("COMI0006");					
					return;	
				}else{
					fn_setBuyHistDs(svcid);
				}
			}else{
				cf_Alert("COME0035",strRtnMsg);	
			}			
		}else{
			cf_Alert("COME0035",strHttpMsg);
		}		
	}
	
	// 그룹포인트조회
	if(svcid == "IF_CSC_ITRT_133"){
		var strHttpCd 	= ds_if_grppt_common.getColumn(ds_if_grppt_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_grppt_common.getColumn(ds_if_grppt_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_grppt_header.getColumn(ds_if_grppt_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_grppt_header.getColumn(ds_if_grppt_header.rowposition,"OT_RES_MSG");
		
		//trace("===>"+ds_if_grppt_record.saveXML());
		
		if(strHttpCd=="0"){
			if(strRtnCd=="00000"){
				fn_saveBizProc();
				var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];			
				//건수표시	
				objCntStt.text	= ds_if_grppt_record.rowcount;
				//trace("ds_if_grppt_record"+ds_if_grppt_record.saveXML());
				if(ds_if_grppt_record.rowcount < 1){
					cf_Alert("COMI0006");					
					return;	
				}else{			
					fn_setBuyHistDs(svcid);
				}
			}else{
				cf_Alert("COME0035",strRtnMsg);	
			}			
		}else{
			cf_Alert("COME0035",strHttpMsg);
		}		
	}
	
	// 한도조정을 위한 인터페이스1
	if(svcid == "IF_CSC_ITRT_133_BEF1"){
		var strHttpCd 	= ds_if_bef_hist1_common.getColumn(ds_if_bef_hist1_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bef_hist1_common.getColumn(ds_if_bef_hist1_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bef_hist1_header.getColumn(ds_if_bef_hist1_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bef_hist1_header.getColumn(ds_if_bef_hist1_header.rowposition,"OT_RES_MSG");
		
		var intRow = ds_call_back.addRow();
		ds_call_back.setColumn(intRow,"HTTP_CD",strHttpCd);
		ds_call_back.setColumn(intRow,"HTTP_MSG",strHttpMsg);
		ds_call_back.setColumn(intRow,"RSPN_CD",strRtnCd);
		ds_call_back.setColumn(intRow,"RSPN_MSG",strRtnMsg);
				
		fn_callBackAll();			
	}	
	
	if(svcid == "IF_CSC_ITRT_081_BEF1"){
		var strHttpCd 	= ds_if_bef_hist1_common.getColumn(ds_if_bef_hist1_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bef_hist1_common.getColumn(ds_if_bef_hist1_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bef_hist1_header.getColumn(ds_if_bef_hist1_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bef_hist1_header.getColumn(ds_if_bef_hist1_header.rowposition,"OT_RES_MSG");
		
		var intRow = ds_call_back.addRow();
		ds_call_back.setColumn(intRow,"HTTP_CD",strHttpCd);
		ds_call_back.setColumn(intRow,"HTTP_MSG",strHttpMsg);
		ds_call_back.setColumn(intRow,"RSPN_CD",strRtnCd);
		ds_call_back.setColumn(intRow,"RSPN_MSG",strRtnMsg);
				
		fn_callBackAll();			
	}		
		
	// 한도조정을 위한 인터페이스2
	if(svcid == "IF_CSC_ITRT_133_BEF2"){
		var strHttpCd 	= ds_if_bef_hist2_common.getColumn(ds_if_bef_hist2_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bef_hist2_common.getColumn(ds_if_bef_hist2_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bef_hist2_header.getColumn(ds_if_bef_hist2_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bef_hist2_header.getColumn(ds_if_bef_hist2_header.rowposition,"OT_RES_MSG");
		
		var intRow = ds_call_back.addRow();
		ds_call_back.setColumn(intRow,"HTTP_CD",strHttpCd);
		ds_call_back.setColumn(intRow,"HTTP_MSG",strHttpMsg);
		ds_call_back.setColumn(intRow,"RSPN_CD",strRtnCd);
		ds_call_back.setColumn(intRow,"RSPN_MSG",strRtnMsg);
				
		fn_callBackAll();			
	}
	
	if(svcid == "IF_CSC_ITRT_081_BEF2"){
		var strHttpCd 	= ds_if_bef_hist2_common.getColumn(ds_if_bef_hist2_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bef_hist2_common.getColumn(ds_if_bef_hist2_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bef_hist2_header.getColumn(ds_if_bef_hist2_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bef_hist2_header.getColumn(ds_if_bef_hist2_header.rowposition,"OT_RES_MSG");
		
		var intRow = ds_call_back.addRow();
		ds_call_back.setColumn(intRow,"HTTP_CD",strHttpCd);
		ds_call_back.setColumn(intRow,"HTTP_MSG",strHttpMsg);
		ds_call_back.setColumn(intRow,"RSPN_CD",strRtnCd);
		ds_call_back.setColumn(intRow,"RSPN_MSG",strRtnMsg);
				
		fn_callBackAll();			
	}	
			
	// 한도조정을 위한 인터페이스3
	if(svcid == "IF_CSC_ITRT_133_BEF3"){
		var strHttpCd 	= ds_if_bef_hist3_common.getColumn(ds_if_bef_hist3_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bef_hist3_common.getColumn(ds_if_bef_hist3_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bef_hist3_header.getColumn(ds_if_bef_hist3_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bef_hist3_header.getColumn(ds_if_bef_hist3_header.rowposition,"OT_RES_MSG");
		
		var intRow = ds_call_back.addRow();
		ds_call_back.setColumn(intRow,"HTTP_CD",strHttpCd);
		ds_call_back.setColumn(intRow,"HTTP_MSG",strHttpMsg);
		ds_call_back.setColumn(intRow,"RSPN_CD",strRtnCd);
		ds_call_back.setColumn(intRow,"RSPN_MSG",strRtnMsg);
				
		fn_callBackAll();				
	}
	
	if(svcid == "IF_CSC_ITRT_081_BEF3"){
		var strHttpCd 	= ds_if_bef_hist3_common.getColumn(ds_if_bef_hist3_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bef_hist3_common.getColumn(ds_if_bef_hist3_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bef_hist3_header.getColumn(ds_if_bef_hist3_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bef_hist3_header.getColumn(ds_if_bef_hist3_header.rowposition,"OT_RES_MSG");
		
		var intRow = ds_call_back.addRow();
		ds_call_back.setColumn(intRow,"HTTP_CD",strHttpCd);
		ds_call_back.setColumn(intRow,"HTTP_MSG",strHttpMsg);
		ds_call_back.setColumn(intRow,"RSPN_CD",strRtnCd);
		ds_call_back.setColumn(intRow,"RSPN_MSG",strRtnMsg);
				
		fn_callBackAll();				
	}	
	
	if(svcid == "IF_01"){
	
	
		if(ds_if_payhist_record.rowcount < 1){
			cf_Alert("COMI0006");	
		}	
		
		var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];			
		//건수표시	
		objCntStt.text	= ds_if_payhist_record.rowcount;
	
		//trace("구매이력::>>>>"+ds_if_payhist_record.saveXML());
	
	}
	
	if(svcid == "IF_CSC_OPS_002"){
		var ot_respon = ds_if_ev_chargeSum_header.getColumn(0,"RESULTCODE");
		if(ot_respon == "0000"){
			Stt_TotRflAmnt00.text = "총 충전량 :";
			Stt_TotRflAmnt2.text = "총 할인금액 :";
			Stt_TotRflAmnt3.text = "최종 결제금액 :";
			
			Msk_BefTotAmt1.value = ds_charge_sum_record.getColumn(0,"FINALCHARGEQTY");
			Msk_BefTotAmt2.value = ds_charge_sum_record.getColumn(0,"FINALDISCOUNTAMT");
			Msk_BefTotAmt3.value = ds_charge_sum_record.getColumn(0,"FINALPAIDAMT");
			
			Stt_TotRflAmnt00.visible = true;
			Stt_TotRflAmnt2.visible = true;
			Stt_TotRflAmnt3.visible = true;
			
			Msk_BefTotAmt1.mask = "";
			
			Msk_BefTotAmt1.visible = true;
			Msk_BefTotAmt2.visible = true;
			Msk_BefTotAmt3.visible = true;
			
		}
	}
	
	if(svcid == "IF_CSC_OPS_003"){
		var ot_respon = ds_if_ev_chargeHist_header.getColumn(0,"RESULTCODE");
		
		if(ot_respon == "0000") {
			//trace(ds_charge_hist_record.saveXML());
			for(var i = 0; i<ds_charge_hist_record.rowcount; i++) {
				ds_charge_hist_record.setColumn(i, "SELLDT", ds_charge_hist_record.getColumn(i, "SELLDT") + ds_charge_hist_record.getColumn(i, "SELLTM"));
				
				if(ds_charge_hist_record.getColumn(i, "PTTRNNICK") == "NULL") {
					ds_charge_hist_record.setColumn(i, "PTTRNNICK", "");
				}
				
				//소수점 자리 제거
				ds_charge_hist_record.setColumn(i, "TOTPAYAMT"	, Math.floor(ds_charge_hist_record.getColumn(i, "TOTPAYAMT")));			//전체결제금액
				ds_charge_hist_record.setColumn(i, "DCUNTPRC"	, Math.floor(ds_charge_hist_record.getColumn(i, "DCUNTPRC")));			//할인단가
				ds_charge_hist_record.setColumn(i, "CHARGEUNTPRC"	, Math.floor(ds_charge_hist_record.getColumn(i, "CHARGEUNTPRC")));	//충전단가
				ds_charge_hist_record.setColumn(i, "USEPNT"	, Math.floor(ds_charge_hist_record.getColumn(i, "USEPNT")));				//사용포인트
				ds_charge_hist_record.setColumn(i, "SAVEPNT"	, Math.floor(ds_charge_hist_record.getColumn(i, "SAVEPNT")));			//적립포인트
			}

			var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];			
			//건수표시	
			objCntStt.text	= ds_charge_hist_record.rowcount;
		} else {
			var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];			
			//건수표시	
			objCntStt.text	= "";
		}
	}
	
	if(svcid == "IF_WS_0352"){
		var strHttpCd 	= ds_if_eventptHist_common.getColumn(0,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_eventptHist_common.getColumn(0,"HTTP_RET_MSG");
	
		if(strHttpCd=="0"){
			var strRtnCd	= ds_if_eventptHist_header.getColumn(0,"OT_RESPON_CODE");
			var strRtnMsg	= ds_if_eventptHist_header.getColumn(0,"OT_RES_MSG");
			
			if(strRtnCd == "00000") {
				var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];
				//건수표시	
				objCntStt.text	= ds_if_eventptHist_record.rowcount;
				
				for(var i = 0; i < ds_if_eventptHist_record.rowcount; i++) {
					ds_if_eventptHist_record.setColumn(i, "SALE_DTIME", ds_if_eventptHist_record.getColumn(i, "SALE_DTIME").split('.')[0]);
				}
				
			} else {
				cf_Alert("COME0035",strRtnMsg);
			}
		}else {
			cf_Alert("COME0035",strHttpMsg);
		}
	}
	
	
	
			
}

// 콜백BW
function fn_callBackBwCnt(svcid,strErrCode,strErrMsg)
{
	// BW 구매이력 총카운트 조회(캡티브)
	if(svcid == "IF_CSC_BW_001"){
		var strHttpCd 	= ds_if_bwcnt_cptv_common.getColumn(ds_if_bwcnt_cptv_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bwcnt_cptv_common.getColumn(ds_if_bwcnt_cptv_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bwcnt_cptv_header.getColumn(ds_if_bwcnt_cptv_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bwcnt_cptv_header.getColumn(ds_if_bwcnt_cptv_header.rowposition,"OT_RES_MSG");
		
		if(strHttpCd=="0"){
			if(strRtnCd=="00000"){
				// BW 인터페이스조회				
				
				sta_bw1.value = ds_if_bwcnt_cptv_record.getColumn(0,"ot_total_amount");
				sta_bw2.value = ds_if_bwcnt_cptv_record.getColumn(0,"ot_total_quantity");
				sta_bw3.value = ds_if_bwcnt_cptv_record.getColumn(0,"ot_total_point");
				
				fn_srchPastListInfo();			
			}else{
				cf_Alert("COME0035",strRtnMsg);	
			}			
		}else{
			cf_Alert("COME0035",strHttpMsg);
		}		
	}
	
	// BW 구매이력 총카운트 조회(통합)
	if(svcid == "IF_CSC_BW_003"){
		var strHttpCd 	= ds_if_bwcnt_intg_common.getColumn(ds_if_bwcnt_intg_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bwcnt_intg_common.getColumn(ds_if_bwcnt_intg_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bwcnt_intg_header.getColumn(ds_if_bwcnt_intg_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bwcnt_intg_header.getColumn(ds_if_bwcnt_intg_header.rowposition,"OT_RES_MSG");
		
		//trace("=============페이지 호출 결과 받을때 시간 걸림==========");
		//trace(strHttpCd);
		//trace(strHttpMsg);
		//trace(strRtnCd);
		//trace(strRtnMsg);
		
		if(strHttpCd=="0"){
			if(strRtnCd=="00000"){
				// BW 인터페이스조회
				
				sta_bw1.value = ds_if_bwcnt_intg_record.getColumn(0,"ot_total_amount");
				sta_bw2.value = ds_if_bwcnt_intg_record.getColumn(0,"ot_total_quantity");
				sta_bw3.value = ds_if_bwcnt_intg_record.getColumn(0,"ot_total_point");
				
				//trace("CallCSC_BWGSLPCNT_RNI 결과::"+TodayTime()+ds_if_bwcnt_intg_record.saveXML());		
				
				fn_srchPastListInfo();			
			}else{
				cf_Alert("COME0035",strRtnMsg);	
			}			
		}else{
			cf_Alert("COME0035",strHttpMsg);
		}		
	}	
}

// 콜백BW
function fn_callBackBwList(svcid,strErrCode,strErrMsg)
{
	// BW 구매이력 리스트 조회(캡티브)
	if(svcid == "IF_CSC_BW_002"){
	
		//trace(ds_if_bwlist_cptv_record.saveXML());
	
		var strHttpCd 	= ds_if_bwlist_cptv_common.getColumn(ds_if_bwlist_cptv_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bwlist_cptv_common.getColumn(ds_if_bwlist_cptv_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bwlist_cptv_header.getColumn(ds_if_bwlist_cptv_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bwlist_cptv_header.getColumn(ds_if_bwlist_cptv_header.rowposition,"OT_RES_MSG");
		
		if(strHttpCd=="0"){
			if(strRtnCd=="00000"){
				if(ds_srch_cond.getColumn(0,"MORE_YN") != "Y" && ds_srch_cond.getColumn(0,"EXCEL_YN") != "Y"){
					fn_saveBizProc();
				}
				fn_setBwHistDs(svcid);				
			}else{
				cf_Alert("COME0035",strRtnMsg);	
			}			
		}else{
			cf_Alert("COME0035",strHttpMsg);
		}		
	}
	
	// BW 구매이력 리스트 조회(통합)
	if(svcid == "IF_CSC_BW_004"){
		var strHttpCd 	= ds_if_bwlist_intg_common.getColumn(ds_if_bwlist_intg_common.rowposition,"HTTP_RET_CODE");
		var strHttpMsg 	= ds_if_bwlist_intg_common.getColumn(ds_if_bwlist_intg_common.rowposition,"HTTP_RET_MSG");
		var strRtnCd	= ds_if_bwlist_intg_header.getColumn(ds_if_bwlist_intg_header.rowposition,"OT_RESPON_CODE");
		var strRtnMsg	= ds_if_bwlist_intg_header.getColumn(ds_if_bwlist_intg_header.rowposition,"OT_RES_MSG");
		
		
		//trace(strHttpCd+"//"+strRtnCd);
		//trace("CallCSC_BWGSLLST_RNI 결과====>"+TodayTime()+ds_if_bwlist_intg_record.saveXML());
		
		if(strHttpCd=="0"){
			if(strRtnCd=="00000"){
				if(ds_srch_cond.getColumn(0,"MORE_YN") != "Y" && ds_srch_cond.getColumn(0,"EXCEL_YN") != "Y"){
					fn_saveBizProc();
				}			
				fn_setBwHistDs(svcid);
			}else{
				cf_Alert("COME0035",strRtnMsg);	
			}			
		}else{
			cf_Alert("COME0035",strHttpMsg);
		}		
	}	
}

/********************************************************************************** 
 *****	List 세팅
***********************************************************************************/
// 적립포인트, 그룹포인트 항목 세팅
function fn_setBuyHistDs(strSvcId)
{	
	if(strSvcId == "IF_CSC_ITRT_081"){				// 적립포인트조회
		for(i=0;i<ds_if_trnpt_record.rowcount;i++)
		{					
			
			var intRow = ds_rsv_hist_out.addRow();
			
			ds_rsv_hist_out.setColumn(intRow,"SALE_DTIME_UI",ds_if_trnpt_record.getColumn(i,"SALE_DTIME").substr(0,14));
			ds_rsv_hist_out.setColumn(intRow,"CRD_NO",ds_if_trnpt_record.getColumn(i,"CRD_NO"));
			ds_rsv_hist_out.setColumn(intRow,"CHNL_DIV",ds_if_trnpt_record.getColumn(i,"CHNL_DIV_CD"));
			ds_rsv_hist_out.setColumn(intRow,"CHNL_DIV_NM",ds_if_trnpt_record.getColumn(i,"CHNL_DIV_NM"));
			ds_rsv_hist_out.setColumn(intRow,"RSV_USE_DIV",ds_if_trnpt_record.getColumn(i,"RSV_USE_DIV_CD"));
			ds_rsv_hist_out.setColumn(intRow,"RSV_USE_DIV_NM",ds_if_trnpt_record.getColumn(i,"RSV_USE_DIV_NM"));
			ds_rsv_hist_out.setColumn(intRow,"POINT_REASON",ds_if_trnpt_record.getColumn(i,"TR_OCUR_RSN_CD"));
			ds_rsv_hist_out.setColumn(intRow,"POINT_REASON_NAME",ds_if_trnpt_record.getColumn(i,"TR_OCUR_RSN_NM"));
			ds_rsv_hist_out.setColumn(intRow,"POINT_REASON_CNTT",ds_if_trnpt_record.getColumn(i,"TR_OCUR_RSN_CNTT"));			
			ds_rsv_hist_out.setColumn(intRow,"FRCH_CD",ds_if_trnpt_record.getColumn(i,"FRCH_CD"));
			ds_rsv_hist_out.setColumn(intRow,"FRCH_NM",ds_if_trnpt_record.getColumn(i,"FRCH_NM"));
			ds_rsv_hist_out.setColumn(intRow,"PROD_CD",ds_if_trnpt_record.getColumn(i,"PROD_CD"));
			ds_rsv_hist_out.setColumn(intRow,"PROD_CD_NM",ds_if_trnpt_record.getColumn(i,"PROD_CD_NM"));
			ds_rsv_hist_out.setColumn(intRow,"AMT",ds_if_trnpt_record.getColumn(i,"AMT"));
			ds_rsv_hist_out.setColumn(intRow,"UPRC",ds_if_trnpt_record.getColumn(i,"UPRC"));
			ds_rsv_hist_out.setColumn(intRow,"QTY",ds_if_trnpt_record.getColumn(i,"QTY"));
			ds_rsv_hist_out.setColumn(intRow,"BAL_PT",ds_if_trnpt_record.getColumn(i,"BAL_PT"));
			ds_rsv_hist_out.setColumn(intRow,"USBL_PT",ds_if_trnpt_record.getColumn(i,"USBL_PT"));
			ds_rsv_hist_out.setColumn(intRow,"VANISH_INTEND_DATE","");
			ds_rsv_hist_out.setColumn(intRow,"PAYM_TP_CD",ds_if_trnpt_record.getColumn(i,"PAYM_TP_CD"));
			ds_rsv_hist_out.setColumn(intRow,"PAYM_TP_NM",ds_if_trnpt_record.getColumn(i,"PAYM_TP_NM"));
			//적립기준 - 3L/5L/7L
			ds_rsv_hist_out.setColumn(intRow,"APPL_PT",ds_if_trnpt_record.getColumn(i,"APPL_PT"));
			//고객단계 - 정회원A, 정회원B, 준회원, 미등록카드 
			ds_rsv_hist_out.setColumn(intRow,"RSV_STD_CD",ds_if_trnpt_record.getColumn(i,"RSV_STD_CD"));
			ds_rsv_hist_out.setColumn(intRow,"RSV_STD_CD_NM",ds_if_trnpt_record.getColumn(i,"RSV_STD_CD_NM"));
			//적립유형 - 모바일/플레이트 카드/ 미등록
			ds_rsv_hist_out.setColumn(intRow,"CRD_MDA_CD",ds_if_trnpt_record.getColumn(i,"CRD_MDA_CD"));
			ds_rsv_hist_out.setColumn(intRow,"CRD_MDA_CD_NM",ds_if_trnpt_record.getColumn(i,"CRD_MDA_CD_NM"));
			
			ds_rsv_hist_out.setColumn(intRow,"DETAIL_TYPE","");
			ds_rsv_hist_out.setColumn(intRow,"DETAIL_TYPE_NAME","");
			if(	ds_if_trnpt_record.getColumn(i,"RSV_USE_DIV_CD")=="02" || ds_if_trnpt_record.getColumn(i,"RSV_USE_DIV_CD")=="04"){
				ds_rsv_hist_out.setColumn(intRow,"CNCL_YN","Y");
			}else{
				ds_rsv_hist_out.setColumn(intRow,"CNCL_YN","N");				
			}
			ds_rsv_hist_out.setColumn(intRow,"FRNCHSE_DIV_CD","");
			ds_rsv_hist_out.setColumn(intRow,"FRNCHSE_DIV_CD_NM","");	
		}
		// 조건필터링
		fn_setFltTrn();
	}else if(strSvcId == "IF_CSC_ITRT_133"){		// 그룹포인트조회
		
			
		for(i=0;i<ds_if_grppt_record.rowcount;i++)
		{                 
			var intRow = ds_rsv_hist_out.addRow();
			/*
			trace("=======================================================================");
			trace("기존 처리일시                                 ===>"+ ds_if_grppt_record.getColumn(i,"SUB_CO_TRANS_DATE")+ds_if_grppt_record.getColumn(i,"SUB_CO_TRANS_TIME"));
			trace("1>승인일자/자사_승인_일자(SUB_CO_APPRV_DATE) ===>"+ds_if_grppt_record.getColumn(i,"SUB_CO_APPRV_DATE"));
			trace("2>승인일시<APPRV_DATE_TIME>                    ===>"+ds_if_grppt_record.getColumn(i,"APPRV_DATE_TIME"));
			trace("3>매출일자<SUB_CO_TRANS_DATE>                  ===>"+ds_if_grppt_record.getColumn(i,"SUB_CO_TRANS_DATE")); 
			trace("4>입력_일시<INPUT_DATE_TIME>                   ===>"+ds_if_grppt_record.getColumn(i,"INPUT_DATE_TIME"));
			trace("5>승인_일시<APPRV_DATE>                        ===>"+ds_if_grppt_record.getColumn(i,"APPRV_DATE"));
			trace("5>승인일자/자사_승인_일자<SUB_CO_APPRV_DATE> ===>"+ds_if_grppt_record.getColumn(i,"SUB_CO_APPRV_DATE"));
			trace("6>포인트 소멸일자 <VANISH_INTEND_DATE>        ===>"+ ds_if_grppt_record.getColumn(i,"VANISH_INTEND_DATE").replace("/",""));
			trace("=======================================================================");
			*/
			ds_rsv_hist_out.setColumn(intRow,"SUB_CO_APPRV_DATE",ds_if_grppt_record.getColumn(i,"SUB_CO_APPRV_DATE"));
			ds_rsv_hist_out.setColumn(intRow,"SALE_DTIME_UI",ds_if_grppt_record.getColumn(i,"SUB_CO_TRANS_DATE")+ds_if_grppt_record.getColumn(i,"SUB_CO_TRANS_TIME"));			
			ds_rsv_hist_out.setColumn(intRow,"CRD_NO",ds_if_grppt_record.getColumn(i,"CARD_NO"));
			ds_rsv_hist_out.setColumn(intRow,"CHNL_DIV",ds_if_grppt_record.getColumn(i,"CHNL_SUB_CO_CODE"));
			ds_rsv_hist_out.setColumn(intRow,"CHNL_DIV_NM",ds_if_grppt_record.getColumn(i,"CHNL_SUB_CO_CODE_NAME"));
			ds_rsv_hist_out.setColumn(intRow,"RSV_USE_DIV",ds_if_grppt_record.getColumn(i,"SLIP_DIV_CODE"));
			ds_rsv_hist_out.setColumn(intRow,"RSV_USE_DIV_NM",ds_if_grppt_record.getColumn(i,"SLIP_DIV_CODE_NAME"));
			ds_rsv_hist_out.setColumn(intRow,"POINT_REASON",ds_if_grppt_record.getColumn(i,"TRANS_RSN_CODE"));
			ds_rsv_hist_out.setColumn(intRow,"POINT_REASON_NAME",ds_if_grppt_record.getColumn(i,"TRANS_RSN_CODE_NAME"));
			ds_rsv_hist_out.setColumn(intRow,"POINT_REASON_CNTT",ds_if_grppt_record.getColumn(i,"REMARK"));			
			ds_rsv_hist_out.setColumn(intRow,"FRCH_CD",ds_if_grppt_record.getColumn(i,"SUB_CO_FRNCHSE_CODE"));
			ds_rsv_hist_out.setColumn(intRow,"FRCH_NM",ds_if_grppt_record.getColumn(i,"SUB_CO_FRNCHSE_CODE_NAME"));
			ds_rsv_hist_out.setColumn(intRow,"PROD_CD",ds_if_grppt_record.getColumn(i,"PROD_CODE"));
			ds_rsv_hist_out.setColumn(intRow,"PROD_CD_NM",ds_if_grppt_record.getColumn(i,"PROD_CODE_NAME"));
			ds_rsv_hist_out.setColumn(intRow,"AMT",ds_if_grppt_record.getColumn(i,"SALE_AMT"));
			ds_rsv_hist_out.setColumn(intRow,"UPRC",ds_if_grppt_record.getColumn(i,"UNITPRC"));
			ds_rsv_hist_out.setColumn(intRow,"QTY",ds_if_grppt_record.getColumn(i,"CNT"));
			ds_rsv_hist_out.setColumn(intRow,"BAL_PT",ds_if_grppt_record.getColumn(i,"OCCUR_PT"));
			ds_rsv_hist_out.setColumn(intRow,"USBL_PT","");
			ds_rsv_hist_out.setColumn(intRow,"VANISH_INTEND_DATE",ds_if_grppt_record.getColumn(i,"VANISH_INTEND_DATE").replace("/",""));
			ds_rsv_hist_out.setColumn(intRow,"PAYM_TP_CD",ds_if_grppt_record.getColumn(i,"PYMT_PATTERN_CODE"));
			ds_rsv_hist_out.setColumn(intRow,"PAYM_TP_NM",ds_if_grppt_record.getColumn(i,"PYMT_PATTERN_CODE_NAME"));
			//적립기준 - 3L/5L/7L
			ds_rsv_hist_out.setColumn(intRow,"APPL_PT",ds_if_grppt_record.getColumn(i,"APPL_PT"));
			//고객단계 - 정회원A, 정회원B, 준회원, 미등록카드 
			ds_rsv_hist_out.setColumn(intRow,"RSV_STD_CD",ds_if_grppt_record.getColumn(i,"RSV_STD_CD"));
			ds_rsv_hist_out.setColumn(intRow,"RSV_STD_CD_NM",ds_if_grppt_record.getColumn(i,"RSV_STD_CD_NM"));
			//적립유형 - 모바일/플레이트 카드/ 미등록
			ds_rsv_hist_out.setColumn(intRow,"CRD_MDA_CD",ds_if_grppt_record.getColumn(i,"CARD_MEDIA_DIV_CODE"));
			ds_rsv_hist_out.setColumn(intRow,"CRD_MDA_CD_NM",ds_if_grppt_record.getColumn(i,"CARD_MEDIA_DIV_CODE_NAME"));
			
			ds_rsv_hist_out.setColumn(intRow,"DETAIL_TYPE","");
			ds_rsv_hist_out.setColumn(intRow,"DETAIL_TYPE_NAME","");
			if(ds_if_grppt_record.getColumn(i,"SLIP_DIV_CODE")=="02" || ds_if_grppt_record.getColumn(i,"SLIP_DIV_CODE")=="04" || ds_if_grppt_record.getColumn(i,"CANCEL_DIV_CODE")=="02"){
				ds_rsv_hist_out.setColumn(intRow,"CNCL_YN","Y");
			}else{
				ds_rsv_hist_out.setColumn(intRow,"CNCL_YN","N");
			}
			ds_rsv_hist_out.setColumn(intRow,"FRNCHSE_DIV_CD",ds_if_grppt_record.getColumn(i,"FRNCHSE_DIV_CODE"));
			ds_rsv_hist_out.setColumn(intRow,"FRNCHSE_DIV_CD_NM",ds_if_grppt_record.getColumn(i,"FRNCHSE_DIV_CODE_NAME"));	
		}
		// 조건 필터링
		fn_setFltGrp();
	}
}

// BW 캡티브, BW 로열티 항목 세팅
function fn_setBwHistDs(strSvcId)
{	
	if(ds_srch_cond.getColumn(0,"MORE_YN") != "Y" && ds_srch_cond.getColumn(0,"EXCEL_YN") != "Y"){
		ds_rsv_hist_out.clearData();
	}
	
	if(strSvcId == "IF_CSC_BW_002"){				// BW 캡티브
		var intTotCnt = parseInt(ds_if_bwcnt_cptv_header.getColumn(0,"OT_LISTCOUNT"));
		var intTotPage = Math.ceil(intTotCnt / 100);
		
		
		//trace("BW==========>"+ds_if_bwlist_cptv_record.saveXML());
		
		for(i=0;i<ds_if_bwlist_cptv_record.rowcount;i++)
		{                 
			var intRow = ds_bw_page_list.addRow();
			ds_bw_page_list.setColumn(intRow,"SALE_DTIME_UI",ds_if_bwlist_cptv_record.getColumn(i,"PROC_DATE"));
			ds_bw_page_list.setColumn(intRow,"CRD_NO",ds_if_bwlist_cptv_record.getColumn(i,"CARD_NO"));
			ds_bw_page_list.setColumn(intRow,"CHNL_DIV",ds_if_bwlist_cptv_record.getColumn(i,"CHANNEL_CLASS"));
			ds_bw_page_list.setColumn(intRow,"CHNL_DIV_NM",ds_if_bwlist_cptv_record.getColumn(i,"CHANNEL_CLASS_NAME"));	
			//20200708 캡티브도 수정 한다고 해서 수정 함.
			ds_bw_page_list.setColumn(intRow,"RSV_USE_DIV",ds_if_bwlist_cptv_record.getColumn(i,"RSV_USE_DIV_CD"));
			ds_bw_page_list.setColumn(intRow,"RSV_USE_DIV_NM",ds_if_bwlist_cptv_record.getColumn(i,"RSV_USE_DIV_NM"));
			ds_bw_page_list.setColumn(intRow,"POINT_REASON",ds_if_bwlist_cptv_record.getColumn(i,"POINT_REASON_CODE"));
			ds_bw_page_list.setColumn(intRow,"POINT_REASON_NAME",ds_if_bwlist_cptv_record.getColumn(i,"POINT_REASON_NAME"));
			ds_bw_page_list.setColumn(intRow,"POINT_REASON_CNTT","");			
			ds_bw_page_list.setColumn(intRow,"FRCH_CD",ds_if_bwlist_cptv_record.getColumn(i,"SS_CODE"));
			ds_bw_page_list.setColumn(intRow,"FRCH_NM",ds_if_bwlist_cptv_record.getColumn(i,"SS_NAME"));
			ds_bw_page_list.setColumn(intRow,"PROD_CD",ds_if_bwlist_cptv_record.getColumn(i,"PROD_CODE"));
			ds_bw_page_list.setColumn(intRow,"PROD_CD_NM",ds_if_bwlist_cptv_record.getColumn(i,"PROD_NAME"));
			ds_bw_page_list.setColumn(intRow,"AMT",ds_if_bwlist_cptv_record.getColumn(i,"PROD_AMT"));
			ds_bw_page_list.setColumn(intRow,"UPRC",ds_if_bwlist_cptv_record.getColumn(i,"UNIT_PRICE"));
			ds_bw_page_list.setColumn(intRow,"QTY",ds_if_bwlist_cptv_record.getColumn(i,"PROD_QTY"));
			ds_bw_page_list.setColumn(intRow,"BAL_PT",ds_if_bwlist_cptv_record.getColumn(i,"TOT_POINT"));
			ds_bw_page_list.setColumn(intRow,"USBL_PT","");
			ds_bw_page_list.setColumn(intRow,"VANISH_INTEND_DATE","");
			ds_bw_page_list.setColumn(intRow,"PAYM_TP_CD",ds_if_bwlist_cptv_record.getColumn(i,"PAY_METHOD_CODE"));
			ds_bw_page_list.setColumn(intRow,"PAYM_TP_NM",ds_if_bwlist_cptv_record.getColumn(i,"PAY_METHOD_NAME"));
			ds_bw_page_list.setColumn(intRow,"DETAIL_TYPE","");
			ds_bw_page_list.setColumn(intRow,"DETAIL_TYPE_NAME","");
			ds_bw_page_list.setColumn(intRow,"CNCL_YN","");
			ds_bw_page_list.setColumn(intRow,"FRNCHSE_DIV_CD","");
			ds_bw_page_list.setColumn(intRow,"FRNCHSE_DIV_CD_NM","");	
		}
		ds_rsv_hist_out.appendData(ds_bw_page_list);
		
		if(ds_srch_cond.getColumn(0,"EXCEL_YN") == "Y"){
			if(parseInt(ds_srch_cond.getColumn(0,"CUR_PAGE")) < intTotPage){
				ds_srch_cond.setColumn(0,"CUR_PAGE",(parseInt(ds_srch_cond.getColumn(0,"CUR_PAGE")) + 1).toString());
				fn_srchPastListInfo();				
			}else{
				// 조건 필터링		
				Btn_More.visible = false;				
				fn_setFltBw(strSvcId);
				
				
				var sPerTCd ; 
				var sPerTDt = "ICCS_CSC 구매 이력 다운로드(BW)";  // 수행업무 상세내용
				var sCalFun = "Btn_Excel_onclick()";  // 호출함수명 	
				var sInqCon = gfn_getStringFromDataset(ds_srch_cond); //조회 조건은 고객번호 
				var sInqCnt = ds_rsv_hist_out.rowcount;  // 조회건수		
				var sInCustNo = "CUST_ID="+objDsCust.getColumn(0,"IO_CUST_NO") ;
					
				var cnt = fn_exel_Doenhis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);	
				
				//상세사유가 없으면 다운로드 안됨.
				if(cnt < 1){
					return;
				}
				
				GridExportExcel(Grd_BuyHist, ExportObject00, "sheet1");				
			}
		}else{		
			if(parseInt(ds_srch_cond.getColumn(0,"CUR_PAGE")) < intTotPage){
				Btn_More.visible = true;
			}else{
				Btn_More.visible = false;		
			}
			// 조건 필터링		
			fn_setFltBw(strSvcId);
		}		
	}else if(strSvcId == "IF_CSC_BW_004"){
		var intTotCnt = parseInt(ds_if_bwcnt_intg_header.getColumn(0,"OT_LISTCOUNT"));
		var intTotPage = Math.ceil(intTotCnt / 100);
		
		
		//trace("111>>>>>>>>>>>>>>>>>"+ds_if_bwlist_intg_record.saveXML());
		
		
		for(i=0;i<ds_if_bwlist_intg_record.rowcount;i++)
		{                 
			var intRow = ds_bw_page_list.addRow();
			ds_bw_page_list.setColumn(intRow,"SALE_DTIME_UI",ds_if_bwlist_intg_record.getColumn(i,"PROC_DATE"));
			ds_bw_page_list.setColumn(intRow,"CRD_NO",ds_if_bwlist_intg_record.getColumn(i,"CARD_NO"));
			ds_bw_page_list.setColumn(intRow,"CHNL_DIV",ds_if_bwlist_intg_record.getColumn(i,"CHANNEL_CD"));
			ds_bw_page_list.setColumn(intRow,"CHNL_DIV_NM",ds_if_bwlist_intg_record.getColumn(i,"CHANNEL_NAME"));
			//적릭 구분 추가 20200609
			ds_bw_page_list.setColumn(intRow,"RSV_USE_DIV",ds_if_bwlist_intg_record.getColumn(i,"RSV_USE_DIV_CD"));
			ds_bw_page_list.setColumn(intRow,"RSV_USE_DIV_NM",ds_if_bwlist_intg_record.getColumn(i,"RSV_USE_DIV_NM"));
						
			ds_bw_page_list.setColumn(intRow,"POINT_REASON",ds_if_bwlist_intg_record.getColumn(i,"POINT_REASON_CODE"));
			ds_bw_page_list.setColumn(intRow,"POINT_REASON_NAME",ds_if_bwlist_intg_record.getColumn(i,"POINT_REASON_NAME"));
			ds_bw_page_list.setColumn(intRow,"POINT_REASON_CNTT","");			
			ds_bw_page_list.setColumn(intRow,"FRCH_CD",ds_if_bwlist_intg_record.getColumn(i,"SS_CODE"));
			ds_bw_page_list.setColumn(intRow,"FRCH_NM",ds_if_bwlist_intg_record.getColumn(i,"SS_NAME"));
			ds_bw_page_list.setColumn(intRow,"PROD_CD",ds_if_bwlist_intg_record.getColumn(i,"PROD_CODE"));
			ds_bw_page_list.setColumn(intRow,"PROD_CD_NM",ds_if_bwlist_intg_record.getColumn(i,"PROD_NAME"));
			ds_bw_page_list.setColumn(intRow,"AMT",ds_if_bwlist_intg_record.getColumn(i,"PROD_AMT"));
			ds_bw_page_list.setColumn(intRow,"UPRC",ds_if_bwlist_intg_record.getColumn(i,"UNIT_PRICE"));
			ds_bw_page_list.setColumn(intRow,"QTY",ds_if_bwlist_intg_record.getColumn(i,"PROD_QTY"));
			ds_bw_page_list.setColumn(intRow,"BAL_PT",ds_if_bwlist_intg_record.getColumn(i,"TOT_POINT"));
			ds_bw_page_list.setColumn(intRow,"USBL_PT","");
			ds_bw_page_list.setColumn(intRow,"VANISH_INTEND_DATE","");
			ds_bw_page_list.setColumn(intRow,"PAYM_TP_CD",ds_if_bwlist_intg_record.getColumn(i,"PAY_METHOD_CODE"));
			ds_bw_page_list.setColumn(intRow,"PAYM_TP_NM",ds_if_bwlist_intg_record.getColumn(i,"PAY_METHOD_NAME"));
			ds_bw_page_list.setColumn(intRow,"DETAIL_TYPE","");
			ds_bw_page_list.setColumn(intRow,"DETAIL_TYPE_NAME","");
			ds_bw_page_list.setColumn(intRow,"CNCL_YN","");
			ds_bw_page_list.setColumn(intRow,"FRNCHSE_DIV_CD","");
			ds_bw_page_list.setColumn(intRow,"FRNCHSE_DIV_CD_NM","");	
		}
		ds_rsv_hist_out.appendData(ds_bw_page_list);
		
		if(ds_srch_cond.getColumn(0,"EXCEL_YN") == "Y"){
			if(parseInt(ds_srch_cond.getColumn(0,"CUR_PAGE")) < intTotPage){
				ds_srch_cond.setColumn(0,"CUR_PAGE",(parseInt(ds_srch_cond.getColumn(0,"CUR_PAGE")) + 1).toString());
				fn_srchPastListInfo();				
			}else{
				// 조건 필터링		
				Btn_More.visible = false;				
				fn_setFltBw(strSvcId);
				
				var sPerTCd ; 
				var sPerTDt = "ICCS_CSC 구매 이력 다운로드(WB)";  // 수행업무 상세내용
				var sCalFun = "Btn_Excel_onclick()";  // 호출함수명 	
				var sInqCon = gfn_getStringFromDataset(ds_srch_cond); //조회 조건은 고객번호 
				var sInqCnt = ds_rsv_hist_out.rowcount;  // 조회건수		
				var sInCustNo = "CUST_ID="+objDsCust.getColumn(0,"IO_CUST_NO") ;
					
				var cnt = fn_exel_Doenhis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);	
				
				//상세사유가 없으면 다운로드 안됨.
				if(cnt < 1){
					return;
				}
				
				GridExportExcel(Grd_BuyHist, ExportObject00, "sheet1");												
			}
		}else{		
			if(parseInt(ds_srch_cond.getColumn(0,"CUR_PAGE")) < intTotPage){
				Btn_More.visible = true;
			}else{
				Btn_More.visible = false;		
			}
			// 조건 필터링		
			fn_setFltBw(strSvcId);
		}
	}
}

/********************************************************************************** 
 *****	구매이력 조건 필터링 및 합계 세팅
***********************************************************************************/

// 적립포인트조회 조건 필터링
function fn_setFltTrn()
{
	var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];
	var strProdDiv 	= getTrim(Cmb_UseOilKnd.value);
	var strChnlDiv	= getTrim(Cmb_Chnl.value);
	var strFltCond	= "";
	
	if(strProdDiv != ""){
		strFltCond = strFltCond + "PROD_CD == '" + strProdDiv + "' ";
	}
	if(strChnlDiv != ""){
		if(strFltCond == ""){
			strFltCond = strFltCond + "CHNL_DIV == '" + strChnlDiv + "'";			
		}else{
			strFltCond = strFltCond + "&& CHNL_DIV == '" + strChnlDiv + "'";		
		}
	}
		
	ds_rsv_hist_out.filter(strFltCond);
			
	//건수표시		
	objCntStt.text	= ds_rsv_hist_out.rowcount;
	// 처리일시로 정렬
	ds_rsv_hist_out.keystring = "S:-RREG_PBLC_DT";
	ds_rsv_hist_out.rowposition = 0;	
	fn_setTotValTrn();
}

// 그룹포인트조회 조건 필터링
function fn_setFltGrp()
{
	var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];
	var strRsvDiv	= getTrim(Cmb_SaveDiv.value);
//	var strProdDiv 	= getTrim(Cmb_UseOilKnd.value);
	var strFrchDiv	= getTrim(Cmb_Affil.value);
	var strFltCond	= "";
	
	if(strRsvDiv != ""){
		strFltCond = strFltCond + "RSV_USE_DIV == '" + strRsvDiv + "' ";
	}	
//	if(strProdDiv != ""){
//		strFltCond = strFltCond + "&& PROD_CD == '" + strProdDiv + "' ";
//	}
	if(strFrchDiv != ""){
		if(strFltCond == ""){
			strFltCond = strFltCond + "FRNCHSE_DIV_CD == '" + strFrchDiv + "'";			
		}else{	
			strFltCond = strFltCond + "&& FRNCHSE_DIV_CD == '" + strFrchDiv + "'";
		}
	}		
	//trace(">>>>>>>>>>>>>>>"+ds_rsv_hist_out.saveXML());	
	//trace(">>>>>>>>>>>>>>>"+strFltCond);	
	ds_rsv_hist_out.filter(strFltCond);	
			
	//건수표시	
	objCntStt.text	= ds_rsv_hist_out.rowcount;
	// 처리일시로 정렬
	ds_rsv_hist_out.keystring = "S:-RREG_PBLC_DT";
	ds_rsv_hist_out.rowposition = 0;	
	fn_setTotValGrp();
	
}

// BW 조회 조건 필터링
function fn_setFltBw(strSvcId)
{
	var objCntStt	= this.parent.parent.all["Stt_HistInfoCnt"];
	var strProdDiv 	= getTrim(Cmb_UseOilKnd.value);
	var strChnlDiv	= getTrim(Cmb_Chnl.value);
	var strFltCond	= "";
	//BW조회조건 필터링 추가 20200609 김순화D
	var strRsvDiv	= getTrim(Cmb_SaveDiv.value);
		
	if(strProdDiv != ""){
		strFltCond = strFltCond + "PROD_CD == '" + strProdDiv + "' ";
	}
	if(strChnlDiv != ""){
		if(strFltCond == ""){
			strFltCond = strFltCond + "CHNL_DIV == '" + strChnlDiv + "' ";		
		}else{
			strFltCond = strFltCond + "&& CHNL_DIV == '" + strChnlDiv + "' ";
		}
	}
	
	//BW조건 필터링 추가 20200609
	if(strRsvDiv != ""){
		strFltCond = strFltCond + "RSV_USE_DIV == '" + strRsvDiv + "' ";
	}		
	//trace("BW조회조건 추가>>>"+strFltCond);
	
	ds_rsv_hist_out.filter(strFltCond);	
	
	if(ds_rsv_hist_out.rowcount < 1){
		cf_Alert("COMI0006");		
	}else{
		// 처리일시로 정렬
		ds_rsv_hist_out.keystring = "S:-RREG_PBLC_DT";
		ds_rsv_hist_out.rowposition = 0;
	}
		
	//건수표시
	if(strSvcId == "IF_CSC_BW_002"){
		objCntStt.text	= ds_rsv_hist_out.rowcount + " /" + ds_if_bwcnt_cptv_header.getColumn(0,"OT_LISTCOUNT");
		fn_setTotValTrn();		
	}else if(strSvcId == "IF_CSC_BW_004"){
		objCntStt.text	= ds_rsv_hist_out.rowcount + " /" + ds_if_bwcnt_intg_header.getColumn(0,"OT_LISTCOUNT");
		fn_setTotValGrp();		
	}

}

// 캡티브 총주유금액, 총주유량, 총포인트 세팅
function fn_setTotValTrn()
{
	var intTotAmt	= 0;
	var intTotPoint	= 0;
	var dblTotQty	= 0;

	// 적립 채널이 01,08,09,61 일때 총주유금액, 총주유량 합산
	for(i=0; i<ds_rsv_hist_out.rowcount; i++)
	{
		var strChnlCls = ds_rsv_hist_out.getColumn(i,"CHNL_DIV");
		intTotPoint = intTotPoint + parseInt(ds_rsv_hist_out.getColumn(i,"BAL_PT"));
		if(strChnlCls == "01" || strChnlCls == "08" || strChnlCls == "09" || strChnlCls == "61"){
			intTotAmt = intTotAmt + parseInt(ds_rsv_hist_out.getColumn(i,"AMT"));
			dblTotQty = dblTotQty + parseFloat(ds_rsv_hist_out.getColumn(i,"QTY"));
		}		
	}	

	dblTotQty = Math.round(dblTotQty*100)/100.0;									// 총 주유량

	Msk_TotRflPay.value  = intTotAmt;												// 총주유금액
	Msk_TotRflAmnt.value = dblTotQty;												// 총주유량
	Msk_TotPt.value		 = intTotPoint;												// 총포인트
}


// 그룹 총주유금액, 총주유량, 총포인트 세팅
function fn_setTotValGrp()
{
	var intTotAmt	= 0;
	var intTotPoint	= 0;
	var dblTotQty	= 0;

	for(i=0; i<ds_rsv_hist_out.rowcount; i++)
	{
		intTotPoint = intTotPoint + parseInt(ds_rsv_hist_out.getColumn(i,"BAL_PT"));
		intTotAmt = intTotAmt + parseInt(ds_rsv_hist_out.getColumn(i,"AMT"));
		dblTotQty = dblTotQty + parseFloat(ds_rsv_hist_out.getColumn(i,"QTY"));
	}	

	dblTotQty = Math.round(dblTotQty*100)/100.0;									// 총 주유량

	Msk_TotRflPay.value  = intTotAmt;												// 총주유금액
	Msk_TotRflAmnt.value = dblTotQty;												// 총주유량
	Msk_TotPt.value		 = intTotPoint;												// 총포인트
}

/********************************************************************************** 
 *****	구매이력 업무버튼 
***********************************************************************************/
// 구매이력발송클릭
function Btn_SendSaveHist_onclick(obj:Button,  e:ClickEventInfo)
{
	var objDsCust = this.parent.parent.all["ds_cust_info"];
	var objCnslDs = this.parent.parent.all["Tab_CntctHistInfo"]["tabpage1"].all["ds_cnsl_seq_out"];	// 상담일련번호 DS
	var objFlgDs	= this.parent.parent.all["ds_srch_flg"];	
	var strCnslSeq =  "";
	
	if(getTrim(objFlgDs.getColumn(0,"FRCH_YN")) == "Y"){
		cf_Alert("BNSE0040","구매이력발송");	
		return;	
	}	
		
	if(ds_rsv_hist_out.rowcount < 1){
		cf_Alert("COME0013","구매이력");		
		return;
	}
	
	if(objCnslDs.rowcount > 0){
		strCnslSeq = objCnslDs.getColumn(0,"CNSL_SEQ_NO");
	}

	ds_get_param.clearData();
	ds_set_param.clearData();
	ds_get_param_list.clearData();
	
	// * Column 삭제를 위해 ds_get_param_list의 updatecontrol 속성을 false로 변경.
	ds_get_param_list.copyData(ds_rsv_hist_out,false);
	ds_get_param_list.deleteColumn("CHK");
	ds_get_param_list.deleteColumn("CHNL_DIV");
	ds_get_param_list.deleteColumn("RSV_USE_DIV");
	ds_get_param_list.deleteColumn("POINT_REASON");
	ds_get_param_list.deleteColumn("POINT_REASON_NAME");
	ds_get_param_list.deleteColumn("POINT_REASON_CNTT");	
	ds_get_param_list.deleteColumn("FRCH");
	ds_get_param_list.deleteColumn("FRCH_CD");
	ds_get_param_list.deleteColumn("PROD_CD");
	ds_get_param_list.deleteColumn("USBL_PT");
	ds_get_param_list.deleteColumn("VANISH_INTEND_DATE");
	ds_get_param_list.deleteColumn("PAYM_TP_CD");
	ds_get_param_list.deleteColumn("DETAIL_TYPE");
	ds_get_param_list.deleteColumn("DETAIL_TYPE_NAME");
	ds_get_param_list.deleteColumn("CNCL_YN");
	ds_get_param_list.deleteColumn("FRNCHSE_DIV_CD");
	ds_get_param_list.deleteColumn("FRNCHSE_DIV_CD_NM");		
		
	fn_setListDsMask();
	
	
	//trace("ds_get_param_list===>"+ds_get_param_list.saveXML());
	
	
	var strTailRsBzNo = "";
	for(i=0; i<getTrim(objDsCust.getColumn(0,"OT_TAIL_RS_BZ_NO")).length; i++)
	{
		strTailRsBzNo = strTailRsBzNo + "*";
	}
		
	var strRsBzNo = getTrim(objDsCust.getColumn(0,"OT_HEAD_RS_BZ_NO")) + "-" + strTailRsBzNo; 	
	
	fun_ds_srch(ds_get_param, "RS_BZ_NO", strRsBzNo);	
	fun_ds_srch(ds_get_param, "CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
	fun_ds_srch(ds_get_param, "CUST_NM", getTrim(objDsCust.getColumn(0,"OT_CUST_NM")));	
	fun_ds_srch(ds_get_param, "EML_ADDR", getTrim(objDsCust.getColumn(0,"OT_EML_ADDR")));
	fun_ds_srch(ds_get_param, "FAX_PHONE_NO", getTrim(objDsCust.getColumn(0,"OT_FAX_PHONE_NO")));
	fun_ds_srch(ds_get_param, "TOT_PT", getTrim(objDsCust.getColumn(0,"OT_TOT_PT")));	
	fun_ds_srch(ds_get_param, "CNSL_SEQ_NO", strCnslSeq);

								
	var arrParam = {getDsArgument:ds_get_param, getDsArgumentList:ds_get_param_list, setDsArgument:ds_set_param};

	PopupDialog("BNS460","BNS::BNS460.xfdl", -1, -1, 800, 425, false, -1, arrParam, false, false, true, false);		
	
}

// 고객에게 전송할 내용(처리일시, 카드번호 등을 마스킹 처리한다.)
function fn_setListDsMask()
{
	for(i=0;i<ds_get_param_list.rowcount;i++)
	{		
		
		ds_get_param_list.setColumn(i,"SALE_DTIME_UI",
		ds_get_param_list.getColumn(i,"SALE_DTIME_UI").substr(0,4)+"-"+
		ds_get_param_list.getColumn(i,"SALE_DTIME_UI").substr(4,2)+"-"+
		ds_get_param_list.getColumn(i,"SALE_DTIME_UI").substr(6,2)+" "+
		ds_get_param_list.getColumn(i,"SALE_DTIME_UI").substr(8,2)+":"+
		ds_get_param_list.getColumn(i,"SALE_DTIME_UI").substr(10,2)+":"+
		ds_get_param_list.getColumn(i,"SALE_DTIME_UI").substr(12,2));	
		
		ds_get_param_list.setColumn(i,"CRD_NO",
		ds_get_param_list.getColumn(i,"CRD_NO").substr(0,4)+"-"+
		ds_get_param_list.getColumn(i,"CRD_NO").substr(4,4)+"-"+
		ds_get_param_list.getColumn(i,"CRD_NO").substr(8,4)+"-"+
		ds_get_param_list.getColumn(i,"CRD_NO").substr(12,4));	
		
		//alert(ds_get_param_list.getColumn(i,"SALE_DTIME_UI"));
		//ds_get_param_list.setColumn(i,"SALE_DTIME_UI",Grd_BuyHist.getCellText(i,2));
		//ds_get_param_list.setColumn(i,"CRD_NO",Grd_BuyHist.getCellText(i,3));	
	}	
}

// 카드바뀜클릭
function Btn_CrdChange_onclick(obj:Button,  e:ClickEventInfo)
{
	var objDsCust = this.parent.parent.all["ds_cust_info"];
	var objFlgDs	= this.parent.parent.all["ds_srch_flg"];	
/*		
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");		
		return;
	}
*/
	
	if(getTrim(objFlgDs.getColumn(0,"FRCH_YN")) == "Y"){
		cf_Alert("BNSE0040","카드바뀜 업무처리");	
		return;	
	}	

	ds_get_param.clearData();
	ds_set_param.clearData();

	fun_ds_srch(ds_get_param, "HEAD_RS_BZ_NO", getTrim(objDsCust.getColumn(0,"OT_HEAD_RS_BZ_NO")));
	fun_ds_srch(ds_get_param, "TAIL_RS_BZ_NO", getTrim(objDsCust.getColumn(0,"OT_TAIL_RS_BZ_NO")));
	fun_ds_srch(ds_get_param, "CUST_NM", getTrim(objDsCust.getColumn(0,"OT_CUST_NM")));			
	fun_ds_srch(ds_get_param, "CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
	fun_ds_srch(ds_get_param, "GRP_AGR_YN", getTrim(objDsCust.getColumn(0,"OT_GRP_AGR_YN")));
	fun_ds_srch(ds_get_param, "INTG_CUST_NO", getTrim(objDsCust.getColumn(0,"OT_INTG_CUST_NO")));		
								
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

//	PopupDialog("BNS420","BNS::BNS420.xfdl", -1, -1, 1372, 729, false, -1, arrParam, false, false, true, false);
	this.parent.parent.parent.mdiOpen("BNS420","BNS::BNS420.xfdl","카드바뀜", 393, 23, 1115, 553, false, "absolute", arrParam, true, false, true, false);
}

// 포인트조정클릭
function Btn_ModPt_onclick(obj:Button,  e:ClickEventInfo)
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var objFlgDs	= this.parent.parent.all["ds_srch_flg"];		
		
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");		
		return;
	}
	
	if(getTrim(objFlgDs.getColumn(0,"FRCH_YN")) == "Y"){
		cf_Alert("BNSE0040","포인트조정");	
		return;	
	}
/*		
	if(ds_rsv_hist_out.rowcount < 1){
		cf_Alert("COME0013","구매이력");		
		return;
	}	
*/	

	ds_get_param.clearData();
	ds_set_param.clearData();
	
	fun_ds_srch(ds_get_param, "RS_BZ_NO", getTrim(objDsCust.getColumn(0,"OT_RS_BZ_NO").replace("-","")));
	fun_ds_srch(ds_get_param, "CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));	
								
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

//	PopupDialog("BNS430","BNS::BNS430.xfdl", -1, -1, 1000, 681, false, -1, arrParam, false, false, true, false);
	this.parent.parent.parent.mdiOpen("BNS430","BNS::BNS430.xfdl","포인트조정", 393, 23, 1000, 631, false, "absolute", arrParam, true, false, true, false);
}

// 한도조정클릭
function Btn_ModLimt_onclick(obj:Button,  e:ClickEventInfo)
{
	var objFlgDs	= this.parent.parent.all["ds_srch_flg"];
	var objDsCust = this.parent.parent.all["ds_cust_info"];	
	
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");		
		return;
	}
			
	if(getTrim(objFlgDs.getColumn(0,"FRCH_YN")) == "Y"){
		cf_Alert("BNSE0040","한도조정");	
		return;	
	}	
/*		
	if(ds_rsv_hist_out.rowcount < 1){
		cf_Alert("COME0013","구매이력");		
		return;
	}
*/	
				
	if(strSelMaxQtyYn == "N"){
		var strBfToDt3 = AddDate(getToday(),-parseInt(getToday().substr(6,2)));
		var strBfToDt2 = AddDate(strBfToDt3,-parseInt(strBfToDt3.substr(6,2)));
		var strBfToDt1 = AddDate(strBfToDt2,-parseInt(strBfToDt2.substr(6,2)));	
		var strBfFrmDt3 = strBfToDt3.substr(0,6) + "01";
		var strBfFrmDt2 = strBfToDt2.substr(0,6) + "01";
		var strBfFrmDt1 = strBfToDt1.substr(0,6) + "01";
		
		ds_call_back.clearData();		
		fn_srchBefHist1(strBfFrmDt1,strBfToDt1);
		fn_srchBefHist2(strBfFrmDt2,strBfToDt2);
		fn_srchBefHist3(strBfFrmDt3,strBfToDt3);	
	}else{
		fn_openModLimt();
	}
}

// 한도조정 이전 3개월 총 주유량을 위한 IN DS 세팅
function fn_setBefHistInDs(objParaEnvDs, objParaDataDs, strFromDt, strToDt)
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var objDsCrd	= this.parent.parent.all["Tab_CrdInfo"]["tabpage2"].all["ds_crd_info"];
	var objEnvDs 	= "";
	var objDataDs 	= "";
	
	if (typeof objParaEnvDs == "string"){
		ObjEnvDs= (function(){eval(objParaEnvDs);}());
	}else{
		ObjEnvDs = objParaEnvDs;
	}
	
	if (typeof objParaDataDs == "string"){
		objDataDs= (function(){eval(objParaDataDs);}());
	}else{
		objDataDs = objParaDataDs;
	}
	
	// DS 세팅
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// 통합회원(그룹포인트조회)
		// ENV DS
		fun_ds_srch(ObjEnvDs, "IF_KIND","WAS");
		fun_ds_srch(ObjEnvDs, "REQ_SERVICE_METHOD","ptGrpptSelC01.do");
		fun_ds_srch(ObjEnvDs, "REQ_SERVICE_ID","");	
		fun_ds_srch(ObjEnvDs, "RES_HEADER_SECTION","STP_PT_GRPPT_SEL_C01_Rsp");
		fun_ds_srch(ObjEnvDs, "RES_COLUMN_SECTION","");
		fun_ds_srch(ObjEnvDs, "RES_RECORD_SECTION","OT_OUT_CURSOR");
		// DATA DS		
		fun_ds_srch(objDataDs,"req_chnl_code","610050");
		fun_ds_srch(objDataDs,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(objDataDs,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(objDataDs,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		fun_ds_srch(objDataDs,"in_cust_no",objDsCust.getColumn(0,"IO_CUST_NO"));			
		fun_ds_srch(objDataDs,"in_card_no","");												
		fun_ds_srch(objDataDs, "in_from_date",strFromDt);
		fun_ds_srch(objDataDs, "in_to_date",strToDt);
		fun_ds_srch(objDataDs, "in_page_no","0");
		fun_ds_srch(objDataDs, "in_page_size","0");
	}else{													// 기존회원(적립포인트조회)
		fun_ds_srch(ObjEnvDs, "IF_KIND","WAS");
		fun_ds_srch(ObjEnvDs, "REQ_SERVICE_METHOD","ptTrnptSelC08.do");
		fun_ds_srch(ObjEnvDs, "REQ_SERVICE_ID","");	
		fun_ds_srch(ObjEnvDs, "RES_HEADER_SECTION","STP_PT_TRNPT_SEL_C08_Rsp");
		fun_ds_srch(ObjEnvDs, "RES_COLUMN_SECTION","");
		fun_ds_srch(ObjEnvDs, "RES_RECORD_SECTION","OT_OUT_CURSOR");
					
		fun_ds_srch(objDataDs,"req_chnl_code","610050");
		fun_ds_srch(objDataDs,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(objDataDs,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(objDataDs,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		fun_ds_srch(objDataDs, "in_search_key","1");
		fun_ds_srch(objDataDs, "in_cust_no",getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
		fun_ds_srch(objDataDs, "in_crd_no","");					
		fun_ds_srch(objDataDs, "in_strt_dt",strFromDt);
		fun_ds_srch(objDataDs, "in_end_dt",strToDt);
		fun_ds_srch(objDataDs, "in_rsv_use_div_cd","");				// 적립사용구분
		fun_ds_srch(objDataDs, "in_frch_div_cd","");				// 가맹점구분							
	}	
}


function fn_srchBefHist1(strFrmDt, strToDt)
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
	ds_if_bef_hist1_env.clearData();
	ds_if_bef_hist1_data.clear();
	ds_if_bef_hist1_common.clearData();
	ds_if_bef_hist1_header.clear();
	ds_if_bef_hist1_record.clear();
	
	fn_setBefHistInDs(ds_if_bef_hist1_env,ds_if_bef_hist1_data,strFrmDt,strToDt);
	
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// 통합회원(그룹포인트조회)		
		// 그룹포인트
		var	strSvcID = "IF_CSC_ITRT_133_BEF1";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bef_hist1_env:a INTERFACE_DATA=ds_if_bef_hist1_data:a";
		var	strOutDatasets = "ds_if_bef_hist1_common=DS_COMMON ds_if_bef_hist1_header=DS_HEADER ds_if_bef_hist1_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
	
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	}else{
	// 적립포인트
		var	strSvcID = "IF_CSC_ITRT_081_BEF1";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bef_hist1_env:a INTERFACE_DATA=ds_if_bef_hist1_data:a";
		var	strOutDatasets = "ds_if_bef_hist1_common=DS_COMMON ds_if_bef_hist1_header=DS_HEADER ds_if_bef_hist1_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	}
}

function fn_srchBefHist2(strFrmDt,strToDt)
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
	ds_if_bef_hist2_env.clearData();
	ds_if_bef_hist2_data.clear();
	ds_if_bef_hist2_common.clearData();
	ds_if_bef_hist2_header.clear();
	ds_if_bef_hist2_record.clear();
	
	fn_setBefHistInDs(ds_if_bef_hist2_env,ds_if_bef_hist2_data,strFrmDt,strToDt);
	
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// 통합회원(그룹포인트조회)		
		// 그룹포인트
		var	strSvcID = "IF_CSC_ITRT_133_BEF2";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bef_hist2_env:a INTERFACE_DATA=ds_if_bef_hist2_data:a";
		var	strOutDatasets = "ds_if_bef_hist2_common=DS_COMMON ds_if_bef_hist2_header=DS_HEADER ds_if_bef_hist2_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
	
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	}else{
	// 적립포인트
		var	strSvcID = "IF_CSC_ITRT_081_BEF2";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bef_hist2_env:a INTERFACE_DATA=ds_if_bef_hist2_data:a";
		var	strOutDatasets = "ds_if_bef_hist2_common=DS_COMMON ds_if_bef_hist2_header=DS_HEADER ds_if_bef_hist2_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	}
}

function fn_srchBefHist3(strFrmDt,strToDt)
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
	ds_if_bef_hist3_env.clearData();
	ds_if_bef_hist3_data.clear();
	ds_if_bef_hist3_common.clearData();
	ds_if_bef_hist3_header.clear();
	ds_if_bef_hist3_record.clear();
	
	fn_setBefHistInDs(ds_if_bef_hist3_env,ds_if_bef_hist3_data,strFrmDt,strToDt);
	
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// 통합회원(그룹포인트조회)	
		// 그룹포인트
		var	strSvcID = "IF_CSC_ITRT_133_BEF3";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bef_hist3_env:a INTERFACE_DATA=ds_if_bef_hist3_data:a";
		var	strOutDatasets = "ds_if_bef_hist3_common=DS_COMMON ds_if_bef_hist3_header=DS_HEADER ds_if_bef_hist3_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
	
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	}else{
	// 적립포인트
		var	strSvcID = "IF_CSC_ITRT_081_BEF3";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_bef_hist3_env:a INTERFACE_DATA=ds_if_bef_hist3_data:a";
		var	strOutDatasets = "ds_if_bef_hist3_common=DS_COMMON ds_if_bef_hist3_header=DS_HEADER ds_if_bef_hist3_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	}
}

function fn_setBefTotQty1()
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var dblTotQty	= 0;	
		
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// 통합회원(그룹포인트조회)
		for(i=0;i<ds_if_bef_hist1_record.rowcount;i++)
		{
			var strChnlCls 	= ds_if_bef_hist1_record.getColumn(i,"CHNL_SUB_CO_CODE");
			var strUseDiv	= ds_if_bef_hist1_record.getColumn(i,"SLIP_DIV_CODE");
					
			if(strUseDiv == "01" || strUseDiv == "02" || strUseDiv == "03" || strUseDiv == "04" || strUseDiv == "06"){
//				if(strChnlCls == "01" || strChnlCls == "08" || strChnlCls == "09" || strChnlCls == "61"){
					dblTotQty = dblTotQty + parseFloat(ds_if_bef_hist1_record.getColumn(i,"CNT"));
//				}
			}
		}
	}else{
		for(i=0;i<ds_if_bef_hist1_record.rowcount;i++)
		{
			var strChnlCls 	= ds_if_bef_hist1_record.getColumn(i,"CHNL_DIV_CD");
			var strUseDiv	= ds_if_bef_hist1_record.getColumn(i,"RSV_USE_DIV_CD");
					
			if(strUseDiv == "01" || strUseDiv == "02" || strUseDiv == "03" || strUseDiv == "04" || strUseDiv == "06"){
//				if(strChnlCls == "01" || strChnlCls == "08" || strChnlCls == "09" || strChnlCls == "61"){
					dblTotQty = dblTotQty + parseFloat(ds_if_bef_hist1_record.getColumn(i,"QTY"));
//				}
			}
		}			
	}
	
	dblTotQty = Math.round(dblTotQty);									// 총 주유량
	Msk_BefTotAmt1.value = dblTotQty;
	fn_setBefTotQty2();		
}

function fn_setBefTotQty2()
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var dblTotQty	= 0;	
		
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// 통합회원(그룹포인트조회)
		for(i=0;i<ds_if_bef_hist2_record.rowcount;i++)
		{
			var strChnlCls 	= ds_if_bef_hist2_record.getColumn(i,"CHNL_SUB_CO_CODE");
			var strUseDiv	= ds_if_bef_hist2_record.getColumn(i,"SLIP_DIV_CODE");
					
			if(strUseDiv == "01" || strUseDiv == "02" || strUseDiv == "03" || strUseDiv == "04" || strUseDiv == "06"){
//				if(strChnlCls == "01" || strChnlCls == "08" || strChnlCls == "09" || strChnlCls == "61"){
					dblTotQty = dblTotQty + parseFloat(ds_if_bef_hist2_record.getColumn(i,"CNT"));
//				}
			}
		}
	}else{
		for(i=0;i<ds_if_bef_hist2_record.rowcount;i++)
		{
			var strChnlCls 	= ds_if_bef_hist2_record.getColumn(i,"CHNL_DIV_CD");
			var strUseDiv	= ds_if_bef_hist2_record.getColumn(i,"RSV_USE_DIV_CD");
					
			if(strUseDiv == "01" || strUseDiv == "02" || strUseDiv == "03" || strUseDiv == "04" || strUseDiv == "06"){
//				if(strChnlCls == "01" || strChnlCls == "08" || strChnlCls == "09" || strChnlCls == "61"){
					dblTotQty = dblTotQty + parseFloat(ds_if_bef_hist2_record.getColumn(i,"QTY"));
//				}
			}
		}			
	}
	
	dblTotQty = Math.round(dblTotQty);									// 총 주유량
	Msk_BefTotAmt2.value = dblTotQty;
	fn_setBefTotQty3();		
}

function fn_setBefTotQty3()
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	var dblTotQty	= 0;	
		
	if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){		// 통합회원(그룹포인트조회)
		for(i=0;i<ds_if_bef_hist3_record.rowcount;i++)
		{
			var strChnlCls 	= ds_if_bef_hist3_record.getColumn(i,"CHNL_SUB_CO_CODE");
			var strUseDiv	= ds_if_bef_hist3_record.getColumn(i,"SLIP_DIV_CODE");
					
			if(strUseDiv == "01" || strUseDiv == "02" || strUseDiv == "03" || strUseDiv == "04" || strUseDiv == "06"){
//				if(strChnlCls == "01" || strChnlCls == "08" || strChnlCls == "09" || strChnlCls == "61"){
					dblTotQty = dblTotQty + parseFloat(ds_if_bef_hist3_record.getColumn(i,"CNT"));
//				}
			}
		}
	}else{
		for(i=0;i<ds_if_bef_hist3_record.rowcount;i++)
		{
			var strChnlCls 	= ds_if_bef_hist3_record.getColumn(i,"CHNL_DIV_CD");
			var strUseDiv	= ds_if_bef_hist3_record.getColumn(i,"RSV_USE_DIV_CD");
					
			if(strUseDiv == "01" || strUseDiv == "02" || strUseDiv == "03" || strUseDiv == "04" || strUseDiv == "06"){
//				if(strChnlCls == "01" || strChnlCls == "08" || strChnlCls == "09" || strChnlCls == "61"){
					dblTotQty = dblTotQty + parseFloat(ds_if_bef_hist3_record.getColumn(i,"QTY"));
//				}
			}
		}			
	}
	
	dblTotQty = Math.round(dblTotQty);									// 총 주유량
	Msk_BefTotAmt3.value = dblTotQty;
	
	strSelMaxQtyYn = "Y";
	// 한도조정 팝업창 open
	fn_openModLimt();		
}

function fn_callBackAll()
{	
	if(ds_call_back.findRow("RSPN_MSG","Y") != -1){
		return;
	}
	
	var intHttpRow = ds_call_back.findRow("HTTP_CD","-1");
	if(intHttpRow != -1){
		cf_Alert("COME0035",ds_call_back.getColumn(intHttpRow,"HTTP_MSG"));
		ds_call_back.setColumn(intHttpRow,"MSG_POPUP_YN","Y");
		return;
	}
	
	for(i=0;i<ds_call_back.rowcount;i++)
	{
		var strRspnCd = getTrim(ds_call_back.getColumn(i,"RSPN_CD"));
		if(strRspnCd != "00000" && strRspnCd != ""){
			cf_Alert("COME0035",ds_call_back.getColumn(i,"RSPN_MSG"));
			ds_call_back.setColumn(i,"MSG_POPUP_YN","Y");
			return;						
		}
	}
	
	cf_trace("한도조정 인터페이스",ds_call_back.rowposition + "::" + ds_call_back.getColumn(ds_call_back.rowposition,"RSPN_MSG"));	
	
	// 인터페이스 3건 모두 정상으로 온 경우
	if(ds_call_back.rowcount == 3){		
		fn_setBefTotQty1();
	}
}

// 한도조정팝업OPEN
function fn_openModLimt()
{
	var objDsCust = this.parent.parent.all["ds_cust_info"];
	
	ds_get_param.clearData();
	ds_set_param.clearData();
	
	fun_ds_srch(ds_get_param, "RS_BZ_NO", getTrim(objDsCust.getColumn(0,"OT_RS_BZ_NO").replace("-","")));
	fun_ds_srch(ds_get_param, "CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
	fun_ds_srch(ds_get_param, "CUST_NM", getTrim(objDsCust.getColumn(0,"OT_CUST_NM")));
	
	//법인은 월조정 포인트를 30000이상 처리 하기 위해 구분값을 가지고 와야 한다.(개인:01 ,법인:02) 20210318 김재숙선임
	fun_ds_srch(ds_get_param, "CUST_DIV_CD", getTrim(objDsCust.getColumn(0,"OT_CUST_DIV_CD")));
	
	fun_ds_srch(ds_get_param, "HND_PHONE_NO", getTrim(objDsCust.getColumn(0,"OT_HND_PHONE_NO")));	
	fun_ds_srch(ds_get_param, "BEF_QTY_FRST", Msk_BefTotAmt1.value);
	fun_ds_srch(ds_get_param, "BEF_QTY_SCND", Msk_BefTotAmt2.value);
	fun_ds_srch(ds_get_param, "BEF_QTY_THRD", Msk_BefTotAmt3.value);		
								
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};
//	trace(ds_get_param.saveXML());
//	PopupDialog("BNS440","BNS::BNS440.xfdl", -1, -1, 1000, 654, false, -1, arrParam, false, false, true, false);
	this.parent.parent.parent.mdiOpen("BNS440","BNS::BNS440.xfdl","한도조정", 393, 23, 1000, 555, false, "absolute", arrParam, true, false, true, false);	
}

// 문화팝콘클릭
function Btn_Popcorn_onclic(obj:Button,  e:ClickEventInfo)
{
	var objDsCust = this.parent.parent.all["ds_cust_info"];
	var intSelRow = ds_rsv_hist_out.findRow("CHK",1);
	var objFlgDs  = this.parent.parent.all["ds_srch_flg"];	
	
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");		
		return;
	}
	
	if(getTrim(objFlgDs.getColumn(0,"FRCH_YN")) == "Y"){
		cf_Alert("BNSE0040","문화팝콘 업무처리");	
		return;	
	}
		
	if(ds_rsv_hist_out.rowcount < 1){
		cf_Alert("COME0013","구매이력");		
		return;
	}			
	
	if(intSelRow == -1){
		cf_Alert("COME0008","팝콘 발급할 구매이력");			
		return;		
	}
	
	// 거래발생사유(주유내역누락, 특별포인트누락, 통합주유적립정상, CSC포인트조정
	// 채널()
	
	var strPointRsn = ds_rsv_hist_out.getColumn(intSelRow,"POINT_REASON");
	var strChnlcls  = ds_rsv_hist_out.getColumn(intSelRow,"CHNL_DIV");

	if(strPointRsn != "0004" && strPointRsn != "0007" && strPointRsn != "0061" && strPointRsn != "0068" && strChnlcls != "6100" && strChnlcls != "01" && strChnlcls != "02"){
		cf_Alert("BNSE0054");		
		return;
	}else if(ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="AAAA00" 
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="011011" 
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="011511"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="012011"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="061011"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="066011"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="101011"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="102011"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="103011"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="120111"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="120211"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="120311"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="120611"
			|| ds_rsv_hist_out.getColumn(ds_rsv_hist_out.rowposition,"PROD_CD")=="120711"){
			
			
	ds_get_param.clearData();
	ds_set_param.clearData();
	
	fun_ds_srch(ds_get_param, "CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
	fun_ds_srch(ds_get_param, "CRD_NO", getTrim(ds_rsv_hist_out.getColumn(intSelRow,"CRD_NO")));
	fun_ds_srch(ds_get_param, "FRCH_CD", getTrim(ds_rsv_hist_out.getColumn(intSelRow,"FRCH_CD")));
	fun_ds_srch(ds_get_param, "AMT", getTrim(ds_rsv_hist_out.getColumn(intSelRow,"AMT")));
	fun_ds_srch(ds_get_param, "SALE_DTIME_UI", getTrim(ds_rsv_hist_out.getColumn(intSelRow,"SALE_DTIME_UI")));	
								
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

	PopupDialog("BNS450","BNS::BNS450.xfdl", -1, -1, 500, 378, false, -1, arrParam, false, false, true, false);

	
	}else {
	cf_Alert("COME0002","쿠폰을 발급 할수 없는 이력입니다.");
	}
	
	
}

// 엑셀버튼클릭
function Btn_Excel_onclick(obj:Button,  e:ClickEventInfo)
{
	
	var objDsCust = this.parent.parent.all["ds_cust_info"];
	var objFlgDs	= this.parent.parent.all["ds_srch_flg"];	
	
		
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");	
		return;
	}			

	if(getTrim(objFlgDs.getColumn(0,"FRCH_YN")) == "Y"){
		cf_Alert("BNSE0040","엑셀다운로드");	
		return;	
	}	
	
	
	if(Grd_BuyHist.visible == true && Grd_PayHist.visible == false && Grd_ChargeHist.visible == false && Grd_EventPoint.visible == false) {				//구매이력 엑셀 다운로드
		if(Rdo_SrchDiv.value == "1" || Rdo_SrchDiv.value == "2"){
			if(ds_rsv_hist_out.rowcount < 1){
				cf_Alert("BNSE0036","구매이력이");			
				return;
			}
		
			
			var sPerTCd ; 
			var sPerTDt = "ICCS_CSC 구매 이력 다운로드";  // 수행업무 상세내용
			var sCalFun = "Btn_Excel_onclick()";  // 호출함수명 	
			var sInqCon = gfn_getStringFromDataset(ds_srch_cond); //조회 조건은 고객번호 
			var sInqCnt = ds_rsv_hist_out.rowcount;  // 조회건수		
			var sInCustNo = "CUST_ID="+objDsCust.getColumn(0,"IO_CUST_NO") ;
				
			var cnt = fn_exel_Doenhis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);	
			
			//상세사유가 없으면 다운로드 안됨.
			if(cnt < 1){
				return;
			}			
		
			GridExportExcel(Grd_BuyHist, ExportObject00, "sheet1");	
		
		}else if(Rdo_SrchDiv.value == "3" || Rdo_SrchDiv.value == "4"){
			fn_srchBwExcel();		
		}
	}else if(Grd_PayHist.visible == true && Grd_BuyHist.visible == false && Grd_ChargeHist.visible == false && Grd_EventPoint.visible == false) {		//주유이력 엑셀 다운로드
		if(ds_if_payhist_record.rowcount < 1){
			cf_Alert("BNSE0036","주유이력이");			
			return;
		}
		GridExportExcel(Grd_PayHist, ExportObject00, "sheet1");	
	}else if(Grd_ChargeHist.visible == true && Grd_BuyHist.visible == false && Grd_PayHist.visible == false && Grd_EventPoint.visible == false) {		//EV충전이력 엑셀 다운로드
		if(ds_charge_hist_record.rowcount < 1){
			cf_Alert("BNSE0036","EV충전이력이");			
			return;
		}
		
		GridExportExcel(Grd_ChargeHist, ExportObject00, "sheet1");	
	}else if(Grd_EventPoint.visible == true && Grd_BuyHist.visible == false && Grd_PayHist.visible == false && Grd_ChargeHist.visible == false) {		//Event-Point 엑셀 다운로드
		if(ds_if_eventptHist_record.rowcount < 1){
			cf_Alert("BNSE0036","E-Point 이력이");			
			return;
		}
		
		GridExportExcel(Grd_EventPoint, ExportObject00, "sheet1");	
	}

}

// + 버튼클릭
function Btn_AddScrnHei_onclick(obj:Button,  e:ClickEventInfo)
{
	// Tab Height : 250 
//	this.parent.position.height = 405;
	this.parent.position.height = 445;	
	// tabpage Grid Height : 152
//	this.all["Grd_BuyHist"].position.height = 307;
	this.all["Grd_BuyHist"].position.height = 347;
	
	// Email 탭의 AXMSIE visible을 관리
	if(this.parent.parent.all["Tab_CntctHistInfo"].tabindex == 5){
		this.parent.parent.all["Tab_CntctHistInfo"]["tabpage6"].all["AXMSIE_ANSR"].visible = false;
		this.parent.parent.all["Tab_CntctHistInfo"]["tabpage6"].all["AXMSIE_QUEST"].visible = false;		
	}
}

// - 버튼클릭
function Btn_SubScrnHei_onclick(obj:Button,  e:ClickEventInfo)
{
	// Tab Height : 405
//	this.parent.position.height = 250;
	this.parent.position.height = 290;	
	// tabpage Grid Height : 307
//	this.all["Grd_BuyHist"].position.height = 152;
	this.all["Grd_BuyHist"].position.height = 192;
		
	// Email 탭의 AXMSIE visible을 관리
	if(this.parent.parent.all["Tab_CntctHistInfo"].tabindex == 5){
		this.parent.parent.all["Tab_CntctHistInfo"]["tabpage6"].all["AXMSIE_ANSR"].visible = true;
		this.parent.parent.all["Tab_CntctHistInfo"]["tabpage6"].all["AXMSIE_QUEST"].visible = true;		
	}		
}


function Grd_BuyHist_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	cf_gridSort(obj, e);
	ds_rsv_hist_out.rowposition = 0;	
}

function Grd_PayHist_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	cf_gridSort(obj, e);
	ds_if_payhist_record.rowposition = 0;	
}

function Grd_ChargeHist_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	cf_gridSort(obj, e);
	ds_charge_hist_record.rowposition = 0;
}



// 조회구분(Radio) 변경시
function Rdo_SrchDiv_onitemchanged(obj:Radio, e:ItemChangeEventInfo)
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];

	switch(Rdo_SrchDiv.value)
	{
		case "1" :
		case "2" :
			if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){
				Cmb_UseOilKnd.value 	= "";
				Cmb_UseOilKnd.enable 	= false;
				Cmb_Chnl.value 			= "";
				Cmb_Chnl.enable 		= false;
				Cmb_SaveDiv.value 		= "";
				Cmb_Affil.value			= "";				
				Cmb_SaveDiv.enable 		= true;
				Cmb_Affil.enable		= true;				
			}else{
				Cmb_UseOilKnd.value 	= "";
				Cmb_UseOilKnd.enable 	= true;			
				Cmb_Chnl.value 		= "";
				Cmb_Chnl.enable 	= true;
				Cmb_SaveDiv.value 	= "";
				Cmb_Affil.value		= "";				
				Cmb_SaveDiv.enable 	= true;
				Cmb_Affil.enable	= true;							
			}		
			break;
		case "3" :
		case "4" :
			if(objDsCust.getColumn(0,"OT_GRP_AGR_YN") == "Y"){
				Cmb_UseOilKnd.value 	= "";
				Cmb_UseOilKnd.enable 	= false;						
				Cmb_Chnl.value 		= "";
				Cmb_Chnl.enable 	= false;			
				Cmb_SaveDiv.value 	= "";
				Cmb_Affil.value		= "";
				Cmb_SaveDiv.enable 	= true;
				Cmb_Affil.enable	= false;				
			}else{
				Cmb_UseOilKnd.value 	= "";
				Cmb_UseOilKnd.enable 	= true;			
				Cmb_Chnl.value 		= "";
				Cmb_Chnl.enable 	= true;			
				Cmb_SaveDiv.value 	= "";
				Cmb_Affil.value		= "";
				Cmb_SaveDiv.enable 	= true;
				Cmb_Affil.enable	= false;					
			}

			break;
		default : 
			break;
	}	
}

function Cmb_SaveDiv_onkeyup(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == "13" ) Btn_Srch_onclick();	
}

function Cmb_UseOilKnd_onkeyup(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == "13" ) Btn_Srch_onclick();	
}

function Cmb_Chnl_onkeyup(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == "13" ) Btn_Srch_onclick();	
}

function Cmb_Affil_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	if (e.keycode == "13" ) Btn_Srch_onclick();	
}

function Cal_SrchFrmDt_onkeyup(obj:Calendar, e:KeyEventInfo)
{
	if (e.keycode == "13" ) Btn_Srch_onclick();	
}

function Cal_SrchToDt_onkeyup(obj:Calendar, e:KeyEventInfo)
{
	if (e.keycode == "13" ) Btn_Srch_onclick();	
}

// 셀내용복사
function Grd_BuyHist_onkeydown(obj:Grid, e:KeyEventInfo)
{
	if(e.ctrlKey){
		if(e.keycode == 67){
			var v_clip;			
			v_clip = obj.getCellText(obj.currentrow,obj.currentcol);
			system.clearClipboard();
			system.setClipboard("CF_TEXT",v_clip);
		}	
	}	
}


// 응모쿠폰발급클릭
function Btn_ecEntrIssueIns_onclick(obj:Button,  e:ClickEventInfo)
{
	
	if(ds_rsv_hist_out.rowcount < 1){
		cf_Alert("COME0013","구매이력");		
		return;
	}
	
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];

	fun_ds_srch(ds_get_param, "CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
	
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};
	
	PopupDialog("BNS470","BNS::BNS470.xfdl", -1, -1, 500, 378, false, -1, arrParam, false, false, true, false);

	ds_get_param.clearData();

	fun_ds_srch(ds_get_param, "CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
	
	
}

/* 켐페인 이벤트
 * 이벤트 사용중지로 인한 주석처리
 * 2021.11.25 CANP847
function Btn_cmpInfo_onclick(obj:Button,  e:ClickEventInfo)
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
	// 고객 조회여부 체크
	
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");					
		return;
	}
			
	ds_get_param.clearData();
	ds_set_param.clearData();
	
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
	fun_ds_srch(ds_get_param, "IO_CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
		
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};     
		
	this.parent.parent.parent.mdiOpen("BNS473","BNS::BNS473.xfdl","캠페인응모", 393, 23, 1150, 530, false, "absolute", arrParam, true, false, true, false);
																				 
}
*/

/* EV충전이력
 * 캠페인 -> EV충전이력 변경
 * 2021.11.25 CANP847
*/
function Btn_evCharge_onclick(obj:Button,  e:ClickEventInfo)
{
	
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
			
	// 고객 조회여부 체크	
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");		
		return;
	}	
	
	if(Cal_SrchFrmDt.value == "" || Cal_SrchToDt.value == "")
	{
		alert("기간을 입력해 주세요.");
		return;
	}
	
	
	//필수체크
	if(!cf_ValidDate(Cal_SrchFrmDt.value, Cal_SrchToDt.value)) {
		Cal_Srch_RegDateFrom.setFocus();
		return false;
	}
	
	
	Grd_BuyHist.visible = false;
	Grd_PayHist.visible = false;
	Grd_EventPoint.visible = false;
	Grd_ChargeHist.visible = true;
	
	var In_cust_no = getTrim(objDsCust.getColumn(0,"IO_CUST_NO"));
	
	
	//이력 합계 조회
	fn_chargeSum(In_cust_no);
	
	//이력리스트 조회
	fn_chargeList(In_cust_no);
	
}

//EV충전이력 조회
function fn_chargeList(In_cust_no){

	//초기화
	ds_if_ev_chargeHist_env.clearData();
	ds_if_ev_chargeHist_data.clearData();
	ds_if_ev_chargeHist_common.clearData();
	ds_if_ev_chargeHist_header.clearData();
	ds_charge_hist_record.clearData();
	
	
	fn_setIfEnvDs(ds_if_ev_chargeHist_env,"WAS-EVAPP","api/chargeHist","","chargeHistList_Rsp","","chargeHistList");
		
	//IF DATA DS	
	fun_ds_srch(ds_if_ev_chargeHist_data, "custNo", In_cust_no); 						//고객번호
	fun_ds_srch(ds_if_ev_chargeHist_data, "stdDate", getTrim(Cal_SrchFrmDt.value)); 	//시작일자
	fun_ds_srch(ds_if_ev_chargeHist_data, "endDate", getTrim(Cal_SrchToDt.value)); 		//종료일자
	
	//trace(ds_if_ev_chargeHist_data.saveXML());
	var	strSvcID = "IF_CSC_OPS_003";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_ev_chargeHist_env:a INTERFACE_DATA=ds_if_ev_chargeHist_data:a";
	var	strOutDatasets = "ds_if_ev_chargeHist_common=DS_COMMON ds_if_ev_chargeHist_header=DS_HEADER ds_if_ev_chargeHist_column=DS_COLUMN ds_charge_hist_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	

}


//EV충전이력 충전량 조회
function fn_chargeSum(In_cust_no)
 {
	ds_if_ev_chargeSum_env.clearData();
	ds_if_ev_chargeSum_data.clearData();
	ds_if_ev_chargeSum_common.clearData();
	ds_if_ev_chargeSum_header.clearData();
	ds_charge_sum_record.clearData();
	
	
	fun_ds_srch(ds_if_ev_chargeSum_data,"custNo",In_cust_no);
	fun_ds_srch(ds_if_ev_chargeSum_data,"stdDate",Cal_SrchFrmDt.value);
	fun_ds_srch(ds_if_ev_chargeSum_data,"endDate",Cal_SrchToDt.value);
																       
	fn_setIfEnvDs(ds_if_ev_chargeSum_env,"WAS-EVAPP","api/chargeHist","","chargeHistList_Rsp","","chargeSum");
	
	
	var	strSvcID = "IF_CSC_OPS_002";  
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_ev_chargeSum_env:a INTERFACE_DATA=ds_if_ev_chargeSum_data:a";
	var	strOutDatasets = "ds_if_ev_chargeSum_common=DS_COMMON ds_if_ev_chargeSum_header=DS_HEADER ds_if_ev_chargeSum_column=DS_COLUMN ds_charge_sum_record=DS_RECORD";
	var	strArgument = "";			
	var strCallbackFunc = "fn_callBack";        
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
																				 
}

//EV충전이력 상세
function Grd_ChargeHist_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var objDsCust = this.parent.parent.all["ds_cust_info"];
	ds_get_param.clearData();
	ds_set_param.clearData();
	
	fun_ds_srch(ds_get_param, "custNo", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));								//고객번호
	fun_ds_srch(ds_get_param, "transDistntNo", getTrim(ds_charge_hist_record.getColumn(e.row,"TRANSDISTNTNO")));	//거래고유번호
	fun_ds_srch(ds_get_param, "pgAuthCd", getTrim(ds_charge_hist_record.getColumn(e.row,"PGAUTHCD")));				//PG승인번호
	
			
						
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};
	this.parent.parent.parent.mdiOpen("BNS413","BNS::BNS413.xfdl","EV충전 상세이력", 393, 23, 843, 621, false, "absolute", arrParam, true, false, true, false);	
}

function Rdo_SrchDiv_onitemclick(obj:Radio, e:RadioMouseEventInfo)
{
	
}
/*
 * 구매내역 Van사 조회 화면 Popup
 * 구매내역 필드 추가 --> 팝업 조회로 변경
 * CSR : R20161010000005
 * 2016.10.18 박동규
 */
function Btn_vanInfo_onclick(obj:Button,  e:ClickEventInfo)
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
	// 고객 조회여부 체크
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");					
		return;
	}		
	ds_get_param.clearData();
	ds_set_param.clearData();
	
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
	fun_ds_srch(ds_get_param, "IO_CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
		
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};     
		
	this.parent.parent.parent.mdiOpen("BNS472","BNS::BNS472.xfdl","밴사 조회", 393, 23, 1071, 453, false, "absolute", arrParam, true, false, true, false);
}


//GS칼텍스 자사앱 주유이력
function Btn_PaySrch_onclick(obj:Button,  e:ClickEventInfo)
{
	
	Stt_TotRflAmnt00.visible = false;
	Stt_TotRflAmnt2.visible = false;
	Stt_TotRflAmnt3.visible = false;
			
	Msk_BefTotAmt1.visible = false;
	Msk_BefTotAmt2.visible = false;
	Msk_BefTotAmt3.visible = false;
	
	
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
			
	// 고객 조회여부 체크	
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");		
		return;
	}	
	
	//날짜 기간 체크	
	/*
	var strCompDt = AddMonth(Cal_SrchFrmDt.value,3);
		if(strCompDt < Cal_SrchToDt.value){
			cf_Alert("COME0019","3개월");
			return;
	}
	*/
	if(Cal_SrchFrmDt.value == "" || Cal_SrchToDt.value == "")
	{
		alert("기간을 입력해 주세요.");
	}
	
	
	//필수체크
	if(!cf_ValidDate(Cal_SrchFrmDt.value, Cal_SrchToDt.value)) {
		Cal_Srch_RegDateFrom.setFocus();
		return false;
	}
	
	
	Grd_BuyHist.visible = false;
	Grd_ChargeHist.visible = false;
	Grd_EventPoint.visible = false;
	Grd_PayHist.visible = true;
	
	var In_cust_no = getTrim(objDsCust.getColumn(0,"IO_CUST_NO"));
	

	ds_if_payhist_env.clearData();
	ds_if_payhist_data.clearData();
	ds_if_payhist_common.clearData();
	ds_if_payhist_header.clearData();
	ds_if_payhist_record.clearData();

	
	
	fun_ds_srch(ds_if_payhist_data,"custNo",In_cust_no);
	fun_ds_srch(ds_if_payhist_data,"stdDate",Cal_SrchFrmDt.value);
	fun_ds_srch(ds_if_payhist_data,"endDate",Cal_SrchToDt.value);
	
	//trace(ds_if_payhist_data.saveXML());
																       
	fn_setIfEnvDs(ds_if_payhist_env,"WAS-APP","api/api-list","","apiList_Rsp","","apiList");
	
	
	var	strSvcID = "IF_01";  
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_payhist_env:a INTERFACE_DATA=ds_if_payhist_data:a";
	var	strOutDatasets = "ds_if_payhist_common=DS_COMMON ds_if_payhist_header=DS_HEADER ds_if_payhist_record=DS_RECORD";
	var	strArgument = "";			
	var strCallbackFunc = "fn_callBack";        
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	
}

function Grd_PayHist_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var objDsCust = this.parent.parent.all["ds_cust_info"];
	ds_get_param.clearData();
	ds_set_param.clearData();
	
	fun_ds_srch(ds_get_param, "CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));					//고객번호
	fun_ds_srch(ds_get_param, "PINNO", getTrim(ds_if_payhist_record.getColumn(e.row,"PINNO")));				//핀번호		
	
	fun_ds_srch(ds_get_param, "BARCD", getTrim(ds_if_payhist_record.getColumn(e.row,"BARCD")));				//바코드번호
	fun_ds_srch(ds_get_param, "TROWNNO", getTrim(ds_if_payhist_record.getColumn(e.row,"TROWNNO")));				//거래번호
	
	
	fun_ds_srch(ds_get_param, "PRODNM", getTrim(ds_if_payhist_record.getColumn(e.row,"PRODNM"))); 			//상품구분명
	fun_ds_srch(ds_get_param, "RESVQTY", getTrim(ds_if_payhist_record.getColumn(e.row,"RESVQTY")));			//예약수량
	fun_ds_srch(ds_get_param, "RESVUPRC", getTrim(ds_if_payhist_record.getColumn(e.row,"RESVUPRC")));		//예약단가
	fun_ds_srch(ds_get_param, "TOTAMT", getTrim(ds_if_payhist_record.getColumn(e.row,"TOTAMT")));			//전체결제금액
	fun_ds_srch(ds_get_param, "SALEDT", getTrim(ds_if_payhist_record.getColumn(e.row,"SALEDT")));			//매출일시
	
	fun_ds_srch(ds_get_param, "SALETMDAY", getTrim(ds_if_payhist_record.getColumn(e.row,"SALETMDAY")));		//매출일시
	fun_ds_srch(ds_get_param, "APRVDIVCD", getTrim(ds_if_payhist_record.getColumn(e.row,"APRVDIVCD")));		//승인구분코드
	fun_ds_srch(ds_get_param, "FRCHCDPAYM", getTrim(ds_if_payhist_record.getColumn(e.row,"FRCHCDPAYM")));	//주유소코드
	fun_ds_srch(ds_get_param, "FRCHNMPAYM", getTrim(ds_if_payhist_record.getColumn(e.row,"FRCHNMPAYM")));	//주유소명
	fun_ds_srch(ds_get_param, "PRODCDPAYM", getTrim(ds_if_payhist_record.getColumn(e.row,"PRODCDPAYM")));	//상품구분코드
	
	
	fun_ds_srch(ds_get_param, "QTY", getTrim(ds_if_payhist_record.getColumn(e.row,"QTY")));					//주유량
	fun_ds_srch(ds_get_param, "AMTPAYM", getTrim(ds_if_payhist_record.getColumn(e.row,"AMTPAYM")));			//결제금액
	fun_ds_srch(ds_get_param, "UPRCPAYM", getTrim(ds_if_payhist_record.getColumn(e.row,"UPRCPAYM")));		//단가
	fun_ds_srch(ds_get_param, "PAYALIAS", getTrim(ds_if_payhist_record.getColumn(e.row,"PAYALIAS")));		//패턴명
	
	fun_ds_srch(ds_get_param, "CUPNUSEYN", getTrim(ds_if_payhist_record.getColumn(e.row,"CUPNUSEYN")));		//쿠폰사용여부
	fun_ds_srch(ds_get_param, "PTUSEYN", getTrim(ds_if_payhist_record.getColumn(e.row,"PTUSEYN")));		//포인트사용여부
	
	fun_ds_srch(ds_get_param, "INPTDTIME", getTrim(ds_if_payhist_record.getColumn(e.row,"INPTDTIME")));		//결제예정_생성시간
	fun_ds_srch(ds_get_param, "MODDTIME", getTrim(ds_if_payhist_record.getColumn(e.row,"MODDTIME")));		//결졔예정_수정시간
	
	fun_ds_srch(ds_get_param, "ORDGBN", getTrim(ds_if_payhist_record.getColumn(e.row,"ORDGBN")));			//쿠폰조건
	
			
						
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

	//PopupDialog("BNS412","BNS::BNS412.xfdl", -1, -1, 560, 276, false, -1, arrParam, false, false, true, false);		
	//this.parent.parent.parent.mdiOpen("BNS420","BNS::BNS420.xfdl","카드바뀜", 393, 23, 1115, 553, false, "absolute", arrParam, true, false, true, false);	
	this.parent.parent.parent.mdiOpen("BNS412","BNS::BNS412.xfdl","주유상세이력", 393, 23, 843, 521, false, "absolute", arrParam, true, false, true, false);	
}


function Grd_BuyHist_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	
		
	if(e.col == "1"){
		if(ds_rsv_hist_out.getColumn(e.row,"CHK") == "1"){
			if(ds_rsv_hist_out.getCaseCount("CHK == '1'") > 1){
				for(i=0;i<ds_rsv_hist_out.rowcount;i++)
				{
					ds_rsv_hist_out.setColumn(i,"CHK","0");
				}				
			}
			ds_rsv_hist_out.setColumn(e.row,"CHK","1");			
		}	
	}	
		
		/*
		if(e.col == "1"){
		if(e.oldcol == "1"){
			if(e.oldrow != e.row){
				ds_rsv_hist_out.setColumn(e.oldrow,"CHK","0");			
				ds_rsv_hist_out.setColumn(e.row,"CHK","1");
			}else{
				if(ds_rsv_hist_out.getColumn(e.row,"CHK") == "1"){
					ds_rsv_hist_out.setColumn(e.row,"CHK","0");
				}else{
					ds_rsv_hist_out.setColumn(e.row,"CHK","1");
				}
			}
		}
		
		else{
			var intRow = ds_rsv_hist_out.findRow("CHK","1");
			if(intRow != e.row){
				ds_rsv_hist_out.setColumn(intRow,"CHK","0");			
				ds_rsv_hist_out.setColumn(e.row,"CHK","1");				
			}else{
				if(ds_rsv_hist_out.getColumn(e.row,"CHK") == "1"){
					ds_rsv_hist_out.setColumn(e.row,"CHK","0");
				}else{
					ds_rsv_hist_out.setColumn(e.row,"CHK","1");
				}				
			}
		}*/
	
	
	if(e.col == "6"){ 
		if(ds_rsv_hist_out.getColumn(e.row,"POINT_REASON") == "9201" || ds_rsv_hist_out.getColumn(e.row,"POINT_REASON") == "9202"){			
			var objDsCust = this.parent.parent.all["ds_cust_info"];
			ds_get_param.clearData();
			ds_set_param.clearData();
			
			fun_ds_srch(ds_get_param, "CUST_NO", getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
			fun_ds_srch(ds_get_param, "PROC_DT", getTrim(ds_rsv_hist_out.getColumn(e.row,"SALE_DTIME_UI")).substr(0,8));			
								
			var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

			PopupDialog("BNS411","BNS::BNS411.xfdl", -1, -1, 560, 276, false, -1, arrParam, false, false, true, false);			
		}
	}
}


/**
* GS&포인트 자사화 > 이벤트 포인트 거래내역 조회
* 2024.12.31 | NP847
*/
function Btn_EPnt_onclick(obj:Button,  e:ClickEventInfo)
{
	var objDsCust 	= this.parent.parent.all["ds_cust_info"];
	
	// 고객 조회여부 체크
	if(getTrim(objDsCust.getColumn(0,"IO_CUST_NO")) == ""){
		cf_Alert("COME0013","고객");					
		return;
	}
	
	// 기간 체크
	if(!cf_ValidDate(Cal_SrchFrmDt.value, Cal_SrchToDt.value)) {
		alert("기간 선택은 필수입니다.");
		Cal_Srch_RegDateFrom.setFocus();
		return;
	}
	
	Grd_BuyHist.visible = false;
	Grd_PayHist.visible = false;
	Grd_ChargeHist.visible = false;
	Grd_EventPoint.visible = true;
	
	//초기화
	ds_if_eventptHist_env.clearData();
	ds_if_eventptHist_data.clearData();
	ds_if_eventptHist_common.clearData();
	ds_if_eventptHist_header.clearData();
	ds_if_eventptHist_column.clearData();
	ds_if_eventptHist_record.clearData();
	
	//IF 세팅
	fun_ds_srch(ds_if_eventptHist_env, "IF_KIND"			, "WAS");
	fun_ds_srch(ds_if_eventptHist_env, "REQ_SERVICE_METHOD"	, "ptCustEventpttrSelC01.do");
	fun_ds_srch(ds_if_eventptHist_env, "REQ_SERVICE_ID"		, "");
	fun_ds_srch(ds_if_eventptHist_env, "RES_HEADER_SECTION"	, "STP_PT_CUSTEVENTPTTR_SEL_C01_Rsp");
	fun_ds_srch(ds_if_eventptHist_env, "RES_COLUMN_SECTION"	, ""); 
	fun_ds_srch(ds_if_eventptHist_env, "RES_RECORD_SECTION"	, "OT_RESULT"); 

	//parameter setting
	fun_ds_srch(ds_if_eventptHist_data,"io_prcd_id"			, "");
	fun_ds_srch(ds_if_eventptHist_data,"in_req_chnl_cd"		, "610050");
	fun_ds_srch(ds_if_eventptHist_data,"in_page_no"			, "1");
	fun_ds_srch(ds_if_eventptHist_data,"in_page_size"		, "10000");
	fun_ds_srch(ds_if_eventptHist_data,"in_search_key"		, "S1");
	fun_ds_srch(ds_if_eventptHist_data,"in_cust_no"			, getTrim(objDsCust.getColumn(0,"IO_CUST_NO")));
	fun_ds_srch(ds_if_eventptHist_data,"in_from_date"		, getTrim(Cal_SrchFrmDt.value));
	fun_ds_srch(ds_if_eventptHist_data,"in_end_date"		, getTrim(Cal_SrchToDt.value));
	
	var	strSvcID = "IF_WS_0352";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_eventptHist_env:a INTERFACE_DATA=ds_if_eventptHist_data:a";
	var	strOutDatasets = "ds_if_eventptHist_common=DS_COMMON ds_if_eventptHist_header=DS_HEADER ds_if_eventptHist_column=DS_COLUMN ds_if_eventptHist_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	
}


function Grd_EventPoint_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	//이벤트포인트 복구
	if(e.col == 53) {
		//trace("이벤트포인트 복구 시도");
	}
}
]]></Script>
    <Layout>
      <Grid id="Grd_PayHist" class="grd_WFDA2" taborder="1" binddataset="ds_if_payhist_record" autoenter="select" useinputpanel="false" cellsizingtype="both" onkeydown="Grd_BuyHist_onkeydown" position="absolute 0 72 1630 264" titletext="정상카드" visible="false" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;BARCD&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;CUSTNO&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;PAYMINFODIVCD&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;OATMSEQ&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;PINNO&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;FRCHCD&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;FRCHNM&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;PRODCD&quot;/&gt;&#10;      &lt;Cell col=&quot;8&quot; disptype=&quot;normal&quot; text=&quot;PRODNM&quot;/&gt;&#10;      &lt;Cell col=&quot;9&quot; disptype=&quot;normal&quot; text=&quot;MAXOILYN&quot;/&gt;&#10;      &lt;Cell col=&quot;10&quot; disptype=&quot;normal&quot; text=&quot;TOAMT&quot;/&gt;&#10;      &lt;Cell col=&quot;11&quot; disptype=&quot;normal&quot; text=&quot;VLIDSTRDT&quot;/&gt;&#10;      &lt;Cell col=&quot;12&quot; disptype=&quot;normal&quot; text=&quot;VLIDENDDT&quot;/&gt;&#10;      &lt;Cell col=&quot;13&quot; disptype=&quot;normal&quot; text=&quot;USEDIVCD&quot;/&gt;&#10;      &lt;Cell col=&quot;14&quot; disptype=&quot;normal&quot; text=&quot;USEYN&quot;/&gt;&#10;      &lt;Cell col=&quot;15&quot; disptype=&quot;normal&quot; text=&quot;TROWNNO&quot;/&gt;&#10;      &lt;Cell col=&quot;16&quot; disptype=&quot;normal&quot; text=&quot;ORGTROWNNO&quot;/&gt;&#10;      &lt;Cell col=&quot;17&quot; disptype=&quot;normal&quot; text=&quot;SALEDT&quot;/&gt;&#10;      &lt;Cell col=&quot;18&quot; disptype=&quot;normal&quot; text=&quot;SALETMDAY&quot;/&gt;&#10;      &lt;Cell col=&quot;19&quot; disptype=&quot;normal&quot; text=&quot;APRVDIVCD&quot;/&gt;&#10;      &lt;Cell col=&quot;20&quot; disptype=&quot;normal&quot; text=&quot;FRCHCDPAYM&quot;/&gt;&#10;      &lt;Cell col=&quot;21&quot; disptype=&quot;normal&quot; text=&quot;FRCHNMPAYM&quot;/&gt;&#10;      &lt;Cell col=&quot;22&quot; disptype=&quot;normal&quot; text=&quot;QTY&quot;/&gt;&#10;      &lt;Cell col=&quot;23&quot; disptype=&quot;normal&quot; text=&quot;AMTPAYM&quot;/&gt;&#10;      &lt;Cell col=&quot;24&quot; disptype=&quot;normal&quot; text=&quot;UPRC&quot;/&gt;&#10;      &lt;Cell col=&quot;25&quot; disptype=&quot;normal&quot; text=&quot;PAYMDIVCD&quot;/&gt;&#10;      &lt;Cell col=&quot;26&quot; disptype=&quot;normal&quot; text=&quot;FDYNEXPTDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;27&quot; disptype=&quot;normal&quot; text=&quot;AMTEXPTDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;28&quot; disptype=&quot;normal&quot; text=&quot;PAYMDIVVAL&quot;/&gt;&#10;      &lt;Cell col=&quot;29&quot; disptype=&quot;normal&quot; text=&quot;CRDNO&quot;/&gt;&#10;      &lt;Cell col=&quot;30&quot; disptype=&quot;normal&quot; text=&quot;CCRDCOCD&quot;/&gt;&#10;      &lt;Cell col=&quot;31&quot; disptype=&quot;normal&quot; text=&quot;APRVDIVCDDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;32&quot; disptype=&quot;normal&quot; text=&quot;FDYNPAYMDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;33&quot; disptype=&quot;normal&quot; text=&quot;AMTPAYMDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;34&quot; disptype=&quot;normal&quot; text=&quot;FDAMT&quot;/&gt;&#10;      &lt;Cell col=&quot;35&quot; disptype=&quot;normal&quot; text=&quot;PAYMVAL&quot;/&gt;&#10;      &lt;Cell col=&quot;36&quot; disptype=&quot;normal&quot; text=&quot;RESPCD&quot;/&gt;&#10;      &lt;Cell col=&quot;37&quot; disptype=&quot;normal&quot; text=&quot;RESPMSG&quot;/&gt;&#10;      &lt;Cell col=&quot;38&quot; disptype=&quot;normal&quot; text=&quot;APRVDT&quot;/&gt;&#10;      &lt;Cell col=&quot;39&quot; disptype=&quot;normal&quot; text=&quot;APRVNO&quot;/&gt;&#10;      &lt;Cell col=&quot;40&quot; disptype=&quot;normal&quot; text=&quot;TORESTPT&quot;/&gt;&#10;      &lt;Cell col=&quot;41&quot; disptype=&quot;normal&quot; text=&quot;GNRLPT&quot;/&gt;&#10;      &lt;Cell col=&quot;42&quot; disptype=&quot;normal&quot; text=&quot;OAPRVDT&quot;/&gt;&#10;      &lt;Cell col=&quot;43&quot; disptype=&quot;normal&quot; text=&quot;OAPRVNO&quot;/&gt;&#10;      &lt;Cell col=&quot;44&quot; disptype=&quot;normal&quot; text=&quot;APYALIAS&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:BARCD&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:CUSTNO&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:PAYMINFODIVCD&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:OATMSEQ&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;bind:PINNO&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;bind:FRCHCD&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;bind:FRCHNM&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;bind:PRODCD&quot;/&gt;&#10;      &lt;Cell col=&quot;8&quot; disptype=&quot;normal&quot; text=&quot;bind:PRODNM&quot;/&gt;&#10;      &lt;Cell col=&quot;9&quot; disptype=&quot;normal&quot; text=&quot;bind:MAXOILYN&quot;/&gt;&#10;      &lt;Cell col=&quot;10&quot; disptype=&quot;normal&quot; text=&quot;bind:TOAMT&quot;/&gt;&#10;      &lt;Cell col=&quot;11&quot; disptype=&quot;normal&quot; text=&quot;bind:VLIDSTRDT&quot;/&gt;&#10;      &lt;Cell col=&quot;12&quot; disptype=&quot;normal&quot; text=&quot;bind:VLIDENDDT&quot;/&gt;&#10;      &lt;Cell col=&quot;13&quot; disptype=&quot;normal&quot; text=&quot;bind:USEDIVCD&quot;/&gt;&#10;      &lt;Cell col=&quot;14&quot; disptype=&quot;normal&quot; text=&quot;bind:USEYN&quot;/&gt;&#10;      &lt;Cell col=&quot;15&quot; disptype=&quot;normal&quot; text=&quot;bind:TROWNNO&quot;/&gt;&#10;      &lt;Cell col=&quot;16&quot; disptype=&quot;normal&quot; text=&quot;bind:ORGTROWNNO&quot;/&gt;&#10;      &lt;Cell col=&quot;17&quot; disptype=&quot;normal&quot; text=&quot;bind:SALEDT&quot;/&gt;&#10;      &lt;Cell col=&quot;18&quot; disptype=&quot;normal&quot; text=&quot;bind:SALETMDAY&quot;/&gt;&#10;      &lt;Cell col=&quot;19&quot; disptype=&quot;normal&quot; text=&quot;bind:APRVDIVCD&quot;/&gt;&#10;      &lt;Cell col=&quot;20&quot; disptype=&quot;normal&quot; text=&quot;bind:FRCHCDPAYM&quot;/&gt;&#10;      &lt;Cell col=&quot;21&quot; disptype=&quot;normal&quot; text=&quot;bind:FRCHNMPAYM&quot;/&gt;&#10;      &lt;Cell col=&quot;22&quot; disptype=&quot;normal&quot; text=&quot;bind:QTY&quot;/&gt;&#10;      &lt;Cell col=&quot;23&quot; disptype=&quot;normal&quot; text=&quot;bind:AMTPAYM&quot;/&gt;&#10;      &lt;Cell col=&quot;24&quot; disptype=&quot;normal&quot; text=&quot;bind:UPRC&quot;/&gt;&#10;      &lt;Cell col=&quot;25&quot; disptype=&quot;normal&quot; text=&quot;bind:PAYMDIVCD&quot;/&gt;&#10;      &lt;Cell col=&quot;26&quot; disptype=&quot;normal&quot; text=&quot;bind:FDYNEXPTDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;27&quot; disptype=&quot;normal&quot; text=&quot;bind:AMTEXPTDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;28&quot; disptype=&quot;normal&quot; text=&quot;bind:PAYMDIVVAL&quot;/&gt;&#10;      &lt;Cell col=&quot;29&quot; disptype=&quot;normal&quot; text=&quot;bind:CRDNO&quot;/&gt;&#10;      &lt;Cell col=&quot;30&quot; disptype=&quot;normal&quot; text=&quot;bind:CCRDCOCD&quot;/&gt;&#10;      &lt;Cell col=&quot;31&quot; disptype=&quot;normal&quot; text=&quot;bind:APRVDIVCDDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;32&quot; disptype=&quot;normal&quot; text=&quot;bind:FDYNPAYMDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;33&quot; disptype=&quot;normal&quot; text=&quot;bind:AMTPAYMDETAIL&quot;/&gt;&#10;      &lt;Cell col=&quot;34&quot; disptype=&quot;normal&quot; text=&quot;bind:FDAMT&quot;/&gt;&#10;      &lt;Cell col=&quot;35&quot; disptype=&quot;normal&quot; text=&quot;bind:PAYMVAL&quot;/&gt;&#10;      &lt;Cell col=&quot;36&quot; disptype=&quot;normal&quot; text=&quot;bind:RESPCD&quot;/&gt;&#10;      &lt;Cell col=&quot;37&quot; disptype=&quot;normal&quot; text=&quot;bind:RESPMSG&quot;/&gt;&#10;      &lt;Cell col=&quot;38&quot; disptype=&quot;normal&quot; text=&quot;bind:APRVDT&quot;/&gt;&#10;      &lt;Cell col=&quot;39&quot; disptype=&quot;normal&quot; text=&quot;bind:APRVNO&quot;/&gt;&#10;      &lt;Cell col=&quot;40&quot; disptype=&quot;normal&quot; text=&quot;bind:TORESTPT&quot;/&gt;&#10;      &lt;Cell col=&quot;41&quot; disptype=&quot;normal&quot; text=&quot;bind:GNRLPT&quot;/&gt;&#10;      &lt;Cell col=&quot;42&quot; disptype=&quot;normal&quot; text=&quot;bind:OAPRVDT&quot;/&gt;&#10;      &lt;Cell col=&quot;43&quot; disptype=&quot;normal&quot; text=&quot;bind:OAPRVNO&quot;/&gt;&#10;      &lt;Cell col=&quot;44&quot; disptype=&quot;normal&quot; text=&quot;bind:APYALIAS&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;" oncelldblclick="Grd_PayHist_oncelldblclick" onheadclick="Grd_PayHist_onheadclick">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="33"/>
              <Column size="130"/>
              <Column size="0"/>
              <Column size="100"/>
              <Column size="140"/>
              <Column size="200"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="100"/>
              <Column size="110"/>
              <Column size="130"/>
              <Column size="130"/>
              <Column size="120"/>
              <Column size="70"/>
              <Column size="70"/>
            </Columns>
            <Rows>
              <Row size="24" band="head"/>
              <Row size="24"/>
            </Rows>
            <Band id="head">
              <Cell text="NO"/>
              <Cell col="1" text="매출일시"/>
              <Cell col="2" text="고객번호"/>
              <Cell col="3" text="결제정보구분"/>
              <Cell col="4" text="패턴명"/>
              <Cell col="5" text="주유소명"/>
              <Cell col="6" text="주유소명"/>
              <Cell col="7" text="상품구분코드"/>
              <Cell col="8" text="상품구분명"/>
              <Cell col="9" text="상품구분명"/>
              <Cell col="10" text="결제금액"/>
              <Cell col="11" text="단가"/>
              <Cell col="12" text="주유량"/>
              <Cell col="13" text="핀번호"/>
              <Cell col="14" text="승인구분코드"/>
              <Cell col="15" text="승인상세구분코드"/>
              <Cell col="16" text="거래고유번호"/>
              <Cell col="17" text="원거래고유번호"/>
              <Cell col="18" text="거래구분"/>
              <Cell col="19" text="예약수량"/>
              <Cell col="20" text="예약단가"/>
            </Band>
            <Band id="body">
              <Cell text="expr:currow + 1"/>
              <Cell col="1" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="expr:ds_if_payhist_record.getColumn(currow,'SALEDT') +ds_if_payhist_record.getColumn(currow,'SALETMDAY')" mask="expr:ds_if_payhist_record.getColumn(currow,'SALEDT') +ds_if_payhist_record.getColumn(currow,'SALETMDAY') == &quot;&quot;?&quot;&quot;:&quot;####-##-##_##:##:##&quot;"/>
              <Cell col="2" text="bind:CUSTNO"/>
              <Cell col="3" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="expr:ds_if_payhist_record.getColumn(currow,'PAYMINFODIVCD') == &quot;01&quot;?&quot;바로주유&quot;:(ds_if_payhist_record.getColumn(currow,'PAYMINFODIVCD') == &quot;02&quot;?&quot;예약주유&quot;:&quot;&quot;)"/>
              <Cell col="4" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:PAYALIAS"/>
              <Cell col="5" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="expr:ds_if_payhist_record.getColumn(currow,'FRCHNMPAYM') +&quot;(&quot;+ds_if_payhist_record.getColumn(currow,'FRCHCDPAYM')+&quot;)&quot;"/>
              <Cell col="6" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:FRCHNM"/>
              <Cell col="7" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:PRODCD"/>
              <Cell col="8" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:PRODNM"/>
              <Cell col="9" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:PRODNM"/>
              <Cell col="10" displaytype="number" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:AMTPAYM"/>
              <Cell col="11" displaytype="number" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:UPRCPAYM"/>
              <Cell col="12" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:QTY"/>
              <Cell col="13" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:PINNO"/>
              <Cell col="14" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="expr:ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;01&quot;?&quot;결제&quot;:(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;결제취소&quot;:&quot;&quot;)"/>
              <Cell col="15" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="expr:ds_if_payhist_record.getColumn(currow,'APRVDIVDTLCD') == &quot;0101&quot;?&quot;전체결제&quot;:(ds_if_payhist_record.getColumn(currow,'APRVDIVDTLCD') == &quot;0102&quot;?&quot;부분결제&quot;:(ds_if_payhist_record.getColumn(currow,'APRVDIVDTLCD') == &quot;0109&quot;?&quot;결제실패&quot;:(ds_if_payhist_record.getColumn(currow,'APRVDIVDTLCD') == &quot;0201&quot;?&quot;전체취소&quot;:(ds_if_payhist_record.getColumn(currow,'APRVDIVDTLCD') == &quot;0202&quot;?&quot;부분취소&quot;:(ds_if_payhist_record.getColumn(currow,'APRVDIVDTLCD') == &quot;0203&quot;?&quot;전체취소(일부)&quot;:&quot;&quot;)))))"/>
              <Cell col="16" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:TROWNNO"/>
              <Cell col="17" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:ORGTROWNNO"/>
              <Cell col="18" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:COMPCKTCD" expr="ds_if_payhist_record.getColumn(currow,'COMPCKTCD') == &quot;2200&quot;?&quot;서비스 중계허브&quot;:&quot;스마트로 무장애&quot;"/>
              <Cell col="19" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:RESVQTY"/>
              <Cell col="20" style="color:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_if_payhist_record.getColumn(currow,'APRVDIVCD') == &quot;02&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:RESVUPRC"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
      <Static id="Static01" class="sta_WFSA2_BG" position="absolute 0 0 1630 52" text=""/>
      <MaskEdit id="Msk_TotRflPay" taborder="6" text="100000" class="mae_WFSA2" position="absolute 95 6 215 24" value="0" mask="9,999" readonly="true"/>
      <Static id="Stt_TotRflAmnt" text="총주유량" class="sta_WFSA2_label" position="absolute 261 10 351 22"/>
      <Static id="Stt_TotRflPay" text="총주유금액" class="sta_WFSA2_label" position="absolute 17 10 107 22"/>
      <Button id="Btn_Srch" taborder="11" text="조회" class="btn_WFSA2_P" position="absolute 1055 4 1115 24" onclick="Btn_Srch_onclick"/>
      <Static id="Stt_SaveDiv" text="적립구분" class="sta_WFSA2_label" position="absolute 17 32 107 44"/>
      <Static id="Stt_UseOilKnd" text="사용유종" class="sta_WFSA2_label" position="absolute 261 32 351 44"/>
      <MaskEdit id="Msk_TotPt" taborder="16" class="mae_WFSA2" position="absolute 564 6 684 24" value="0" readonly="true" mask="9,999"/>
      <Static id="Stt_TotPt" text="총포인트" class="sta_WFSA2_label" position="absolute 496 10 586 22"/>
      <Static id="Stt_SrchFrmDt" text="기간" class="sta_WFSA2_label" position="absolute 737 10 795 22"/>
      <Calendar id="Cal_SrchFrmDt" taborder="17" position="absolute 792 6 892 24" class="cal_WFSA2" dateformat="yyyy-MM-dd " onkeyup="Cal_SrchFrmDt_onkeyup"/>
      <Static id="Static08" text="~" position="absolute 898 8 913 20"/>
      <Calendar id="Cal_SrchToDt" taborder="18" class="cal_WFSA2" position="absolute 912 6 1012 24" dateformat="yyyy-MM-dd" onkeyup="Cal_SrchToDt_onkeyup"/>
      <Combo id="Cmb_SaveDiv" taborder="19" class="cmb_WFSA2" position="absolute 95 27 215 47" onkeyup="Cmb_SaveDiv_onkeyup"/>
      <Combo id="Cmb_UseOilKnd" taborder="21" class="cmb_WFSA2" position="absolute 329 27 449 47" onkeyup="Cmb_UseOilKnd_onkeyup"/>
      <Combo id="Cmb_Chnl" taborder="22" class="cmb_WFSA2" position="absolute 564 27 664 47" onkeyup="Cmb_Chnl_onkeyup"/>
      <Static id="Stt_Chnl" text="채널" class="sta_WFSA2_label" position="absolute 496 32 551 44"/>
      <Static id="Stt_Affil" text="가맹점" class="sta_WFSA2_label" position="absolute 737 32 792 44"/>
      <Combo id="Cmb_Affil" taborder="23" class="cmb_WFSA2" position="absolute 792 27 932 47" onitemchanged="Cmb_Affil_onitemchanged"/>
      <Radio id="Rdo_SrchDiv" taborder="24" position="absolute 963 32 1316 50" innerdataset="@ds_rdo_div" codecolumn="CODE" direction="vertical" class="rdo_WFSA2" datacolumn="CODE_NM" onitemchanged="Rdo_SrchDiv_onitemchanged" onitemclick="Rdo_SrchDiv_onitemclick"/>
      <Button id="Btn_SendSaveHist" taborder="25" text="구매이력발송" class="btn_WFSA2_P" position="absolute 1119 4 1224 24" onclick="Btn_SendSaveHist_onclick"/>
      <Button id="Btn_CrdChange" taborder="26" text="카드바뀜" class="btn_WFSA2_P" position="absolute 1228 4 1308 24" onclick="Btn_CrdChange_onclick"/>
      <Button id="Btn_ModPt" taborder="27" text="P-조정" class="btn_WFSA2_P" position="absolute 1313 4 1383 24" onclick="Btn_ModPt_onclick"/>
      <Button id="Btn_ModLimt" taborder="28" text="한도조정" onclick="Btn_ModLimt_onclick" class="btn_WFSA2_P" position="absolute 1388 4 1468 24"/>
      <Button id="Btn_Popcorn" taborder="29" text="문화팝콘" onclick="Btn_Popcorn_onclic" class="btn_WFSA2_P" position="absolute 1640 4 1720 24" enable="false" visible="false"/>
      <Button id="Btn_Excel" taborder="30" text="엑셀" class="btn_WFSA2_P" position="absolute 1555 4 1615 24" onclick="Btn_Excel_onclick"/>
      <Button id="Btn_ecEntrIssueIns" taborder="48" text="응모쿠폰" class="btn_WFSA2_P" position="absolute 1640 27 1720 47" onclick="Btn_ecEntrIssueIns_onclick" enable="false" visible="false"/>
      <Grid id="Grd_BuyHist" taborder="31" binddataset="ds_rsv_hist_out" position="absolute 0 72 1630 264" titletext="정상카드" class="grd_WFDA2" oncellclick="Grd_BuyHist_oncellclick" cellsizingtype="both" onheadclick="Grd_BuyHist_onheadclick" autoenter="select" onkeydown="Grd_BuyHist_onkeydown">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="40"/>
              <Column size="30"/>
              <Column size="130"/>
              <Column size="130"/>
              <Column size="82"/>
              <Column size="70"/>
              <Column size="200"/>
              <Column size="200"/>
              <Column size="125"/>
              <Column size="70"/>
              <Column size="70"/>
              <Column size="60"/>
              <Column size="60"/>
              <Column size="0"/>
              <Column size="75"/>
              <Column size="90"/>
              <Column size="65"/>
              <Column size="55"/>
              <Column size="80"/>
              <Column size="102"/>
            </Columns>
            <Rows>
              <Row size="20" band="head"/>
              <Row size="20"/>
            </Rows>
            <Band id="head">
              <Cell text="NO"/>
              <Cell col="1"/>
              <Cell col="2" text="처리일시"/>
              <Cell col="3" text="카드번호"/>
              <Cell col="4" text="채널"/>
              <Cell col="5" text="적립구분"/>
              <Cell col="6" text="발생사유"/>
              <Cell col="7" text="가맹점"/>
              <Cell col="8" text="유종"/>
              <Cell col="9" text="금액"/>
              <Cell col="10" text="단가"/>
              <Cell col="11" text="주유량"/>
              <Cell col="12" text="포인트"/>
              <Cell col="13" text="가용P"/>
              <Cell col="14" text="소멸일"/>
              <Cell col="15" text="결제유형"/>
              <Cell col="16" text="적용포인트"/>
              <Cell col="17" text="적립기준"/>
              <Cell col="18" text="적립유형"/>
              <Cell col="19" text="실취소일"/>
            </Band>
            <Band id="body">
              <Cell text="expr:currow + 1"/>
              <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
              <Cell col="2" style="color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:SALE_DTIME_UI" mask="@@@@-@@-@@ @@:@@:@@"/>
              <Cell col="3" displaytype="normal" edittype="none" style="color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:CRD_NO" mask="expr:ds_rsv_hist_out.getColumn(currow,'CARD_NO') == &quot;&quot;?&quot;&quot;:&quot;####-####-####-####&quot;"/>
              <Cell col="4" style="align:left;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:CHNL_DIV_NM"/>
              <Cell col="5" style="align:left;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:RSV_USE_DIV_NM"/>
              <Cell col="6" style="align:left;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);font:EXPR(ds_rsv_hist_out.getColumn(currow,'POINT_REASON') == &quot;9201&quot;?&quot;Dotum,9,underline&quot;:(ds_rsv_hist_out.getColumn(currow,'POINT_REASON') == &quot;9202&quot;?&quot;Dotum,9,underline&quot;:&quot;Dotum,9&quot;));cursor:EXPR(ds_rsv_hist_out.getColumn(currow,'POINT_REASON') == &quot;9201&quot;?&quot;hand&quot;:(ds_rsv_hist_out.getColumn(currow,'POINT_REASON') == &quot;9202&quot;?&quot;hand&quot;:&quot;default&quot;));selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectfont:EXPR(ds_rsv_hist_out.getColumn(currow,'POINT_REASON') == &quot;9201&quot;?&quot;Dotum,9,underline&quot;:(ds_rsv_hist_out.getColumn(currow,'POINT_REASON') == &quot;9202&quot;?&quot;Dotum,9,underline&quot;:&quot;Dotum,9&quot;));" text="bind:POINT_REASON_NAME" mask="expr:ds_rsv_hist_out.getColumn(currow,'POINT_REASON_CNTT') == &quot;&quot;?ds_rsv_hist_out.getColumn(currow,'POINT_REASON_NAME'): ds_rsv_hist_out.getColumn(currow,'POINT_REASON_NAME')"/>
              <Cell col="7" style="align:left;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:FRCH" expr="expr:ds_rsv_hist_out.getColumn(currow,'FRCH_NM') == &quot;&quot;?&quot;&quot;: ds_rsv_hist_out.getColumn(currow,'FRCH_NM') + '[' +ds_rsv_hist_out.getColumn(currow,'FRCH_CD') + ']'"/>
              <Cell col="8" style="align:left;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:PROD_CD_NM"/>
              <Cell col="9" displaytype="number" style="align:right;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:AMT" maskchar=" " displayexpdec="-1"/>
              <Cell col="10" displaytype="number" style="align:right;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:UPRC" maskchar=" "/>
              <Cell col="11" displaytype="number" style="align:right;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:QTY" maskchar=" "/>
              <Cell col="12" displaytype="number" style="align:right;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:BAL_PT" maskchar=" "/>
              <Cell col="13" displaytype="number" style="align:right;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:USBL_PT" maskchar=" "/>
              <Cell col="14" displaytype="normal" style="color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:VANISH_INTEND_DATE" mask="expr:ds_rsv_hist_out.getColumn(currow,'VANISH_INTEND_DATE') ==&quot;&quot;?&quot;&quot;:&quot;@@@@-@@-@@&quot;"/>
              <Cell col="15" style="align:left;color:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);color2:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);selectcolor:EXPR(ds_rsv_hist_out.getColumn(currow,'CNCL_YN') == &quot;Y&quot;?&quot;orangered&quot;:&quot;#333333ff&quot;);" text="bind:PAYM_TP_NM"/>
              <Cell col="16" text="bind:APPL_PT"/>
              <Cell col="17" text="bind:RSV_STD_CD_NM"/>
              <Cell col="18" text="bind:CRD_MDA_CD_NM"/>
              <Cell col="19" text="bind:SUB_CO_APPRV_DATE" mask="@@@@-@@-@@"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
      <Button id="Btn_AddScrnHei" taborder="32" text="+" class="btn_WFDA_plus" position="absolute 1591 55 1605 69" style="padding:0 0 0 1; align:left middle; " onclick="Btn_AddScrnHei_onclick"/>
      <Button id="Btn_SubScrnHei" taborder="33" text="-" class="btn_WFDA_plus" position="absolute 1609 55 1623 69" style="padding:0 0 0 1; align:left middle; " onclick="Btn_SubScrnHei_onclick"/>
      <MaskEdit id="Msk_TotRflAmnt" taborder="38" value="0" text="0" readonly="true" mask="9,999.99" class="mae_WFSA2" position="absolute 329 6 449 24"/>
      <Button id="Btn_More" taborder="41" class="btn_WFDA_more" position="absolute 1538 54 1579 69" visible="false" onclick="Btn_More_onclick"/>
      <Static id="Stt_TotRflAmnt00" text="주유량1 : " position="absolute 17 56 107 68" class="sta_WFSA2_label" visible="false"/>
      <MaskEdit id="Msk_BefTotAmt1" taborder="42" text="0" readonly="true" mask="9,999" position="absolute 95 53 215 71" style="border:0 double #afd0cdff #ffffffff;align:left middle;" class="mae_WFSA2" visible="false"/>
      <Static id="Stt_TotRflAmnt2" text="주유량2 : " class="sta_WFSA2_label" position="absolute 227 56 351 68" visible="false"/>
      <MaskEdit id="Msk_BefTotAmt2" taborder="43" text="0" readonly="true" mask="9,999" position="absolute 313 53 433 71" style="border:0 double #afd0cdff #ffffffff;align:left middle;" class="mae_WFSA2" visible="false"/>
      <Static id="Stt_TotRflAmnt3" text="주유량3 : " class="sta_WFSA2_label" position="absolute 464 56 610 68" visible="false"/>
      <MaskEdit id="Msk_BefTotAmt3" taborder="44" text="0" readonly="true" mask="9,999" position="absolute 556 53 676 71" style="border:0 double #afd0cdff #ffffffff;align:left middle;" class="mae_WFSA2" visible="false"/>
      <Static id="Stt_TotRflAmnt01" text="BW 주유금액" class="sta_WFSA2_label" position="absolute 809 56 899 68" visible="false"/>
      <MaskEdit id="sta_bw1" taborder="45" readonly="true" mask="9,999" class="mae_WFSA2" position="absolute 903 53 1023 71" style="border:0 double #afd0cdff #ffffffff; align:left middle; " visible="false"/>
      <Static id="Stt_TotRflAmnt04" text="BW 주유량" class="sta_WFSA2_label" position="absolute 1053 56 1143 68" visible="false"/>
      <MaskEdit id="sta_bw2" taborder="46" readonly="true" mask="9,999" class="mae_WFSA2" position="absolute 1137 53 1257 71" style="border:0 double #afd0cdff #ffffffff; align:left middle; " visible="false"/>
      <Static id="Stt_TotRflAmnt05" text="BW 포인트" class="sta_WFSA2_label" position="absolute 1288 56 1378 68" visible="false"/>
      <MaskEdit id="sta_bw3" taborder="47" readonly="true" mask="9,999" class="mae_WFSA2" position="absolute 1372 53 1492 71" style="border:0 double #afd0cdff #ffffffff; align:left middle; " visible="false"/>
      <Static id="Stt_TotRflAmnt06" text="BW 총합" class="sta_WFSA2_label" position="absolute 721 56 792 68" style="color:deeppink;" visible="false"/>
      <!--<Button id="Btn_cmpInfo" taborder="49" text=" 캠페인" class="btn_WFSA2_P" position="absolute 1405 27 1465 47" onclick="Btn_cmpInfo_onclick"/>-->
      <Button id="Btn_evCharge" taborder="49" text="EV 충전이력" class="btn_WFSA2_P" position="absolute 1388 27 1468 47" onclick="Btn_evCharge_onclick" style="background:#86c3c8ff no-repeat 10 50;"/>
      <Button id="Btn_vanInfo" taborder="50" text="밴사" onclick="Btn_vanInfo_onclick" class="btn_WFSA2_P" position="absolute 1472 4 1551 24"/>
      <Button id="Btn_Srch00" taborder="1" text="  주유이력" onclick="Btn_PaySrch_onclick" class="btn_WFSA2_P" position="absolute 1316 27 1384 47"/>
      <Grid id="Grd_ChargeHist" class="grd_WFDA2" taborder="1" binddataset="ds_charge_hist_record" autoenter="select" useinputpanel="false" cellsizingtype="both" onheadclick="Grd_ChargeHist_onheadclick" visible="false" position="absolute 0 72 1630 264" titletext="정상카드" oncelldblclick="Grd_ChargeHist_oncelldblclick" nodatatext="조회된 결과가 없습니다.">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="40"/>
              <Column size="150"/>
              <Column size="150"/>
              <Column size="150"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="0"/>
              <Column size="80"/>
              <Column size="0"/>
              <Column size="82"/>
              <Column size="0"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="100"/>
              <Column size="100"/>
            </Columns>
            <Rows>
              <Row size="24" band="head"/>
              <Row size="24"/>
            </Rows>
            <Band id="head">
              <Cell text="NO"/>
              <Cell col="1" text="매출일시"/>
              <Cell col="2" text="카드번호"/>
              <Cell col="3" text="충전소명"/>
              <Cell col="4" text="고객번호"/>
              <Cell col="5" text="매출일자"/>
              <Cell col="6" text="매출시간"/>
              <Cell col="7" text="SITE 코드"/>
              <Cell col="8" text="전체결제금액"/>
              <Cell col="9" text="최종결제금액"/>
              <Cell col="10" text="최종할인금액"/>
              <Cell col="11" text="충전량"/>
              <Cell col="12" text="할인단가"/>
              <Cell col="13" text="충전단가"/>
              <Cell col="14" text="거래유형코드"/>
              <Cell col="15" text="결제상태"/>
              <Cell col="16" text="결제구분코드"/>
              <Cell col="17" text="거래구분"/>
              <Cell col="18" text="무료충전량(kWh)"/>
              <Cell col="19" text="사용포인트"/>
              <Cell col="20" text="적립포인트"/>
              <Cell col="21" text="충전시작일시"/>
              <Cell col="22" text="충전종료일시"/>
              <Cell col="23" text="최종할인금액"/>
              <Cell col="24" text="승인번호"/>
              <Cell col="25" text="거래고유번호"/>
              <Cell col="26" text="pg사 승인번호"/>
              <Cell col="27" text="결제처리여부"/>
              <Cell col="28" text="바로충전패턴SEQ"/>
              <Cell col="29" text="별칭"/>
              <Cell col="30" text="다이나믹 프라이싱"/>
            </Band>
            <Band id="body">
              <Cell text="expr:currow + 1"/>
              <Cell col="1" text="bind:SELLDT" mask="@@@@-@@-@@ @@:@@:@@"/>
              <Cell col="2" text="bind:RFCARDNO" mask="expr:ds_charge_hist_record.getColumn(currow,'RFCARDNO') == &quot;&quot;?&quot;&quot;:&quot;####-####-####-####&quot;"/>
              <Cell col="3" text="bind:STATIONNM"/>
              <Cell col="4" text="bind:CUSTNO"/>
              <Cell col="5" text="bind:SELLDT"/>
              <Cell col="6" text="bind:SELLTM"/>
              <Cell col="7" text="bind:SITECD"/>
              <Cell col="8" displaytype="number" text="bind:TOTPAYAMT"/>
              <Cell col="9" text="bind:FNLPAYAMT"/>
              <Cell col="10" text="bind:DCPRC"/>
              <Cell col="11" text="bind:TOTCHARGEQTY"/>
              <Cell col="12" text="bind:DCUNTPRC"/>
              <Cell col="13" text="bind:CHARGEUNTPRC"/>
              <Cell col="14" text="bind:TRANSTYCD"/>
              <Cell col="15" text="bind:PAYSXNCD" expr="ds_charge_hist_record.getColumn(currow,'CHARGESTAT') == &quot;00&quot;?&quot;결제성공&quot;:&quot;결제실패&quot;"/>
              <Cell col="16" text="bind:PAYSXNCD"/>
              <Cell col="17" text="bind:TRANSSXNCD" expr="ds_charge_hist_record.getColumn(currow,'TRANSSXNCD') == &quot;01&quot;?&quot;바코드&quot;:&quot;RF태깅&quot;"/>
              <Cell col="18" text="bind:FREECHARGEQTY"/>
              <Cell col="19" text="bind:USEPNT"/>
              <Cell col="20" text="bind:SAVEPNT"/>
              <Cell col="21" text="bind:CHARGESTADTTM"/>
              <Cell col="22" text="bind:CHARGEFINDTTM"/>
              <Cell col="23" text="bind:DCPRC"/>
              <Cell col="24" text="bind:PGAUTHCD"/>
              <Cell col="25" text="bind:TRANSDISTNTNO"/>
              <Cell col="26" text="bind:PGAUTHCD"/>
              <Cell col="27" text="bind:PROYN"/>
              <Cell col="28" text="bind:PTTRNSEQ"/>
              <Cell col="29" text="bind:PTTRNNICK"/>
              <Cell col="30" text="bind:DPID" expr="ds_charge_hist_record.getColumn(currow,'DPID') == &quot;0&quot;?&quot;N&quot;:(ds_charge_hist_record.getColumn(currow,'DPID') == &quot;&quot;?&quot;N&quot;:&quot;Y&quot;)"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
      <Button id="Btn_EPnt" taborder="1" text="E-Point" class="btn_WFSA2_P" position="absolute 1472 27 1551 47" onclick="Btn_EPnt_onclick"/>
      <Grid id="Grd_EventPoint" class="grd_WFDA2" taborder="1" autoenter="select" useinputpanel="false" cellsizingtype="both" nodatatext="조회된 결과가 없습니다." visible="false" position="absolute 0 72 1630 264" titletext="정상카드" binddataset="ds_if_eventptHist_record" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;SALE_DT&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;CRD_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;APRV_SEQ&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;CHNL_DIV_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;SALE_DTIME&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;SALE_TMDAY&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;CHNL_DIV_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;RSV_USE_DIV_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;8&quot; disptype=&quot;normal&quot; text=&quot;RSV_USE_DIV_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;9&quot; disptype=&quot;normal&quot; text=&quot;PCKT_TP_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;10&quot; disptype=&quot;normal&quot; text=&quot;PCKT_TP_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;11&quot; disptype=&quot;normal&quot; text=&quot;COM_PCKT_ORG_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;12&quot; disptype=&quot;normal&quot; text=&quot;COM_PCKT_ORG_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;13&quot; disptype=&quot;normal&quot; text=&quot;FRCH_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;14&quot; disptype=&quot;normal&quot; text=&quot;FRCH_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;15&quot; disptype=&quot;normal&quot; text=&quot;CHAS_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;16&quot; disptype=&quot;normal&quot; text=&quot;PAYM_TP_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;17&quot; disptype=&quot;normal&quot; text=&quot;PAYM_TP_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;18&quot; disptype=&quot;normal&quot; text=&quot;PROD_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;19&quot; disptype=&quot;normal&quot; text=&quot;PROD_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;20&quot; disptype=&quot;normal&quot; text=&quot;CUST_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;21&quot; disptype=&quot;normal&quot; text=&quot;QTY&quot;/&gt;&#10;      &lt;Cell col=&quot;22&quot; disptype=&quot;normal&quot; text=&quot;UPRC&quot;/&gt;&#10;      &lt;Cell col=&quot;23&quot; disptype=&quot;normal&quot; text=&quot;AMT&quot;/&gt;&#10;      &lt;Cell col=&quot;24&quot; disptype=&quot;normal&quot; text=&quot;EVNT_PT&quot;/&gt;&#10;      &lt;Cell col=&quot;25&quot; disptype=&quot;normal&quot; text=&quot;CRD_REST_PT&quot;/&gt;&#10;      &lt;Cell col=&quot;26&quot; disptype=&quot;normal&quot; text=&quot;CUST_REST_PT&quot;/&gt;&#10;      &lt;Cell col=&quot;27&quot; disptype=&quot;normal&quot; text=&quot;TR_OCUR_RSN_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;28&quot; disptype=&quot;normal&quot; text=&quot;TR_OCUR_RSN_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;29&quot; disptype=&quot;normal&quot; text=&quot;TR_OCUR_RSN_CNTT&quot;/&gt;&#10;      &lt;Cell col=&quot;30&quot; disptype=&quot;normal&quot; text=&quot;APRV_DT&quot;/&gt;&#10;      &lt;Cell col=&quot;31&quot; disptype=&quot;normal&quot; text=&quot;APRV_TMDAY&quot;/&gt;&#10;      &lt;Cell col=&quot;32&quot; disptype=&quot;normal&quot; text=&quot;APRV_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;33&quot; disptype=&quot;normal&quot; text=&quot;OAPRV_DT&quot;/&gt;&#10;      &lt;Cell col=&quot;34&quot; disptype=&quot;normal&quot; text=&quot;OAPRV_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;35&quot; disptype=&quot;normal&quot; text=&quot;RSNO_TR_YN&quot;/&gt;&#10;      &lt;Cell col=&quot;36&quot; disptype=&quot;normal&quot; text=&quot;CRD_MDA_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;37&quot; disptype=&quot;normal&quot; text=&quot;CRD_MDA_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;38&quot; disptype=&quot;normal&quot; text=&quot;RSV_STD_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;39&quot; disptype=&quot;normal&quot; text=&quot;CPTV_EVNT_PT_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;40&quot; disptype=&quot;normal&quot; text=&quot;CAMP_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;41&quot; disptype=&quot;normal&quot; text=&quot;OFR_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;42&quot; disptype=&quot;normal&quot; text=&quot;VANISH_INTEND_DATE&quot;/&gt;&#10;      &lt;Cell col=&quot;43&quot; disptype=&quot;normal&quot; text=&quot;FILLER_1&quot;/&gt;&#10;      &lt;Cell col=&quot;44&quot; disptype=&quot;normal&quot; text=&quot;FILLER_2&quot;/&gt;&#10;      &lt;Cell col=&quot;45&quot; disptype=&quot;normal&quot; text=&quot;FILLER_3&quot;/&gt;&#10;      &lt;Cell col=&quot;46&quot; disptype=&quot;normal&quot; text=&quot;INPT_DTIME&quot;/&gt;&#10;      &lt;Cell col=&quot;47&quot; disptype=&quot;normal&quot; text=&quot;INPT_USER_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;48&quot; disptype=&quot;normal&quot; text=&quot;INPT_IP&quot;/&gt;&#10;      &lt;Cell col=&quot;49&quot; disptype=&quot;normal&quot; text=&quot;MOD_DTIME&quot;/&gt;&#10;      &lt;Cell col=&quot;50&quot; disptype=&quot;normal&quot; text=&quot;MOD_USER_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;51&quot; disptype=&quot;normal&quot; text=&quot;MOD_IP&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:SALE_DT&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:CRD_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:APRV_SEQ&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:CHNL_DIV_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;bind:SALE_DTIME&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;bind:SALE_TMDAY&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;bind:CHNL_DIV_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;bind:RSV_USE_DIV_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;8&quot; disptype=&quot;normal&quot; text=&quot;bind:RSV_USE_DIV_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;9&quot; disptype=&quot;normal&quot; text=&quot;bind:PCKT_TP_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;10&quot; disptype=&quot;normal&quot; text=&quot;bind:PCKT_TP_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;11&quot; disptype=&quot;normal&quot; text=&quot;bind:COM_PCKT_ORG_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;12&quot; disptype=&quot;normal&quot; text=&quot;bind:COM_PCKT_ORG_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;13&quot; disptype=&quot;normal&quot; text=&quot;bind:FRCH_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;14&quot; disptype=&quot;normal&quot; text=&quot;bind:FRCH_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;15&quot; disptype=&quot;normal&quot; text=&quot;bind:CHAS_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;16&quot; disptype=&quot;normal&quot; text=&quot;bind:PAYM_TP_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;17&quot; disptype=&quot;normal&quot; text=&quot;bind:PAYM_TP_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;18&quot; disptype=&quot;normal&quot; text=&quot;bind:PROD_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;19&quot; disptype=&quot;normal&quot; text=&quot;bind:PROD_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;20&quot; disptype=&quot;normal&quot; text=&quot;bind:CUST_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;21&quot; disptype=&quot;normal&quot; text=&quot;bind:QTY&quot;/&gt;&#10;      &lt;Cell col=&quot;22&quot; disptype=&quot;normal&quot; text=&quot;bind:UPRC&quot;/&gt;&#10;      &lt;Cell col=&quot;23&quot; disptype=&quot;normal&quot; text=&quot;bind:AMT&quot;/&gt;&#10;      &lt;Cell col=&quot;24&quot; disptype=&quot;normal&quot; text=&quot;bind:EVNT_PT&quot;/&gt;&#10;      &lt;Cell col=&quot;25&quot; disptype=&quot;normal&quot; text=&quot;bind:CRD_REST_PT&quot;/&gt;&#10;      &lt;Cell col=&quot;26&quot; disptype=&quot;normal&quot; text=&quot;bind:CUST_REST_PT&quot;/&gt;&#10;      &lt;Cell col=&quot;27&quot; disptype=&quot;normal&quot; text=&quot;bind:TR_OCUR_RSN_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;28&quot; disptype=&quot;normal&quot; text=&quot;bind:TR_OCUR_RSN_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;29&quot; disptype=&quot;normal&quot; text=&quot;bind:TR_OCUR_RSN_CNTT&quot;/&gt;&#10;      &lt;Cell col=&quot;30&quot; disptype=&quot;normal&quot; text=&quot;bind:APRV_DT&quot;/&gt;&#10;      &lt;Cell col=&quot;31&quot; disptype=&quot;normal&quot; text=&quot;bind:APRV_TMDAY&quot;/&gt;&#10;      &lt;Cell col=&quot;32&quot; disptype=&quot;normal&quot; text=&quot;bind:APRV_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;33&quot; disptype=&quot;normal&quot; text=&quot;bind:OAPRV_DT&quot;/&gt;&#10;      &lt;Cell col=&quot;34&quot; disptype=&quot;normal&quot; text=&quot;bind:OAPRV_NO&quot;/&gt;&#10;      &lt;Cell col=&quot;35&quot; disptype=&quot;normal&quot; text=&quot;bind:RSNO_TR_YN&quot;/&gt;&#10;      &lt;Cell col=&quot;36&quot; disptype=&quot;normal&quot; text=&quot;bind:CRD_MDA_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;37&quot; disptype=&quot;normal&quot; text=&quot;bind:CRD_MDA_CD_NM&quot;/&gt;&#10;      &lt;Cell col=&quot;38&quot; disptype=&quot;normal&quot; text=&quot;bind:RSV_STD_CD&quot;/&gt;&#10;      &lt;Cell col=&quot;39&quot; disptype=&quot;normal&quot; text=&quot;bind:CPTV_EVNT_PT_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;40&quot; disptype=&quot;normal&quot; text=&quot;bind:CAMP_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;41&quot; disptype=&quot;normal&quot; text=&quot;bind:OFR_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;42&quot; disptype=&quot;normal&quot; text=&quot;bind:VANISH_INTEND_DATE&quot;/&gt;&#10;      &lt;Cell col=&quot;43&quot; disptype=&quot;normal&quot; text=&quot;bind:FILLER_1&quot;/&gt;&#10;      &lt;Cell col=&quot;44&quot; disptype=&quot;normal&quot; text=&quot;bind:FILLER_2&quot;/&gt;&#10;      &lt;Cell col=&quot;45&quot; disptype=&quot;normal&quot; text=&quot;bind:FILLER_3&quot;/&gt;&#10;      &lt;Cell col=&quot;46&quot; disptype=&quot;normal&quot; text=&quot;bind:INPT_DTIME&quot;/&gt;&#10;      &lt;Cell col=&quot;47&quot; disptype=&quot;normal&quot; text=&quot;bind:INPT_USER_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;48&quot; disptype=&quot;normal&quot; text=&quot;bind:INPT_IP&quot;/&gt;&#10;      &lt;Cell col=&quot;49&quot; disptype=&quot;normal&quot; text=&quot;bind:MOD_DTIME&quot;/&gt;&#10;      &lt;Cell col=&quot;50&quot; disptype=&quot;normal&quot; text=&quot;bind:MOD_USER_ID&quot;/&gt;&#10;      &lt;Cell col=&quot;51&quot; disptype=&quot;normal&quot; text=&quot;bind:MOD_IP&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;" oncellclick="Grd_EventPoint_oncellclick">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="80"/>
              <Column size="150"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="150"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="100"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="200"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="100"/>
              <Column size="0"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="100"/>
              <Column size="100"/>
              <Column size="100"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="100"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="80"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="80"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="50"/>
            </Columns>
            <Rows>
              <Row size="24" band="head"/>
              <Row size="24"/>
            </Rows>
            <Band id="head">
              <Cell text="매출일자"/>
              <Cell col="1" text="보너스카드번호"/>
              <Cell col="2" text="APRV_SEQ"/>
              <Cell col="3" text="CHNL_DIV_CD"/>
              <Cell col="4" text="매출일시"/>
              <Cell col="5" text="SALE_TMDAY"/>
              <Cell col="6" text="CHNL_DIV_CD_NM"/>
              <Cell col="7" text="RSV_USE_DIV_CD"/>
              <Cell col="8" text="적립구분"/>
              <Cell col="9" text="PCKT_TP_CD"/>
              <Cell col="10" text="PCKT_TP_CD_NM"/>
              <Cell col="11" text="COM_PCKT_ORG_CD"/>
              <Cell col="12" text="COM_PCKT_ORG_CD_NM"/>
              <Cell col="13" text="FRCH_CD"/>
              <Cell col="14" text="가맹점명"/>
              <Cell col="15" text="CHAS_NO"/>
              <Cell col="16" text="PAYM_TP_CD"/>
              <Cell col="17" text="PAYM_TP_CD_NM"/>
              <Cell col="18" text="PROD_CD"/>
              <Cell col="19" text="상품코드명"/>
              <Cell col="20" text="고객번호"/>
              <Cell col="21" text="매출수량"/>
              <Cell col="22" text="단가금액"/>
              <Cell col="23" text="매출금액"/>
              <Cell col="24" text="이벤트포인트"/>
              <Cell col="25" text="카드잔여포인트"/>
              <Cell col="26" text="고객잔여포인트"/>
              <Cell col="27" text="TR_OCUR_RSN_CD"/>
              <Cell col="28" text="TR_OCUR_RSN_CD_NM"/>
              <Cell col="29" text="TR_OCUR_RSN_CNTT"/>
              <Cell col="30" text="승인일자"/>
              <Cell col="31" text="승인일자"/>
              <Cell col="32" text="APRV_TMDAY"/>
              <Cell col="33" text="거래승인번호"/>
              <Cell col="34" text="OAPRV_DT"/>
              <Cell col="35" text="OAPRV_NO"/>
              <Cell col="36" text="RSNO_TR_YN"/>
              <Cell col="37" text="CRD_MDA_CD"/>
              <Cell col="38" text="CRD_MDA_CD_NM"/>
              <Cell col="39" text="RSV_STD_CD"/>
              <Cell col="40" text="CPTV_EVNT_PT_ID"/>
              <Cell col="41" text="CAMP_ID"/>
              <Cell col="42" text="OFR_ID"/>
              <Cell col="43" text="소멸예정일자"/>
              <Cell col="44" text="FILLER_1"/>
              <Cell col="45" text="FILLER_2"/>
              <Cell col="46" text="FILLER_3"/>
              <Cell col="47" text="INPT_DTIME"/>
              <Cell col="48" text="INPT_USER_ID"/>
              <Cell col="49" text="INPT_IP"/>
              <Cell col="50" text="MOD_DTIME"/>
              <Cell col="51" text="MOD_USER_ID"/>
              <Cell col="52" text="MOD_IP"/>
              <Cell col="53" text="복구"/>
            </Band>
            <Band id="body">
              <Cell text="bind:SALE_DT" mask="####-##-##"/>
              <Cell col="1" text="bind:CRD_NO" mask="expr:ds_if_eventptHist_record.getColumn(currow,'CRD_NO') == &quot;&quot;?&quot;&quot;:&quot;####-####-####-####&quot;"/>
              <Cell col="2" text="bind:APRV_SEQ"/>
              <Cell col="3" text="bind:CHNL_DIV_CD"/>
              <Cell col="4" text="bind:SALE_DTIME"/>
              <Cell col="5" text="bind:SALE_TMDAY"/>
              <Cell col="6" text="bind:CHNL_DIV_CD_NM"/>
              <Cell col="7" text="bind:RSV_USE_DIV_CD"/>
              <Cell col="8" text="bind:RSV_USE_DIV_CD_NM"/>
              <Cell col="9" text="bind:PCKT_TP_CD"/>
              <Cell col="10" text="bind:PCKT_TP_CD_NM"/>
              <Cell col="11" text="bind:COM_PCKT_ORG_CD"/>
              <Cell col="12" text="bind:COM_PCKT_ORG_CD_NM"/>
              <Cell col="13" text="bind:FRCH_CD"/>
              <Cell col="14" text="bind:FRCH_NM"/>
              <Cell col="15" text="bind:CHAS_NO"/>
              <Cell col="16" text="bind:PAYM_TP_CD"/>
              <Cell col="17" text="bind:PAYM_TP_CD_NM"/>
              <Cell col="18" text="bind:PROD_CD"/>
              <Cell col="19" text="bind:PROD_CD_NM"/>
              <Cell col="20" text="bind:CUST_NO"/>
              <Cell col="21" displaytype="number" text="bind:QTY"/>
              <Cell col="22" displaytype="number" text="bind:UPRC"/>
              <Cell col="23" displaytype="number" text="bind:AMT"/>
              <Cell col="24" displaytype="number" text="bind:EVNT_PT"/>
              <Cell col="25" displaytype="number" text="bind:CRD_REST_PT"/>
              <Cell col="26" displaytype="number" text="bind:CUST_REST_PT"/>
              <Cell col="27" text="bind:TR_OCUR_RSN_CD"/>
              <Cell col="28" text="bind:TR_OCUR_RSN_CD_NM"/>
              <Cell col="29" text="bind:TR_OCUR_RSN_CNTT"/>
              <Cell col="30" text="bind:APRV_DT" mask="expr:ds_if_eventptHist_record.getColumn(currow,'APRV_DT') == &quot;&quot;?&quot;&quot;:&quot;####-##-##&quot;"/>
              <Cell col="31" text="bind:APRV_DT"/>
              <Cell col="32" text="bind:APRV_TMDAY"/>
              <Cell col="33" text="bind:APRV_NO"/>
              <Cell col="34" text="bind:OAPRV_DT"/>
              <Cell col="35" text="bind:OAPRV_NO"/>
              <Cell col="36" text="bind:RSNO_TR_YN"/>
              <Cell col="37" text="bind:CRD_MDA_CD"/>
              <Cell col="38" text="bind:CRD_MDA_CD_NM"/>
              <Cell col="39" text="bind:RSV_STD_CD"/>
              <Cell col="40" text="bind:CPTV_EVNT_PT_ID"/>
              <Cell col="41" text="bind:CAMP_ID"/>
              <Cell col="42" text="bind:OFR_ID"/>
              <Cell col="43" text="bind:VANISH_INTEND_DATE" mask="expr:ds_if_eventptHist_record.getColumn(currow,'VANISH_INTEND_DATE') == &quot;&quot;?&quot;&quot;:&quot;####-##-##&quot;"/>
              <Cell col="44" text="bind:FILLER_1"/>
              <Cell col="45" text="bind:FILLER_2"/>
              <Cell col="46" text="bind:FILLER_3"/>
              <Cell col="47" text="bind:INPT_DTIME"/>
              <Cell col="48" text="bind:INPT_USER_ID"/>
              <Cell col="49" text="bind:INPT_IP"/>
              <Cell col="50" text="bind:MOD_DTIME"/>
              <Cell col="51" text="bind:MOD_USER_ID"/>
              <Cell col="52" text="bind:MOD_IP"/>
              <Cell col="53" displaytype="expr:expr:ds_if_eventptHist_record.getColumn(currow,'RSV_USE_DIV_CD') == &quot;05&quot;?&quot;button&quot;:&quot;none&quot;" edittype="expr:expr:ds_if_eventptHist_record.getColumn(currow,'RSV_USE_DIV_CD') == &quot;05&quot;?&quot;button&quot;:&quot;none&quot;" text="expr:ds_if_eventptHist_record.getColumn(currow,'RSV_USE_DIV_CD') == &quot;05&quot;?&quot;복구&quot;:&quot;&quot;"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
    </Layout>
    <Objects>
      <Dataset id="ds_rdo_div" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NM">전체조회</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NM">카드조회</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="CODE_NM">BW전체조회</Col>
          </Row>
          <Row>
            <Col id="CODE">4</Col>
            <Col id="CODE_NM">BW카드조회</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_get_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_set_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_rsv_hist_out" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="SALE_DTIME_UI" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="CHNL_DIV" type="STRING" size="256"/>
          <Column id="CHNL_DIV_NM" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_NM" type="STRING" size="256"/>
          <Column id="POINT_REASON" type="STRING" size="256"/>
          <Column id="POINT_REASON_NAME" type="STRING" size="256"/>
          <Column id="POINT_REASON_CNTT" type="STRING" size="256"/>
          <Column id="FRCH" type="STRING" size="256"/>
          <Column id="FRCH_CD" type="STRING" size="256"/>
          <Column id="FRCH_NM" type="STRING" size="256"/>
          <Column id="PROD_CD" type="STRING" size="256"/>
          <Column id="PROD_CD_NM" type="STRING" size="256"/>
          <Column id="AMT" type="INT" size="256"/>
          <Column id="UPRC" type="INT" size="256"/>
          <Column id="QTY" type="FLOAT" size="256"/>
          <Column id="BAL_PT" type="INT" size="256"/>
          <Column id="USBL_PT" type="INT" size="256"/>
          <Column id="VANISH_INTEND_DATE" type="STRING" size="256"/>
          <Column id="PAYM_TP_CD" type="STRING" size="256"/>
          <Column id="PAYM_TP_NM" type="STRING" size="256"/>
          <Column id="DETAIL_TYPE" type="STRING" size="256"/>
          <Column id="DETAIL_TYPE_NAME" type="STRING" size="256"/>
          <Column id="CNCL_YN" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CD" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CD_NM" type="STRING" size="256"/>
          <Column id="RSV_STD_CD" type="STRING" size="256"/>
          <Column id="RSV_STD_CD_NM" type="STRING" size="256"/>
          <Column id="CRD_MDA_CD" type="STRING" size="256"/>
          <Column id="CRD_MDA_CD_NM" type="STRING" size="256"/>
          <Column id="APPL_PT" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_CD" type="STRING" size="256"/>
          <Column id="SUB_CO_APPRV_DATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <ExportObject id="ExportObject00" exporttype="0" exporteventtype="itemrecord"/>
      <Dataset id="ds_get_param_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_trnpt_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_trnpt_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_trnpt_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_trnpt_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_trnpt_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_trnpt_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHNL_DIV_CD" type="STRING" size="256"/>
          <Column id="CHNL_DIV_NM" type="STRING" size="256"/>
          <Column id="SALE_DTIME" type="STRING" size="256"/>
          <Column id="SALE_DTIME_UI" type="STRING" size="256"/>
          <Column id="APRV_SEQ" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_CD" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_NM" type="STRING" size="256"/>
          <Column id="PCKT_TP_CD" type="STRING" size="256"/>
          <Column id="PCKT_TP_NM" type="STRING" size="256"/>
          <Column id="FRCH_CD" type="STRING" size="256"/>
          <Column id="FRCH_NM" type="STRING" size="256"/>
          <Column id="ENTR_NO" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="CUST_NO" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="PAYM_TP_CD" type="STRING" size="256"/>
          <Column id="PAYM_TP_NM" type="STRING" size="256"/>
          <Column id="APRV_DT" type="STRING" size="256"/>
          <Column id="APRV_TMDAY" type="STRING" size="256"/>
          <Column id="APRV_NO" type="STRING" size="256"/>
          <Column id="OAPRV_DT" type="STRING" size="256"/>
          <Column id="OAPRV_NO" type="STRING" size="256"/>
          <Column id="PROD_CD" type="STRING" size="256"/>
          <Column id="PROD_CD_NM" type="STRING" size="256"/>
          <Column id="QTY" type="STRING" size="256"/>
          <Column id="UPRC" type="STRING" size="256"/>
          <Column id="AMT" type="STRING" size="256"/>
          <Column id="GNRL_PT" type="STRING" size="256"/>
          <Column id="SPCL_PT" type="STRING" size="256"/>
          <Column id="CPRT_PT" type="STRING" size="256"/>
          <Column id="BAL_PT" type="STRING" size="256"/>
          <Column id="USBL_PT" type="STRING" size="256"/>
          <Column id="TOT_ACUM_PT" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_CD" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_NM" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_CNTT" type="STRING" size="256"/>
          <Column id="TRSF_APLY_NO" type="STRING" size="256"/>
          <Column id="ERR_OCUR_RSN_CD" type="STRING" size="256"/>
          <Column id="ERR_OCUR_RSN_NM" type="STRING" size="256"/>
          <Column id="SALE_DT" type="STRING" size="256"/>
          <Column id="SALE_TMDAY" type="STRING" size="256"/>
          <Column id="COM_PCKT_ORG_CD" type="STRING" size="256"/>
          <Column id="COM_PCKT_ORG_NM" type="STRING" size="256"/>
          <Column id="CHAS_NO" type="STRING" size="256"/>
          <Column id="CRD_REST_PT" type="STRING" size="256"/>
          <Column id="CUST_REST_PT" type="STRING" size="256"/>
          <Column id="RSNO_TR_YN" type="STRING" size="256"/>
          <Column id="INPT_DTIME" type="STRING" size="256"/>
          <Column id="INPT_DTIME_UI" type="STRING" size="256"/>
          <Column id="INPT_USER_ID" type="STRING" size="256"/>
          <Column id="INPT_IP" type="STRING" size="256"/>
          <Column id="MOD_DTIME" type="STRING" size="256"/>
          <Column id="MOD_DTIME_UI" type="STRING" size="256"/>
          <Column id="MOD_USER_ID" type="STRING" size="256"/>
          <Column id="MOD_IP" type="STRING" size="256"/>
          <Column id="DTL_SEQ" type="STRING" size="256"/>
          <Column id="OCUR_PT_DIV_CD" type="STRING" size="256"/>
          <Column id="OCUR_PT_DIV_NM" type="STRING" size="256"/>
          <Column id="CAMP_ID" type="STRING" size="256"/>
          <Column id="OFR_ID" type="STRING" size="256"/>
          <Column id="CAMP_PT" type="STRING" size="256"/>
          <Column id="WIN_RSULT_CD" type="STRING" size="256"/>
          <Column id="WIN_RSULT_NM" type="STRING" size="256"/>
          <Column id="DTL_CPRT_PT" type="STRING" size="256"/>
          <Column id="DTL_SPCL_PT" type="STRING" size="256"/>
          <Column id="SPCL_PT_CD" type="STRING" size="256"/>
          <Column id="SPCL_PT_NM" type="STRING" size="256"/>
          <Column id="RSV_STD_CD" type="STRING" size="256"/>
          <Column id="RSV_STD_CD_NM" type="STRING" size="256"/>
          <Column id="CRD_MDA_CD" type="STRING" size="256"/>
          <Column id="CRD_MDA_CD_NM" type="STRING" size="256"/>
          <Column id="APPL_PT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_grppt_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_grppt_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_grppt_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_grppt_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_grppt_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_grppt_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHNAPPRV_DATE" type="STRING" size="256"/>
          <Column id="APPRV_NO" type="STRING" size="256"/>
          <Column id="SUB_CO_FRNCHSE_CODE" type="STRING" size="256"/>
          <Column id="SUB_CO_FRNCHSE_CODE_NAME" type="STRING" size="256"/>
          <Column id="SUB_CO_APPRV_DATE" type="STRING" size="256"/>
          <Column id="SUB_CO_APPRV_NO" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="INTGR_CUST_NO" type="STRING" size="256"/>
          <Column id="CHNL_SUB_CO_CODE" type="STRING" size="256"/>
          <Column id="CHNL_SUB_CO_CODE_NAME" type="STRING" size="256"/>
          <Column id="SLIP_DIV_CODE" type="STRING" size="256"/>
          <Column id="SLIP_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="TRANS_RSN_CODE" type="STRING" size="256"/>
          <Column id="TRANS_RSN_CODE_NAME" type="STRING" size="256"/>
          <Column id="PROD_CODE" type="STRING" size="256"/>
          <Column id="PROD_CODE_NAME" type="STRING" size="256"/>
          <Column id="PROD_DESCTN" type="STRING" size="256"/>
          <Column id="PYMT_PATTERN_CODE" type="STRING" size="256"/>
          <Column id="PYMT_PATTERN_CODE_NAME" type="STRING" size="256"/>
          <Column id="PACKET_PATTERN_CODE" type="STRING" size="256"/>
          <Column id="PACKET_PATTERN_CODE_NAME" type="STRING" size="256"/>
          <Column id="APPRV_DATE_TIME" type="STRING" size="256"/>
          <Column id="SUB_CO_TRANS_DATE" type="STRING" size="256"/>
          <Column id="SUB_CO_TRANS_TIME" type="STRING" size="256"/>
          <Column id="OCCUR_PT" type="STRING" size="256"/>
          <Column id="GEN_RSV_PT" type="STRING" size="256"/>
          <Column id="SPECIAL_RSV_PT" type="STRING" size="256"/>
          <Column id="CPRT_RSV_PT" type="STRING" size="256"/>
          <Column id="VANISH_INTEND_DATE" type="STRING" size="256"/>
          <Column id="CNT" type="STRING" size="256"/>
          <Column id="UNITPRC" type="STRING" size="256"/>
          <Column id="SALE_AMT" type="STRING" size="256"/>
          <Column id="CANCEL_DIV_CODE" type="STRING" size="256"/>
          <Column id="CANCEL_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="ORN_APPRV_DATE" type="STRING" size="256"/>
          <Column id="ORN_APPRV_NO" type="STRING" size="256"/>
          <Column id="ORN_SUB_CO_TRANS_DATE" type="STRING" size="256"/>
          <Column id="ORN_SUB_CO_APPRV_DATE" type="STRING" size="256"/>
          <Column id="ORN_SUB_CO_APPRV_NO" type="STRING" size="256"/>
          <Column id="CHASING_NO" type="STRING" size="256"/>
          <Column id="RELATION_NO" type="STRING" size="256"/>
          <Column id="INTGR_CAMPAIGN_CODE" type="STRING" size="256"/>
          <Column id="CAMPAIGN_VEST_PT" type="STRING" size="256"/>
          <Column id="OFFER_CODE" type="STRING" size="256"/>
          <Column id="PRZ_RSLT_CODE" type="STRING" size="256"/>
          <Column id="INPUT_DATE_TIME" type="STRING" size="256"/>
          <Column id="INPUT_USER_ID" type="STRING" size="256"/>
          <Column id="RES_NO" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
          <Column id="BIZ_NO" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CODE" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="SUB_CO_ORDER_NO" type="STRING" size="256"/>
          <Column id="CARD_MEDIA_DIV_CODE" type="STRING" size="256"/>
          <Column id="CARD_MEDIA_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="TAXFL_DIV_CODE" type="STRING" size="256"/>
          <Column id="TAXFL_DIV_CODE_NAME" type="STRING" size="256"/>
          <Column id="SUPPPRC" type="STRING" size="256"/>
          <Column id="VAT" type="STRING" size="256"/>
          <Column id="VOLUNTEER_AMT" type="STRING" size="256"/>
          <Column id="MAIN_APPRV_NO" type="STRING" size="256"/>
          <Column id="RSV_STD_CD" type="STRING" size="256"/>
          <Column id="RSV_STD_CD_NM" type="STRING" size="256"/>
          <Column id="APPL_PT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bwcnt_cptv_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bwcnt_cptv_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwcnt_cptv_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwcnt_cptv_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwcnt_cptv_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwcnt_cptv_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="LISTCOUNT" type="STRING" size="256"/>
          <Column id="TOTAL_AMOUNT" type="STRING" size="256"/>
          <Column id="TOTAL_QUANTITY" type="STRING" size="256"/>
          <Column id="TOTAL_POINT" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bwlist_cptv_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bwlist_cptv_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwlist_cptv_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwlist_cptv_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwlist_cptv_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwlist_cptv_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="RID" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="PROC_DATE" type="STRING" size="256"/>
          <Column id="CHANNEL_CD" type="STRING" size="256"/>
          <Column id="CHANNEL_NAME" type="STRING" size="256"/>
          <Column id="SS_CODE" type="STRING" size="256"/>
          <Column id="SS_NAME" type="STRING" size="256"/>
          <Column id="PROD_CODE" type="STRING" size="256"/>
          <Column id="PROD_NAME" type="STRING" size="256"/>
          <Column id="TOT_POINT" type="STRING" size="256"/>
          <Column id="UNIT_PRICE" type="STRING" size="256"/>
          <Column id="PROD_AMT" type="STRING" size="256"/>
          <Column id="PROD_QTY" type="STRING" size="256"/>
          <Column id="PAY_METHOD_CODE" type="STRING" size="256"/>
          <Column id="PAY_METHOD_NAME" type="STRING" size="256"/>
          <Column id="CHANNEL_CLASS" type="STRING" size="256"/>
          <Column id="CHANNEL_CLASS_NAME" type="STRING" size="256"/>
          <Column id="POINT_REASON_CODE" type="STRING" size="256"/>
          <Column id="POINT_REASON_NAME" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_CD" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bwcnt_intg_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bwcnt_intg_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwcnt_intg_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwcnt_intg_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwcnt_intg_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwcnt_intg_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="LISTCOUNT" type="STRING" size="256"/>
          <Column id="TOTAL_AMOUNT" type="STRING" size="256"/>
          <Column id="TOTAL_QUANTITY" type="STRING" size="256"/>
          <Column id="TOTAL_POINT" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bwlist_intg_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bwlist_intg_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwlist_intg_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwlist_intg_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwlist_intg_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bwlist_intg_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="RID" type="STRING" size="256"/>
          <Column id="CARD_NO" type="STRING" size="256"/>
          <Column id="PROC_DATE" type="STRING" size="256"/>
          <Column id="CHANNEL_CD" type="STRING" size="256"/>
          <Column id="CHANNEL_NAME" type="STRING" size="256"/>
          <Column id="SS_CODE" type="STRING" size="256"/>
          <Column id="SS_NAME" type="STRING" size="256"/>
          <Column id="PROD_CODE" type="STRING" size="256"/>
          <Column id="PROD_NAME" type="STRING" size="256"/>
          <Column id="TOT_POINT" type="STRING" size="256"/>
          <Column id="UNIT_PRICE" type="STRING" size="256"/>
          <Column id="PROD_AMT" type="STRING" size="256"/>
          <Column id="PROD_QTY" type="STRING" size="256"/>
          <Column id="PAY_METHOD_CODE" type="STRING" size="256"/>
          <Column id="PAY_METHOD_NAME" type="STRING" size="256"/>
          <Column id="CHANNEL_CLASS" type="STRING" size="256"/>
          <Column id="CHANNEL_CLASS_NAME" type="STRING" size="256"/>
          <Column id="POINT_REASON_CODE" type="STRING" size="256"/>
          <Column id="POINT_REASON_NAME" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_CD" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bw_page_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="SALE_DTIME_UI" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="CHNL_DIV" type="STRING" size="256"/>
          <Column id="CHNL_DIV_NM" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_NM" type="STRING" size="256"/>
          <Column id="POINT_REASON" type="STRING" size="256"/>
          <Column id="POINT_REASON_NAME" type="STRING" size="256"/>
          <Column id="POINT_REASON_CNTT" type="STRING" size="256"/>
          <Column id="FRCH" type="STRING" size="256"/>
          <Column id="FRCH_CD" type="STRING" size="256"/>
          <Column id="FRCH_NM" type="STRING" size="256"/>
          <Column id="PROD_CD" type="STRING" size="256"/>
          <Column id="PROD_CD_NM" type="STRING" size="256"/>
          <Column id="AMT" type="STRING" size="256"/>
          <Column id="UPRC" type="STRING" size="256"/>
          <Column id="QTY" type="STRING" size="256"/>
          <Column id="BAL_PT" type="STRING" size="256"/>
          <Column id="USBL_PT" type="STRING" size="256"/>
          <Column id="VANISH_INTEND_DATE" type="STRING" size="256"/>
          <Column id="PAYM_TP_CD" type="STRING" size="256"/>
          <Column id="PAYM_TP_NM" type="STRING" size="256"/>
          <Column id="DETAIL_TYPE" type="STRING" size="256"/>
          <Column id="DETAIL_TYPE_NAME" type="STRING" size="256"/>
          <Column id="CNCL_YN" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CD" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV_CD_NM" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_srch_cond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FROM_DT" type="STRING" size="256"/>
          <Column id="TO_DT" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV" type="STRING" size="256"/>
          <Column id="PROD_DIV" type="STRING" size="256"/>
          <Column id="CHNL_DIV" type="STRING" size="256"/>
          <Column id="FRNCHSE_DIV" type="STRING" size="256"/>
          <Column id="RDO_DIV" type="STRING" size="256"/>
          <Column id="CUR_PAGE" type="STRING" size="256"/>
          <Column id="MORE_YN" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="EXCEL_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bef_hist1_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bef_hist1_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist1_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist1_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist1_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist2_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bef_hist2_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist2_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist2_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist2_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist3_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_bef_hist3_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist3_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist3_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_bef_hist3_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_call_back" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="HTTP_CD" type="STRING" size="256"/>
          <Column id="HTTP_MSG" type="STRING" size="256"/>
          <Column id="RSPN_CD" type="STRING" size="256"/>
          <Column id="RSPN_MSG" type="STRING" size="256"/>
          <Column id="MSG_POPUP_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_payhist_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_payhist_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_payhist_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_payhist_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SALEDT" type="STRING" size="256"/>
          <Column id="SALETMDAY" type="STRING" size="256"/>
          <Column id="PAYMINFODIVCD" type="STRING" size="256"/>
          <Column id="PAYALIAS" type="STRING" size="256"/>
          <Column id="FRCHNMPAYM" type="STRING" size="256"/>
          <Column id="FRCHCDPAYM" type="STRING" size="256"/>
          <Column id="PRODCDPAYM" type="STRING" size="256"/>
          <Column id="AMTPAYM" type="STRING" size="256"/>
          <Column id="UPRCPAYM" type="STRING" size="256"/>
          <Column id="QTY" type="STRING" size="256"/>
          <Column id="PINNO" type="STRING" size="256"/>
          <Column id="APRVDIVCD" type="STRING" size="256"/>
          <Column id="APRVDIVDTLCD" type="STRING" size="256"/>
          <Column id="TROWNNO" type="STRING" size="256"/>
          <Column id="ORGTROWNNO" type="STRING" size="256"/>
          <Column id="TROWNNO" type="STRING" size="256"/>
          <Column id="ORGTROWNNO" type="STRING" size="256"/>
          <Column id="PRODNM" type="STRING" size="256"/>
          <Column id="RESVQTY" type="STRING" size="256"/>
          <Column id="RESVUPRC" type="STRING" size="256"/>
          <Column id="CURUPRC" type="STRING" size="256"/>
          <Column id="TOTAMT" type="STRING" size="256"/>
          <Column id="BARCD" type="STRING" size="256"/>
          <Column id="CUPNUSEYN" type="STRING" size="256"/>
          <Column id="PTUSEYN" type="STRING" size="256"/>
          <Column id="INPTDTIME" type="STRING" size="256"/>
          <Column id="MODDTIME" type="STRING" size="256"/>
          <Column id="ORDGBN" type="STRING" size="256"/>
          <Column id="COMPCKTCD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_payhist_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_payhist_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ev_chargeHist_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="HTTP_RET_CODE" type="STRING" size="256"/>
          <Column id="HTTP_RET_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ev_chargeSum_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ev_chargeSum_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ev_chargeSum_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="custNo" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
          <Column id="endDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ev_chargeSum_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="RESULTCODE" type="STRING" size="256"/>
          <Column id="RESULT_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ev_chargeSum_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="HTTP_RET_CODE" type="STRING" size="256"/>
          <Column id="HTTP_RET_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_charge_hist_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TRANSDISTNTNO" type="STRING" size="256"/>
          <Column id="RFCARDNO" type="STRING" size="256"/>
          <Column id="CUSTNO" type="STRING" size="256"/>
          <Column id="SELLDT" type="STRING" size="256"/>
          <Column id="SELLTM" type="STRING" size="256"/>
          <Column id="CHARGESTAT" type="STRING" size="256"/>
          <Column id="STATIONID" type="STRING" size="256"/>
          <Column id="STATIONNM" type="STRING" size="256"/>
          <Column id="CHARGERID" type="STRING" size="256"/>
          <Column id="CHARGESTADTTM" type="STRING" size="256"/>
          <Column id="CHARGEFINDTTM" type="STRING" size="256"/>
          <Column id="TRANSTYCD" type="STRING" size="256"/>
          <Column id="TRANSSXNCD" type="STRING" size="256"/>
          <Column id="PAYSXNCD" type="STRING" size="256"/>
          <Column id="TOTCHARGEQTY" type="STRING" size="256"/>
          <Column id="FREECHARGEQTY" type="STRING" size="256"/>
          <Column id="CHARGEUNTPRC" type="STRING" size="256"/>
          <Column id="DCUNTPRC" type="STRING" size="256"/>
          <Column id="TOTPAYAMT" type="STRING" size="256"/>
          <Column id="FNLPAYAMT" type="STRING" size="256"/>
          <Column id="DCPRC" type="STRING" size="256"/>
          <Column id="USEPNT" type="STRING" size="256"/>
          <Column id="SAVEPNT" type="STRING" size="256"/>
          <Column id="PGAUTHCD" type="STRING" size="256"/>
          <Column id="PROYN" type="STRING" size="256"/>
          <Column id="PTTRNSEQ" type="STRING" size="256"/>
          <Column id="SITECD" type="STRING" size="256"/>
          <Column id="PTTRNNICK" type="STRING" size="256"/>
          <Column id="DPID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_charge_sum_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TOTCOUNT" type="STRING" size="256"/>
          <Column id="FINALCHARGEQTY" type="STRING" size="256"/>
          <Column id="FINALDISCOUNTAMT" type="STRING" size="256"/>
          <Column id="FINALPAIDAMT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ev_chargeHist_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ev_chargeHist_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="custNo" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
          <Column id="endDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ev_chargeHist_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="RESULTCODE" type="STRING" size="256"/>
          <Column id="RESULT_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ev_chargeHist_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_eventptHist_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_eventptHist_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_eventptHist_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_eventptHist_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SALE_DT" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="APRV_SEQ" type="STRING" size="256"/>
          <Column id="CHNL_DIV_CD" type="STRING" size="256"/>
          <Column id="SALE_DTIME" type="STRING" size="256"/>
          <Column id="SALE_TMDAY" type="STRING" size="256"/>
          <Column id="CHNL_DIV_CD_NM" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_CD" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_CD_NM" type="STRING" size="256"/>
          <Column id="PCKT_TP_CD" type="STRING" size="256"/>
          <Column id="PCKT_TP_CD_NM" type="STRING" size="256"/>
          <Column id="COM_PCKT_ORG_CD" type="STRING" size="256"/>
          <Column id="COM_PCKT_ORG_CD_NM" type="STRING" size="256"/>
          <Column id="FRCH_CD" type="STRING" size="256"/>
          <Column id="FRCH_NM" type="STRING" size="256"/>
          <Column id="CHAS_NO" type="STRING" size="256"/>
          <Column id="PAYM_TP_CD" type="STRING" size="256"/>
          <Column id="PAYM_TP_CD_NM" type="STRING" size="256"/>
          <Column id="PROD_CD" type="STRING" size="256"/>
          <Column id="PROD_CD_NM" type="STRING" size="256"/>
          <Column id="CUST_NO" type="STRING" size="256"/>
          <Column id="QTY" type="STRING" size="256"/>
          <Column id="UPRC" type="STRING" size="256"/>
          <Column id="AMT" type="STRING" size="256"/>
          <Column id="EVNT_PT" type="STRING" size="256"/>
          <Column id="CRD_REST_PT" type="STRING" size="256"/>
          <Column id="CUST_REST_PT" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_CD" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_CD_NM" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_CNTT" type="STRING" size="256"/>
          <Column id="APRV_DT" type="STRING" size="256"/>
          <Column id="APRV_TMDAY" type="STRING" size="256"/>
          <Column id="APRV_NO" type="STRING" size="256"/>
          <Column id="OAPRV_DT" type="STRING" size="256"/>
          <Column id="OAPRV_NO" type="STRING" size="256"/>
          <Column id="RSNO_TR_YN" type="STRING" size="256"/>
          <Column id="CRD_MDA_CD" type="STRING" size="256"/>
          <Column id="CRD_MDA_CD_NM" type="STRING" size="256"/>
          <Column id="RSV_STD_CD" type="STRING" size="256"/>
          <Column id="CPTV_EVNT_PT_ID" type="STRING" size="256"/>
          <Column id="CAMP_ID" type="STRING" size="256"/>
          <Column id="OFR_ID" type="STRING" size="256"/>
          <Column id="VANISH_INTEND_DATE" type="STRING" size="256"/>
          <Column id="FILLER_1" type="STRING" size="256"/>
          <Column id="FILLER_2" type="STRING" size="256"/>
          <Column id="FILLER_3" type="STRING" size="256"/>
          <Column id="INPT_DTIME" type="STRING" size="256"/>
          <Column id="INPT_USER_ID" type="STRING" size="256"/>
          <Column id="INPT_IP" type="STRING" size="256"/>
          <Column id="MOD_DTIME" type="STRING" size="256"/>
          <Column id="MOD_USER_ID" type="STRING" size="256"/>
          <Column id="MOD_IP" type="STRING" size="256"/>
          <Column id="APRV_DTM" type="STRING" size="256"/>
          <Column id="SALE_DTM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_eventptHist_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_eventptHist_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
  </Form>
</FDL>
