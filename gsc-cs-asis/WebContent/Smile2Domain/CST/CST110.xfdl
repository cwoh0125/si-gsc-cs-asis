<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.2">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="LPS010" classname="001" inheritanceid="" position="absolute 0 0 1652 800" titletext="ARS카드등록조회" onload="CST110_onload" onkeydown="Copy_Prevention_onkeydown" onrbuttondown="Copy_onrbuttondown">
    <Script type="xscript4.0"><![CDATA[include "LIB::CommonLib.xjs"

var g_div_cti 	= getTopFrame().Div_CTI;

var COM290 					= null;  // ARS고객정보입력 팝업
var objPHN = getObjPhnDtmf_CST110();
if(objPHN){
	objPHN.CST110 = this;
	objPHN.getPhnEvent = getPhnEvent;	
}

var userID=gds_User.getColumn(gds_User.rowposition,"GBL_USR_ID");
var userNM=gds_User.getColumn(gds_User.rowposition,"GBL_USR_NM");
var userPart=gds_User.getColumn(gds_User.rowposition,"GBL_PART_CD");


//------------------------------------------------------------------------------------------
//조회
//------------------------------------------------------------------------------------------

function btn_srch_onclick(obj:Button,  e:ClickEventInfo)
{	
	in_name.value = ""; //초기화

	if(	   (getTrim(edt_cuik_bday.value)	== "" 	|| getTrim(edt_cuik_bday.value)	== null)
		&& (getTrim(cmb_sex_cd.value)		== "" 	|| getTrim(cmb_sex_cd.value) 	== null)
		&& (getTrim(edt_name.value)			== "" 	|| getTrim(edt_name.value) 		== null)){

		//trace("1");
		if (   (getTrim(edt_card_num.value) == "" || getTrim(edt_card_num.value) 	== null)
			&& (getTrim(Edt_hphone.value) 	== "" || getTrim(Edt_hphone.value) 		== null)){
				 cf_Alert("HELE0007"+"1212");
				 return;
		}else{
			//주민번호나 카드번호나 휴대폰번호가 존재하면 조회
			srch_Get_LPS_SELECT();
		}
	}else{
	
		//필수 3개 값 null체크!
		if(getTrim(edt_cuik_bday.value)	== "" 	  || getTrim(edt_cuik_bday.value)	== null){
			alert("생년월일을 입력해주세요");
			return;
		}else if(getTrim(cmb_sex_cd.value)	== "" || getTrim(cmb_sex_cd.value) 	== null){
			alert("셩별을 선택해주세요");
			return;
		}else if(getTrim(Edt_hphone.value)	== "" || getTrim(Edt_hphone.value) 	== null){
			alert("휴대폰번호를 입력해주세요");
			return;
		}else{
			//필수값 3개 모두 null이 아닐경우 조회
			//성명은 미할당이거나 처리하지않은경우 데이터가 없기때문에 제외
			srch_Get_LPS_SELECT();
		}
	}
}		


function srch_Get_LPS_SELECT(){

	ds_srch.clearData();
	ds_out.clearData();

	//fun_ds_srch(ds_srch, "RES_REG_NO", getTrim(edt_jumin.value));
	//fun_ds_srch(ds_srch, "CRD_NO", getTrim(edt_card_num.value));	
	fun_ds_srch(ds_srch, "CUIK_BDAY", getTrim(edt_cuik_bday.value).replace("-",""));	
	fun_ds_srch(ds_srch, "SEX_CD", getTrim(cmb_sex_cd.value));	
	fun_ds_srch(ds_srch, "CUST_NM", getTrim(edt_name.value));	
	fun_ds_srch(ds_srch, "MBPH_NO", getTrim(Edt_hphone.value).replace("-",""));	
	fun_ds_srch(ds_srch, "RES_REG_NO", getTrim(edt_jumin.value).replace("-",""));	
	fun_ds_srch(ds_srch, "CRD_NO", getTrim(edt_card_num.value).replace("-",""));	
		
	var	strSvcID = "R1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "SELECT_0_IDATA=ds_srch:a"; 
	var	strOutDatasets = "ds_out=SELECT_0_ODATA";
	var	strArgument = "SELECT_0_ID=CST110.Get_LPS_SELECT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
	return;
}

//=======================================================
// 왜 똑같은 로직의 함수를 또만들었을까.. (사용X)
//=======================================================
function btn_re_srch_onclick(obj:Button,  e:ClickEventInfo)
{	
	if (edt_jumin.value=="" || edt_jumin.value==null){
		 if(edt_card_num.value=="" || edt_card_num.value==null){
			 cf_Alert("HELE0007");
			 return;
		 }
	}
	
	ds_srch.clearData();
	ds_out.clearData();

	fun_ds_srch(ds_srch, "RES_REG_NO", getTrim(edt_jumin.value));
	fun_ds_srch(ds_srch, "CRD_NO", getTrim(edt_card_num.value));	
		
	var	strSvcID = "RE1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "SELECT_0_IDATA=ds_srch:a"; 
	var	strOutDatasets = "ds_out=SELECT_0_ODATA";
	var	strArgument = "SELECT_0_ID=CST110.Get_LPS_SELECT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
	return;
	
}			


//------------------------------------------------------------------------------------------
//콜백 함수
//------------------------------------------------------------------------------------------

function fn_callBack(svcid,strErrCode,strErrMsg)
{

	if (svcid=="R1"){
 		if(ds_out.rowcount==0){
			cf_Alert("COMI0006");
 		}
 		
 		//2015.08.15 개인정보접촉이력
	    //trace("=============개인정보접촉이력 ARS카드등록 조회 Start===========");
		
	    var sAccNo = "CST110"; //개인정보접촉이력 일련번호
	    var sPerTCd = "PT1002";  // 수행업무 코드
	    var sPerTDt = "ICCS_CSC ARS카드등록 조회";  // 수행업무 상세내용
	    var sCalFun = "srch_Get_LPS_SELECT()";  // 호출함수명 
	    var sInqCon = gfn_getStringFromDataset(ds_srch); //조회조건										
	    var sInqCnt = ds_out.rowcount;  // 조회건수
		var sInCustNo = "";					
		
		ds_out.addColumn("CUST_NM_1","string");
		
		for(i=0 ; i < ds_out.rowcount ; i++){
			sInCustNo = sInCustNo + "CRD_NO=" + ds_out.getColumn(i,"CRD_NO")+"|" ;//식별키
			
			//고객이름 마스킹
			ds_out.setColumn(i,"CUST_NM_1",maskCustNm(ds_out.getColumn(i,"CUST_NM")));
		}
		/*
	    trace("개인정보접촉이력--ARS카드등록 조회 데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
	    trace("=============개인정보접촉이력 ARS카드등록 조회 END==========="); 
	    
		trace("ds_out.saveXML()>>>"+ds_out.saveXML());
		*/
		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);

 		
	}
	//sta_row.text=Grid00.rowcount;

 	if (svcid=="D1"){
 		cf_Alert("COMI0004");
 		
 		//2015.08.15 개인정보접촉이력
	    //trace("=============개인정보접촉이력 ARS카드등록 삭제 Start===========");
		
	    var sAccNo = "CST110"; //개인정보접촉이력 일련번호
	    var sPerTCd = "PT1004";  // 수행업무 코드
	    var sPerTDt = "ICCS_CSC ARS카드등록 삭제";  // 수행업무 상세내용
	    var sCalFun = "ars_info_delete()";  // 호출함수명 
	    var sInqCon = gfn_getStringFromDataset(ds_srch); //조회조건										
	    var sInqCnt = 1;  // 조회건수	   
	    var sInCustNo = ds_srch.getColumn(0,"SEQ_NO") ;//식별키
		/*
	    trace("개인정보접촉이력--ARS카드등록 삭제 데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
	    trace("=============개인정보접촉이력 ARS카드등록 삭제 END==========="); 
	    */

		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
 		
 		//즉시 삭제 카운트 
 		LP_del();
 		
		srch_Get_LPS_SELECT();
	}
	
	
	if( svcid=="SS2"){ 	//신규등록
		//ds_out.setColumn(ds_out.rowposition,"CUST_NM",edt_name.value);
		//ds_out.setColumn(ds_out.rowposition,"CUIK_BDAY",edt_cuik_bday.value);
		//ds_out.setColumn(ds_out.rowposition,"SEX_CD",cmb_sex_cd.value);
		
		
		//2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 고객정보수정 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록(상담원)";  // 수행업무 상세내용
		var sCalFun = "cust_nm_upd()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_master_name_in); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_master_name_in.getColumn(0,"SEQ_NO") ;//식별키
		/*
		trace("개인정보접촉이력--ARS카드등록 고객정보수정데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 고객정보수정 END==========="); 
		*/
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);	
		
		
		btn_ars_input_onclick();
			
	}
	
	if(svcid == "IF_WAS_208"){
	
	
		//2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 일반카드 등록 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 일반카드 등록";  // 수행업무 상세내용
		var sCalFun = "LP_start_onclick()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_if_ars_card_data); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_if_ars_card_data.getColumn(0,"in_crd_no") ;//식별키	
		/*
		trace("개인정보접촉이력--ARS카드등록 일반카드 등록데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 일반카드 등록 END==========="); 
		*/
		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
		
		
		if (ds_if_ars_card_record.getColumn("0","OT_RESPON_CODE")=="00000"){
			
			// 패스워드 인터페이스 호출
			//password_onclick();
			ars_card_end();
			lp_sms_send(); 
					
		}else{		
			cf_Alert("COME0002",ds_if_ars_card_record.getColumn("0","OT_RES_MSG"));
			LP_error_end();
			
		}
	}
	
	
	if(svcid == "Auto_sms"){
		
		 //2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 SMS발송 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 SMS발송";  // 수행업무 상세내용
		var sCalFun = "lp_sms_send()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_SMS); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = "TR_PHONE="+ds_SMS.getColumn(0,"TR_PHONE") ;//식별키
		/*
		trace("개인정보접촉이력--ARS카드등록 SMS발송데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 SMS발송 END==========="); 
		*/

		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
	}
	
	
	if(svcid == "End"){
	
		//작업완료 여부 패스워드 전 상태로 변경
		//if(ds_if_pw_init_record.getColumn("0","OT_RESPON_CODE")!="00000"){
		
		//work_password();
		//}
		
		cf_Alert("COME0002","정상발급");
		btn_srch_onclick();				
		//setLP();
	}
	
	
	
}

//------------------------------------------------------------------------------------------
//화면 로드시
//------------------------------------------------------------------------------------------

function CST110_onload(obj:Form, e:LoadEventInfo)
{
	//화면 복사 방지 Event
	var evtObj = new EventInfo(); // 이벤트 객체 생성
	obj.onkeydown.addHandler(Copy_Prevention_onkeydown, evtObj);
	obj.onrbuttondown.addHandler(Copy_onrbuttondown, evtObj);
	//화면 복사 방지 Event END
	
	setDefaultValue();
}

//------------------------------------------------------------------------------------------
//공통 콤보
//------------------------------------------------------------------------------------------

function setDefaultValue(){

	//콤보생성	
	var arrCombo           = ["cmb_sex_cd"];    									//콤보ID
    var arrSearchKey       = ["NW008"];               							//공통코드-대분류코드
    var arrListMode        = ["TY"];                    							//CTN : [코드] 코드명  , TY : 코드명,  TN: 초기값무시
    var arrOptionRowValue  = [","];                  								//코드상단에 로우추가후 전체, 공백

	setComboList(arrCombo, arrSearchKey, arrListMode, arrOptionRowValue);     					//공통콤보가져오기	

}

//------------------------------------------------------------------------------------------
//그리드 정렬
//------------------------------------------------------------------------------------------

function Grid00_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	cf_gridSort(obj, e);
}

//------------------------------------------------------------------------------------------
//삭제 버튼
//------------------------------------------------------------------------------------------
//20200203 여기서 삭제 버튼은 일단 막는다.. ARS통계도 같이 삭제 처리 됩니다. 김재숙 주임. 
function btn_del_onclick(obj:Button,  e:ClickEventInfo)
{
	
	if (ds_out.findRow("CHK","1")=="-1"){
		cf_Alert("COME0002","선택한 데이터가없습니다.");
	}else if(ds_out.getCaseCount("CHK =="+ '1')>1) {
		cf_Alert("COME0002","삭제는 1개씩만가능합니다.");
	}
	else{
	
	if (!cf_Confirm("COMI0012","삭제"))	return;
		//ars_info_delete();    
	}
}

function ars_info_delete(){
	
	ds_srch.clearData();
	ds_srch2.clearData();
	
	fun_ds_srch(ds_srch, "SEQ_NO", Grid00.getCellValue(ds_out.findRow("CHK","1"),15));
	fun_ds_srch(ds_srch, "JOB_DT", getToday());
	fun_ds_srch(ds_srch, "JOB_ID", GetUserInfo("gUSR_ID"));
	var arsRegDtm = ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8);
	
	ds_out.clearData();
	//2013.07.11 삭제를 상태값 변경하는걸로 변경
	//2018.12.21 상태 변경이 아닌 ROW삭제로 변경 김순화D요청
	var	strSvcID = "D1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "DELETE_0_IDATA=ds_srch:a"; 
	var	strOutDatasets = "";
	var	strArgument = "DELETE_0_ID=CST110.Set_LPS_UPDATE_DELETE_STAT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if(getToday() != arsRegDtm){
		strInDatasets = strInDatasets + " DELETE_1_IDATA=ds_srch:a";
		strArgument = strArgument + " DELETE_1_ID=CST110.Set_LPS_UPDATE_DELETE_STAT_MIG";
	}
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	return;
	
	//Grid00.getCellText(ds_out.findRow("CHK","1"),4);	
	//fun_ds_srch(ds_srch, "RES_REG_NO", Grid00.getCellValue(ds_out.findRow("CHK","1"),3));
	//fun_ds_srch(ds_srch, "CRD_NO", Grid00.getCellValue(ds_out.findRow("CHK","1"),7));				    
	//var	strInDatasets = "UPDATE_0_IDATA=ds_srch:a UPDATE_1_IDATA=ds_srch:a SELECT_2_IDATA=ds_srch2:a"; 
	//var	strArgument = "UPDATE_0_ID=CST110.Set_LPS_UPDATE UPDATE_1_ID=CST110.Set_LPS_UPDATE2 SELECT_2_ID=CST110.Get_LPS_SELECT";
}

//===============================================================
// ARS주민번호 - 주민번호 수집금지 이후 사용X
//===============================================================
function btn_srch00_onclick(obj:Button,  e:ClickEventInfo)
{
	if(objPHN){
		g_div_cti.DTMF_PGM_ID = "CST110";
		//trace("CST110 DTMF_PGM_ID ==> " + g_div_cti.DTMF_PGM_ID);		
		var intRtnCd = g_div_cti.conferenceInit(GetConfig("IVR_AUTH"), "10");
		if(intRtnCd != 9999){		
			PopupDialog("COM290","COM::COM290.xfdl", -1, -1, 419, 178, false, -1, "", false, false, true, false);
		}
	}	else{
	cf_Alert("COME0020");
	}
}

//===============================================================
// ARS고객정보 조회
//===============================================================
function btn_srchCustInfo_onclick(obj:Button,  e:ClickEventInfo)
{
	if(objPHN){
		g_div_cti.DTMF_PGM_ID = "CST110";
		//trace("CST110 DTMF_PGM_ID ==> " + g_div_cti.DTMF_PGM_ID);		
		var intRtnCd = g_div_cti.conferenceInit(GetConfig("IVR_AUTH"), "75");
		if(intRtnCd != 9999){		
			PopupDialog("COM290","COM::COM290.xfdl", -1, -1, 419, 178, false, -1, "", false, false, true, false);
		}
	}	else{
	cf_Alert("COME0020");
	}
}

function getPhnEvent(arrParam){
	switch(arrParam.frmPgmId)
	{
		case "DTMF_10" :			
			var new_jumin_no = arrParam.new_jumin_no;
			/*
			trace("result.service_gubun==>" + arrParam.service_gubun);
			trace("result.agent_ip==>" 		+ arrParam.agent_ip);
			trace("result.agent_port==>" 	+ arrParam.agent_port);
			trace("result.new_jumin_no==>" 	+ arrParam.new_jumin_no);
			trace("result.yak_yn==>" 		+ arrParam.yak_yn);
			trace("result.info_yn==>" 		+ arrParam.info_yn);
			*/
			CST110.edt_jumin.value 	= CST110.getTrim(new_jumin_no);			

			break;
			
		case "DTMF_75" :
			/*var new_jumin_no = arrParam.new_jumin_no;			
			trace("result.service_gubun==>" + arrParam.service_gubun);
			trace("result.agent_ip==>" 		+ arrParam.agent_ip);
			trace("result.agent_port==>" 	+ arrParam.agent_port);
			trace("result.new_jumin_no==>" 	+ arrParam.new_jumin_no);
			trace("result.yak_yn==>" 		+ arrParam.yak_yn);
			trace("result.info_yn==>" 		+ arrParam.info_yn);
			
			CST110.edt_jumin.value 	= CST110.getTrim(new_jumin_no);		*/
			
			//서비스 75번 (생년월일, 성별, 핸드폰번호)
			/*
			trace("CST110_result.bday==>" 				+ arrParam.bday);
			trace("CST110_result.sex_cd==>" 			+ arrParam.sex_cd);
			trace("CST110_result.cphn_head_tphn_no==>"  + arrParam.cphn_head_tphn_no);
			trace("CST110_result.cphn_min_tphn_no==>" 	+ arrParam.cphn_min_tphn_no);
			trace("CST110_result.cphn_fnl_tphn_no==>" 	+ arrParam.cphn_fnl_tphn_no);	
			*/
			CST110.edt_cuik_bday.value 	= CST110.getTrim(arrParam.bday);
			CST110.cmb_sex_cd.value 	= CST110.getTrim(arrParam.sex_cd);
			CST110.Edt_hphone.value 	= CST110.getTrim(arrParam.cphn_head_tphn_no) 
									+ "-" + CST110.getTrim(arrParam.cphn_min_tphn_no) 
									+ "-" + CST110.getTrim(arrParam.cphn_fnl_tphn_no); 
			break;	
		default :	
			break;
	}	
}


//==================================================================================
// 마스크 포커스 처리
//==================================================================================
function Msk_SrchCrdNo_oneditclick(obj:MaskEdit,  e:EditClickEventInfo)
{
	if(getTrim(obj.value)==""){
		obj.setCaretPos(0);
	}	
}

function Msk_SrchTailRsBzNo_oneditclick(obj:MaskEdit,  e:EditClickEventInfo)
{	
	if(getTrim(obj.value)==""){
		obj.setCaretPos(0);
	}
}
function Msk_CuikBday_oneditclick(obj:MaskEdit,  e:EditClickEventInfo)
{
	if(getTrim(obj.value)==""){
		obj.setCaretPos(0);
	}
}

function Cal_CuikBday_oneditclick(obj:Calendar,  e:EditClickEventInfo)
{
	if(getTrim(obj.value)==""){
		obj.setCaretPos(0);
	}
}



function edt_card_num_onkeyup(obj:MaskEdit, e:KeyEventInfo)
{
	if (e.keycode == "13" ) btn_srch_onclick();	
}



function Grid00_onkeydown(obj:Grid, e:KeyEventInfo)
{
	if(e.ctrlKey){
		if(e.keycode == 67){
			var v_clip;			
			v_clip = obj.getCellText(obj.currentrow,obj.currentcol);
			system.clearClipboard();
			system.setClipboard("CF_TEXT",v_clip);
		}	
	}		
}

function Edt_CelPhone_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
	var intLength = getTrim(obj.value).length;
	
	if(intLength == obj.getCaretPos()){
		obj.value = maskPhone(e.posttext);
		obj.setCaretPos(-1);		
	}else{
		var intIndx = obj.getCaretPos();	
		obj.value = maskPhone(e.posttext);
		obj.setCaretPos(intIndx);
	}	
}

/*2015.03.11 조회조건 엔터키 조회 추가 허선화P 요청*/
//생년월일
function edt_cuik_bday_onkeydown(obj:MaskEdit, e:KeyEventInfo)
{
	if (e.keycode == "13" ) btn_srch_onclick();	
}

//성별
function cmb_sex_cd_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == "13" ) btn_srch_onclick();	
}

//성명
function edt_name_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == "13" ) btn_srch_onclick();	
}

//휴대전화
function Edt_hphone_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == "13" ) btn_srch_onclick();	
}

//입력 성명 
function in_name_onkeydown(obj:Edit, e:KeyEventInfo)
{
	
	if (e.keycode == "13" ) btn_up_save_onclick();	
}


//삭제 카운트 
function LP_del()
{
		
		ds_if_ars_del_data.clearData();
		
		var dat = getToday();
		fun_ds_srch(ds_if_ars_del_data, "I_WORK_DAY",  dat);			
		
		var	strSvcID = "Ars_del";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = "PROCEDURE_0_IDATA=ds_if_ars_del_data:a"; 
		var	strOutDatasets = "";
		var	strArgument = "PROCEDURE_0_ID=LPS010.Prc_LP_MASTER_HIST_DEL";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;		
		
	   cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);			
		
}
function btn_up_save_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_out.rowcount=="0"){
		cf_Alert("COME0002","등록할 데이터가 없습니다.");
		return;
	}
	
	if(edt_seq.value == "" || edt_seq.value == null){
		
		cf_Alert("LPSE0001");
		return;
	}
	
	if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="0" || ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="4") {
		cf_Alert("COME0002","등록된 카드 / 미할당 작업 입니다.");
		return;
	}
	
	
	
	//작업중인 카드는 고객 명이 없다. 
	if(in_name.value == "" || getTrim(in_name.value) == null || in_name.value == undefined){
		alert("고객성명이 없습니다. LP파트로 문의주세요");
		return;
	}
	
	//
	if(ds_out.getColumn(ds_out.rowposition,"CUIK_BDAY") == "" || getTrim(edt_cuik_bday.value) == null){
		alert("생년월일이 없습니다. LP파트로 문의주세요");
		return;
	}
	
	//
	if(ds_out.getColumn(ds_out.rowposition,"SEX_CD") == "" || getTrim(cmb_sex_cd.value) == null){
		alert("성별이 없습니다. LP파트로 문의주세요");
		return;
	}
	if (!cf_Confirm("COMI0012","카드등록"))	return;
	
	//작업 완료 여부 확인 
	if(ds_out.getColumn(ds_out.rowposition,'JOB_CPLT_YN')=='N'){
		
		//trace("고객명 업데이트");
		cust_nm_upd();	//고객명 업데이트		
		
	}else{	
		
		alert("작업이 완료된 카드 입니다.");
	}
}


//===========================================================
// 카드등록전 고객 정보수정 - (신규등록용)
//===========================================================
function cust_nm_upd()
{
	ds_master_name_in.clearData();
	
	fun_ds_srch(ds_master_name_in, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO")); 
	fun_ds_srch(ds_master_name_in, "CUST_NM", in_name.value); //CUST_NM
	fun_ds_srch(ds_master_name_in, "CUIK_BDAY", ds_out.getColumn(ds_out.rowposition,"CUIK_BDAY")); //CUIK_BDAY
	fun_ds_srch(ds_master_name_in, "SEX_CD", ds_out.getColumn(ds_out.rowposition,"SEX_CD")); //SEX_CD
	
	fun_ds_srch(ds_master_name_in, "JOB_ID", userID); 
	
	//fun_ds_srch(ds_master_name_in, "ACNM_CNFM_RSLT_CD", ds_out_vf.getColumn(0,"YN")); 
	//fun_ds_srch(ds_master_name_in, "ACNM_CNFM_DTM", edt_name.value); //실명확인일시
	
	//trace("ds_master_name_in>>>"+ds_master_name_in.saveXML());
			    
	var	strSvcID = "SS2"; //신규용SS2
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "UPDATE_1_IDATA=ds_master_name_in:a"; 
	var	strOutDatasets = "";
	var	strArgument = "UPDATE_1_ID=LPS010.Set_LPS_master_name";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	return;
	
}


//------------------------------------------------------------------------------------------
// 고객정보등록저장
//------------------------------------------------------------------------------------------
function btn_ars_input_onclick(obj:Button,  e:ClickEventInfo)
{	
	//제휴카드 여부 : 제휴=Y,그외 N
	if(ds_out.getColumn(ds_out.rowposition,"BIZ_CARD_YN") == "Y")
	{
		//더이상 사용 하지 않는 I/F로 확인 20190304 김성민k
		//alert("제휴");
		fnCustNmCk(); 	
	}
	else
	{
		LP_start_onclick();  //일반카드
	}

}




/********************************************************************************** 
 *  카드발급정보등록 인터페이스
***********************************************************************************/

function LP_start_onclick(obj:Button,  e:ClickEventInfo)
{
	
	
	var nextNum = getDBToday();
	var agrmNum = nextNum.substr(0,8);
	
	ds_if_ars_card_env.clearData();			// 제휴, 일반  인터페이스에서 같이 사용하기때문에 cleardate() 대신 clear() 사용
	ds_if_ars_card_data.clearData();
	ds_if_ars_card_common.clearData();
	ds_if_ars_card_header.clearData();
	ds_if_ars_card_column.clearData();
	ds_if_ars_card_record.clearData();	

	fun_ds_srch(ds_if_ars_card_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_ars_card_env, "REQ_SERVICE_METHOD", 	"arsCmCustInsC02.do"); //공통이 어디까지?
	fun_ds_srch(ds_if_ars_card_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_ars_card_env, "RES_HEADER_SECTION", 	""); //xml상위 헤더항목
	fun_ds_srch(ds_if_ars_card_env, "RES_COLUMN_SECTION", 	""); 
	fun_ds_srch(ds_if_ars_card_env, "RES_RECORD_SECTION", 	"STP_ARS_CM_CUST_INS_C02_Rsp"); 

	fun_ds_srch(ds_if_ars_card_data,"req_chnl_code","610050");
	fun_ds_srch(ds_if_ars_card_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_ars_card_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_ars_card_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
	fun_ds_srch(ds_if_ars_card_data,"in_nxtt_seq",nextNum); //임시일련번호
//	fun_ds_srch(ds_if_ars_card_data,"in_crd_no",edt_card_num.value);
	
	fun_ds_srch(ds_if_ars_card_data,"in_crd_no",ds_out.getColumn(ds_out.rowposition,"CRD_NO"));

	var NumJ = edt_jumin.value;		
				
	//★20120625 주민번호 수집금지			
	//fun_ds_srch(ds_if_ars_card_data,"in_head_rsno",NumJ.substr(0,6));
	//fun_ds_srch(ds_if_ars_card_data,"in_tail_rsno",NumJ.substr(6,13));
	fun_ds_srch(ds_if_ars_card_data,"in_head_rsno","");
	fun_ds_srch(ds_if_ars_card_data,"in_tail_rsno","");

	//fun_ds_srch(ds_if_ars_card_data,"in_bday",edt_cuik_bday.value);	//생년월일 CUIK_BDAY
	//fun_ds_srch(ds_if_ars_card_data,"in_sex_cd",cmb_sex_cd.value);	//성별 SEX_CD
	
	fun_ds_srch(ds_if_ars_card_data,"in_bday",ds_out.getColumn(ds_out.rowposition,"CUIK_BDAY"));	//생년월일 
	fun_ds_srch(ds_if_ars_card_data,"in_sex_cd",ds_out.getColumn(ds_out.rowposition,"SEX_CD"));	//성별 
	
	fun_ds_srch(ds_if_ars_card_data,"in_rlnm_authn_dtime",nextNum); //실명인증일시
	fun_ds_srch(ds_if_ars_card_data,"in_join_chnl_cd","610060"); //가입채널코드
	fun_ds_srch(ds_if_ars_card_data,"in_inpt_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_ars_card_data,"in_agrm_date",agrmNum);
	fun_ds_srch(ds_if_ars_card_data,"in_sms_rcv_yn",ds_out.getColumn(ds_out.rowposition,"SMS_AGRM_YN"));
	fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd4",ds_out.getColumn(ds_out.rowposition,"INFO_CONJ_AGRM_YN"));  //제3자 정보제공약관세분화로인하여 사용안함	
	
	//fun_ds_srch(ds_if_ars_card_data,"in_sign_yn",edt_agreeYN.value); //STPL_AGRM_YN 약관 동의여부
	fun_ds_srch(ds_if_ars_card_data,"in_sign_yn",ds_out.getColumn(ds_out.rowposition,"STPL_AGRM_YN"));
	
	
	
		
	var cvcvalue = ds_out.getColumn(ds_out.rowposition,"CRD_NO");
	var cvcData = cvcCheck(cvcvalue);		
		
	fun_ds_srch(ds_if_ars_card_data,"in_cvc_no",cvcData);
	//fun_ds_srch(ds_if_ars_card_data,"in_cust_nm",edt_name.value);
	fun_ds_srch(ds_if_ars_card_data,"in_cust_nm",in_name.value);
	
		
	var arrClPhn 	= getTrim(ds_out.getColumn(ds_out.rowposition,"MBPH_NO"));
	
	arrClPhn = getTrim(arrClPhn).replace(" ", ""); //공백 제거
	
	arrClPhn = maskPhone(arrClPhn); //핸드폰 형식 변환	
	
	arrClPhn = arrClPhn.split("-"); //	
	
	var strClPhnDdd = "";
	var strClPhnFst = "";
	var strClPhnLst = "";
	
	if(arrClPhn.length > 1){	

		if(arrClPhn.length == 3){
		
			strClPhnDdd	= arrClPhn[0];
			strClPhnFst = arrClPhn[1];
			strClPhnLst = arrClPhn[2];
			
		}else{
		
			cf_Alert("COME0002","휴대번호 형식이 맞지 않습니다.");
			
		}
	}
			
			
	//휴대폰번호
	fun_ds_srch(ds_if_ars_card_data,"in_head_tphn_no",strClPhnDdd);
	fun_ds_srch(ds_if_ars_card_data,"in_mid_tphn_no",strClPhnFst);
	fun_ds_srch(ds_if_ars_card_data,"in_fnl_tphn_no",strClPhnLst);
	
	strClPhnDdd	= "";
	strClPhnFst = "";
	strClPhnLst = "";	
			
	//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_FROM","20091001");
	//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_TO","20101201");	
		
	fun_ds_srch(ds_if_ars_card_data,"in_use_pw",ds_out.getColumn(ds_out.rowposition,"CUST_PW"));	
	fun_ds_srch(ds_if_ars_card_data,"in_inpt_ip",getTrim(GetUserInfo("gLGIN_IP")));	
	fun_ds_srch(ds_if_ars_card_data,"in_ci_val","");						
	
	//★20120625 주민번호 수집금지	
	//fun_ds_srch(ds_if_ars_card_data,"in_authn_sbjt_cd",cmb_authn_sbjt_cd.value); //인증_주체_코드 AUTHN_SBJT_CD
	//fun_ds_srch(ds_if_ars_card_data,"in_com_co_div_cd",cmb_com_co_div_cd.value); //통신회사_구분_코드 COM_CO_DIV_CD	
	fun_ds_srch(ds_if_ars_card_data,"in_authn_sbjt_cd",ds_out.getColumn(ds_out.rowposition,"AUTHN_SBJT_CD")); //인증_주체_코드 
	fun_ds_srch(ds_if_ars_card_data,"in_com_co_div_cd",ds_out.getColumn(ds_out.rowposition,"COM_CO_DIV_CD")); //통신회사_구분_코드 
	
	
	fun_ds_srch(ds_if_ars_card_data,"in_sms_authn_dtime",ds_out.getColumn(ds_out.rowposition,"SMS_AUTHN_DTM")); //인증일시
	
	/**
	* 약관 내용 변경으로 인한 수정처리
	* 2025.02.25 | NP847
	
	//★20130128 약관 내용 추가 SJ
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_3_YN") == 'Y'|| ds_out.getColumn(ds_out.rowposition,"INFO_CONJ_AGRM_YN") =='Y') //서비스제공을 위한 제3자 제공(GSR,GSHS) 동의여부 = Y
	{
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd6","471000"); //GSR 약관코드 
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd7","481000"); //GSHS 약관코드
	}
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_4_YN") == 'Y')  //참여의사 홍보 및 고객응대를 위한 3자 제공(GSR,GSHS,GSMBiz) 및 제휴신용카드 제3자 제공약관 (신한,KB국민, 현대, 삼성, IBK)
	{	
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd13","494000"); //개인정보수집 및 활용(선택)
		//
		//2014.06.18 약관 추가 (2014.07.01 새 약관 적용)
		
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd13","451000"); //제휴신용카드 제3자 제공약관(신한카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd14","452000"); //제휴신용카드 제3자 제공약관(KB국민카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd15","453000"); //제휴신용카드 제3자 제공약관(현대카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd16","454000"); //제휴신용카드 제3자 제공약관(삼성카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd17","455000"); //제휴신용카드 제3자 제공약관(롯데카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd18","456000"); //제휴신용카드 제3자 제공약관(IBK기업은행)
		
	}
	
	//약관 분리 작업 20190327
	
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_5_YN") == 'Y'){
		
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd8","472000"); //GSR 약관코드(마케팅) 
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd10","473000"); //GSR 약관코드(마케팅)
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd9","482000"); //GSHS 약관코드(마케팅)
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd11","483000"); //GSHS 약관코드(마케팅)
	}
	
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_6_YN") == 'Y'){
		
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd12","461000"); //GSMbiz 약관코드(정보제공)		
	}
	*/
	
	//94번 약관 - 개인정보수집 및 활용(선택)
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_4_YN") == 'Y'){
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd13","494000"); 
	}
	
	//61번 약관 - GS&포인트 마케팅을 위한 제3자 제공 및 광고성정보 수신(GS엠비즈) (선택)
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_6_YN") == 'Y'){
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd12","461000");
	}
	
	//67번 약관 - GS&포인트 마케팅을 위한 제3자 제공 및 광고성정보 수신(한국신용데이터) (선택)
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_7_YN") == 'Y'){
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd14","467000");
	}
	//trace(">>>>>>>>>>>>ds_if_ars_card_data::"+ds_if_ars_card_data.saveXML());
	
	
	var	strSvcID = "IF_WAS_208";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_ars_card_env:a INTERFACE_DATA=ds_if_ars_card_data:a";
	var	strOutDatasets = "ds_if_ars_card_common=DS_COMMON ds_if_ars_card_header=DS_HEADER ds_if_ars_card_column=DS_COLUMN ds_if_ars_card_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
}


/********************************************************************************** 
 *  저장후 처리 - 신규등록용
***********************************************************************************/
function ars_card_end(){
		
	var enddata;
		
	if (ds_if_ars_card_record.getColumn("0","OT_RESPON_CODE")=="00000"){
	
		enddata=4; // 완료
		
	}else{		
	
		enddata=9;   //에러
		
	}
		
	ds_ars_card_end.clearData();
					
	fun_ds_srch(ds_ars_card_end, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO"));
	fun_ds_srch(ds_ars_card_end, "JOB_ID", userID);
	fun_ds_srch(ds_ars_card_end, "JOB_PRGR_ST_CD", enddata);		
	fun_ds_srch(ds_ars_card_end, "CATIVE_RSLT_MSG", "");	
	
	//2012.11.27 MIG통계 수정
	var	strSvcID = "End";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_end:a "; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_end ";
	}else{
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_end:a UPDATE_1_IDATA=ds_ars_card_end:a"; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_end UPDATE_1_ID=LPS010.Get_LPS_UPDATE_MIG_end";
	}
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
}



function lp_sms_send(){

	
	ds_get_param.clearData();
	ds_set_param.clearData();
	ds_SMS.clearData();
	ds_SMS_copy1.clearData();
	ds_SMS_copy2.clearData();
		
	//ds_get_param.setColumn(0,"TR_PHONE",	 edt_tel2.value);	
	
	ds_get_param.setColumn(0,"TR_PHONE",	 ds_out.getColumn(ds_out.rowposition,"MBPH_NO"));
	ds_get_param.setColumn(0,"TR_CALLBACK",	GetConfig("COM_2"));
		
	ds_get_param.setColumn(0,"TR_MSG",		"카드발급메세지");	
		
	
	ds_SMS.addRow();
	ds_SMS.setColumn(0, "TR_PHONE"          , ds_out.getColumn(ds_out.rowposition,"MBPH_NO"));            //수신번호		
	ds_SMS.setColumn(0, "TR_CALLBACK"       , GetConfig("COM_2"));         //발신번호
	ds_SMS.setColumn(0, "TR_MSG"            , "[GS칼텍스]고객님의 카드가 정상등록 처리 되었습니다."); 		   //수신메세지
	ds_SMS.setColumn(0, "SNDR_ID"      		, "LP");    
	ds_SMS.setColumn(0, "TR_PHONE"          , getTrim(ds_SMS.getColumn(0,"TR_PHONE")).replace("-", ""));            //수신번호		
	ds_SMS.setColumn(0, "TR_CALLBACK"       , getTrim(ds_SMS.getColumn(0,"TR_CALLBACK")).replace("-", ""));         //발신번호
	ds_SMS.setColumn(0, "TR_MSG"            , getTrim(ds_SMS.getColumn(0,"TR_MSG")).replace("\r\n", " ")); 		   //수신메세지	

	var len_msg = ds_SMS.getColumn(0, "TR_MSG");	
	
	if (len_msg.length < 81) {
		
		var nRow = ds_SMS_copy1.addRow();
		ds_SMS_copy1.copyRow(nRow, ds_SMS , 0);
		
	}else{
		
		alert("MMS로 전송됩니다.");
		var nRow = ds_SMS_copy2.addRow();
		ds_SMS_copy2.copyRow(nRow, ds_SMS , 0);		
			
	}
			
	//alert(ds_SMS.getColumn(0, "TR_MSG"));
	//alert(ds_out_sms.rowcount);
	//trace(ds_SMS.saveXML());
	
	
	var	strSvcID = "Auto_sms";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=ds_SMS_copy1:a INSERT_1_IDATA=ds_SMS_copy2:a";
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=COM170.Set_SMS_INSERT INSERT_1_ID=COM170.Set_MMS_INSERT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;				
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		
}


//------------------------------------------------------------------------------------------
// 캡티브 에러결과 저장 - 신규등록용
//------------------------------------------------------------------------------------------
function LP_error_end(){

	ds_ars_card_pass.clearData();
					
	fun_ds_srch(ds_ars_card_pass, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO"));
	fun_ds_srch(ds_ars_card_pass, "JOB_ID", userID);
	fun_ds_srch(ds_ars_card_pass, "JOB_CPLT_YN", "N");
	
	//ds_out.clearData();
	//더이상 사용 하지 않아서 일단 alert으로 확인 한다.
	if(ds_out.getColumn(ds_out.rowposition,"BIZ_CARD_YN") == "Y")
	{
		alert("관리자에게 문의 하세요.");
		//fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_MSG", ds_if_partcard_record.getColumn(0,"OT_RES_MSG"));	
		//fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_CD", ds_if_partcard_record.getColumn(0,"OT_RESPON_CODE"));
		return;
	}
	else
	{
		fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_MSG", ds_if_ars_card_record.getColumn(0,"OT_RES_MSG"));	
		fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_CD", ds_if_ars_card_record.getColumn(0,"OT_RESPON_CODE"));
	}
		    
	var	strSvcID = "Error";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_pass:a";
		strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_error";
	}else{
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_pass:a UPDATE_1_IDATA=ds_ars_card_pass:a";
		strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_error UPDATE_1_ID=LPS010.Set_LPS_UPDATE_error_MIG";
	}
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
}

//------------------------------------------------------------------------------------------
//  MOD함수
//------------------------------------------------------------------------------------------
function MOD(aa,bb){

var cc=aa%bb;
return cc;

}


//------------------------------------------------------------------------------------------
// CVC계산식
//------------------------------------------------------------------------------------------
function cvcCheck(cvcvalue){
//var cvcvalue = cvcdata;

	var excelcvc = (MOD(10-MOD((parseInt(cvcvalue.substr(0,1))+parseInt(cvcvalue.substr(2,1))+parseInt(cvcvalue.substr(4,1))+parseInt(cvcvalue.substr(6,1))+parseInt(cvcvalue.substr(8,1))+parseInt(cvcvalue.substr(10,1))+parseInt(cvcvalue.substr(12,1))+parseInt(cvcvalue.substr(14,1))),10),10))*100+
(MOD(10-MOD((parseInt(cvcvalue.substr(1,1))+parseInt(cvcvalue.substr(3,1))+parseInt(cvcvalue.substr(5,1))+parseInt(cvcvalue.substr(7,1))+parseInt(cvcvalue.substr(9,1))+parseInt(cvcvalue.substr(11,1))+parseInt(cvcvalue.substr(13,1))+parseInt(cvcvalue.substr(15,1))),10),10))*10+
MOD((10-MOD(7*(MOD(10-MOD((parseInt(cvcvalue.substr(0,1))+parseInt(cvcvalue.substr(2,1))+parseInt(cvcvalue.substr(4,1))+parseInt(cvcvalue.substr(6,1))+parseInt(cvcvalue.substr(8,1))+parseInt(cvcvalue.substr(10,1))+parseInt(cvcvalue.substr(12,1))+parseInt(cvcvalue.substr(14,1))),10),10))+
9*(MOD(10-MOD((parseInt(cvcvalue.substr(1,1))+parseInt(cvcvalue.substr(3,1))+parseInt(cvcvalue.substr(5,1))+parseInt(cvcvalue.substr(7,1))+parseInt(cvcvalue.substr(9,1))+parseInt(cvcvalue.substr(11,1))+parseInt(cvcvalue.substr(13,1))+parseInt(cvcvalue.substr(15,1))),10),10)),10)),10);

	return excelcvc;
}

]]></Script>
    <Layout>
      <Static id="Static36" text="총         건" position="absolute 1571 54 1639 66"/>
      <Static id="Static01" class="sta_WFSA_BG" position="absolute 12 12 1640 44" onclick="Static01_onclick" text=""/>
      <Static id="Static03" text="주민번호" class="sta_WFSA_label" position="absolute 632 54 692 66" visible="false"/>
      <MaskEdit id="edt_jumin" taborder="7" oneditclick="Msk_SrchTailRsBzNo_oneditclick" class="edt_WFSA" position="absolute 697 50 828 70" inputtype="number" imemode="alpha" inputfilter="dot,comma,sign,symbol,alpha,space" maxlength="13" type="string" mask="######-{#######}" onkeyup="edt_jumin_onkeyup" maskchar=" " style="align:left middle;" visible="false"/>
      <Button id="btn_srch" taborder="8" text="조회" onclick="btn_srch_onclick" class="btn_WFSA_P" position="absolute 954 18 1014 38"/>
      <Grid id="Grid00" taborder="9" binddataset="ds_out" position="absolute 12 71 1640 714" onheadclick="Grid00_onheadclick" cellsizingtype="both" onkeydown="Grid00_onkeydown">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="30"/>
              <Column size="120"/>
              <Column size="120"/>
              <Column size="0"/>
              <Column size="76"/>
              <Column size="66"/>
              <Column size="108"/>
              <Column size="150"/>
              <Column size="120"/>
              <Column size="120"/>
              <Column size="120"/>
              <Column size="150"/>
              <Column size="180"/>
              <Column size="180"/>
              <Column size="150"/>
              <Column size="2"/>
            </Columns>
            <Rows>
              <Row size="24" band="head"/>
              <Row size="24"/>
            </Rows>
            <Band id="head">
              <Cell displaytype="normal" edittype="none" text="선택"/>
              <Cell col="1" text="ARS등록일자"/>
              <Cell col="2" text="고객명"/>
              <Cell col="3" text="주민등록번호"/>
              <Cell col="4" text="생년월일"/>
              <Cell col="5" text="성별"/>
              <Cell col="6" text="휴대폰번호"/>
              <Cell col="7" text="카드번호"/>
              <Cell col="8" text="작업일자"/>
              <Cell col="9" text="작업상태"/>
              <Cell col="10" text="작업자ID"/>
              <Cell col="11" text="통화결과"/>
              <Cell col="12" text="접촉이력"/>
              <Cell col="13" text="결과메세지"/>
              <Cell col="14" text="SMS전송여부"/>
              <Cell col="15" text="seq_no"/>
            </Band>
            <Band id="body">
              <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
              <Cell col="1" text="bind:ARS_REG_DTM"/>
              <Cell col="2" text="bind:CUST_NM_1"/>
              <Cell col="3" text="bind:RES_REG_NO" mask="######-{#######}"/>
              <Cell col="4" text="bind:CUIK_BDAY" mask="####-##-##"/>
              <Cell col="5" text="bind:SEX_CDNM"/>
              <Cell col="6" text="bind:MBPH_NO"/>
              <Cell col="7" text="bind:CRD_NO" mask="####-####-####-####"/>
              <Cell col="8" text="bind:JOB_DT" mask="####-##-##"/>
              <Cell col="9" text="bind:JOB_PRGR_ST_CDNM"/>
              <Cell col="10" text="bind:JOB_ID"/>
              <Cell col="11" text="bind:CUR_RSLT_CDNM"/>
              <Cell col="12" text="bind:CNSL_CTT"/>
              <Cell col="13" text="bind:CATIVE_RSLT_MSG"/>
              <Cell col="14" text="bind:SMS_TRMS_YN"/>
              <Cell col="15" text="bind:SEQ_NO"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
      <Static id="sta_row" position="absolute 1585 54 1617 66" style="align:right top; " text=""/>
      <Button id="btn_del" taborder="11" text="삭제" position="absolute 1580 726 1640 746" onclick="btn_del_onclick" visible="false"/>
      <Button id="btn_srch00" taborder="12" text="ARS주민" onclick="btn_srch00_onclick" class="btn_WFSA_P" position="absolute 1562 808 1638 828" visible="false"/>
      <Static id="Static05" text="카드번호" class="sta_WFSA_label" position="absolute 680 22 740 34"/>
      <MaskEdit id="edt_card_num" taborder="13" text="____-____-____-____" type="string" mask="####-####-####-####" class="edt_WFSA" position="absolute 746 18 879 38" maxlength="16" inputtype="number" imemode="alpha" inputfilter="dot,comma,sign,symbol,alpha,space" maskchar=" " onkeyup="edt_card_num_onkeyup" style="align:left middle;" oneditclick="Msk_SrchCrdNo_oneditclick"/>
      <Static id="Static00" text="생년월일" class="sta_WFSA_label" position="absolute 24 22 84 34"/>
      <MaskEdit id="edt_cuik_bday" taborder="14" text="      -       " type="string" mask="####-##-##" maskchar=" " oneditclick="Msk_CuikBday_oneditclick" class="edt_WFSA" position="absolute 89 18 170 38" inputtype="number" imemode="alpha" inputfilter="dot,comma,sign,symbol,alpha,space" maxlength="13" style="align:left middle;" onkeydown="edt_cuik_bday_onkeydown"/>
      <Static id="Static02" text="성별" class="sta_WFSA_label" position="absolute 182 22 242 34"/>
      <Static id="Static04" text="성명" class="sta_WFSA_label" position="absolute 310 22 349 34"/>
      <Static id="Static06" text="휴대폰번호" class="sta_WFSA_label" position="absolute 481 22 567 34"/>
      <Edit id="Edt_hphone" taborder="18" ontextchanged="Edt_CelPhone_ontextchanged" position="absolute 559 18 659 38" onkeydown="Edt_hphone_onkeydown"/>
      <Edit id="edt_name" taborder="19" maxlength="60" position="absolute 349 18 442 38" style="align:left middle;" onkeydown="edt_name_onkeydown"/>
      <Combo id="cmb_sex_cd" taborder="20" class="cmb_WFSA" position="absolute 222 18 271 38" onkeydown="cmb_sex_cd_onkeydown"/>
      <Button id="btn_srchCustInfo" taborder="21" text="ARS고객조회" onclick="btn_srchCustInfo_onclick" class="btn_WFSA_P" position="absolute 1452 726 1568 746"/>
      <Button id="btn_del00" taborder="23" text="저장" onclick="btn_up_save_onclick" position="absolute 1566 19 1626 39"/>
      <Edit id="edt_seq" taborder="24" maxlength="60" visible="false" position="absolute 1283 728 1376 748" style="align:center middle; "/>
      <Static id="Static07" text="성명" class="sta_WFSA_label" position="absolute 1406 22 1445 34"/>
      <Edit id="in_name" taborder="25" maxlength="60" position="absolute 1445 18 1538 38" style="align:left middle; " onkeydown="in_name_onkeydown"/>
    </Layout>
    <Objects>
      <Dataset id="ds_srch" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true">
        <ColumnInfo>
          <Column id="A" type="STRING" size="256"/>
          <Column id="B" type="STRING" size="256"/>
          <Column id="C" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_out_b" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true">
        <ColumnInfo>
          <Column id="PH_REC_STR_DTM" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="CUST_RES_REG_NO" type="STRING" size="256"/>
          <Column id="CRD_INFO" type="STRING" size="256"/>
          <Column id="JOB_DT" type="STRING" size="256"/>
          <Column id="JOB_PRGR_ST_CD" type="STRING" size="256"/>
          <Column id="JOB_PRGR_ST_CDNM" type="STRING" size="256"/>
          <Column id="JOB_ID" type="STRING" size="256"/>
          <Column id="CUR_RSLT_CD" type="STRING" size="256"/>
          <Column id="CNSL_CTT" type="STRING" size="256"/>
          <Column id="CATIVE_RSLT_MSG" type="STRING" size="256"/>
          <Column id="SMS_TRMS_YN" type="STRING" size="256"/>
          <Column id="JOB_YN" type="STRING" size="256"/>
          <Column id="CUR_RSLT_CDNM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_out" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="ARS_REG_DTM" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="RES_REG_NO" type="STRING" size="256"/>
          <Column id="CUIK_BDAY" type="STRING" size="256"/>
          <Column id="SEX_CDNM" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="JOB_DT" type="STRING" size="256"/>
          <Column id="JOB_PRGR_ST_CD" type="STRING" size="256"/>
          <Column id="JOB_PRGR_ST_CDNM" type="STRING" size="256"/>
          <Column id="JOB_ID" type="STRING" size="256"/>
          <Column id="CUR_RSLT_CD" type="STRING" size="256"/>
          <Column id="CNSL_CTT" type="STRING" size="256"/>
          <Column id="CATIVE_RSLT_MSG" type="STRING" size="256"/>
          <Column id="SMS_TRMS_YN" type="STRING" size="256"/>
          <Column id="JOB_YN" type="STRING" size="256"/>
          <Column id="STPL_AGRM_YN" type="STRING" size="256"/>
          <Column id="JOB_CPLT_YN" type="STRING" size="256"/>
          <Column id="PNCH_CUST_YN" type="STRING" size="256"/>
          <Column id="CRD_PINT" type="STRING" size="256"/>
          <Column id="MBPH_NO" type="STRING" size="256"/>
          <Column id="NEW_AGISSU_DV_CD" type="STRING" size="256"/>
          <Column id="CUR_RSLT_CDNM" type="STRING" size="256"/>
          <Column id="SMS_AGRM_YN" type="STRING" size="256"/>
          <Column id="INFO_CONJ_AGRM_YN" type="STRING" size="256"/>
          <Column id="FILE_NM" type="STRING" size="256"/>
          <Column id="FILE_PATH" type="STRING" size="256"/>
          <Column id="CUST_PW" type="STRING" size="256"/>
          <Column id="TEL_NO" type="STRING" size="256"/>
          <Column id="SEQ_NO" type="STRING" size="256"/>
          <Column id="TEMP" type="STRING" size="256"/>
          <Column id="CRD_ST_CD" type="STRING" size="256"/>
          <Column id="CRD_ST_CD_NM" type="STRING" size="256"/>
          <Column id="SEX_CD" type="STRING" size="256"/>
          <Column id="AUTHN_SBJT_CD" type="STRING" size="256"/>
          <Column id="COM_CO_DIV_CD" type="STRING" size="256"/>
          <Column id="SMS_AUTHN_DTM" type="STRING" size="256"/>
          <Column id="AGRM_1_YN" type="STRING" size="256"/>
          <Column id="AGRM_2_YN" type="STRING" size="256"/>
          <Column id="AGRM_3_YN" type="STRING" size="256"/>
          <Column id="AGRM_4_YN" type="STRING" size="256"/>
          <Column id="AGRM_5_YN" type="STRING" size="256"/>
          <Column id="AGRM_6_YN" type="STRING" size="256"/>
          <Column id="BIZ_CARD_YN" type="STRING" size="256"/>
          <Column id="CUST_NM_1" type="STRING" size="256"/>
          <Column id="MBPH_NO_1" type="STRING" size="256"/>
          <Column id="TEL_NO_1" type="STRING" size="256"/>
          <Column id="AGRM_7_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_srch2" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true">
        <ColumnInfo>
          <Column id="A" type="STRING" size="256"/>
          <Column id="B" type="STRING" size="256"/>
          <Column id="C" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_xml" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_PRIV_CNT_HIS" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ACC_NO" type="STRING" size="256"/>
          <Column id="SYS_CD" type="STRING" size="256"/>
          <Column id="SYS_IP" type="STRING" size="256"/>
          <Column id="USR_ID" type="STRING" size="256"/>
          <Column id="USR_CMP_ID" type="STRING" size="256"/>
          <Column id="USR_PART" type="STRING" size="256"/>
          <Column id="ACC_DAT" type="STRING" size="256"/>
          <Column id="ACC_IP" type="STRING" size="256"/>
          <Column id="ACC_URL" type="STRING" size="256"/>
          <Column id="PER_TSK_CD" type="STRING" size="256"/>
          <Column id="PER_TSK_DT" type="STRING" size="256"/>
          <Column id="PER_TSK_ID" type="STRING" size="256"/>
          <Column id="CAL_FUN" type="STRING" size="256"/>
          <Column id="INQ_CON" type="STRING" size="256"/>
          <Column id="INQ_CNT" type="STRING" size="256"/>
          <Column id="INQ_INFO_LIST" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ars_del_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_ars_card_pass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_SMS" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TR_PHONE" type="STRING" size="256"/>
          <Column id="TR_CALLBACK" type="STRING" size="256"/>
          <Column id="TR_MSG" type="STRING" size="256"/>
          <Column id="SINF_RSN" type="STRING" size="256"/>
          <Column id="DSFT_ACPN_SEQ_NO" type="STRING" size="256"/>
          <Column id="ASCT_SNDG_YN" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="SNDR_ID" type="STRING" size="256"/>
          <Column id="USR_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SMS_copy1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TR_PHONE" type="STRING" size="256"/>
          <Column id="TR_CALLBACK" type="STRING" size="256"/>
          <Column id="TR_MSG" type="STRING" size="256"/>
          <Column id="SINF_RSN" type="STRING" size="256"/>
          <Column id="DSFT_ACPN_SEQ_NO" type="STRING" size="256"/>
          <Column id="ASCT_SNDG_YN" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="SNDR_ID" type="STRING" size="256"/>
          <Column id="USR_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SMS_copy2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TR_PHONE" type="STRING" size="256"/>
          <Column id="TR_CALLBACK" type="STRING" size="256"/>
          <Column id="TR_MSG" type="STRING" size="256"/>
          <Column id="SINF_RSN" type="STRING" size="256"/>
          <Column id="DSFT_ACPN_SEQ_NO" type="STRING" size="256"/>
          <Column id="ASCT_SNDG_YN" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="SNDR_ID" type="STRING" size="256"/>
          <Column id="USR_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_master_name_in" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ars_card_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_STATUS_CODE" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
          <Column id="IO_PRCD_ID" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ars_card_end" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_set_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_get_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TR_PHONE" type="STRING" size="256"/>
          <Column id="TR_CALLBACK" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="TR_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item19" compid="edt_seq" propid="value" datasetid="ds_out" columnid="SEQ_NO"/>
    </Bind>
  </Form>
</FDL>
