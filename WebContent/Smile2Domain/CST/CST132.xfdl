<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.2">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="CST132" classname="CST080" inheritanceid="" cachelevel="" position="absolute 0 0 1652 800" version="" titletext="가입신청서 등록/수정" onload="CST132_onload">
    <Layout>
      <Static id="Static01" class="sta_WFSA_BG" position="absolute 12 12 1640 44" text=""/>
      <Button id="Btn_Srch" taborder="2" text="조회" class="btn_WFSA_P" position="absolute 1558 18 1618 38" onclick="Btn_Srch_onclick"/>
      <Static id="Static11" text="총         건" position="absolute 1572 54 1640 66"/>
      <Static id="Stt_tot" position="absolute 1586 54 1618 66" style="align:right top; " text=""/>
      <Static id="Stt_SrchCustNo" text="고객번호" class="sta_WFSA_label" position="absolute 262 22 329 34"/>
      <Static id="Static34" text="가입신청서" class="sta_WF_subtitle" position="absolute 17 187 186 211" style="font:dotum,9,bold; "/>
      <Static id="Static03" text="신청서 이미지" class="sta_WF_subtitle" position="absolute 17 303 186 327" style="font:dotum,9,bold; "/>
      <Edit id="Edt_SrchCustNo" taborder="0" maxlength="10" class="edt_WFSA" position="absolute 326 18 426 38" lengthunit="ascii" inputtype="digit" onkeyup="SrchCond_onkeyup"/>
      <Button id="Btn_SrchCustNo" taborder="1" class="btn_WFDA_srch" position="absolute 429 18 449 38" onclick="Btn_SrchCustNo_onclick"/>
      <Static id="Static00" text="가입신청서 정보" class="sta_WF_subtitle" position="absolute 17 49 186 73" style="font:dotum,9,bold; "/>
      <Button id="Btn_ImgUpload" taborder="10" text="이미지찾기" position="absolute 1257 299 1379 319" onclick="Btn_ImgUpload_onclick"/>
      <Static id="Static04" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 161 237 555 263" text=""/>
      <Static id="Static12" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 161 212 555 238" text=""/>
      <Static id="Stt_BsneDiv" text="* 업체구분" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 12 237 162 263"/>
      <Static id="Stt_ScanSeq" text="스캔일련번호" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 12 212 162 238"/>
      <Edit id="Edt_BsneDiv" taborder="7" position="absolute 165 240 465 260" lengthunit="ascii" maxlength="1"/>
      <Edit id="Edt_ScanSeq" taborder="4" readonly="true" position="absolute 165 215 465 235"/>
      <Static id="Static02" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 703 237 1097 263" text=""/>
      <Static id="Static06" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 703 212 1097 238" text=""/>
      <Static id="Stt_JoinDtm" text="* 등록일자" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 554 237 704 263"/>
      <Static id="Stt_CrdNo" text="* 카드번호" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 554 212 704 238"/>
      <Static id="Static08" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 1245 237 1639 263" text=""/>
      <Static id="Static09" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 1245 212 1639 238" text=""/>
      <Static id="Stt_JoinSt" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 1096 237 1246 263" text="* 가입상태"/>
      <Static id="Stt_NxttSeq" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 1096 212 1246 238" text="* GSN 파일시퀀스"/>
      <Edit id="Edt_NxttSeq" taborder="6" position="absolute 1249 215 1549 235" maxlength="10" lengthunit="ascii"/>
      <Button id="Btn_Excel" taborder="3" text="ExcelDownload" onclick="Btn_Excel_onclick" position="absolute 1513 180 1635 200" visible="false"/>
      <Button id="Btn_Del" taborder="13" text="이미지삭제" position="absolute 1513 299 1635 319" onclick="Btn_Del_onclick" enable="false"/>
      <Button id="Btn_Upd" taborder="12" text="저장" position="absolute 1565 799 1635 819" onclick="Btn_Upd_onclick"/>
      <Button id="Btn_Insrt" taborder="11" text="신규" position="absolute 1489 799 1559 819" onclick="Btn_Insrt_onclick"/>
      <MaskEdit id="Msk_CrdNo" taborder="26" position="absolute 707 215 1007 235" type="string" mask="@@@@-@@@@-@@@@-@@@@" maskchar=" " style="padding:0 0 0 6;align:left middle;"/>
      <Button id="btn_Confirm" taborder="27" text="확인" class="btn_WFDA_B" position="absolute 1010 215 1060 235" onclick="btn_Confirm_onclick"/>
      <Grid id="Grd_JoinFormList" taborder="28" binddataset="ds_if_sel_joinform_record" useinputpanel="false" cellsizingtype="both" nodatatext="조회된 결과가 없습니다." onheadclick="Grd_JoinFormList_onheadclick" position="absolute 12 72 1640 170" onselectchanged="Grd_JoinFormList_onselectchanged">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="40"/>
              <Column size="140"/>
              <Column size="150"/>
              <Column size="100"/>
              <Column size="120"/>
              <Column size="150"/>
              <Column size="120"/>
              <Column size="120"/>
              <Column size="100"/>
            </Columns>
            <Rows>
              <Row size="24" band="head"/>
              <Row size="24"/>
            </Rows>
            <Band id="head">
              <Cell text="NO"/>
              <Cell col="1" text="카드번호"/>
              <Cell col="2" text="스캔일련번호"/>
              <Cell col="3" text="업체구분"/>
              <Cell col="4" text="본등록일자"/>
              <Cell col="5" text="GSM 파일시퀀스"/>
              <Cell col="6" text="이미지유형"/>
              <Cell col="7" text="가입상태"/>
              <Cell col="8" text="이미지존재여부"/>
            </Band>
            <Band id="body">
              <Cell text="expr:currow+1"/>
              <Cell col="1" text="bind:CRD_NO" mask="@@@@-@@@@-@@@@-@@@@" maskchar=" "/>
              <Cell col="2" text="bind:SCAN_SEQ"/>
              <Cell col="3" text="bind:BSNE_DIV"/>
              <Cell col="4" text="bind:JOIN_YMD" mask="@@@@-@@-@@" maskchar=" "/>
              <Cell col="5" text="bind:NXTT_SEQ"/>
              <Cell col="6" text="bind:FILE_TP"/>
              <Cell col="7" text="bind:JOIN_ST_NM"/>
              <Cell col="8" text="bind:FILE_IMG_ST"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
      <Calendar id="Cal_JoinDtm" taborder="29" position="absolute 707 240 1007 260" style="usetrailingday:true;buttonsize:-1;padding:0 0 0 0; :disabled {padding:0 0 0 0;}" dateformat="yyyy-MM-dd"/>
      <Static id="Stt_SrchGbn" text="조회구분" class="sta_WFSA_label" position="absolute 43 21 108 33"/>
      <Combo id="Cmb_SrchGbn" taborder="31" innerdataset="ds_cmb_srch_gbn" codecolumn="CODE" datacolumn="CODE_NM" onitemchanged="Cmb_SrchGbn_onitemchanged" onkeyup="SrchCond_onkeyup" class="cmb_WFSA" position="absolute 113 18 213 38"/>
      <Static id="Stt_SrchCrdNo" text="카드번호" class="sta_WFSA_label" position="absolute 262 21 327 33"/>
      <MaskEdit id="Msk_SrchCrdNo" taborder="32" text="    -    -    -    " type="string" mask="####-####-####-####" maskchar=" " onkeyup="SrchCond_onkeyup" oneditclick="Msk_SrchCrdNo_oneditclick" class="mae_WFSA" position="absolute 326 18 449 38" style="padding:0 0 0 3; align:left middle; "/>
      <Static id="Static05" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 161 262 555 288" text=""/>
      <Static id="Stt_ImgFileNm" text="가입신청서 파일명" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 12 262 162 288"/>
      <Edit id="Edt_ImgFileNm" taborder="33" readonly="true" position="absolute 165 265 465 285" lengthunit="ascii" maxlength="30"/>
      <Static id="Static07" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 703 262 1097 288" text=""/>
      <Static id="Stt_ImgFileTp" text="가입신청서 이미지유형" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 554 262 704 288"/>
      <Edit id="Edt_ImgFileTp" taborder="34" readonly="true" position="absolute 707 265 1007 285" lengthunit="ascii" maxlength="4"/>
      <Static id="Static10" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 1245 262 1639 288" text=""/>
      <Static id="Stt_ImgFileSize" text="가입신청서 이미지크기" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 1096 262 1246 288"/>
      <Edit id="Edt_ImgFileSize" taborder="35" readonly="true" position="absolute 1249 265 1549 285" lengthunit="ascii" maxlength="10"/>
      <CheckBox id="Chk_CrdNoYn" taborder="36" position="absolute 1066 215 1083 234" readonly="true" visible="false"/>
      <Button id="Btn_Init" taborder="37" text="초기화" position="absolute 1412 799 1482 819" onclick="Btn_Init_onclick"/>
      <Combo id="Cmb_JoinSt" taborder="38" position="absolute 1249 240 1549 260"/>
      <Static id="Stt_info" text="※ TIF 이미지만 등록 가능합니다." position="absolute 16 798 263 824" style="color:crimson; font:Dotum,9,bold; "/>
      <Button id="Btn_Cncl" taborder="39" text="이미지취소" position="absolute 1385 299 1507 319" onclick="Btn_Cncl_onclick"/>
      <Div id="Div_Img" taborder="40" url="CST::CST140.xfdl" position="absolute 12 326 1640 792">
        <Layout/>
        <Layout/>
      </Div>
    </Layout>
    <Script type="xscript4.0"><![CDATA[/*
 * 대분류 	: 	CST
 * 화면ID 	: 	CST132
 * 설  명 	: 	고객 가입신청서를 등록/수정/삭제 처리한다.
 * 작성일 	: 	2011.12
 * 작성자 	: 	송기환
 *
 * 변경일자 	변경자	내용
 *-----------	------	---------------------------------------------------------------------------------------------------
 * 		  
 */

include "LIB::CommonLib.xjs"

// 이미지뷰어 최초크기
var ImgViewHeigt;
var ImgViewWidth;

/********************************************************************************** 
 * Form onload
***********************************************************************************/
function CST132_onload(obj:Form, e:LoadEventInfo)
{
	// 최초크기세팅(초기화 시 사용하기 위해)
	ImgViewHeigt = Div_Img.Img_ScanImg.position.height;
	ImgViewWidth = Div_Img.Img_ScanImg.position.width;
	
	setDefaultValue();	// 통합코드 콤보
	
	// 조회조건 초기화
	Cmb_SrchGbn.index = 0;	
	Cmb_JoinSt.index  = 0;
	Chk_CrdNoYn.value = 0;
	Cmb_SrchGbn_onitemchanged();
	fn_initSrchCond();
}

/********************************************************************************** 
 * 콤보세팅(통합코드)
***********************************************************************************/
function setDefaultValue()
{
    var arrCombo           = ["Cmb_JoinSt"];
    var arrSearchKey       = ["NW125"];
    var arrListMode        = ["TN"];                    					
    var arrOptionRowValue  = [","];                  					

	setComboList(arrCombo, arrSearchKey, arrListMode, arrOptionRowValue);     					//공통콤보가져오기	
}


/********************************************************************************** 
 * 조회조건 초기화
***********************************************************************************/
function fn_initSrchCond()
{	
	Edt_SrchCustNo.value 	= "";
	Msk_SrchCrdNo.value		= "";	
}

/********************************************************************************** 
 * 고객번호찾기 아이콘 클릭 시
***********************************************************************************/
function Btn_SrchCustNo_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_get_param.clearData();
	ds_set_param.clearData();
		
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

	PopupDialog("COM200","COM::COM200.xfdl", -1, -1, 972, 539, false, -1, arrParam, false, false, true, false);
	
	if(ds_set_param.rowcount > 0){
		Edt_SrchCustNo.value = getTrim(ds_set_param.getColumn(ds_set_param.rowposition,"CUST_NO"));
	}		
}

/********************************************************************************** 
 * 조회버튼 클릭 시
***********************************************************************************/
function Btn_Srch_onclick(obj:Button,  e:ClickEventInfo)
{
	if(Cmb_SrchGbn.value == "01") {
		if(getTrim(Edt_SrchCustNo.value) == "") {
			cf_Alert("COME0007", "고객번호");		// 고객번호 을(를) 입력하셔야합니다.
			Edt_SrchCustNo.setFocus();
			return;
		} else if(getTrim(Edt_SrchCustNo.value).length != 10) {
			cf_Alert("COME0028","고객번호","10");	// 고객번호는 10자리가 입력되어야 합니다.		
			Edt_SrchCustNo.setFocus();
			return;			
		}		
	} else if(Cmb_SrchGbn.value == "02") {
		if(getTrim(Msk_SrchCrdNo.value) == "") {
			cf_Alert("COME0007", "카드번호");		// 카드번호 을(를) 입력하셔야합니다.
			Msk_SrchCrdNo.setFocus();
			return;
		} else if(getTrim(Msk_SrchCrdNo.value).length != 16) {
			cf_Alert("COME0028","카드번호","16");	// 카드번호는 16자리가 입력되어야 합니다.		
			Msk_SrchCrdNo.setFocus();
			return;
		}
	}
	
	// 가입신청서 조회
	fn_selJoinForm_if();
}

/********************************************************************************** 
 * Interface 가입신청서 조회(scScanSelC01)
 * 원래 100건씩 조회되는데 '고객번호'로는 그 이상 조회될 가능성이 절대!!! 없다고 함
 *  => 인터페이스 개발 담당자(조대희 과장)에게 문의해봤음
***********************************************************************************/
function fn_selJoinForm_if()
{	
	// 카드번호 수정못하도록 readonly 처리
	// 카드번호 수정은 "가입신청서 카드번호 수정" 화면에서 처리
	Msk_CrdNo.readonly = true;
	
	var strGbnVal = "";
	if(Cmb_SrchGbn.value == "01") {
		strGbnVal = getTrim(Edt_SrchCustNo.value);
	} else if(Cmb_SrchGbn.value == "02") {
		strGbnVal = getTrim(Msk_SrchCrdNo.value);
	}
		
	// 건수 초기화
	Stt_tot.text = "";
	
	// ImageView DS 초기화
	Div_Img.ds_img_view.clearData();	

	// IF DS 초기화
	ds_if_sel_joinform_env.clearData();
	ds_if_sel_joinform_common.clearData();
	ds_if_sel_joinform_column.clearData();
	ds_if_sel_joinform_header.clearData();
	ds_if_sel_joinform_data.clearData();
	ds_if_sel_joinform_record.clearData();
	
	// IF ENV DS 세팅
	fn_setIfEnvDs(ds_if_sel_joinform_env,"WAS","scScanSelC01.do","","STP_SC_SCAN_SEL_C01_Rsp","","OT_RESULT");

	// IF DATA DS 세팅		
	fun_ds_srch(ds_if_sel_joinform_data, "req_chnl_code","610050");
	fun_ds_srch(ds_if_sel_joinform_data, "input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_sel_joinform_data, "input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_sel_joinform_data, "input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
	
	fun_ds_srch(ds_if_sel_joinform_data, "in_page_no","1");										// 페이지번호
	fun_ds_srch(ds_if_sel_joinform_data, "in_page_size","100");									// 한 페이지에 보여줄 Row수

	fun_ds_srch(ds_if_sel_joinform_data, "in_gubn",Cmb_SrchGbn.value);					// 조회구분("01" 고객번호, "02" 카드번호)
	fun_ds_srch(ds_if_sel_joinform_data, "in_cust_info",strGbnVal);						// 고객번호
	fun_ds_srch(ds_if_sel_joinform_data, "in_bsne_div","");								// 업체구분
	fun_ds_srch(ds_if_sel_joinform_data, "in_join_yr","");								// 본등록년도	
	fun_ds_srch(ds_if_sel_joinform_data, "in_join_md","");								// 본등록월일
	fun_ds_srch(ds_if_sel_joinform_data, "in_nxtt_seq","");								// GSN 파일시퀀스
	fun_ds_srch(ds_if_sel_joinform_data, "in_join_st","");								// 가입상태	
		
	var	strSvcID = "IF_SCAN_CSC_001";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_sel_joinform_env:a INTERFACE_DATA=ds_if_sel_joinform_data:a";
	var	strOutDatasets = "ds_if_sel_joinform_common=DS_COMMON ds_if_sel_joinform_header=DS_HEADER ds_if_sel_joinform_column=DS_COLUMN ds_if_sel_joinform_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack_if";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
}

/********************************************************************************** 
 * 확인버튼 클릭 시
***********************************************************************************/
function btn_Confirm_onclick(obj:Button,  e:ClickEventInfo)
{
	var strCrdNo = getTrim(Msk_CrdNo.value).replace("-","");

	if(strCrdNo == "") {
		cf_Alert("COME0007", "카드번호");		// 카드번호 을(를) 입력하셔야합니다.
		Msk_CrdNo.setFocus();
		return;			
	} else if(strCrdNo.length != 16) {
		cf_Alert("COME0028","카드번호","16");	// 카드번호는 10자리가 입력되어야 합니다.		
		Msk_CrdNo.setFocus();
		return;
	}
	
	//카드번호 확인 조회
	fn_selChkCard_if();
}

/********************************************************************************** 
 * Interface 카드번호 확인 조회(scScanCardchkSelC01)
***********************************************************************************/
function fn_selChkCard_if()
{
	var strCrdNo = getTrim(Msk_CrdNo.value).replace("-","");	

	// IF DS 초기화
	ds_if_sel_chkcard_env.clearData();
	ds_if_sel_chkcard_common.clearData();
	ds_if_sel_chkcard_column.clearData();
	ds_if_sel_chkcard_header.clearData();
	ds_if_sel_chkcard_data.clearData();
	ds_if_sel_chkcard_record.clearData();
	
	// IF ENV DS 세팅
	fn_setIfEnvDs(ds_if_sel_chkcard_env,"WAS","scScanCardchkSelC01.do","","STP_SC_SCAN_CARDCHK_SEL_C01_Rsp","","");

	// IF DATA DS 세팅		
	fun_ds_srch(ds_if_sel_chkcard_data, "req_chnl_code","610050");
	fun_ds_srch(ds_if_sel_chkcard_data, "input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_sel_chkcard_data, "input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_sel_chkcard_data, "input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
	
	fun_ds_srch(ds_if_sel_chkcard_data, "in_crd_no",strCrdNo);	// 카드번호
		
	var	strSvcID = "IF_SCAN_CSC_008";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_sel_chkcard_env:a INTERFACE_DATA=ds_if_sel_chkcard_data:a";
	var	strOutDatasets = "ds_if_sel_chkcard_common=DS_COMMON ds_if_sel_chkcard_header=DS_HEADER ds_if_sel_chkcard_column=DS_COLUMN ds_if_sel_chkcard_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack_if";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		
}

/********************************************************************************** 
 * 초기화버튼 클릭 시
***********************************************************************************/
function Btn_Init_onclick(obj:Button,  e:ClickEventInfo)
{
	// 조회조건 초기화
	Cmb_SrchGbn.index = 0;
	Cmb_JoinSt.index  = 0;
	Chk_CrdNoYn.value = 0;
	Cmb_SrchGbn_onitemchanged();
	fn_initSrchCond();
		
	// DATA 초기화
	ds_if_sel_joinform_record.clearData();
	ds_if_sel_joinformImg_record.clearData();
	Div_Img.ds_img_view.clearData();
	Cal_JoinDtm.value = "";
	Chk_CrdNoYn.value = 0;
	
	// 버튼 enable 처리
	Btn_Del.enable = false;
	
	// 카드번호 readonly 처리
	Msk_CrdNo.readonly = true;
}

/********************************************************************************** 
 * 신규버튼 클릭 시
***********************************************************************************/
function Btn_Insrt_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_if_sel_joinform_record.rowcount > 0){
		if (!cf_Confirm("COMI028","현재정보를 초기화 후 신규입력을 진행"))	return;		// 초기화 후 신규입력을 진행하시겠습니까?
	}
	
	// 초기화
	Btn_Init_onclick();
	
	// 신규입력을 위한 행 추가
	ds_if_sel_joinform_record.addRow();
		
	// 등록시에만 카드번호 입력하도록 카드번호 readonly false로 변경
	Msk_CrdNo.readonly = false;	
	Msk_CrdNo.setFocus();
	
	// DATA 초기화
	Cmb_JoinSt.value = "01";		// 정상으로 세팅
	
}

/********************************************************************************** 
 * 저장버튼 클릭 시 - 선택된 Row의 RowType으로 등록/수정 구분
***********************************************************************************/
function Btn_Upd_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_if_sel_joinform_record.rowcount == 0){
		cf_Alert("CAME0005","가입신청서 정보");		// 가입신청서 정보 가(이) 없습니다.
		return;
	}
	
	var intSelRow	= ds_if_sel_joinform_record.rowposition;
	var intRowType	= ds_if_sel_joinform_record.getRowType(intSelRow);
	var strImgSt 	= ds_if_sel_joinform_record.getColumn(intSelRow,"FILE_IMG_ST");
	
	// validation 체크
	if(intRowType == 1){
		cf_Alert("CAME0005", "변경된 정보");		// 변경된 정보 가(이) 없습니다.
		return;
	}
	
	if(getTrim(Msk_CrdNo.value) == "") {
		cf_Alert("COME0007", "카드번호");		// 카드번호 을(를) 입력하셔야합니다.
		Msk_CrdNo.setFocus();
		return;
	} else if(getTrim(Msk_CrdNo.value).replace("-","").length != 16) {
		cf_Alert("COME0028","카드번호","16");	// 카드번호는 16자리가 입력되어야 합니다.		
		Msk_CrdNo.setFocus();
		return;
	}
	
	if(getTrim(Edt_NxttSeq.value) == ""){
 		cf_Alert("COME0007", "GSN 파일시퀀스");		// GSN 파일시퀀스 을(를) 입력하셔야합니다.
 		Edt_NxttSeq.setFocus();
		return;
	}
	
	if(getTrim(Edt_BsneDiv.value) == ""){
 		cf_Alert("COME0007", "업체구분");			// 업체구분 을(를) 입력하셔야합니다.
 		Edt_BsneDiv.setFocus();
		return;
	}
	
	if(getTrim(Cal_JoinDtm.value) == ""){
 		cf_Alert("COME0007", "등록일자");			// 등록일자 을(를) 입력하셔야합니다.
 		Cal_JoinDtm.setFocus();
		return;		
	}
	
	if(getTrim(Cmb_JoinSt.value) == ""){
		cf_Alert("COME0008", "가입상태");			// 가입상태 을(를) 선택하셔야합니다.
		return;
	}
	
	if(intRowType == 2){
		if(Chk_CrdNoYn.value == 0){
			cf_Alert("COME0037", "카드번호 확인");		// 카드번호 확인 을(를) 먼저 하셔야 합니다.
			return;
		}
		
		if(Div_Img.ds_img_view.rowcount == 0){
			cf_Alert("CAME0005", "업로드 된 이미지");	// 업로드 된 이미지 가(이) 없습니다.
			return;
		}
	
		if (!cf_Confirm("COMI0012","등록"))	return;		// 등록 처리하시겠습니까?
		fn_insJoinform_if("I");		
	} else if(intRowType == 4){
		if (!cf_Confirm("COMI0012","수정"))	return;		// 수정 처리하시겠습니까?
		fn_insJoinform_if("U");
	}
}

/********************************************************************************** 
 * Interface 가입신청서 등록/수정(scScanInsC01)
***********************************************************************************/
function fn_insJoinform_if(argInDiv)
{
	var strJoinYr = ""; 
	var strJoinMd = "";
	strJoinYr = getTrim(Cal_JoinDtm.value).substr(0,4);
	strJoinMd = getTrim(Cal_JoinDtm.value).substr(4,4);
	
	// BASE64 인코딩하여 String 형식으로 변환
	var strEcdImg = "";	
	strEcdImg = fn_getImgData();
	
	// IF DS 초기화
	ds_if_ins_joinform_env.clearData();
	ds_if_ins_joinform_common.clearData();
	ds_if_ins_joinform_column.clearData();
	ds_if_ins_joinform_header.clearData();
	ds_if_ins_joinform_data.clearData();
	ds_if_ins_joinform_record.clearData();
	
	// IF ENV DS 세팅
	fn_setIfEnvDs(ds_if_ins_joinform_env,"WAS","scScanInsC01.do","","STP_SC_SCAN_INS_C01_Rsp","","");

	// IF DATA DS 세팅		
	fun_ds_srch(ds_if_ins_joinform_data, "req_chnl_code","610050");
	fun_ds_srch(ds_if_ins_joinform_data, "input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_ins_joinform_data, "input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_ins_joinform_data, "input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
	
	fun_ds_srch(ds_if_ins_joinform_data, "in_div",argInDiv);									// 구분(I:등록, U:수정)
	fun_ds_srch(ds_if_ins_joinform_data, "in_scan_seq",getTrim(Edt_ScanSeq.value));				// 스캔 일련번호
	fun_ds_srch(ds_if_ins_joinform_data, "in_crd_no",getTrim(Msk_CrdNo.value).replace("-",""));	// 카드번호
	fun_ds_srch(ds_if_ins_joinform_data, "in_bsne_div",getTrim(Edt_BsneDiv.value));				// 업체구분
	fun_ds_srch(ds_if_ins_joinform_data, "in_join_yr",strJoinYr);								// 가입년도
	fun_ds_srch(ds_if_ins_joinform_data, "in_join_md",strJoinMd);								// 가입월일
	fun_ds_srch(ds_if_ins_joinform_data, "in_nxtt_seq",getTrim(Edt_NxttSeq.value));				// 넥스테이션 시퀀스
	fun_ds_srch(ds_if_ins_joinform_data, "in_file_nm",getTrim(Edt_ImgFileNm.value));			// 가입신청서 파일명
	fun_ds_srch(ds_if_ins_joinform_data, "in_file_tp",getTrim(Edt_ImgFileTp.value));			// 가입신청서 이미지유형
	fun_ds_srch(ds_if_ins_joinform_data, "in_file_size",getTrim(Edt_ImgFileSize.value));		// 가입신청서 이미지사이즈
	fun_ds_srch(ds_if_ins_joinform_data, "in_file_img",strEcdImg);								// 가입신청서 이미지
	fun_ds_srch(ds_if_ins_joinform_data, "in_join_st",getTrim(Cmb_JoinSt.value));				// 가입상태
	
	if(argInDiv == "I"){
		var	strSvcID = "IF_SCAN_CSC_006_INS";
	} else if(argInDiv == "U"){
		var	strSvcID = "IF_SCAN_CSC_006_UPD";
	}
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_ins_joinform_env:a INTERFACE_DATA=ds_if_ins_joinform_data:a";
	var	strOutDatasets = "ds_if_ins_joinform_common=DS_COMMON ds_if_ins_joinform_header=DS_HEADER ds_if_ins_joinform_column=DS_COLUMN ds_if_ins_joinform_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack_if";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
}


/********************************************************************************** 
 * 삭제버튼 클릭 시
***********************************************************************************/
function Btn_Del_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_if_sel_joinform_record.rowcount == 0){
		cf_Alert("BNSE0036","가입신청서 정보");		// 조회된 가입신청서 정보가(이) 없습니다.
		return;
	}
	
	var strScanSeq = ds_if_sel_joinform_record.getColumn(ds_if_sel_joinform_record.rowposition,"SCAN_SEQ");

	if(strScanSeq == ""){
		cf_Alert("CAME0005","스캔일련번호");		// 스캔일련번호 가(이) 없습니다.	
		return;
	}
	
	if (!cf_Confirm("COMI0012","가입신청서 이미지를 삭제"))	return;		// 가입신청서 이미지를 삭제 처리하시겠습니까?
		
	// 가입신청서 삭제
	fn_delJoinForm_if(strScanSeq);
}

/********************************************************************************** 
 * Interface 가입신청서 삭제(scScanDelC01)
***********************************************************************************/
function fn_delJoinForm_if(argScnSeq)
{
	// IF DS 초기화
	ds_if_del_joinform_env.clearData();
	ds_if_del_joinform_common.clearData();
	ds_if_del_joinform_column.clearData();
	ds_if_del_joinform_header.clearData();
	ds_if_del_joinform_data.clearData();
	ds_if_del_joinform_record.clearData();
	
	// IF ENV DS 세팅
	fn_setIfEnvDs(ds_if_del_joinform_env,"WAS","scScanDelC01.do","","STP_SC_SCAN_DEL_C01_Rsp","","");

	// IF DATA DS 세팅		
	fun_ds_srch(ds_if_del_joinform_data, "req_chnl_code","610050");
	fun_ds_srch(ds_if_del_joinform_data, "input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_del_joinform_data, "input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_del_joinform_data, "input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
	
	fun_ds_srch(ds_if_del_joinform_data, "in_scan_seq",argScnSeq);	// 스캔 일련번호
		
	var	strSvcID = "IF_SCAN_CSC_003";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_del_joinform_env:a INTERFACE_DATA=ds_if_del_joinform_data:a";
	var	strOutDatasets = "ds_if_del_joinform_common=DS_COMMON ds_if_del_joinform_header=DS_HEADER ds_if_del_joinform_column=DS_COLUMN ds_if_del_joinform_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack_if";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
}


/********************************************************************************** 
 * ImageViewer에 load된 BLOB type의 DATA를 BASE64 인코딩하여 String type 리턴
***********************************************************************************/
function fn_getImgData()
{
	var ExtObj = new ExtCommon();
	var StrImgData = "";
	
	StrImgData = ExtObj.encodeBase64(Div_Img.ds_img_view.getColumn(0,"BLOB_IMG"));
	return StrImgData;
}

/********************************************************************************** 
 * Interface 가입신청서 이미지조회(scScanImgSelC01)
***********************************************************************************/
function fn_selJoinFormImg_if(argScnSeq)
{
	// IF DS 초기화
	ds_if_sel_joinformImg_env.clearData();
	ds_if_sel_joinformImg_common.clearData();
	ds_if_sel_joinformImg_column.clearData();
	ds_if_sel_joinformImg_header.clearData();
	ds_if_sel_joinformImg_data.clearData();
	ds_if_sel_joinformImg_record.clearData();
	
	// IF ENV DS 세팅
	fn_setIfEnvDs(ds_if_sel_joinformImg_env,"WAS","scScanImgSelC01.do","","STP_SC_SCAN_IMG_SEL_C01_Rsp","","");

	// IF DATA DS 세팅		
	fun_ds_srch(ds_if_sel_joinformImg_data, "req_chnl_code","610050");
	fun_ds_srch(ds_if_sel_joinformImg_data, "input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_sel_joinformImg_data, "input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_sel_joinformImg_data, "input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
	
	fun_ds_srch(ds_if_sel_joinformImg_data, "in_scan_seq",argScnSeq);	// 스캔 일련번호
		
	var	strSvcID = "IF_SCAN_CSC_002";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_sel_joinformImg_env:a INTERFACE_DATA=ds_if_sel_joinformImg_data:a";
	var	strOutDatasets = "ds_if_sel_joinformImg_common=DS_COMMON ds_if_sel_joinformImg_header=DS_HEADER ds_if_sel_joinformImg_column=DS_COLUMN ds_if_sel_joinformImg_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack_if";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
}

/********************************************************************************** 
 * 인터페이스 환경 DS 세팅
***********************************************************************************/
function fn_setIfEnvDs(ObjDs,IfKnd,ReqMthd,ReqId,ResHd,ResCol,ResRec)
{
	var ObjEnvDs = "";
	
	if (typeof ObjDs == "string"){
		ObjEnvDs= eval(ObjDs);
	} else{
		ObjEnvDs = ObjDs;
	}
	
	fun_ds_srch(ObjEnvDs, "IF_KIND",IfKnd);
	fun_ds_srch(ObjEnvDs, "REQ_SERVICE_METHOD",ReqMthd);
	fun_ds_srch(ObjEnvDs, "REQ_SERVICE_ID",ReqId);	
	fun_ds_srch(ObjEnvDs, "RES_HEADER_SECTION",ResHd);
	fun_ds_srch(ObjEnvDs, "RES_COLUMN_SECTION",ResCol);
	fun_ds_srch(ObjEnvDs, "RES_RECORD_SECTION",ResRec);		
}

/********************************************************************************** 
 * IF 콜백처리
***********************************************************************************/
function fn_callBack_if(svcid,strErrCode,strErrMsg)
{
	var strScanSeq  = "";
	var strCrdNo	= "";
	var strJoinYr 	= "";
	var strJoinMd 	= "";
	var strBsneDiv	= "";
	var strNxttSeq	= "";

	var strHttpCd 	= "";
	var strHttpMsg 	= "";
	var strRtnCd	= "";
	var strRtnMsg	= "";
	
	// 가입신청서 조회
	if(svcid == "IF_SCAN_CSC_001"){			
		strHttpCd 	= ds_if_sel_joinform_common.getColumn(ds_if_sel_joinform_common.rowposition,"HTTP_RET_CODE");
		strHttpMsg 	= ds_if_sel_joinform_common.getColumn(ds_if_sel_joinform_common.rowposition,"HTTP_RET_MSG");
		
		if(strHttpCd == "0"){					
			strRtnCd	= ds_if_sel_joinform_header.getColumn(ds_if_sel_joinform_header.rowposition,"OT_RESPON_CODE");
			strRtnMsg	= ds_if_sel_joinform_header.getColumn(ds_if_sel_joinform_header.rowposition,"OT_RES_MSG");
			
			if(strRtnCd=="00000"){
				//건수표시
				if(ds_if_sel_joinform_record.rowcount == 0){
					cf_Alert("BNSE0036","결과");	// 조회된 결과가 없습니다.
				} else{
					Stt_tot.text = ds_if_sel_joinform_record.rowcount;
					
					// 등록년도/등록월일로 분리된 DATA를 등록일자로 세팅
					// ds_if_sel_joinform_record 는 useclientlayout 컬럼은 "true"로 설정했음.
					var nRow = ds_if_sel_joinform_record.rowcount;
					
					// *** RowType 변경을 위해 잠시 세팅.
					ds_if_sel_joinform_record.updatecontrol = false;
					
					for(i = 0; i<nRow; i++)
					{
						strJoinYr = getTrim(ds_if_sel_joinform_record.getColumn(i,"JOIN_YR")).replace("-","");
						strJoinMd = getTrim(ds_if_sel_joinform_record.getColumn(i,"JOIN_MD")).replace("-","");
						ds_if_sel_joinform_record.setColumn(i,"JOIN_YMD", strJoinYr + strJoinMd);
						ds_if_sel_joinform_record.setRowType(i,"normal");	// RowType 초기화
					}
					
					// *** RowType 변경 후 다시 자동변경되도록 세팅.
					ds_if_sel_joinform_record.updatecontrol = true;
				}
				
				// 거래이력등록
				if(Cmb_SrchGbn.value == "01"){
					fn_insScanTranHist("SCAN001", Cmb_SrchGbn.value, getTrim(Edt_SrchCustNo.value), "", "", "", "", "", "");
				} else if(Cmb_SrchGbn.value == "02"){
					fn_insScanTranHist("SCAN001", Cmb_SrchGbn.value, "", getTrim(Msk_SrchCrdNo.value), "", "", "", "", "");
				}
			} else{
				cf_Alert("COME0035",strRtnMsg);
				Grd_JoinFormList.nodatatext = "조회된 결과가 없습니다.";
			}
									
		} else{
			cf_Alert("COME0035",strHttpMsg);
			Grd_JoinFormList.nodatatext = "조회된 결과가 없습니다.";
		}
	}
	
	// 가입신청서 이미지 조회
	if(svcid == "IF_SCAN_CSC_002"){			
		strHttpCd 	= ds_if_sel_joinformImg_common.getColumn(ds_if_sel_joinformImg_common.rowposition,"HTTP_RET_CODE");
		strHttpMsg 	= ds_if_sel_joinformImg_common.getColumn(ds_if_sel_joinformImg_common.rowposition,"HTTP_RET_MSG");
		
		if(strHttpCd == "0"){					
			strRtnCd	= ds_if_sel_joinformImg_header.getColumn(ds_if_sel_joinformImg_header.rowposition,"OT_RESPON_CODE");
			strRtnMsg	= ds_if_sel_joinformImg_header.getColumn(ds_if_sel_joinformImg_header.rowposition,"OT_RES_MSG");
			
			if(strRtnCd=="00000"){
				// Image SET
				fn_setImgViewer();
				
				// 거래이력등록
				strScanSeq 	= getTrim(ds_if_sel_joinform_record.getColumn(ds_if_sel_joinform_record.rowposition,"SCAN_SEQ"));
				strCrdNo	= getTrim(ds_if_sel_joinform_record.getColumn(ds_if_sel_joinform_record.rowposition,"CRD_NO")).replace("-","");				
				fn_insScanTranHist("SCAN002", "", "", strCrdNo, "", "", "", "", strScanSeq);
			} else{
				cf_Alert("COME0035",strRtnMsg);
			}									
		} else{
			cf_Alert("COME0035",strHttpMsg);
		}
	}
	
	// 카드번호확인조회
	if(svcid == "IF_SCAN_CSC_008"){	
		strHttpCd 	= ds_if_sel_chkcard_common.getColumn(ds_if_sel_chkcard_common.rowposition,"HTTP_RET_CODE");
		strHttpMsg 	= ds_if_sel_chkcard_common.getColumn(ds_if_sel_chkcard_common.rowposition,"HTTP_RET_MSG");
		
		if(strHttpCd == "0"){					
			strRtnCd	= ds_if_sel_chkcard_header.getColumn(ds_if_sel_chkcard_header.rowposition,"OT_RESPON_CODE");
			strRtnMsg	= ds_if_sel_chkcard_header.getColumn(ds_if_sel_chkcard_header.rowposition,"OT_RES_MSG");
			
			if(strRtnCd=="00000"){
				// 정상처리
				Chk_CrdNoYn.value = 1;				
				cf_Alert("COME0035",strRtnMsg);
				
				// 거래이력등록
				strCrdNo = getTrim(Msk_CrdNo.value).replace("-","");
				fn_insScanTranHist("SCAN008", "", "", strCrdNo, "", "", "", "", "");

			} else{
				cf_Alert("COME0035",strRtnMsg);
			}									
		} else{
			cf_Alert("COME0035",strHttpMsg);
		}
	}		
		
	// 가입신청서 등록/수정
	if(svcid == "IF_SCAN_CSC_006_INS" || svcid == "IF_SCAN_CSC_006_UPD"){			
		strHttpCd 	= ds_if_ins_joinform_common.getColumn(ds_if_ins_joinform_common.rowposition,"HTTP_RET_CODE");
		strHttpMsg 	= ds_if_ins_joinform_common.getColumn(ds_if_ins_joinform_common.rowposition,"HTTP_RET_MSG");
		
		if(strHttpCd == "0"){					
			strRtnCd	= ds_if_ins_joinform_header.getColumn(ds_if_ins_joinform_header.rowposition,"OT_RESPON_CODE");
			strRtnMsg	= ds_if_ins_joinform_header.getColumn(ds_if_ins_joinform_header.rowposition,"OT_RES_MSG");
			
			if(strRtnCd=="00000"){
				strCrdNo	= getTrim(Msk_CrdNo.value).replace("-","");
				strJoinYr 	= getTrim(Cal_JoinDtm.value).substr(0,4);
				strJoinMd 	= getTrim(Cal_JoinDtm.value).substr(4,4);
				strBsneDiv 	= getTrim(Edt_BsneDiv.value);
				strNxttSeq	= getTrim(Edt_NxttSeq.value);				 
						
				if(svcid == "IF_SCAN_CSC_006_INS"){
					cf_Alert("TSSI0007","등록");	// 등록 처리되었습니다.
					// 거래이력등록
					fn_insScanTranHist("SCAN006", "I", "", strCrdNo, strBsneDiv, strJoinYr, strJoinMd, strNxttSeq, "");					
				}else if(svcid == "IF_SCAN_CSC_006_UPD"){
					cf_Alert("TSSI0007","수정");	// 수정 처리되었습니다.
					// 거래이력등록
					fn_insScanTranHist("SCAN006", "U", "", strCrdNo, strBsneDiv, strJoinYr, strJoinMd, strNxttSeq, getTrim(Edt_ScanSeq.value));
					// 가입신청서정보 재조회
					Btn_Srch_onclick();						
				}			
			} else{
				cf_Alert("COME0035",strRtnMsg);
			}									
		} else{
			cf_Alert("COME0035",strHttpMsg);
		}
	}
	
	// 가입신청서 삭제
	if(svcid == "IF_SCAN_CSC_003"){			
		strHttpCd 	= ds_if_del_joinform_common.getColumn(ds_if_del_joinform_common.rowposition,"HTTP_RET_CODE");
		strHttpMsg 	= ds_if_del_joinform_common.getColumn(ds_if_del_joinform_common.rowposition,"HTTP_RET_MSG");
		
		if(strHttpCd == "0"){					
			strRtnCd	= ds_if_del_joinform_header.getColumn(ds_if_del_joinform_header.rowposition,"OT_RESPON_CODE");
			strRtnMsg	= ds_if_del_joinform_header.getColumn(ds_if_del_joinform_header.rowposition,"OT_RES_MSG");
			
			if(strRtnCd=="00000"){
				cf_Alert("TSSI0007","삭제");		// 삭제처리되었습니다.
				// 거래이력등록
				strScanSeq 	= getTrim(ds_if_sel_joinform_record.getColumn(ds_if_sel_joinform_record.rowposition,"SCAN_SEQ"));
				strCrdNo	= getTrim(ds_if_sel_joinform_record.getColumn(ds_if_sel_joinform_record.rowposition,"CRD_NO")).replace("-","");				
				fn_insScanTranHist("SCAN003", "", "", strCrdNo, "", "", "", "", strScanSeq);				
				// 가입신청서정보 재조회
				Btn_Srch_onclick();				
			} else{
				cf_Alert("COME0035",strRtnMsg);
			}									
		} else{
			cf_Alert("COME0035",strHttpMsg);
		}
	}	
}

/********************************************************************************** 
 * 1. BASE64 인코딩된 이미지데이터(string)를  BASE64 디코딩한다. 
 * 2. 디코딩된 Buffer type DATA를 Div_Img.ds_img_view에 SET(Image Viewer에 Image SET)
 * 3. Image Viewer는 디코딩된 Buffer type을 Image로 보여줌.
***********************************************************************************/
function fn_setImgViewer()
{
	var strEcdImg = ds_if_sel_joinformImg_header.getColumn(0,"OT_FILE_IMG");
	var ExtObj = new ExtCommon();
	var objDcdBuf = new Buffer();
	
	// 이미지뷰어 초기화
	fn_InitImgViewer();
	Div_Img.ds_img_view.addRow();
			
	objDcdBuf = ExtObj.decodeBase64(strEcdImg,"BIN");
	Div_Img.ds_img_view.setColumn(0,"BLOB_IMG",objDcdBuf);
	
	// 이미지크기에 따라 동적으로 뷰어크기를 늘린다.(스크롤처리 되도록)
	var intVieH	= Div_Img.Img_ScanImg.position.height;		// 이미지뷰어 Height
	var intVieW = Div_Img.Img_ScanImg.position.width;		// 이미지뷰어 Width
	var intImgH = Div_Img.Img_ScanImg.imageheight;			// 이미지 Height
	var intImgW = Div_Img.Img_ScanImg.imagewidth;			// 이미지 Width
	
	if(intVieH < intImgH){
		Div_Img.Img_ScanImg.position.height = intImgH;
		Div_Img.resetScroll();		
	}
	
	if(intVieW < intImgW){
		Div_Img.Img_ScanImg.position.width = intImgW;
		Div_Img.resetScroll();
	}
}


/********************************************************************************** 
 * ExcelDownload버튼 클릭 시
***********************************************************************************/
function Btn_Excel_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_if_sel_joinform_record.rowcount == 0){
		cf_Alert("BNSE0036","가입신청서 정보");		// 조회된 가입신청서 정보가(이) 없습니다.
		return;
	}
	
	GridExportExcel(Grd_JoinFormList, ExportObject00, "sheet1");	
}

/********************************************************************************** 
 * 이미지업로드 버튼 클릭 시
***********************************************************************************/
function Btn_ImgUpload_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_if_sel_joinform_record.rowcount == 0){
		cf_Alert("CAME0005","가입신청서 정보");		// 가입신청서 정보 가(이) 없습니다.
		return;
	}

	var vFile 	= FileDialog00.open("파일열기", FileDialog00.LOAD, "%MYDOCUMENT%");
	
	if(vFile) {
		var rtn 	= vFile.open(VirtualFile.openRead | VirtualFile.openBinary);
		
		if (!rtn){
			cf_Alert("COME0029","파일을 OPEN","파일형식");	// 파일을 OPEN 할 수 없습니다. 파일형식을 확인하시기 바랍니다.
			return;
		}	
		
		var objBuffer = new Buffer();
		objBuffer = vFile.read();
		
		// 파일명, 유형, Size 세팅
		var objArr	  = vFile.filename.split(".");		
		var strFileNm = "";
		for(i=0; i<objArr.length - 1; i++)
		{
			if(i == objArr.length - 2){
				strFileNm = strFileNm + objArr[i];
			} else{
				strFileNm = strFileNm + objArr[i] + ".";
			}
		}
		var strFileTp = objArr[objArr.length - 1].toUpperCase();

		Edt_ImgFileNm.value 	= strFileNm + "." + strFileTp;	// 파일명
		Edt_ImgFileTp.value		= strFileTp;					// 파일유형
		Edt_ImgFileSize.value	= vFile.getFileSize();			// 파일SIZE
		
		vFile.close();
		// 이미지뷰어 초기화
		fn_InitImgViewer();
		Div_Img.ds_img_view.addRow();
		Div_Img.ds_img_view.setColumn(0,"BLOB_IMG",objBuffer);
		
		// 이미지크기에 따라 동적으로 뷰어크기를 늘린다.(스크롤처리 되도록)
		var intVieH	= Div_Img.Img_ScanImg.position.height;		// 이미지뷰어 Height
		var intVieW = Div_Img.Img_ScanImg.position.width;		// 이미지뷰어 Width
		var intImgH = Div_Img.Img_ScanImg.imageheight;			// 이미지 Height
		var intImgW = Div_Img.Img_ScanImg.imagewidth;			// 이미지 Width
		
		if(intVieH < intImgH){
			Div_Img.Img_ScanImg.position.height = intImgH;
			Div_Img.resetScroll();
		}
		
		if(intVieW < intImgW){
			Div_Img.Img_ScanImg.position.width = intImgW;
			Div_Img.resetScroll();			
		}
	}
}

/********************************************************************************** 
 * Grid onselectchanged 이벤트 - 선택 Row 변경 시 이미지 데이터 조회
***********************************************************************************/
function Grd_JoinFormList_onselectchanged(obj:Grid, e:GridSelectEventInfo)
{
	if(ds_if_sel_joinform_record.rowcount == 0) return;
	
	var intRow 		= ds_if_sel_joinform_record.rowposition;
	var strImgSt 	= ds_if_sel_joinform_record.getColumn(intRow,"FILE_IMG_ST");
	var strScanSeq 	= ds_if_sel_joinform_record.getColumn(intRow,"SCAN_SEQ");
	
	if(strImgSt == "Y"){
		Btn_Del.enable		= true;
		// 가입신청서 이미지 조회
		fn_selJoinFormImg_if(strScanSeq);
	} else{
		Btn_Del.enable		= false;
		// 이미지뷰어 초기화
		fn_InitImgViewer();
	}
}

/********************************************************************************** 
 * Grid onheadclick 이벤트 - 정렬
***********************************************************************************/
function Grd_JoinFormList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	cf_gridSort(obj, e);
}

/********************************************************************************** 
 * 조회조건 onkeyup 이벤트 - 엔터키 입력 시 조회클릭 이벤트
***********************************************************************************/
function SrchCond_onkeyup(obj, e:KeyEventInfo)
{
	if (e.keycode == "13" ) Btn_Srch_onclick();	
}

/********************************************************************************** 
 * 조회구분콤보 onkeyup 이벤트
***********************************************************************************/
function Cmb_SrchGbn_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	var strCmbCd = Cmb_SrchGbn.value;
	
	switch(strCmbCd)
	{
		case "01":		// 고객번호로 조회
			Stt_SrchCustNo.visible	= true;
			Edt_SrchCustNo.visible	= true;
			Btn_SrchCustNo.visible	= true;			
			Stt_SrchCrdNo.visible	= false;
			Msk_SrchCrdNo.visible	= false;			
			Edt_SrchCustNo.setFocus();
			break;
		case "02":		// 카드번호호 조회
			Stt_SrchCustNo.visible	= false;
			Edt_SrchCustNo.visible	= false;
			Btn_SrchCustNo.visible	= false;			
			Stt_SrchCrdNo.visible	= true;
			Msk_SrchCrdNo.visible	= true;			
			Msk_SrchCrdNo.setFocus();
			break;		
		default :
			Stt_SrchCustNo.visible	= true;
			Edt_SrchCustNo.visible	= true;
			Btn_SrchCustNo.visible	= true;			
			Stt_SrchCrdNo.visible	= false;
			Msk_SrchCrdNo.visible	= false;			
			Edt_SrchCustNo.setFocus();
			break;
	}
	
	// 조회조건 초기화
	fn_initSrchCond();		
}

/********************************************************************************** 
 * 카드번호 MASK oneditclick 이벤트
***********************************************************************************/
function Msk_SrchCrdNo_oneditclick(obj:MaskEdit,  e:EditClickEventInfo)
{
	if(getTrim(obj.value)==""){
		obj.setCaretPos(0);
	}		
}


/********************************************************************************** 
 * 이미지취소 버튼 클릭 시
***********************************************************************************/
function Btn_Cncl_onclick(obj:Button,  e:ClickEventInfo)
{	
	fn_InitImgViewer();
	Edt_ImgFileNm.value 	= "";
	Edt_ImgFileTp.value 	= "";
	Edt_ImgFileSize.value 	= "";	
}

/********************************************************************************** 
 * 이미지뷰어 초기화
***********************************************************************************/
function fn_InitImgViewer()
{
	Div_Img.ds_img_view.clearData();
	// 이미지뷰어 원래크기로.
	Div_Img.Img_ScanImg.position.height = ImgViewHeigt;
	Div_Img.Img_ScanImg.position.width 	= ImgViewWidth;
	Div_Img.resetScroll();	
}

/********************************************************************************** 
 * 가입신청서(SCAN) 인터페이스 거래 이력등록(인터페이스 성공 후 처리)
***********************************************************************************/
function fn_insScanTranHist(pIfId, pSrchGbn, pCustNo, pCrdNo, pBsneGbn, pJoinYr, pJoinMd, pNxttSeq, pScanSeq)
{
	ds_ins_hist_in.clearData();

	fun_ds_srch(ds_ins_hist_in, "BIZ_DV_CD", 	"SCAN");		// 통합코드 NW123 ex) SCAN, DSIG, CMKT
	fun_ds_srch(ds_ins_hist_in, "IF_ID", 		pIfId);			// 통합코드 NW124 ex) SCAN001, DSIG001, CMKT001 ...
	
	fun_ds_srch(ds_ins_hist_in, "SRCH_GBN", 	pSrchGbn);		// 조회구분	
	fun_ds_srch(ds_ins_hist_in, "CUST_NO", 		pCustNo);		// 고객번호	
	fun_ds_srch(ds_ins_hist_in, "CRD_NO", 		pCrdNo);		// 카드번호
	fun_ds_srch(ds_ins_hist_in, "BSNE_GBN", 	pBsneGbn);		// 업체구분
	fun_ds_srch(ds_ins_hist_in, "JOIN_YR", 		pJoinYr);		// 본등록년도
	fun_ds_srch(ds_ins_hist_in, "JOIN_MD", 		pJoinMd);		// 본등록월일
	fun_ds_srch(ds_ins_hist_in, "NXTT_SEQ", 	pNxttSeq);		// 넥스테이션 파일시퀀스	
	fun_ds_srch(ds_ins_hist_in, "SCAN_SEQ", 	pScanSeq);		// 가입신청서 스캔일련번호

	var	strSvcID = "INS_SCAN_TRAN_HIST";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=ds_ins_hist_in:a";
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=CST137.Set_ScanTranHist_INSERT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
}

/********************************************************************************** 
 * DB Transaction CallBack
***********************************************************************************/
function fn_callBack(svcid,strErrCode,strErrMsg)
{
	if(svcid == "INS_SCAN_TRAN_HIST"){
		//trace(strErrCode + "::" + strErrMsg);
	}
}]]></Script>
    <Objects>
      <Dataset id="ds_set_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_get_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <ExportObject id="ExportObject00" exporttype="0" exporteventtype="itemrecord"/>
      <FileDialog defaultextention="false" filter="Image File(*.tif)|*.tif|" filterindex="0" id="FileDialog00"/>
      <Dataset id="ds_if_sel_joinformImg_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_sel_joinformImg_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_joinformImg_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_joinformImg_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_joinformImg_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_joinformImg_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ins_joinform_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ins_joinform_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ins_joinform_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ins_joinform_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ins_joinform_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ins_joinform_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_chkcard_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_sel_chkcard_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_chkcard_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_chkcard_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_chkcard_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_chkcard_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_joinform_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_sel_joinform_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_joinform_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_joinform_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_joinform_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_sel_joinform_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SCAN_SEQ" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="BSNE_DIV" type="STRING" size="256"/>
          <Column id="JOIN_YR" type="STRING" size="256"/>
          <Column id="JOIN_MD" type="STRING" size="256"/>
          <Column id="JOIN_YMD" type="STRING" size="256"/>
          <Column id="NXTT_SEQ" type="STRING" size="256"/>
          <Column id="FILE_NM" type="STRING" size="256"/>
          <Column id="FILE_TP" type="STRING" size="256"/>
          <Column id="FILE_SIZE" type="STRING" size="256"/>
          <Column id="FILE_IMG_ST" type="STRING" size="256"/>
          <Column id="OLD_CRD_NO" type="STRING" size="256"/>
          <Column id="JOIN_ST" type="STRING" size="256"/>
          <Column id="JOIN_ST_NM" type="STRING" size="256"/>
          <Column id="DEL_DT" type="STRING" size="256"/>
          <Column id="INPT_DTIME" type="STRING" size="256"/>
          <Column id="INPT_USER_ID" type="STRING" size="256"/>
          <Column id="INPT_IP" type="STRING" size="256"/>
          <Column id="MOD_DTIME" type="STRING" size="256"/>
          <Column id="MOD_USER_ID" type="STRING" size="256"/>
          <Column id="MOD_IP" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmb_srch_gbn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">01</Col>
            <Col id="CODE_NM">고객번호</Col>
          </Row>
          <Row>
            <Col id="CODE_NM">카드번호</Col>
            <Col id="CODE">02</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_if_del_joinform_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_del_joinform_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_del_joinform_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_del_joinform_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_del_joinform_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_del_joinform_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_ins_hist_in" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="Static12" propid="text" datasetid="ds_caminfo" columnid="CMP_ID"/>
      <BindItem id="item3" compid="Edt_BsneDiv" propid="value" datasetid="ds_if_sel_joinform_record" columnid="BSNE_DIV"/>
      <BindItem id="item1" compid="Edt_ScanSeq" propid="value" datasetid="ds_if_sel_joinform_record" columnid="SCAN_SEQ"/>
      <BindItem id="item2" compid="Static06" propid="text" datasetid="ds_caminfo" columnid="CMP_ID"/>
      <BindItem id="item7" compid="Static09" propid="text" datasetid="ds_caminfo" columnid="CMP_ID"/>
      <BindItem id="item10" compid="Edt_NxttSeq" propid="value" datasetid="ds_if_sel_joinform_record" columnid="NXTT_SEQ"/>
      <BindItem id="item6" compid="Msk_CrdNo" propid="value" datasetid="ds_if_sel_joinform_record" columnid="CRD_NO"/>
      <BindItem id="item4" compid="Static05" propid="text" datasetid="ds_caminfo" columnid="CMP_ID"/>
      <BindItem id="item9" compid="Edt_ImgFileNm" propid="value" datasetid="ds_if_sel_joinform_record" columnid="FILE_NM"/>
      <BindItem id="item11" compid="Static07" propid="text" datasetid="ds_caminfo" columnid="CMP_ID"/>
      <BindItem id="item12" compid="Edt_ImgFileTp" propid="value" datasetid="ds_if_sel_joinform_record" columnid="FILE_TP"/>
      <BindItem id="item13" compid="Static10" propid="text" datasetid="ds_caminfo" columnid="CMP_ID"/>
      <BindItem id="item14" compid="Edt_ImgFileSize" propid="value" datasetid="ds_if_sel_joinform_record" columnid="FILE_SIZE"/>
      <BindItem id="item15" compid="Cal_JoinDtm" propid="value" datasetid="ds_if_sel_joinform_record" columnid="JOIN_YMD"/>
      <BindItem id="item16" compid="Cmb_JoinSt" propid="value" datasetid="ds_if_sel_joinform_record" columnid="JOIN_ST"/>
    </Bind>
  </Form>
</FDL>
