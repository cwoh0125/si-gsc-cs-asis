<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.2">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="LPS010" classname="001" inheritanceid="" position="absolute 0 0 1652 800" titletext="ARS카드등록" onload="LPS010_onload" onbeforeclose="LPS010_onbeforeclose">
    <Script type="xscript4.0"><![CDATA[include "LIB::CommonLib.xjs"

var SVC_IF_URL 	= "XinterfaceAction.do?method=CommonInterface";
var SVC_IF_URL_VF 	= "XinterfaceAction.do?method=NameVerification";

var userID=gds_User.getColumn(gds_User.rowposition,"GBL_USR_ID");
var userNM=gds_User.getColumn(gds_User.rowposition,"GBL_USR_NM");
var userPart=gds_User.getColumn(gds_User.rowposition,"GBL_PART_CD");
//사용자 권한
var userGRD=gds_User.getColumn(gds_User.rowposition,"GBL_USR_GRD_CD");

var g_sms_text = "/80 Byte";
var g_color = "red";

var COM014 = null
var COM014_idx = 0;

var mi_crd_no; // 완전삭제용 변수

//콜 이벤트 연동
var objPHN = getObjPhnLps();

//카드 등록 여부 확인 
var userID=gds_User.getColumn(gds_User.rowposition,"GBL_USR_ID");
var userNM=gds_User.getColumn(gds_User.rowposition,"GBL_USR_NM");
var userIP=gds_User.getColumn(gds_User.rowposition,"GBL_LGIN_IP");



if(objPHN){

	objPHN.LPS010 = this;
	objPHN.getPhnEvent = getPhnEvent;
	
}

var arrLPS = new Array();
var arrLPS_result = new Array();
var arrLPS_result_msg = "";


//------------------------------------------------------------------------------------------
//SMS 화면창
//------------------------------------------------------------------------------------------
function Txa_MSG_ontextchanged(obj:TextArea,  e:TextChangedEventInfo)
{
	var len = parseInt(LenB(Txa_MSG.text));
	len = (len == -1) ? 0 : len ; 
	
	if (len > 80) {
	
		Static14.style.color = g_color ;
		
	}else{
	
		Static14.style.color = "" ;
		
	}
	
	Static14.text = len + g_sms_text;	
}



//------------------------------------------------------------------------------------------
//화면 로드시
//------------------------------------------------------------------------------------------

function LPS010_onload(obj:Form, e:LoadEventInfo)
{
	//화면 복사 방지 Event
	var evtObj = new EventInfo(); // 이벤트 객체 생성
	obj.onkeydown.addHandler(Copy_Prevention_onkeydown, evtObj);
	obj.onrbuttondown.addHandler(Copy_onrbuttondown, evtObj);
	//화면 복사 방지 Event END
 
	var userGRD=gds_User.getColumn(gds_User.rowposition,"GBL_USR_GRD_CD");
	
	Cmb_SrchUser();
	//userGRD 권한
	//I => LP파트장  // J =>LP 상담원
	//K=> 불만담당이면 LP파트장 권한으로 변경 하자.
	if(userGRD=="K" || userGRD=="A") { userGRD = "I"; }
	
	cal_01.value 		= getToday();
	cal_00.value 	= AddMonth(getToday(),-1);	
 
 	
 	
 	//상담원 기능 제한
	if(userGRD=="J"){
		
		ars_send_new_user.visible="false";
		cmb_usr.visible="false";
		cmb_usr_base.visible="false";
		
	}

	fn_userComboList();
	
	//setLP();
	
	/*cmb_job_sta
	0 미할당
	1 할당
	2 작업중
	3 전송중
	4 완료
	9 에러
	8 삭제	
	*/
	
	setDefaultValue();	
	cmb_job_sta.value=1;
	//할당여부 초기 : 전체 	
 	cmb_job_sel.value = "1";
		
	cmb_call_result2.value=10;
	//cmb_card_sta.value=3;
		
	ds_srch1.clearData();
	ds_out.clearData();		
		
	
	
	if(userGRD=="I"){	
		fun_ds_srch(ds_srch1, "ARS_REG_DTM", cal_00.value );
		fun_ds_srch(ds_srch1, "ARS_REG_DTM_E", cal_01.value );
		fun_ds_srch(ds_srch1, "JOB_PRGR_ST_CD", cmb_job_sta.value); // 처음 로드 할때 작업 상태 조건 추가 요청(진현주C 2017-01-08)			
	}else{
	
		fun_ds_srch(ds_srch1, "JOB_ID", userID);
	
	}

	
	var	strSvcID = "R1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "SELECT_0_IDATA=ds_srch1:a"; 
	var	strOutDatasets = "ds_out=SELECT_0_ODATA";
	var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_SELECT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
				
}

//------------------------------------------------------------------------------------------
//공통 콤보
//------------------------------------------------------------------------------------------

function setDefaultValue(){

	//콤보생성	
	var arrCombo           = ["cmb_num","cmb_day","cmb_call_result","cmb_job_sta","cmb_call_result2","cmb_card_sta","cmb_com_co_div_cd","cmb_sex_cd","cmb_authn_sbjt_cd","cmb_job_sel"];    									//콤보ID
    var arrSearchKey       = ["NW004","NW020","NW032","NW031","NW032","LP001","NW127","NW008","NW128","NW147"];               							//공통코드-대분류코드
    var arrListMode        = ["TN","TN","TY","TY","TY","TY","TY","TY","TY","TN"];                    							//CTN : [코드] 코드명  , TY : 코드명,  TN: 초기값무시
    var arrOptionRowValue  = [",",",",",전체",",전체",",",",",",",",",",",","];                  								//코드상단에 로우추가후 전체, 공백

	setComboList(arrCombo, arrSearchKey, arrListMode, arrOptionRowValue);     					//공통콤보가져오기	
	
	cmb_num.value=2;

}

//------------------------------------------------------------------------------------------
//잔여 할당건수 , 작업현황
//------------------------------------------------------------------------------------------

function setLP(){
	
	ds_srch.clearData();
	ds_srch2.clearData();
	ds_background.clearData();	  
	ds_background2.clearData();	  	
	
	
	
	fun_ds_srch(ds_srch, "JOB_ID", userID);
	
	
	
	var sum_day=getToday();
	
	fun_ds_srch(ds_srch, "ARS_REG_DTM", sum_day);
	
	fun_ds_srch(ds_srch2, "JOB_DT", sum_day);
		
	
	fun_ds_srch(ds_srch2, "BUSER", userID);
	
	  
	var	strSvcID = "R2";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "SELECT_0_IDATA=ds_srch:a SELECT_1_IDATA=ds_srch2:a"; 
	var	strOutDatasets = "ds_background=SELECT_0_ODATA ds_background2=SELECT_1_ODATA";

	if(userGRD=="I" || userGRD=="A" || userGRD=="B" ){
	
		var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_SELECT_background01 SELECT_1_ID=LPS010.Get_LPS_SELECT_background02_AD";
	
	}else{
		
		var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_SELECT_background01 SELECT_1_ID=LPS010.Get_LPS_SELECT_background02";
	}
	
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	return;
}

//------------------------------------------------------------------------------------------
//작업현황
//------------------------------------------------------------------------------------------

function setLP2(){

	ds_srch.clearData();
	ds_background2.clearData();	  
	
	var	strSvcID = "R3";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "SELECT_0_IDATA=ds_srch:a"; 
	var	strOutDatasets = "ds_background2=SELECT_0_ODATA";
	var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_SELECT_background02";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	return;
}


//------------------------------------------------------------------------------------------
//조회
//------------------------------------------------------------------------------------------

function btn_srch_onclick(obj:Button,  e:ClickEventInfo)
{
   
	if(cal_00.value==null || cal_01.value==null  || cal_00.value=="" || cal_01.value==""){
	
		cf_Alert("COME0002","조회 기간은 필수조건 입니다.");
		return;
	
	}
	
	
	var strCompDt = AddMonth(cal_00.value,3);
	
// 	if(strCompDt < cal_01.value){
// 	
// 		cf_Alert("COME0019","3개월");
// 		return;
// 		
// 	}
	//edt_name.value = "";
	//cmd_day 1:등록일자 2:처리 일자
	if (cmb_day.value=="1"){
	
		ds_srch1.clearData();
		ds_out.clearData();
		
		fun_ds_srch(ds_srch1, "CRD_NO", getTrim(edt_card_num_srch.value));
		fun_ds_srch(ds_srch1, "RES_REG_NO", getTrim(edt_jumin_srch.value));
		fun_ds_srch(ds_srch1, "CUR_RSLT_CD", cmb_call_result.value);
		fun_ds_srch(ds_srch1, "JOB_PRGR_ST_CD", cmb_job_sta.value);
		fun_ds_srch(ds_srch1, "ARS_REG_DTM", cal_00.value);
		fun_ds_srch(ds_srch1, "MBPH_NO", getTrim(Edt_hphone.value).replace("-", ""));
	
		if (cal_01.value=="" || cal_01.value==null ){
		
			fun_ds_srch(ds_srch1, "ARS_REG_DTM_E", cal_01.value);
			
		}else{
		
			fun_ds_srch(ds_srch1, "ARS_REG_DTM_E", cal_01.value+"2500");
			
		}

		/*cmb_job_sta
		0 미할당
		1 할당
		2 작업중
		3 전송중
		4 완료
		9 에러
		8 삭제	
		*/
	    //권한 추가
	    /*A:관리자 B:센터장 C:그룹장D:파트장 E:선임상담 F:일반상담 G:TEC관리자 H:TEC결제권 I:LP파트장 J:LP상담 K:불만담당 N:일반상담(오전)
	    */
		//if(userGRD=="K" || userGRD=="A" || userGRD=="N") { userGRD = "I"; }
		
	    //할당된 전체 조회
		//if(userGRD=="I"){		
			//본인것만 조회 되도록 조회조건 추가
			//본인할당만 조회 1:전체 2:본인
		if(cmb_job_sel.value == "2"){
			fun_ds_srch(ds_srch1, "JOB_ID", userID);    
		}
		//}
		/*else if(cmb_job_sta.value=="1" || cmb_job_sta.value=="2" || cmb_job_sta.value=="3" || cmb_job_sta.value=="4" || cmb_job_sta.value=="5"){			
			fun_ds_srch(ds_srch1, "JOB_ID", userID);    		
		}		
	  */      
		var	strSvcID = "R1";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = "SELECT_0_IDATA=ds_srch1:a"; 
		var	strOutDatasets = "ds_out=SELECT_0_ODATA";
		
		if (cmb_job_sta.value=="0"){			
			var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_SELECT_MI";
		
		}else{  
		   
			var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_SELECT";
		
		}
	
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;

		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
		return;
		
    //작업 일자
	}else if(cmb_day.value=="2"){
	
		ds_srch1.clearData();
		ds_out.clearData();
		
		fun_ds_srch(ds_srch1, "CRD_NO", edt_card_num_srch.value);
		fun_ds_srch(ds_srch1, "RES_REG_NO", edt_jumin_srch.value);
		fun_ds_srch(ds_srch1, "CUR_RSLT_CD", cmb_call_result.value);
		fun_ds_srch(ds_srch1, "JOB_PRGR_ST_CD", cmb_job_sta.value);
		fun_ds_srch(ds_srch1, "JOB_DT", cal_00.value);
		fun_ds_srch(ds_srch1, "MBPH_NO", getTrim(Edt_hphone.value).replace("-", ""));
		
		if (cal_01.value==""){
		
			fun_ds_srch(ds_srch1, "JOB_DT_E", cal_01.value);
			
		}else {
		
			fun_ds_srch(ds_srch1, "JOB_DT_E", cal_01.value+"2500");
			
		}
					
		if(userGRD=="I"){
	
		}else if(cmb_job_sta.value=="1" || cmb_job_sta.value=="2" || cmb_job_sta.value=="3" || cmb_job_sta.value=="4" || cmb_job_sta.value=="5"){
			
			fun_ds_srch(ds_srch1, "JOB_ID", userID);    
			
		}
		    
		var	strSvcID = "R1";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = "SELECT_0_IDATA=ds_srch1:a"; 
		var	strOutDatasets = "ds_out=SELECT_0_ODATA";
			
		if (cmb_job_sta.value=="0"){
		
			var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_SELECT0_MI";
		
		}else{
		
			var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_SELECT0";
		}
		
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;

		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
		return;		
	}
		
}

//------------------------------------------------------------------------------------------
//할당하기
//------------------------------------------------------------------------------------------

function ars_add_onclick(obj:Button,  e:ClickEventInfo)
{
	

	if (cmb_num.value==""){
		
		ds_srch.clearData();
		ds_srch1.clearData();
		ds_srch2.clearData();
		ds_srch3.clearData();
		ds_out.clearData();
					    
		fun_ds_srch(ds_srch1, "JOB_ID", userID);
				    
		var	strSvcID = "U1";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = "SELECT_1_IDATA=ds_srch1:a"; 
		var	strOutDatasets = "ds_out=SELECT_1_ODATA";
		var	strArgument = "SELECT_1_ID=LPS010.Get_LPS_SELECT_AC";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;

		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
		return;
	
	}else if(ds_out.findRow("CHK","1")=="-1"){
	
		ars_update1();
	
	}else if(ds_out.getCaseCount("CHK =="+ '1')>1) {
	
		cf_Alert("COME0002","선택할당은 한건만 가능합니다.");
		
	}else{
	
		if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD") != "0"){
			cf_Alert("COME0002","할당이 불가능한 자료입니다.");
			return;
		}
		
		//선택할당기능
		ds_srch.clearData();
		ds_srch1.clearData();
		ds_srch2.clearData();
		ds_srch3.clearData();	
		
		
				
		fun_ds_srch(ds_srch3, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO"));
		fun_ds_srch(ds_srch3, "JOB_ID", userID);	
		fun_ds_srch(ds_srch, "JOB_ID", userID);
		fun_ds_srch(ds_srch2, "BUSER", userID);
		fun_ds_srch(ds_srch1, "B", userID);
		
		//2012.12.13 MIG테이블에 UPDATE하기위해 변경
		var	strSvcID = "U1";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = ""; 
		var	strOutDatasets = "ds_background=SELECT_1_ODATA ds_background2=SELECT_2_ODATA";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
			strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch:a SELECT_2_IDATA=ds_srch2:a"; 
			strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_SEL SELECT_1_ID=LPS010.Get_LPS_SELECT_background01 SELECT_2_ID=LPS010.Get_LPS_SELECT_background02";
		}else{
			strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch:a SELECT_2_IDATA=ds_srch2:a UPDATE_3_IDATA=ds_srch3:a"; 
			strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_SEL SELECT_1_ID=LPS010.Get_LPS_SELECT_background01 SELECT_2_ID=LPS010.Get_LPS_SELECT_background02 UPDATE_3_ID=LPS010.Get_LPS_UPDATE_MIG_SEL";
		}
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
			
	}
}


/********************************************************************************** 
 *  할당작업
***********************************************************************************/
function ars_update1(){
	
	var dsOutCurRowDate;
	
	if(ds_out.getRowCount() > 0 ){
	//ds_out을 클리어하기 전에 해당로우의 등록date를 가져와서 변수에 저장해놓음
		dsOutCurRowDate = ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8);
	}
	
	
	ds_srch.clearData();
	ds_srch1.clearData();
	ds_srch2.clearData();
	ds_srch3.clearData();
	ds_out.clearData();
	
	fun_ds_srch(ds_srch3, "ROWNUM", cmb_num.text);
	fun_ds_srch(ds_srch3, "JOB_ID", userID);	
	fun_ds_srch(ds_srch, "JOB_ID", userID);
	fun_ds_srch(ds_srch2, "BUSER", userID);
	fun_ds_srch(ds_srch1, "B", userID);
				    
	var	strSvcID = "U1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "ds_background=SELECT_1_ODATA ds_background2=SELECT_2_ODATA";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == dsOutCurRowDate){
		strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch:a SELECT_2_IDATA=ds_srch2:a"; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE SELECT_1_ID=LPS010.Get_LPS_SELECT_background01 SELECT_2_ID=LPS010.Get_LPS_SELECT_background02";
	}else{
		strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch:a SELECT_2_IDATA=ds_srch2:a UPDATE_3_IDATA=ds_srch3:a"; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE SELECT_1_ID=LPS010.Get_LPS_SELECT_background01 SELECT_2_ID=LPS010.Get_LPS_SELECT_background02 UPDATE_3_ID=LPS010.Get_LPS_UPDATE_MIG";
	}
		
		
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	return;
}

//------------------------------------------------------------------------------------------
//반환하기
//------------------------------------------------------------------------------------------

function ars_return_onclick(obj:Button,  e:ClickEventInfo)
{
	
	
	
	if(ds_out.getCaseCount("CHK =="+ '1')>1) {
		
		ds_update.copyData(ds_out);
		ds_update.filter(" CHK == '1'");
			
		ars_update_some();		
		
	}else if(ds_out.findRow("CHK","1")=="-1"){
		
			if (!cf_Confirm("COME0002","할당된 모든 자료를 반환하시겠습니까"))	return; 
			 	
			 	ars_update_all();
			 	
	//}else if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CDNM")!="1"){
	//  alert("할당이외의 상태입니다.");
	
	}else{
		
		ars_update2();
		
	}
	
}
/********************************************************************************** 
 *  여러건 반환 작업
***********************************************************************************/
function ars_update_some(){
	
	//권한 추가
	if(userGRD=="K" || userGRD=="A") { userGRD = "I"; }
	if(userGRD=="I"){
		
		for(i=0;ds_update.rowcount>i;i++){
				
			
			if(ds_update.getColumn(i,'JOB_PRGR_ST_CD')=="0" || ds_update.getColumn(i,'JOB_PRGR_ST_CD')=="3" || ds_update.getColumn(i,'JOB_PRGR_ST_CD')=="4" || ds_update.getColumn(i,'JOB_PRGR_ST_CD')=="9"){
					
				alert("반환 하수 없는 데이터가 있습니다.[작업상태]");
				return;
					
			}		
			
		}
			
	}else{
		
		for(i=0;ds_update.rowcount>i;i++){
			
	
			if(ds_update.getColumn(i,'JOB_PRGR_ST_CD')!="1"){
				
				alert("반환 할수 없는 데이터가 있습니다.[작업상태]");
				return;
					
			}
				
			if(ds_update.getColumn(i,'JOB_ID')!=userID){
				
				alert("반환 할수 없는 데이터가 있습니다.[작업자]");
				return;
				
			}
			
		}
		
	}
	
	var iterate_chk = new Array();
	
	for (i=0;i<ds_update.rowcount;i++){

		iterate_chk.push(ds_update.getColumn(i,"SEQ_NO"));
		fun_ds_srch(ds_send_update, "ITERATE_CUST_TYPE", iterate_chk.join(","));			
	}
	
	var	strSvcID = "SU1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;				
	
	if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
		strInDatasets = "UPDATE_0_IDATA=ds_send_update:a";
		strArgument = "UPDATE_0_ID=LPS010.Set_UPDATE_SOME";
	}else{
		strInDatasets = "UPDATE_0_IDATA=ds_send_update:a UPDATE_1_IDATA=ds_send_update:a";
		strArgument = "UPDATE_0_ID=LPS010.Set_UPDATE_SOME UPDATE_1_ID=LPS010.Set_UPDATE_SOME_MIG";
	}
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		
	
}


/********************************************************************************** 
 *  반환 작업
***********************************************************************************/
function ars_update2(){

	if (edt_job_run.text=="작업중" && (userGRD!="I" && userGRD!="A")){

		cf_Alert("LPSE0003");
		return;

	}else if(edt_job_run.text=="작업중" || edt_job_run.text=="할당"){
		
		ds_srch.clearData();
		ds_srch1.clearData();
		ds_srch2.clearData();
		ds_srch3.clearData();
		
		var ud2=Grid00.getCellValue(ds_out.findRow("CHK","1"),3);	

		
	
		fun_ds_srch(ds_srch, "JOB_ID", userID);
		fun_ds_srch(ds_srch3, "SEQ_NO", ds_out.getColumn(ds_out.findRow("CHK","1"),"SEQ_NO"));				
		fun_ds_srch(ds_srch2, "BUSER", userID);
		fun_ds_srch(ds_srch1, "JOB_ID", userID);			
	    
	    //ds_out을 클리어하기 전에 해당로우의 등록date를 가져와서 변수에 저장해놓음
		var dsOutCurRowDate = ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8);
		
	    ds_out.clearData();
	    
		var	strSvcID = "U2";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = ""; 
		var	strOutDatasets = "ds_out=SELECT_1_ODATA ds_background=SELECT_2_ODATA ds_background2=SELECT_3_ODATA";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		if( Today() == dsOutCurRowDate){
			strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch1:a SELECT_2_IDATA=ds_srch:a SELECT_3_IDATA=ds_srch2:a"; 
			strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE2 SELECT_1_ID=LPS010.Get_LPS_SELECT_AC SELECT_2_ID=LPS010.Get_LPS_SELECT_background01 SELECT_3_ID=LPS010.Get_LPS_SELECT_background02";
		}else{
			strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch1:a SELECT_2_IDATA=ds_srch:a SELECT_3_IDATA=ds_srch2:a UPDATE_4_IDATA=ds_srch3:a"; 
			strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE2 SELECT_1_ID=LPS010.Get_LPS_SELECT_AC SELECT_2_ID=LPS010.Get_LPS_SELECT_background01 SELECT_3_ID=LPS010.Get_LPS_SELECT_background02 UPDATE_0_ID=LPS010.UPDATE_0_ID=LPS010.Get_LPS_UPDATE2_MIG";
		}
		

		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
		return;
	
	}else{
	
	cf_Alert("COME0002","반환할수 없는 자료입니다.");
	
	}
	
}


//------------------------------------------------------------------------------------------
// 모두 반환하기
//------------------------------------------------------------------------------------------
function ars_update_all(){

	//ds_out을 클리어하기 전에 해당로우의 등록date를 가져와서 변수에 저장해놓음
	var dsOutCurRowDate = ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8);
	
	ds_srch.clearData();
	ds_srch1.clearData();
	ds_srch2.clearData();
	ds_srch3.clearData();
	
	ds_out.clearData();
	
	fun_ds_srch(ds_srch, "JOB_ID", userID);
	fun_ds_srch(ds_srch3, "JOB_ID", userID);
	fun_ds_srch(ds_srch2, "BUSER", userID);
	fun_ds_srch(ds_srch1, "JOB_ID", userID);	
	
	
	var	strSvcID = "U_ALL";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "ds_out=SELECT_1_ODATA ds_background=SELECT_2_ODATA ds_background2=SELECT_3_ODATA";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == dsOutCurRowDate){
		strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch1:a SELECT_2_IDATA=ds_srch:a SELECT_3_IDATA=ds_srch2:a"; 
		strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE2_ALL SELECT_1_ID=LPS010.Get_LPS_SELECT_AC SELECT_2_ID=LPS010.Get_LPS_SELECT_background01 SELECT_3_ID=LPS010.Get_LPS_SELECT_background02";
	}else{
		strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch1:a SELECT_2_IDATA=ds_srch:a SELECT_3_IDATA=ds_srch2:a UPDATE_4_IDATA=ds_srch3:a"; 
		strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE2_ALL SELECT_1_ID=LPS010.Get_LPS_SELECT_AC SELECT_2_ID=LPS010.Get_LPS_SELECT_background01 SELECT_3_ID=LPS010.Get_LPS_SELECT_background02 UPDATE_4_ID=LPS010.Set_LPS_UPDATE2_MIG_ALL";
	}

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);

}

//  등록카드조회(적립포인트조회) 
function reSearch(crd_no){
	
	
	
	//------------------------------------------------------------------------------------------
	//  IF 처리해봅시다.
	//------------------------------------------------------------------------------------------
	//trace("crd_no>>>"+crd_no);	
	//IF_BNS260_01 초기화
	ds_if_point_info_env.clearData();
	ds_if_point_info_data.clearData();
	ds_if_point_info_header.clearData();
	ds_if_point_info_column.clearData();
	ds_if_point_info_record.clearData();
	
	//IF_BNS260_01 환경설정
	fun_ds_srch(ds_if_point_info_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_point_info_env, "REQ_SERVICE_METHOD", 	"ptTrnptSelC08.do"); //공통이 어디까지?
	fun_ds_srch(ds_if_point_info_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_point_info_env, "RES_HEADER_SECTION", 	"STP_PT_TRNPT_SEL_C01_Rsp"); //xml상위 헤더항목
	fun_ds_srch(ds_if_point_info_env, "RES_COLUMN_SECTION", 	""); 
	fun_ds_srch(ds_if_point_info_env, "RES_RECORD_SECTION", 	"OT_OUT_CURSOR"); 
	
	//IF_BNS260_01 INPUT DATA
	fun_ds_srch(ds_if_point_info_data, "req_chnl_code", 		"610050");
	fun_ds_srch(ds_if_point_info_data, "input_user_id", 		userID);
	fun_ds_srch(ds_if_point_info_data, "input_user_nm", 		userNM);
	fun_ds_srch(ds_if_point_info_data, "input_user_ip", 		userIP);	
	
	fun_ds_srch(ds_if_point_info_data, "in_search_key", 	"2"	);
	//fun_ds_srch(ds_if_point_info_data, "in_head_rs_bz_no", getDsName.getColumn(0,"HEAD_RS_BZ_NO")	);
	//fun_ds_srch(ds_if_point_info_data, "in_tail_rs_bz_no", getDsName.getColumn(0,"TAIL_RS_BZ_NO")	);
	fun_ds_srch(ds_if_point_info_data, "in_crd_no", crd_no);
	fun_ds_srch(ds_if_point_info_data, "in_strt_dt", cal_00.value);
	fun_ds_srch(ds_if_point_info_data, "in_end_dt", cal_01.value);
	
	//alert(ds_if_point_info_data.getColumn(0,'in_search_key1'));
	
	//거래시작	
//	alert(ds_execute.getColumn(ds_execute.findRow("CHK","1"),"CUST_NO"));

	
	var	strSvcID = "SS7";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_point_info_env:a INTERFACE_DATA=ds_if_point_info_data:a"; 
	var	strOutDatasets = "ds_if_point_info_header=DS_HEADER ds_if_point_info_column=DS_COLUMN ds_if_point_info_record=DS_RECORD ds_if_point_info_common=DS_COMMON";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		
		
		
	//------------------------------------------------------------------------------------------
	//  IF 처리해봤습니다.
	//------------------------------------------------------------------------------------------
	}



//------------------------------------------------------------------------------------------
// 셀 클릭시(체크 / 셀 구분) 작업중으로 바뀜
//------------------------------------------------------------------------------------------

function Grid00_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	
	
	if(e.col == 13){
		reSearch(ds_out.getColumn(e.row , "CRD_NO"));
	}else{
		if(edt_tel2.value!=null){
			
			//DB에 휴대폰번호 컬럼에 빈공간 삽입되어있는 데이터 공백 제거하는 처리 2012.10.31
			edt_tel2.value=maskPhone(getTrim(edt_tel2.value).replace(" ", ""));		
			
		}	
		
		if(edt_tel.value!=null){
		
			edt_tel.value=maskPhone(edt_tel.value);		
			
		}		

		sta_job_yn.value=Grid00.getCellValue(e.row,9);		//?????????????????????
		edt_name.value=ds_out.getColumn(ds_out.rowposition,"CUST_NM");
		cmb_card_sta.value = "";
		

		
		//edt_jumin.value=Grid00.getCellText(e.row,4);
		//edt_card_num.value=Grid00.getCellText(e.row,5);
		//edt_job_id.value=Grid00.getCellText(e.row,8);
		//edt_call_result.value=Grid00.getCellText(e.row,9);
		//edt_smsYN.value=Grid00.getCellText(e.row,12);
		//alert(Grid00.getCellValue(obj.currentrow,7));
		//alert(userID +"=="+Grid00.getCellValue(obj.currentrow,9)+"=="+Grid00.getCellValue(e.row,9));
		//alert(userID+"=="+Grid00.getCellValue(obj.currentrow,9));
		
		if (obj.currentcell=="0"){
			
		}else if(userID!=Grid00.getCellValue(obj.currentrow,8)){
		
		}else{
		
			ars_update3();		
			
		}
		
		//if(ds_out.getColumn(obj.currentrow,"CHK")=="1"){
		
		ars_contact();
		
		//}
		
		//ds_out_con.clearData();		
		if(CheckBox00.isChecked() == true)
		{
			if(application.popupframes["COM014"+COM014_idx])
			{
				application.popupframes["COM014"+COM014_idx].form.close();	
			}

			var URL = "";
			var file=ds_out.getColumn(ds_out.rowposition,"FILE_NM");
			var path=ds_out.getColumn(ds_out.rowposition,"FILE_PATH");
			
			ds_get_param.clearData();
			ds_set_param.clearData();
			
			fun_ds_srch(ds_get_param, "FILE_NM", 			file);
			fun_ds_srch(ds_get_param, "FILE_PATH", 	path);
			var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};
			COM014_idx = COM014_idx+1;
			COM014 = PopupDialog("COM014"+COM014_idx,"COM::COM014.xfdl", -1, -1, 571, 345, false, -1, arrParam, true, false, true, false);				
		}
	}
}

//------------------------------------------------------------------------------------------
//셀 클릭시 작업중 업데이트
//------------------------------------------------------------------------------------------

function ars_update3(){

	if (edt_job_run.value=="할당"){

		ds_srch.clearData();
		ds_srch1.clearData();
		ds_srch2.clearData();
		ds_srch3.clearData();
		
		fun_ds_srch(ds_srch3, "SEQ_NO", edt_seq.value);
		fun_ds_srch(ds_srch3, "JOB_ID", userID);
		
		
		fun_ds_srch(ds_srch, "JOB_ID", userID);
		fun_ds_srch(ds_srch1, "B", userID);
		fun_ds_srch(ds_srch2, "BUSER", userID);
		
		var sum_day=getToday();
		
		fun_ds_srch(ds_srch3, "JOB_DT", sum_day);
	
		//ds_out.clearData();			    
			    
		var	strSvcID = "U3";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = ""; 
		var	strOutDatasets = "ds_background=SELECT_1_ODATA ds_background2=SELECT_2_ODATA";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
			strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch:a SELECT_2_IDATA=ds_srch2:a"; 
			strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE3 SELECT_1_ID=LPS010.Get_LPS_SELECT_background01 SELECT_2_ID=LPS010.Get_LPS_SELECT_background02";
		}else{
			strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch:a SELECT_2_IDATA=ds_srch2:a UPDATE_3_IDATA=ds_srch3:a"; 
			strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE3 SELECT_1_ID=LPS010.Get_LPS_SELECT_background01 SELECT_2_ID=LPS010.Get_LPS_SELECT_background02 UPDATE_3_ID=LPS010.Get_LPS_UPDATE3_MIG";
		}
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
			
	}else{
		
	}
}


//------------------------------------------------------------------------------------------
// 접촉이력조회
//------------------------------------------------------------------------------------------
function ars_contact(){

	ds_srch_con.clearData();
	ds_out_con.clearData();
	//fun_ds_srch(ds_srch_con, "RES_REG_NO", edt_jumin.value);
	fun_ds_srch(ds_srch_con, "ARS_REG_SEQ_NO", edt_seq.value);
		
	var	strSvcID = "S1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "SELECT_0_IDATA=ds_srch_con:a"; 
	var	strOutDatasets = "ds_out_con=SELECT_0_ODATA";
	var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_SELECT_con";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
}

//------------------------------------------------------------------------------------------
// 녹취플레이
//------------------------------------------------------------------------------------------

function btn_play_onclick(obj:Button,  e:ClickEventInfo)
{
	
	if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="0"){
	
		cf_Alert("COME0002","미할당 고객입니다.");
		return;
	
	}		
			
	else if(ds_out.rowposition==-1 || ds_out.getColumn(ds_out.rowposition,"FILE_NM")=="" || ds_out.getColumn(ds_out.rowposition,"FILE_NM")==null ){
	
		cf_Alert("COME0002","녹취경로 / 파일이 없습니다.");
		return;
		
	}else{
	
	//if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="2" || ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="1")
	//goAgentPlayer();
	
	Button00_onclick();
	
	}
	
}


//------------------------------------------------------------------------------------------
// 실명인증 
//------------------------------------------------------------------------------------------

function btn_inter_onclick(obj:Button,  e:ClickEventInfo)
{

	if(edt_name.value==null || edt_name.value==""){
		
		cf_Alert("COME0002","고객녹취 확인후 고객명을 입력해주세요.");
		return;
		
	}
	
	if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="1" || ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="2"){
		
		if (ds_out.getColumn(ds_out.rowposition,"CUST_NM")=="" || ds_out.getColumn(ds_out.rowposition,"CUST_NM")==null){
	
			Btn_Authn_onclick();	
		
		}else{
				
				cf_Alert("COME0002","실명인증된 고객입니다.");
		
		}
	}else{
		
		cf_Alert("COME0002","작업중이 아닙니다.");
	
	}
}



/********************************************************************************** 
 *  실명확인 한신평 전송
***********************************************************************************/
function Btn_Authn_onclick(obj:Button,  e:ClickEventInfo)
{
	
	fun_ds_srch(ds_in_vf,"NAME",getTrim(edt_name.value));
	fun_ds_srch(ds_in_vf,"SSN",getTrim(edt_jumin.value));		
				
	var	strSvcID = "vf";
	var	strURL = SVC_IF_URL_VF;	
	var	strInDatasets = "DS_IN_VF=ds_in_vf:a";
	var	strOutDatasets = "ds_out_vf=DS_OUT_VF";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBackVf";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
}



/********************************************************************************** 
 *  실명인증 콜백처리
***********************************************************************************/

function fn_callBackVf(svcid,strErrCode,strErrMsg)
{
	if(svcid =="vf"){
	
		if(ds_out_vf.getColumn(0,"YN") == "N"){
		
			cf_Alert("COME0002",ds_out_vf.getColumn(0,"MSG"));
			
		}else{
		
			cf_Alert("COME0002",ds_out_vf.getColumn(0,"MSG"));	
			
				ds_out.setColumn(ds_out.rowposition,"CUST_NM",edt_name.value);				
				Authn_DB_in();
				
		}		
	}	
	
}


//------------------------------------------------------------------------------------------
// 실명확인후 결과저장 
//------------------------------------------------------------------------------------------

function Authn_DB_in(){

	ds_real_name.clearData();
	ds_master_name_in.clearData();
		
	fun_ds_srch(ds_real_name, "CRD_NO", edt_card_num.value);
	fun_ds_srch(ds_real_name, "CUST_NM", edt_name.value);
	fun_ds_srch(ds_real_name, "ACNM_CNFM_RSLT_CD", ds_out_vf.getColumn(0,"YN")); //실명확인결과코드	
	fun_ds_srch(ds_real_name, "CNSLR_ID", userID);	
	fun_ds_srch(ds_real_name, "ACNM_CNFM_DTM", edt_jumin.value); //실명확인일시
	
	fun_ds_srch(ds_master_name_in, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO")); 
	fun_ds_srch(ds_master_name_in, "CRD_NO", edt_card_num.value); 
	fun_ds_srch(ds_master_name_in, "CUST_NM", edt_name.value); 
	
	fun_ds_srch(ds_master_name_in, "JOB_ID", userID); 
	
	fun_ds_srch(ds_master_name_in, "ACNM_CNFM_RSLT_CD", ds_out_vf.getColumn(0,"YN")); 
	fun_ds_srch(ds_master_name_in, "ACNM_CNFM_DTM", edt_name.value); //실명확인일시
					    
	var	strSvcID = "SS1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=ds_real_name:a UPDATE_1_IDATA=ds_master_name_in:a"; 
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=LPS010.Set_LPS_real_name UPDATE_1_ID=LPS010.Set_LPS_master_name";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	return;
	
}


//------------------------------------------------------------------------------------------
// 고객 삭제
//------------------------------------------------------------------------------------------
function btn_delete_onclick(obj:Button,  e:ClickEventInfo)
{

	if(cmb_card_sta.value==null || cmb_card_sta.value==''){
		
		if (ds_out.findRow("CHK","1")=="-1"){
		
		cf_Alert("LPSE0001");
		
		}else if(ds_out.getCaseCount("CHK =="+ '1')>1) {
		
			cf_Alert("LPSE0004");
			
		}else{
		
			if (!cf_Confirm("LPSI0001","고객삭제확인"))	return;  	
			ars_info_delete();    
		
		}
		//말소
	}else if(cmb_card_sta.value=='03'){
		//사용하지 않는다. 20200309 김재숙 주임.
		card_state_change();
		return;
		//정지
	}else if(cmb_card_sta.value=='02'){
		
		card_state_change();
		return;
		
	}
		
}





/********************************************************************************** 
 *  ARS고객삭제 작업
***********************************************************************************/
function ars_info_delete(){
	
	
	ds_del_srch.clearData();
	ds_srch.clearData();
	ds_srch1.clearData();
	ds_srch2.clearData();
	ds_srch3.clearData();
	
	//Grid00.getCellText(ds_out.findRow("CHK","1"),4);	
	fun_ds_srch(ds_srch, "JOB_ID", userID);
	
	//fun_ds_srch(ds_del_srch, "RES_REG_NO", Grid00.getCellValue(ds_out.findRow("CHK","1"),3));
	//fun_ds_srch(ds_del_srch, "CRD_NO", Grid00.getCellValue(ds_out.findRow("CHK","1"),6));		
	fun_ds_srch(ds_del_srch, "SEQ_NO", Grid00.getCellValue(ds_out.findRow("CHK","1"),18));
	
	fun_ds_srch(ds_del_srch, "JOB_ID", userID);
	fun_ds_srch(ds_del_srch, "JOB_DT", getToday());
				
	fun_ds_srch(ds_srch1, "CRD_NO", edt_card_num_srch.value);
	fun_ds_srch(ds_srch1, "RES_REG_NO", edt_jumin_srch.value);
	fun_ds_srch(ds_srch1, "CUR_RSLT_CD", cmb_call_result.value);
	fun_ds_srch(ds_srch1, "JOB_PRGR_ST_CD", cmb_job_sta.value);
	fun_ds_srch(ds_srch1, "ARS_REG_DTM", cal_00.value);
	
	//삭제후 전체 조회 되는거 막기 위해 추가 2013.01
	//권한 추가
	if(userGRD=="K" || userGRD=="A") { userGRD = "I"; }
	
	
	if(userGRD=="I"){
	}else if(cmb_job_sta.value=="1" || cmb_job_sta.value=="2" || cmb_job_sta.value=="3" || cmb_job_sta.value=="4" || cmb_job_sta.value=="5"){
		fun_ds_srch(ds_srch1, "JOB_ID", userID);    
	}
	
	if(cal_01.value==""){
		fun_ds_srch(ds_srch1, "ARS_REG_DTM_E", cal_01.value);
	}else{
		fun_ds_srch(ds_srch1, "ARS_REG_DTM_E", cal_01.value+"2500");
	}
	
	//ds_out을 클리어하기 전에 해당로우의 등록date를 가져와서 변수에 저장해놓음
	var dsOutCurRowDate = ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8);
	
	ds_out.clearData();

	var	strSvcID = "D1";
	var	strURL = SVC_USR_URL;
	//등록대기고객 삭제시 실제 row삭제가 아닌 상태를 변경하는걸로 바꿈 2012.12
	//등록대기고객 삭제시 실제 row삭제처리로 변경 20181218 김순화D 요청 
	var	strInDatasets = "DELETE_0_IDATA=ds_del_srch:a SELECT_1_IDATA=ds_srch1:a"; 
	//var	strInDatasets = "UPDATE_0_IDATA=ds_del_srch:a SELECT_1_IDATA=ds_srch1:a"; 
	var	strOutDatasets = "ds_out=SELECT_1_ODATA"; //
	var	strArgument = "";	

	//1 등록일자 기준
	if(cmb_day.value=="1"){
		
		if( Today() == dsOutCurRowDate){
			strArgument = "DELETE_0_ID=LPS010.Set_LPS_DELETE2 SELECT_1_ID=LPS010.Get_LPS_SELECT";
			//strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_DELETE_STAT SELECT_1_ID=LPS010.Get_LPS_SELECT";
		}else{
			strInDatasets = strInDatasets + " DELETE_2_IDATA=ds_del_srch:a";
			strArgument = "DELETE_0_ID=LPS010.Set_LPS_DELETE2 SELECT_1_ID=LPS010.Get_LPS_SELECT";// DELETE_2_ID=LPS010.Set_LPS_DELETE2_MIG";
			//strInDatasets = strInDatasets + " UPDATE_2_IDATA=ds_del_srch:a";
			//strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_DELETE_STAT SELECT_1_ID=LPS010.Get_LPS_SELECT UPDATE_2_ID=LPS010.Set_LPS_UPDATE_DELETE_STAT_MIG";
		}
	//2 작업일자 기준	
	}else{
		
		if( Today() == dsOutCurRowDate){
			strArgument = "DELETE_0_ID=LPS010.Set_LPS_DELETE2 SELECT_1_ID=LPS010.Get_LPS_SELECT0";
			//strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_DELETE_STAT SELECT_1_ID=LPS010.Get_LPS_SELECT0";
		}else{
			strInDatasets = strInDatasets + " DELETE_2_IDATA=ds_del_srch:a";
			strArgument = "DELETE_0_ID=LPS010.Set_LPS_DELETE2 SELECT_1_ID=LPS010.Get_LPS_SELECT0";// DELETE_2_ID=LPS010.Set_LPS_DELETE2_MIG";
			//strInDatasets = strInDatasets + " UPDATE_2_IDATA=ds_del_srch:a";
			//strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_DELETE_STAT SELECT_1_ID=LPS010.Get_LPS_SELECT0 UPDATE_2_ID=LPS010.Set_LPS_UPDATE_DELETE_STAT_MIG";
		}
		
	}
	
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	return;

}

//------------------------------------------------------------------------------------------
//SMS 실행(백그라운드)
//------------------------------------------------------------------------------------------

function btn_sms_load_onclick(obj:Button,  e:ClickEventInfo)
{	

	if(ds_out.findRow("CHK","1")=="-1"){

	cf_Alert("COME0002","SMS 문자 전송할 고객이 선택되지 않았습니다.");
	return;
	
	}
	
	ds_get_param.clearData();
	ds_set_param.clearData();
	ds_out_sms.clearData();
	ds_SMS_copy1.clearData();
	ds_SMS_copy2.clearData();
	//ds_out_sms.copyData(ds_out);		
	ds_out_temp.copyData(ds_out);
	ds_out_temp.filter(" CHK == '1'");	
	ds_out_sms.copyData(ds_out_temp,true);	
	ds_SMS.clearData();
	ds_sms_yn.clearData();

	var iterate_chk = new Array();
	
	for (i=0;i<ds_out_sms.rowcount;i++){

		ds_get_param.setColumn(i,"TR_PHONE",	ds_out_sms.getColumn(i,"MBPH_NO"));
		ds_get_param.setColumn(i,"TR_CALLBACK",	Edt_HomePhone.value);
		
		ds_get_param.setColumn(i,"TR_MSG",		Txa_MSG.value);	
		
	
		ds_SMS.addRow();
		ds_SMS.setColumn(i, "TR_PHONE"          , ds_out_sms.getColumn(i,"MBPH_NO"));            //수신번호		
		ds_SMS.setColumn(i, "TR_CALLBACK"       , Edt_HomePhone.value);         //발신번호
		ds_SMS.setColumn(i, "TR_MSG"            , Txa_MSG.value); 		   //수신메세지
		ds_SMS.setColumn(i, "SNDR_ID"      		, GetUserInfo("gUSR_ID"));    
		ds_SMS.setColumn(i, "TR_PHONE"          , getTrim(ds_SMS.getColumn(i,"TR_PHONE")).replace("-", ""));            //수신번호		
		ds_SMS.setColumn(i, "TR_CALLBACK"       , getTrim(ds_SMS.getColumn(i,"TR_CALLBACK")).replace("-", ""));         //발신번호
		ds_SMS.setColumn(i, "TR_MSG"            , getTrim(ds_SMS.getColumn(i,"TR_MSG")).replace("\r\n", " ")); 		   //수신메세지	

		iterate_chk.push(ds_out_sms.getColumn(i,"SEQ_NO"));
		
		fun_ds_srch(ds_sms_yn, "ITERATE_CUST_TYPE", iterate_chk.join(","));	
		
		//80자 이상이면 MMS발송이다.
		
		var len_msg = ds_SMS.getColumn(i, "TR_MSG");
		
		if(len_msg.length<1){
		
			alert("메세지 내용이 없습니다.");
			return;
			
		}else if (len_msg.length < 81){
		
		var nRow = ds_SMS_copy1.addRow();
		ds_SMS_copy1.copyRow(nRow, ds_SMS , i);
		
		}else{
		
			alert("MMS로 전송됩니다.");
			var nRow = ds_SMS_copy2.addRow();
			ds_SMS_copy2.copyRow(nRow, ds_SMS , i);		
			
		}
			
	}//alert(ds_SMS.getColumn(0, "TR_MSG"));
	//alert(ds_out_sms.rowcount);
	//trace(ds_SMS.saveXML());
	
	
	var	strSvcID = "C1";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "";
	var	strOutDatasets = "";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
		strInDatasets = "INSERT_0_IDATA=ds_SMS_copy1:a INSERT_1_IDATA=ds_SMS_copy2:a UPDATE_2_IDATA=ds_sms_yn:a";
		strArgument = "INSERT_0_ID=COM170.Set_SMS_INSERT INSERT_1_ID=COM170.Set_MMS_INSERT UPDATE_2_ID=LPS010.Set_SMS_YN";
	}else{
		strInDatasets = "INSERT_0_IDATA=ds_SMS_copy1:a INSERT_1_IDATA=ds_SMS_copy2:a UPDATE_2_IDATA=ds_sms_yn:a UPDATE_3_IDATA=ds_sms_yn:a";
		strArgument = "INSERT_0_ID=COM170.Set_SMS_INSERT INSERT_1_ID=COM170.Set_MMS_INSERT UPDATE_2_ID=LPS010.Set_SMS_YN UPDATE_3_ID=LPS010.Set_SMS_YN_MIG";
	}
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		
	
	
/*
	var lp_msg="GS칼텍스입니다. 등록하신보너스카드가미등록상태입니다. 고객센타로 확인바랍니다.";
	ds_get_param.clearData();
	ds_set_param.clearData();
	ds_out_sms.copyData(ds_out,false);		
	ds_out_sms.filter(" CHK == '1'");			
	
	for (i=0;i<ds_out_sms.rowcount;i++){
	
		//fun_ds_srch(ds_get_param, "TR_CALLBACK",ds_out_sms.getColumn(i,"CRD_INFO"));
		//fun_ds_srch(ds_get_param, "CUST_ID",edt_jumin.text);
		//fun_ds_srch(ds_get_param, "CUST_NM",edt_name.text);	
		//fun_ds_srch(ds_get_param, "TR_PHONE",edt_tel2.text);	
		ds_get_param.addRow();
		ds_get_param.setColumn(i,"TR_PHONE",	ds_out_sms.getColumn(i,"MBPH_NO"));
		ds_get_param.setColumn(i,"TR_CALLBACK",	"010-9138-4141");
		//ds_get_param.setColumn(i,"CUST_ID",		ds_out_sms.getColumn(i,"CRD_INFO"));
		//ds_get_param.setColumn(i,"CUST_NM",		ds_out_sms.getColumn(i,"CRD_INFO"));
		ds_get_param.setColumn(i,"TR_MSG",		lp_msg);
	
		//alert(ds_get_param.getColumn(i,"TR_CALLBACK"));
		//alert(ds_get_param.getColumn(i,"TR_CALLBACK"));	
	}
							
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

	PopupDialog("COM170","COM::COM170.xfdl", -1, -1, 720, 765, false, -1, arrParam, true, false, true, false);	
	*/
}

//------------------------------------------------------------------------------------------
// 고객정보등록저장
//------------------------------------------------------------------------------------------
function btn_ars_input_onclick(obj:Button,  e:ClickEventInfo)
{	
	//제휴카드 여부 : 제휴=Y,그외 N
	if(ds_out.getColumn(ds_out.rowposition,"BIZ_CARD_YN") == "Y")
	{
		//더이상 사용 하지 않는 I/F로 확인 20190304 김성민k
		//alert("제휴");
		fnCustNmCk(); 	
	}
	else
	{
		LP_start_onclick();  //일반카드
	}

}

//------------------------------------------------------------------------------------------
// 이력남기기
//------------------------------------------------------------------------------------------

function btn_contact_save_onclick(obj:Button,  e:ClickEventInfo)
{	
	/*if (edt_jumin.value==null || edt_jumin.value==""){
		
		cf_Alert("COME0002","고객을 선택하지 않고 이력을 남길수 없습니다.");
		return;
		
	}else */
	
	if(cmb_call_result2.value==null || cmb_call_result2.value==""){
		
		cf_Alert("COME0002","통화결과를 선택하셔야 합니다.");
		return;
		
	}else if(edt_job_run.text=="미할당"){
		
		cf_Alert("COME0002","미할당 상태의 고객 입니다.");
		return;
		
	}
	
	ds_save.clearData();
	ds_save_hist.clearData();
		
	fun_ds_srch(ds_save, "RES_REG_NO", edt_jumin.value);
	fun_ds_srch(ds_save, "CUR_RSLT_CD", cmb_call_result2.value);
	fun_ds_srch(ds_save, "CNSL_CTT", edt_lp_context.text);	
	fun_ds_srch(ds_save, "SEQ_NO", edt_seq.value);	
	//fun_ds_srch(ds_save, "ARS_REG_SEQ_NO", edt_seq.value);
	fun_ds_srch(ds_save, "JOB_ID", userID);	
	
	var sum_day=getToday();
		
	fun_ds_srch(ds_save, "JOB_DT", sum_day);
	
	
	fun_ds_srch(ds_save_hist, "RES_REG_NO", edt_jumin.value);
	fun_ds_srch(ds_save_hist, "ARS_REG_SEQ_NO", edt_seq.value);
	//fun_ds_srch(ds_save_hist, "B", edt_jumin.value);
	fun_ds_srch(ds_save_hist, "CNSL_RSLT_CD", cmb_call_result2.value);
	fun_ds_srch(ds_save_hist, "CNSL_CTT", edt_lp_context.text);	
	
						    
	var	strSvcID = "U4";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
		strInDatasets = "INSERT_0_IDATA=ds_save_hist:a UPDATE_1_IDATA=ds_save:a"; 
		strArgument = "INSERT_0_ID=LPS010.Set_LPS_save_hist UPDATE_1_ID=LPS010.Set_LPS_save";
	}else{
		strInDatasets = "INSERT_0_IDATA=ds_save_hist:a UPDATE_1_IDATA=ds_save:a UPDATE_2_IDATA=ds_save:a"; 
		strArgument = "INSERT_0_ID=LPS010.Set_LPS_save_hist UPDATE_1_ID=LPS010.Set_LPS_save UPDATE_2_ID=LPS010.Set_LPS_save_MIG";
	}
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
	
	//trace(ds_out.getColumn(ds_out.rowposition,"CHK"));
	if(ds_out.getColumn(ds_out.rowposition,"CHK")=="1"){
		
		ars_update3();		
	
	}
	
}


//------------------------------------------------------------------------------------------
// 그리드 정렬
//------------------------------------------------------------------------------------------
function Grid00_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	
	cf_gridSort(obj, e);
	
	if(e.col == 0)	cf_AllChk(obj,0, "CHK");

}

//------------------------------------------------------------------------------------------
// 이관 (인수인계)
//------------------------------------------------------------------------------------------

function ars_send_new_user_onclick(obj:Button,  e:ClickEventInfo)
{
	if (cmb_usr.value=="" || cmb_usr_base.value==""){
	
		cf_Alert("COME0002","이관할 대상을 선택하셔야 합니다.");
		
	}else{
	
		ars_send_new_user_excute();	
		
	}
	
}


//------------------------------------------------------------------------------------------
// 이관실행(iterate)
//------------------------------------------------------------------------------------------
function ars_send_new_user_excute(){
	/*
	ds_new_save.clearData();
	ds_out_new.clearData();			
	ds_out_new.copyData(ds_out);						// Grid와 연동된 ds_msg_list 전체 데이터를 ds_del_yn에 copy
	ds_out.filter("CHK == 1");					// 체크된 항목만 filter
	ds_new_save.copyData(ds_out, true);	// filter된 항목만 ds_del_yn_filtered 에 copy(업데이트 입력값)
	
	if (ds_out.rowcount < 1){
		cf_Alert("COME0006");	// 선택한 항목이 없습니다.
		ds_out.filter("CHK == 0");
		return;
	}else{
	var iterrate_chk = new Array();
	
	for(i=0;i<ds_new_save.rowcount;i++){
	iterrate_chk.push(ds_new_save.getColumn(i,"RES_REG_NO"));
	
	fun_ds_srch(ds_srch_newchange, "ITERATE_CUST_TYPE", iterrate_chk.join(","));	
	fun_ds_srch(ds_srch_newchange, "NEWA", cmb_usr_base.value);	
	fun_ds_srch(ds_srch_newchange, "NEWB", cmb_usr.value);	
		
	//alert(ds_srch_newchange.getColumn(0,RES_REG_NO));
	//return;
	}
		var	strSvcID = "U6";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = "UPDATE_0_IDATA=ds_srch_newchange:a"; 
		var	strOutDatasets = "";
		var	strArgument = "UPDATE_0_ID=LPS010.Get_LPS_new_user";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);

	}
	*/		
	
	fun_ds_srch(ds_srch_newchange, "OLDUSER", cmb_usr_base.value);	
	fun_ds_srch(ds_srch_newchange, "NEWUSER", cmb_usr.value);	
	
	fun_ds_srch(ds_srch_newchange, "ARS_REG_DTM1", cal_00.value);	
	fun_ds_srch(ds_srch_newchange, "ARS_REG_DTM2", cal_01.value);	
	
	var	strSvcID = "U6";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
		strInDatasets = "UPDATE_0_IDATA=ds_srch_newchange:a"; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_new_user";
	}else{
		strInDatasets = "UPDATE_0_IDATA=ds_srch_newchange:a UPDATE_1_IDATA=ds_srch_newchange:a"; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_new_user UPDATE_1_ID=LPS010.Get_LPS_new_user_MIG";
	}
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);

	/* SMS팝업용으로 사용했음
	
	ds_new_save.clearData();
	ds_out_new.clearData();			
	ds_out_new.copyData(ds_out);						// Grid와 연동된 ds_msg_list 전체 데이터를 ds_del_yn에 copy
	ds_out.filter("CHK == 1");					// 체크된 항목만 filter
	ds_new_save.copyData(ds_out, true);	// filter된 항목만 ds_del_yn_filtered 에 copy(업데이트 입력값)
			
	if (ds_out.rowcount < 1){
		cf_Alert("COME0006");	// 선택한 항목이 없습니다.
		ds_out.filter("CHK == 0");
		return;
	}
    else{	
    		    		
    	fun_ds_srch(ds_new_save, "NEWB", cmb_usr.value);	
    		
    	//alert(ds_new_save.getColumn(0,"RES_REG_NO"));	    		
    	//return;
    		
		var	strSvcID = "U6";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = "UPDATE_0_IDATA=ds_new_save:a"; 
		var	strOutDatasets = "";
		var	strArgument = "UPDATE_0_ID=LPS010.Get_LPS_new_user";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	}*/

}



//------------------------------------------------------------------------------------------
// 이관 (인수인계) 용 사용자콤보
//------------------------------------------------------------------------------------------
 function fn_userComboList()
{

	set_user_code();
	//Cmb_Grp_onitemchanged(Cmb_Grp);
	
}


//------------------------------------------------------------------------------------------
// LP스크립트 불러오기
//------------------------------------------------------------------------------------------
function btn_sms_file_load_onclick(obj:Button,  e:ClickEventInfo)
{
	
	ds_scrt_load.clearData();
	ds_scrt_out.clearData();
	
	var	strSvcID = "R4";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "ds_scrt_out=SELECT_0_ODATA";
	var	strArgument = "SELECT_0_ID=LPS010.Get_LPS_scrt_load";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
		
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	
	
}




/********************************************************************************** 
 *****	전화이벤트
***********************************************************************************/
function getPhnEvent(arrParam){
	
	switch(arrParam.frmPgmId)
	{	
		// 대기버튼 클릭시
		case "COM121_READY" :
			break;
		
		// OB 전화연결시 연결전화번호
		case "COM121_CALLNO" :
			// OB연결 전화번호 세팅
			// cf_trace("arrParam.callNo",arrParam.callNo);
		//	var inip = arrParam.callNo;
		//	var objInLineDs = LPS010.all["Tab_SmryInfo"]["tabpage1"].all["ds_inline_no"];
		//	objInLineDs.clearData();
		//	objInLineDs.addRow();
		//	objInLineDs.setColumn(0,"INLINE_NO",inip);
		//	LPS010.all["Tab_SmryInfo"]["tabpage1"].fn_setInlineNo();
			
			// 상담생성
		//	this.all["Tab_CntctHistInfo"]["tabpage1"].fn_creCnslSeq();			
			break;
	}
}


/********************************************************************************** 
 *  CTI전화걸기(전화)
***********************************************************************************/
function btn_tel_onclick(obj:Button,  e:ClickEventInfo)
{

	objPHN.setEventProcGbn("objPHNLPS");	// objPHNBNS, objPHNORD, objPHNCMP, objPHNLPS			
	objPHN.setMakeCall('9' + getTrim(edt_tel.value).replace("-",""),"LPS");	
	
}


/********************************************************************************** 
 *  CTI전화걸기(휴대폰)
***********************************************************************************/
function btn_hp_tel_onclick(obj:Button,  e:ClickEventInfo)
{

	objPHN.setEventProcGbn("objPHNLPS");	// objPHNBNS, objPHNORD, objPHNCMP, objPHNLPS			
	objPHN.setMakeCall('9' + getTrim(edt_tel2.value).replace("-",""),"LPS");	
		
}


/********************************************************************************** 
 *  녹취 재생(웹서비스이용)
***********************************************************************************/
function goAgentPlayer(){

	var URL = "";
	//system.execShell("wmplayer");
	//try{
	//objPlayer.install();
		/*
		trace("objPlayer.codebase ::" + objPlayer.codebase);			
		objPlayer.codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,5,715";
		objPlayer.FileName="c://test.wav";		
		objPlayer.AutoStart="0";		
		*/
		//AXMSIE.codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,5,715";
			
	//var file=edt_name.value;

	var file=ds_out.getColumn(ds_out.rowposition,"FILE_NM");
	var path=ds_out.getColumn(ds_out.rowposition,"FILE_PATH");
	
	//alert(path+file);
	//return;
	//trace(path+file);
		
		URL = GetConfig("LP_NAS")+"/iisstart.asp?FileName="+path+file; //리얼			
	
	//	URL += "FilePath=" + fp + "&FileName=" + fn;
			
		AXMSIE.Navigate2(URL,"", "_self","","");	
		
		//alert(objPlayer.FileName);	
	//}catch(e){
		//trace("소켓설치 에러발생 :: " + e.description);
	//}
	
	
}


/********************************************************************************** 
 *  카드발급정보등록 인터페이스
***********************************************************************************/

function LP_start_onclick(obj:Button,  e:ClickEventInfo)
{
	
	
	var nextNum = getDBToday();
	var agrmNum = nextNum.substr(0,8);
	
	ds_if_ars_card_env.clearData();			// 제휴, 일반  인터페이스에서 같이 사용하기때문에 cleardate() 대신 clear() 사용
	ds_if_ars_card_data.clearData();
	ds_if_ars_card_common.clearData();
	ds_if_ars_card_header.clearData();
	ds_if_ars_card_column.clearData();
	ds_if_ars_card_record.clearData();	

	fun_ds_srch(ds_if_ars_card_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_ars_card_env, "REQ_SERVICE_METHOD", 	"arsCmCustInsC02.do"); //공통이 어디까지?
	fun_ds_srch(ds_if_ars_card_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_ars_card_env, "RES_HEADER_SECTION", 	""); //xml상위 헤더항목
	fun_ds_srch(ds_if_ars_card_env, "RES_COLUMN_SECTION", 	""); 
	fun_ds_srch(ds_if_ars_card_env, "RES_RECORD_SECTION", 	"STP_ARS_CM_CUST_INS_C02_Rsp"); 

	fun_ds_srch(ds_if_ars_card_data,"req_chnl_code","610050");
	fun_ds_srch(ds_if_ars_card_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_ars_card_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_ars_card_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
	fun_ds_srch(ds_if_ars_card_data,"in_nxtt_seq",nextNum); //임시일련번호
	fun_ds_srch(ds_if_ars_card_data,"in_crd_no",edt_card_num.value);

	var NumJ = edt_jumin.value;		
				
	//★20120625 주민번호 수집금지			
	//fun_ds_srch(ds_if_ars_card_data,"in_head_rsno",NumJ.substr(0,6));
	//fun_ds_srch(ds_if_ars_card_data,"in_tail_rsno",NumJ.substr(6,13));
	fun_ds_srch(ds_if_ars_card_data,"in_head_rsno","");
	fun_ds_srch(ds_if_ars_card_data,"in_tail_rsno","");

	fun_ds_srch(ds_if_ars_card_data,"in_bday",edt_cuik_bday.value);	//생년월일
	fun_ds_srch(ds_if_ars_card_data,"in_sex_cd",cmb_sex_cd.value);	//성별
	
	fun_ds_srch(ds_if_ars_card_data,"in_rlnm_authn_dtime",nextNum); //실명인증일시
	fun_ds_srch(ds_if_ars_card_data,"in_join_chnl_cd","610060"); //가입채널코드
	fun_ds_srch(ds_if_ars_card_data,"in_inpt_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_ars_card_data,"in_agrm_date",agrmNum);
	fun_ds_srch(ds_if_ars_card_data,"in_sms_rcv_yn",ds_out.getColumn(ds_out.rowposition,"SMS_AGRM_YN"));
	fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd4",ds_out.getColumn(ds_out.rowposition,"INFO_CONJ_AGRM_YN"));  //제3자 정보제공약관세분화로인하여 사용안함
	fun_ds_srch(ds_if_ars_card_data,"in_sign_yn",edt_agreeYN.value);
	
	
	
		
	var cvcvalue = edt_card_num.value;
	var cvcData = cvcCheck(cvcvalue);		
		
	fun_ds_srch(ds_if_ars_card_data,"in_cvc_no",cvcData);
	fun_ds_srch(ds_if_ars_card_data,"in_cust_nm",edt_name.value);
		
		
	var arrClPhn 	= getTrim(edt_tel2.value).split("-");
	var strClPhnDdd = "";
	var strClPhnFst = "";
	var strClPhnLst = "";
	
	if(arrClPhn.length > 1){	

		if(arrClPhn.length == 3){
		
			strClPhnDdd	= arrClPhn[0];
			strClPhnFst = arrClPhn[1];
			strClPhnLst = arrClPhn[2];
			
		}else{
		
			cf_Alert("COME0002","휴대번호 형식이 맞지 않습니다.");
			
		}
	}
		
	//휴대폰번호
	fun_ds_srch(ds_if_ars_card_data,"in_head_tphn_no",strClPhnDdd);
	fun_ds_srch(ds_if_ars_card_data,"in_mid_tphn_no",strClPhnFst);
	fun_ds_srch(ds_if_ars_card_data,"in_fnl_tphn_no",strClPhnLst);
	
	strClPhnDdd	= "";
	strClPhnFst = "";
	strClPhnLst = "";	
			
	//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_FROM","20091001");
	//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_TO","20101201");	
		
	fun_ds_srch(ds_if_ars_card_data,"in_use_pw",ds_out.getColumn(ds_out.rowposition,"CUST_PW"));	
	fun_ds_srch(ds_if_ars_card_data,"in_inpt_ip",getTrim(GetUserInfo("gLGIN_IP")));	
	fun_ds_srch(ds_if_ars_card_data,"in_ci_val","");						
	//★20120625 주민번호 수집금지	
	fun_ds_srch(ds_if_ars_card_data,"in_authn_sbjt_cd",cmb_authn_sbjt_cd.value); //인증_주체_코드
	fun_ds_srch(ds_if_ars_card_data,"in_com_co_div_cd",cmb_com_co_div_cd.value); //통신회사_구분_코드
	fun_ds_srch(ds_if_ars_card_data,"in_sms_authn_dtime",ds_out.getColumn(ds_out.rowposition,"SMS_AUTHN_DTM")); //인증일시
	
	/**
	* 약관 내용 변경으로 인한 수정처리
	* 2025.02.25 | NP847
	
	//★20130128 약관 내용 추가 SJ
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_3_YN") == 'Y'|| ds_out.getColumn(ds_out.rowposition,"INFO_CONJ_AGRM_YN") =='Y') //서비스제공을 위한 제3자 제공(GSR,GSHS) 동의여부 = Y
	{
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd6","471000"); //GSR 약관코드 
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd7","481000"); //GSHS 약관코드
	}
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_4_YN") == 'Y')  //참여의사 홍보 및 고객응대를 위한 3자 제공(GSR,GSHS,GSMBiz) 및 제휴신용카드 제3자 제공약관 (신한,KB국민, 현대, 삼성, IBK)
	{	
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd13","494000"); //개인정보수집 및 활용(선택)
		//
		//2014.06.18 약관 추가 (2014.07.01 새 약관 적용)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd13","451000"); //제휴신용카드 제3자 제공약관(신한카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd14","452000"); //제휴신용카드 제3자 제공약관(KB국민카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd15","453000"); //제휴신용카드 제3자 제공약관(현대카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd16","454000"); //제휴신용카드 제3자 제공약관(삼성카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd17","455000"); //제휴신용카드 제3자 제공약관(롯데카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd18","456000"); //제휴신용카드 제3자 제공약관(IBK기업은행)
		
	}
	
	//약관 분리 작업 20190327
	
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_5_YN") == 'Y'){
		
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd8","472000"); //GSR 약관코드(마케팅) 
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd10","473000"); //GSR 약관코드(마케팅)
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd9","482000"); //GSHS 약관코드(마케팅)
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd11","483000"); //GSHS 약관코드(마케팅)
	}
	
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_6_YN") == 'Y'){
		
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd12","461000"); //GSMbiz 약관코드(정보제공)		
	}
	*/
	
	//94번 약관 - 개인정보수집 및 활용(선택)
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_4_YN") == 'Y'){
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd13","494000"); 
	}
	
	//61번 약관 - GS&포인트 마케팅을 위한 제3자 제공 및 광고성정보 수신(GS엠비즈) (선택)
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_6_YN") == 'Y'){
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd12","461000");
	}
	
	//67번 약관 - GS&포인트 마케팅을 위한 제3자 제공 및 광고성정보 수신(한국신용데이터) (선택)
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_7_YN") == 'Y'){
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd14","467000");
	}
	
	var	strSvcID = "IF_WAS_208";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_ars_card_env:a INTERFACE_DATA=ds_if_ars_card_data:a";
	var	strOutDatasets = "ds_if_ars_card_common=DS_COMMON ds_if_ars_card_header=DS_HEADER ds_if_ars_card_column=DS_COLUMN ds_if_ars_card_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
}


//------------------------------------------------------------------------------------------
//  MOD함수
//------------------------------------------------------------------------------------------
function MOD(aa,bb){

var cc=aa%bb;
return cc;

}

//------------------------------------------------------------------------------------------
// CVC계산식
//------------------------------------------------------------------------------------------
function cvcCheck(cvcvalue){
//var cvcvalue = cvcdata;

	var excelcvc = (MOD(10-MOD((parseInt(cvcvalue.substr(0,1))+parseInt(cvcvalue.substr(2,1))+parseInt(cvcvalue.substr(4,1))+parseInt(cvcvalue.substr(6,1))+parseInt(cvcvalue.substr(8,1))+parseInt(cvcvalue.substr(10,1))+parseInt(cvcvalue.substr(12,1))+parseInt(cvcvalue.substr(14,1))),10),10))*100+
(MOD(10-MOD((parseInt(cvcvalue.substr(1,1))+parseInt(cvcvalue.substr(3,1))+parseInt(cvcvalue.substr(5,1))+parseInt(cvcvalue.substr(7,1))+parseInt(cvcvalue.substr(9,1))+parseInt(cvcvalue.substr(11,1))+parseInt(cvcvalue.substr(13,1))+parseInt(cvcvalue.substr(15,1))),10),10))*10+
MOD((10-MOD(7*(MOD(10-MOD((parseInt(cvcvalue.substr(0,1))+parseInt(cvcvalue.substr(2,1))+parseInt(cvcvalue.substr(4,1))+parseInt(cvcvalue.substr(6,1))+parseInt(cvcvalue.substr(8,1))+parseInt(cvcvalue.substr(10,1))+parseInt(cvcvalue.substr(12,1))+parseInt(cvcvalue.substr(14,1))),10),10))+
9*(MOD(10-MOD((parseInt(cvcvalue.substr(1,1))+parseInt(cvcvalue.substr(3,1))+parseInt(cvcvalue.substr(5,1))+parseInt(cvcvalue.substr(7,1))+parseInt(cvcvalue.substr(9,1))+parseInt(cvcvalue.substr(11,1))+parseInt(cvcvalue.substr(13,1))+parseInt(cvcvalue.substr(15,1))),10),10)),10)),10);

	return excelcvc;
}

/********************************************************************************** 
 *  녹취청취 백그라운드 없애기
***********************************************************************************/

function LPS010_onbeforeclose(obj:Form, e:CloseEventInfo)
{

	AXMSIE.destroy();
	AXMSIE.progid = "";
	
}

/********************************************************************************** 
 *  패스워드 변경 인터페이스 -미사용
***********************************************************************************/

function password_onclick(obj:Button,  e:ClickEventInfo)
{

	ds_if_pw_init_env.clearData();
	ds_if_pw_init_data.clearData();
	ds_if_pw_init_common.clearData();
	ds_if_pw_init_header.clearData();
	ds_if_pw_init_column.clearData();
	ds_if_pw_init_record.clearData();	
	
	fun_ds_srch(ds_if_pw_init_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_pw_init_env, "REQ_SERVICE_METHOD", 	"crCrdpwUpdC01.do"); //공통이 어디까지?
	fun_ds_srch(ds_if_pw_init_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_pw_init_env, "RES_HEADER_SECTION", 	""); //xml상위 헤더항목
	fun_ds_srch(ds_if_pw_init_env, "RES_COLUMN_SECTION", 	""); 
	fun_ds_srch(ds_if_pw_init_env, "RES_RECORD_SECTION", 	"STP_CR_CRDPW_UPD_C01_Rsp"); 

	fun_ds_srch(ds_if_pw_init_data,"req_chnl_code","610050");
	fun_ds_srch(ds_if_pw_init_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_pw_init_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_pw_init_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
	fun_ds_srch(ds_if_pw_init_data,"in_req_gbn","U");  // I 초기화
	fun_ds_srch(ds_if_pw_init_data,"in_req_flag","2"); // 1 고객번호 2 주민번호 3 카드번호
	fun_ds_srch(ds_if_pw_init_data,"in_req_data",getTrim(edt_jumin.value));
	fun_ds_srch(ds_if_pw_init_data,"in_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_pw_init_data,"io_use_pw",ds_out.getColumn(ds_out.rowposition,"CUST_PW"));
					
	var	strSvcID = "IF_CSC_ITRT_018";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_pw_init_env:a INTERFACE_DATA=ds_if_pw_init_data:a";
	var	strOutDatasets = "ds_if_pw_init_common=DS_COMMON ds_if_pw_init_header=DS_HEADER ds_if_pw_init_column=DS_COLUMN ds_if_pw_init_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
		
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	
}



/********************************************************************************** 
 *  패스워드 변경 인터페이스(재전송)
***********************************************************************************/
function password_onclick_M(obj:Button,  e:ClickEventInfo)
{
		
	ds_if_pw_init_env.clearData();
	ds_if_pw_init_data.clearData();
	ds_if_pw_init_common.clearData();
	ds_if_pw_init_header.clearData();
	ds_if_pw_init_column.clearData();
	ds_if_pw_init_record.clearData();	
	
		
	fun_ds_srch(ds_if_pw_init_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_pw_init_env, "REQ_SERVICE_METHOD", 	"crCrdpwUpdC01.do"); 
	fun_ds_srch(ds_if_pw_init_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_pw_init_env, "RES_HEADER_SECTION", 	""); //xml상위 헤더항목
	fun_ds_srch(ds_if_pw_init_env, "RES_COLUMN_SECTION", 	""); 
	fun_ds_srch(ds_if_pw_init_env, "RES_RECORD_SECTION", 	"STP_CR_CRDPW_UPD_C01_Rsp"); 

	fun_ds_srch(ds_if_pw_init_data,"req_chnl_code","610050");
	fun_ds_srch(ds_if_pw_init_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_pw_init_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_pw_init_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
	fun_ds_srch(ds_if_pw_init_data,"in_req_gbn","U");  // I 초기화
	fun_ds_srch(ds_if_pw_init_data,"in_req_flag","2"); // 1 고객번호 2 주민번호 3 카드번호
	fun_ds_srch(ds_if_pw_init_data,"in_req_data",getTrim(edt_jumin.value));
	fun_ds_srch(ds_if_pw_init_data,"in_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_pw_init_data,"io_use_pw",ds_out.getColumn(ds_out.rowposition,"CUST_PW"));
					
	var	strSvcID = "IF_CSC_ITRT_018_M";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_pw_init_env:a INTERFACE_DATA=ds_if_pw_init_data:a";
	var	strOutDatasets = "ds_if_pw_init_common=DS_COMMON ds_if_pw_init_header=DS_HEADER ds_if_pw_init_column=DS_COLUMN ds_if_pw_init_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
		
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
	
}

/********************************************************************************** 
 *  저장후 처리 - 신규등록용
***********************************************************************************/
function ars_card_end(){
		
	var enddata;
		
	if (ds_if_ars_card_record.getColumn("0","OT_RESPON_CODE")=="00000"){
	
		enddata=4; // 완료
		
	}else{		
	
		enddata=9;   //에러
		
	}
		
	ds_ars_card_end.clearData();
					
	fun_ds_srch(ds_ars_card_end, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO"));
	fun_ds_srch(ds_ars_card_end, "JOB_ID", userID);
	fun_ds_srch(ds_ars_card_end, "JOB_PRGR_ST_CD", enddata);		
	fun_ds_srch(ds_ars_card_end, "CATIVE_RSLT_MSG", "");	
	
	//2012.11.27 MIG통계 수정
	var	strSvcID = "End";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_end:a "; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_end ";
	}else{
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_end:a UPDATE_1_IDATA=ds_ars_card_end:a"; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_end UPDATE_1_ID=LPS010.Get_LPS_UPDATE_MIG_end";
	}
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
}


/********************************************************************************** 
 * ★저장후 처리 - 재발급용
***********************************************************************************/
function ars_card_end_re(){
		
	var enddata;
		
	if (ds_if_rsv_std_header.getColumn("0","OT_RESPON_CODE")=="00000"){
		enddata=4;
	}else{		
		enddata=9;
	}
		
	ds_ars_card_end.clearData();
					
	fun_ds_srch(ds_ars_card_end, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO"));
	fun_ds_srch(ds_ars_card_end, "JOB_ID", userID);
	fun_ds_srch(ds_ars_card_end, "JOB_PRGR_ST_CD", enddata);	
	fun_ds_srch(ds_ars_card_end, "CATIVE_RSLT_MSG", "[카드재발급 완료]");		
	
	//2012.11.27 MIG통계 수정
	var	strSvcID = "End";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_end:a "; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_end ";
	}else{
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_end:a UPDATE_1_IDATA=ds_ars_card_end:a"; 
		strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_end UPDATE_1_ID=LPS010.Get_LPS_UPDATE_MIG_end";
	}

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
}


/********************************************************************************** 
 *  저장후 처리(전송)
***********************************************************************************/
function ars_card_end_M(){
		
	var enddata;
		
	if (ds_if_ars_card_record.getColumn("0","OT_RESPON_CODE")=="00000" && ds_if_pw_init_record.getColumn("0","OT_RESPON_CODE")=="00000"){
	
		enddata=4;
		
	}else{		
	
		enddata=9;
		
	}
		
	ds_ars_card_end.clearData();
					
	fun_ds_srch(ds_ars_card_end, "RES_REG_NO", edt_jumin.value);
	fun_ds_srch(ds_ars_card_end, "JOB_ID", userID);
	fun_ds_srch(ds_ars_card_end, "JOB_PRGR_ST_CD", enddata);		
	
	//ds_out.clearData();			    
			    
	var	strSvcID = "End_M";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "UPDATE_0_IDATA=ds_ars_card_end:a"; 
	var	strOutDatasets = "";
	var	strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_end";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
}




/********************************************************************************** 
 *  저장후 처리(재전송)
***********************************************************************************/
function ars_card_end_M(){
		
	var enddata;
		
	if (ds_if_ars_card_record.getColumn("0","OT_RESPON_CODE")=="00000" && ds_if_pw_init_record.getColumn("0","OT_RESPON_CODE")=="00000"){
	
		enddata=4;
		
	}else{		
	
		enddata=9;
		
	}
		
	ds_ars_card_end.clearData();
					
	fun_ds_srch(ds_ars_card_end, "RES_REG_NO", edt_jumin.value);
	fun_ds_srch(ds_ars_card_end, "JOB_ID", userID);
	fun_ds_srch(ds_ars_card_end, "JOB_PRGR_ST_CD", enddata);		
	
	//ds_out.clearData();			    
			    
	var	strSvcID = "End_M";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "UPDATE_0_IDATA=ds_ars_card_end:a"; 
	var	strOutDatasets = "";
	var	strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_end";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
}

/********************************************************************************** 
 *  고객조회
 **********************************************************************************/
function Btn_cust_srch()
{
	ds_if_cust_env.clearData();
	ds_if_cust_data.clearData();
	
	//IF_BNS250_01 환경설정
	fun_ds_srch(ds_if_cust_env, "IF_KIND", 				"WAS");
	fun_ds_srch(ds_if_cust_env, "REQ_SERVICE_METHOD", 	"arsCmCustSelC02.do");
	fun_ds_srch(ds_if_cust_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_cust_env, "RES_HEADER_SECTION", 	"STP_ARS_CM_CUST_SEL_C02_Rsp");
	fun_ds_srch(ds_if_cust_env, "RES_COLUMN_SECTION", 	"");
	fun_ds_srch(ds_if_cust_env, "RES_RECORD_SECTION", 	"STP_ARS_CM_CUST_SEL_C02_Rsp");
	
	var arrClPhn 	= getTrim(edt_tel2.value).split("-");
	var strClPhnDdd = "";
	var strClPhnFst = "";
	var strClPhnLst = "";
	
	if(arrClPhn.length > 1){	
		if(arrClPhn.length == 3){
			strClPhnDdd	= arrClPhn[0];
			strClPhnFst = arrClPhn[1];
			strClPhnLst = arrClPhn[2];
		}else{
			cf_Alert("COME0002","휴대번호 형식이 맞지 않습니다.");
		}
	}

	fun_ds_srch(ds_if_cust_data, "in_search_gbn", "4");
	fun_ds_srch(ds_if_cust_data, "in_bday", getTrim(edt_cuik_bday.value));
	fun_ds_srch(ds_if_cust_data, "in_sex_cd", getTrim(cmb_sex_cd.value));
	fun_ds_srch(ds_if_cust_data,"in_cphn_head_tphn_no",strClPhnDdd);
	fun_ds_srch(ds_if_cust_data,"in_cphn_min_tphn_no",strClPhnFst);
	fun_ds_srch(ds_if_cust_data,"in_cphn_fnl_tphn_no",strClPhnLst);
	fun_ds_srch(ds_if_cust_data, "in_cust_nm", getTrim(edt_name.value));

	fun_ds_srch(ds_if_cust_data, "req_chnl_code", "610050"); //콜센터 : 610050 ARS : 610060
	fun_ds_srch(ds_if_cust_data, "input_user_id", GetUserInfo("gUSR_ID"));
	fun_ds_srch(ds_if_cust_data, "input_user_nm", GetUserInfo("gUSR_NM"));
	fun_ds_srch(ds_if_cust_data, "input_user_ip", GetUserInfo("gLGIN_IP"));
	
	var	strSvcID = "IF_WAS_210";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_cust_env:a INTERFACE_DATA=ds_if_cust_data:a";
	var	strOutDatasets = "ds_if_cust_header=DS_HEADER ds_if_cust_record=DS_RECORD ds_if_cust_common=DS_COMMON";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
}



/********************************************************************************** 
 * ★카드 재발급
 **********************************************************************************/
function func_cardInsert(varCusNo, varCardNo)
{
	ds_if_rsv_std_env.clearData();
	ds_if_rsv_std_data.clearData();
	ds_if_rsv_std_common.clearData();
	ds_if_rsv_std_header.clearData();
	ds_if_rsv_std_column.clearData();
	ds_if_rsv_std_record.clearData();
	
	// 환경DS 세팅
	//fn_setIfEnvDs(ds_if_rsv_std_env,"WAS","ptTrnptSelC08.do","","STP_PT_TRNPT_SEL_C01_Rsp","","OT_OUT_CURSOR","","","","");		
			
	fun_ds_srch(ds_if_rsv_std_env, "IF_KIND","WAS");
	fun_ds_srch(ds_if_rsv_std_env, "REQ_SERVICE_METHOD","arsCmCustInsC05.do");
	fun_ds_srch(ds_if_rsv_std_env, "REQ_SERVICE_ID","");	
	fun_ds_srch(ds_if_rsv_std_env, "RES_HEADER_SECTION","STP_ARS_CM_CUST_INS_C05_Rsp");
	fun_ds_srch(ds_if_rsv_std_env, "RES_COLUMN_SECTION","");
	fun_ds_srch(ds_if_rsv_std_env, "RES_RECORD_SECTION","OT_OUT_CURSOR");
	fun_ds_srch(ds_if_rsv_std_env, "RES_CODE_NAME","");
	fun_ds_srch(ds_if_rsv_std_env, "RES_MSG1_NAME","");
	fun_ds_srch(ds_if_rsv_std_env, "RES_MSG2_NAME","");
	fun_ds_srch(ds_if_rsv_std_env, "UPDATE_DATASET_NAME","");		

	fun_ds_srch(ds_if_rsv_std_data, "req_chnl_code","610050");
	fun_ds_srch(ds_if_rsv_std_data, "input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_rsv_std_data, "input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_rsv_std_data, "input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
	
	fun_ds_srch(ds_if_rsv_std_data, "in_user_id",getTrim(GetUserInfo("gUSR_ID")));
	
	//610060으로 넘겨야 GSC 로직에서 카드상태가 정상적으로 발급이 됨.
	fun_ds_srch(ds_if_rsv_std_data, "in_req_chnl_cd","610060");
	
	fun_ds_srch(ds_if_rsv_std_data, "in_cust_no",varCusNo);
	fun_ds_srch(ds_if_rsv_std_data, "in_crd_no"	,varCardNo);//in_pblc_ss_cd 
				
	var	strSvcID = "IF_WAS_127";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_rsv_std_env:a INTERFACE_DATA=ds_if_rsv_std_data:a";
	var	strOutDatasets = "ds_if_rsv_std_common=DS_COMMON ds_if_rsv_std_header=DS_HEADER ds_if_rsv_std_column=DS_COLUMN ds_if_rsv_std_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
}

///신규고객등록
//20190304 더이상 사용 하지 않는 I/F 입니다.
function partNewCustSave()
{
    ds_if_ars_card_env.clear();
    ds_if_ars_card_data.clear();
    ds_if_ars_card_header.clear();
    ds_if_ars_card_record.clear();
    ds_if_ars_card_common.clear();
	ds_if_ars_card_column.clear();

	//ds_if_point_env
	fun_ds_srch(ds_if_ars_card_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_ars_card_env, "REQ_SERVICE_METHOD", 	"cmCustInsC01.do");
	fun_ds_srch(ds_if_ars_card_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_ars_card_env, "RES_HEADER_SECTION", 	"");
	fun_ds_srch(ds_if_ars_card_env, "RES_COLUMN_SECTION", 	"");
	fun_ds_srch(ds_if_ars_card_env, "RES_RECORD_SECTION", 	"STP_CM_CUST_INS_C01_Rsp");
	
	//ds_if_point_data
	fun_ds_srch(ds_if_ars_card_data, "req_chnl_code", "610050"); //콜센터 : 610050 ARS : 610060	
	fun_ds_srch(ds_if_ars_card_data, "input_user_id", GetUserInfo("gUSR_ID"));
	fun_ds_srch(ds_if_ars_card_data, "input_user_nm", GetUserInfo("gUSR_NM"));
	fun_ds_srch(ds_if_ars_card_data, "input_user_ip", GetUserInfo("gLGIN_IP"));
		
	fun_ds_srch(ds_if_ars_card_data, "in_req_gbn"  , "C");
	fun_ds_srch(ds_if_ars_card_data, "in_req_chnl_cd"  , "610050");
	
	fun_ds_srch(ds_if_ars_card_data, "in_head_rs_bz_no"  , "");  //사업자번호
	fun_ds_srch(ds_if_ars_card_data, "in_tail_rs_bz_no"  , "");  //사업자번호
	
	fun_ds_srch(ds_if_ars_card_data, "in_bday"  , edt_cuik_bday.value);  //생년월일
	fun_ds_srch(ds_if_ars_card_data, "in_ci_val"  , "");  //ci값
	fun_ds_srch(ds_if_ars_card_data, "in_com_co_div_cd"  , ds_out.getColumn(ds_out.rowposition,"COM_CO_DIV_CD"));  //통신회사 구분코드
	fun_ds_srch(ds_if_ars_card_data, "in_authn_sbjt_cd"  , ds_out.getColumn(ds_out.rowposition,"AUTHN_SBJT_CD"));  //인증주체코드
	
	fun_ds_srch(ds_if_ars_card_data, "in_sex_cd"  , cmb_sex_cd.value);  //성별코드
	fun_ds_srch(ds_if_ars_card_data, "in_cust_nm"  , edt_name.value);  //고객명

	var arrTel = edt_tel2.text.split("-");
	
	fun_ds_srch(ds_if_ars_card_data, "in_cphn_head_tphn_no"  , arrTel[0]);  //휴대폰앞번호
	fun_ds_srch(ds_if_ars_card_data, "in_cphn_mid_tphn_no"  , arrTel[1]);  //휴대폰중간번호
	fun_ds_srch(ds_if_ars_card_data, "in_cphn_fnl_tphn_no"  , arrTel[2]);  //휴대폰마지막번호
	fun_ds_srch(ds_if_ars_card_data, "in_user_id"  , GetUserInfo("gLGIN_IP"));  //처리ip
	
	fun_ds_srch(ds_if_ars_card_data, "in_crd_no"  , "");//edt_card_num.value);  //카드번호
	fun_ds_srch(ds_if_ars_card_data, "in_crd_tp_cd"  , "2900");  //카드유형코드
	
	fun_ds_srch(ds_if_ars_card_data, "in_agrm_cd1"  , "100000");
	fun_ds_srch(ds_if_ars_card_data, "in_agrm_cd2"  , "200000");
	fun_ds_srch(ds_if_ars_card_data, "in_agrm_cd3"  , "300000");

	//★20130128 약관 내용 추가
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_3_YN") == 'Y'|| ds_out.getColumn(ds_out.rowposition,"AGRM_3_YN") == '') //서비스제공을 위한 제3자 제공(GSR,GSHS) 동의여부 = Y
	{
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd6","471000"); //GSR 약관코드 
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd7","481000"); //GSHS 약관코드
	}
	if(ds_out.getColumn(ds_out.rowposition,"AGRM_4_YN") == 'Y')  //참여의사 홍보 및 고객응대를 위한 3자 제공(GSR,GSHS,GSMBiz) 및 제휴신용카드 제3자 제공약관 (신한,KB국민, 현대, 삼성, IBK)
	{
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd8","472000"); //GSR 약관코드(마케팅) 
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd9","482000"); //GSHS 약관코드(마케팅)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd10","473000"); //GSR 약관코드(마케팅)
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd11","483000"); //GSHS 약관코드(마케팅)
		fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd12","461000"); //GSMbiz 약관코드(정보제공)
		
		//2014.06.18 약관 추가 (2014.07.01 새 약관 적용)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd13","451000"); //제휴신용카드 제3자 제공약관(신한카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd14","452000"); //제휴신용카드 제3자 제공약관(KB국민카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd15","453000"); //제휴신용카드 제3자 제공약관(현대카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd16","454000"); //제휴신용카드 제3자 제공약관(삼성카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd17","455000"); //제휴신용카드 제3자 제공약관(롯데카드)
		//fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd18","456000"); //제휴신용카드 제3자 제공약관(IBK기업은행
	}
	fun_ds_srch(ds_if_ars_card_data, "in_user_id"  , GetUserInfo("gUSR_ID"));
	
	
	//거래시작	
	var	strSvcID = "IF_WAS_064";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_ars_card_env:a INTERFACE_DATA=ds_if_ars_card_data:a"
	var	strOutDatasets = "ds_if_ars_card_common=DS_COMMON ds_if_ars_card_header=DS_HEADER ds_if_ars_card_column=DS_COLUMN ds_if_ars_card_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	 

}
		
//------------------------------------------------------------------------------------------
//콜백
//------------------------------------------------------------------------------------------		
function fn_callBack(svcid,strErrCode,strErrMsg)
{

	sta_sum1.text=ds_background2.getColumn(0,5);
	sta_sum2.text=ds_background2.getColumn(0,4);
	sta_sum3.text=ds_background2.getColumn(0,3);
	sta_sum4.text=ds_background2.getColumn(0,2);
	sta_sum5.text=ds_background2.getColumn(0,1);
	sta_sum6.text=ds_background2.getColumn(0,0);
	
	sta_row.text=ds_out.rowcount;

	//마스킹처리
	
	if(edt_tel2.value!=null){
	
		edt_tel2.value=maskPhone(edt_tel2.value);		
	}	
	
	if(edt_tel.value!=null){
	
		edt_tel.value=maskPhone(edt_tel.value);		
	
	}		
	
	//마스킹처리

	
	switch(svcid){
	
	case "U_ALL" : //모두반환
		
		btn_srch_onclick();
	
	break;
	
	case "R2" :
		
	
	break;
	
	case "SU1" : //다수건반환
	
		ds_update.clearData();
		ds_out_con.clearData();	
		setLP();	
		btn_srch_onclick();
		
	break;
	case "R1" : 
	    //trace(ds_out.saveXML());
	    
	    //2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 조회 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1002";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 조회";  // 수행업무 상세내용
		var sCalFun = "btn_srch_onclick()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_srch1); //조회조건										
		var sInqCnt = ds_out.rowcount;  // 조회건수
		var sInCustNo = "" ;//식별키
		
		ds_out.addColumn("CUST_NM_1","string");
		ds_out.addColumn("MBPH_NO_1","string");
		
		//trace("ds_out>>>>"+ds_out.saveXML());
		for(i=0 ; i < ds_out.rowcount ; i++){
			sInCustNo = sInCustNo + "CRD_NO=" + ds_out.getColumn(i,"CRD_NO") +  "|";
			
			//고객이름 마스킹 처리
			ds_out.setColumn(i,"CUST_NM_1",maskCustNm(ds_out.getColumn(i,"CUST_NM")));			
			
			//휴대폰			
			ds_out.setColumn(i,"MBPH_NO_1",maskPhNo(ds_out.getColumn(i,"MBPH_NO")));
			
			//전화번호			
			//ds_out.setColumn(i,"TEL_NO_1",maskPhNo(ds_out.getColumn(i,"TEL_NO")));
		}	
		
			
		
		
	
		/*
		trace("개인정보접촉이력--ARS카드등록 조회데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 조회 END==========="); 
		*/
		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
	    
	    
		ds_out_con.clearData();	
		setLP();	
	
	break;
	
	case "Pass" :
		
		cf_Alert("COME0002","비밀번호 저장실패");
	
	break;
	
	case "U4" :
	
		cmb_call_result2.value="";
		edt_lp_context.value="";
		
		ars_contact();
		ds_out.setColumn(ds_out.findRow("RES_REG_NO",edt_jumin.value),"CUR_RSLT_CDNM",cmb_call_result2.text);		
				
	break;
	
	case "R4" :
		
		Txa_MSG.value=ds_scrt_out.getColumn(0,"SMS_CTT");
		Txa_MSG_ontextchanged();
		
	break;
	
	case "D1" :
	
		if(cmb_card_sta.value == '1'){
			cf_Alert("COMI0004");
		}
		//삭제 카운트 함수 호출 20190305
		LP_del();
		
				
		 //2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 고객삭제 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1004";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 고객삭제";  // 수행업무 상세내용
		var sCalFun = "ars_info_delete()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_srch1); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_del_srch.getColumn(0,"SEQ_NO") ;//식별키
		
		/*
		trace("개인정보접촉이력--ARS카드등록 고객삭제데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 고객삭제 END==========="); 
		*/
		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
		
		setLP();
		
	
	break;
	
	case "U1" :
	
		btn_srch_onclick();				
	
	break;
		
	case "U6" :
	
		ds_out.filter("");
		alert(cmb_usr_base.text+" 에서 "+cmb_usr.text+" 로 이관합니다.");
		btn_srch_onclick();
		
	break;
	
	case "C1" :
	
		cf_Alert("COMI0008", "SMS"); 
	
		for (i=0;i<ds_out_sms.rowcount;i++){
		
			ds_out.setColumn(ds_out.findRow("SEQ_NO",ds_out_sms.getColumn(i,"SEQ_NO")), "SMS_TRMS_YN"          , "Y" ); 
			
		}
		
		Grid00.redraw();
		
		//2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 SMS발송 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 SMS발송";  // 수행업무 상세내용
		var sCalFun = "btn_sms_load_onclick()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_SMS); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = "" ;//식별키
		
		for(i = 0 ; i < ds_SMS.rowcount ; i++){
			sInCustNo = sInCustNo + "TR_PHONE=" +ds_SMS.getColumn(i, "TR_PHONE")+"|";
		}
		/*
		trace("개인정보접촉이력--ARS카드등록 SMS발송 데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 SMS발송 END==========="); 
		*/

		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
	
	break;
	
	case "IF_WAS_208" : 
	
	
		//2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 일반카드 등록 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 일반카드 등록";  // 수행업무 상세내용
		var sCalFun = "LP_start_onclick()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_if_ars_card_data); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_if_ars_card_data.getColumn(0,"in_crd_no") ;//식별키	
		/*
		trace("개인정보접촉이력--ARS카드등록 일반카드 등록데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 일반카드 등록 END==========="); 
		*/
		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
		
		
		if (ds_if_ars_card_record.getColumn("0","OT_RESPON_CODE")=="00000"){
			
			// 패스워드 인터페이스 호출
			//password_onclick();
			ars_card_end();
			lp_sms_send(); 
					
		}else{
		
			cf_Alert("COME0002",ds_if_ars_card_record.getColumn("0","OT_RES_MSG"));
			LP_error_end();
			
		}
	
	break;
	
	case "IF_WAS_064" :
	
		 //2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 제휴카드 등록 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 제휴카드 등록";  // 수행업무 상세내용
		var sCalFun = "partNewCustSave()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_if_ars_card_data); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_if_ars_card_data.getColumn(0,"in_crd_no") ;//식별키	
		/*
		trace("개인정보접촉이력--ARS카드등록 제휴카드 등록데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 제휴카드 등록 END==========="); 
		*/
		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
	
	
		if (ds_if_ars_card_record.getColumn("0","OT_RESPON_CODE")=="00000")
		{
			part_card_save(); //제휴카드 사용등록처리
		}
		else
		{
			cf_Alert("COME0002",ds_if_ars_card_record.getColumn("0","OT_RES_MSG"));
			LP_error_end();
		}
			
	break;
	
	case "IF_WAS_314" : 
		
		if (ds_if_custnmck_header.getColumn("0","OT_RESPON_CODE")=="00000")
		{	
			ds_if_custnmck_record.filter("RPBLC_DIV_CD != 99");
			if(IsNull(ds_if_custnmck_record.getColumn(0,"WORK_DTIME")))
			{
				alert("삭제된 카드입니다.");
				return;
			}
			else
			{
				partNewCustSave();      //제휴카드
			}
			
		}
		else
		{
			cf_Alert("COME0002",ds_if_custnmck_record.getColumn("0","OT_RES_MSG"));
			LP_error_end();
		}
		
	break;
	
	case "IF_WAS_317":

		 //2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 제휴카드 사용등록 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 제휴카드 사용등록";  // 수행업무 상세내용
		var sCalFun = "part_card_save()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_if_partcard_data); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_if_partcard_data.getColumn(0,"in_cust_no") ;//식별키
		/*
		trace("개인정보접촉이력--ARS카드등록 제휴카드 사용등록데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 제휴카드 사용등록 END==========="); 
		*/


		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
		
		if (ds_if_partcard_record.getColumn("0","OT_RESPON_CODE")=="00000")
		{
			ars_card_end();
			lp_sms_send();	
		}
		else
		{
		
			cf_Alert("COME0002",ds_if_partcard_record.getColumn("0","OT_RES_MSG"));
			LP_error_end();
			
		}
	break;
	
	case "IF_CSC_ITRT_018" : 
	
		cf_Alert("COME0002",ds_if_pw_init_record.getColumn("0","OT_RES_MSG"));
		ars_card_end();	
		
	break;
	
	case "End" : 
	
		//작업완료 여부 패스워드 전 상태로 변경
		//if(ds_if_pw_init_record.getColumn("0","OT_RESPON_CODE")!="00000"){
		
		//work_password();
		//}
		
		cf_Alert("COME0002","정상발급");
		btn_srch_onclick();				
		setLP();
	
	break;
	
	case "U2" : 
	
		btn_srch_onclick();	
		setLP();
			
	break;
	
	case "U3" : 
		//할당에서 -> 작업중으로 변경후 처리
		ds_out.setColumn(ds_out.rowposition,"JOB_PRGR_ST_CDNM","작업중");
		ds_out.setColumn(ds_out.rowposition,"JOB_PRGR_ST_CD","2");
			
	break;
	
	case "SS2" : 	//신규등록
		ds_out.setColumn(ds_out.rowposition,"CUST_NM",edt_name.value);
		ds_out.setColumn(ds_out.rowposition,"CUIK_BDAY",edt_cuik_bday.value);
		ds_out.setColumn(ds_out.rowposition,"SEX_CD",cmb_sex_cd.value);
		
		
		//2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 고객정보수정 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 고객정보수정";  // 수행업무 상세내용
		var sCalFun = "cust_nm_upd()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_master_name_in); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_master_name_in.getColumn(0,"SEQ_NO") ;//식별키
		/*
		trace("개인정보접촉이력--ARS카드등록 고객정보수정데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 고객정보수정 END==========="); 
		*/


		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
		
		
		
		
		//alert("정상적으로 변경되었습니다.");
		//return;
		btn_ars_input_onclick();
			
	break;
	
	
	case "SS3" : 	//★재발급등록
		ds_out.setColumn(ds_out.rowposition,"CUST_NM",edt_name.value);
		ds_out.setColumn(ds_out.rowposition,"CUIK_BDAY",edt_cuik_bday.value);
		ds_out.setColumn(ds_out.rowposition,"SEX_CD",cmb_sex_cd.value);
		
		//2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 고객정보수정(재발급) Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1003";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 고객정보수정(재발급)";  // 수행업무 상세내용
		var sCalFun = "cust_nm_upd_re()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_master_name_in); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_master_name_in.getColumn(0,"SEQ_NO") ;//식별키
		/*
		trace("개인정보접촉이력--ARS카드등록 고객정보수정(재발급)데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 고객정보수정(재발급) END==========="); 
		*/
		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
		
		
		if(cmb_sex_cd.value == "1"){
			ds_out.setColumn(ds_out.rowposition,"SEX_CDNM","남성");
		}else{
			ds_out.setColumn(ds_out.rowposition,"SEX_CDNM","여성");
		}
		Btn_cust_srch();	//고객정보조회
	break;
	
	
	case "IF_WAS_210" : 	//★재발급등록
		
		//2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 고객정보조회 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1002";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 고객정보조회";  // 수행업무 상세내용
		var sCalFun = "Btn_cust_srch()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_if_cust_data); //조회조건										
		var sInqCnt = ds_if_cust_record.rowcount;  // 조회건수
		
		var sInCustNo = "PHN="+getTrim(edt_tel2.value).split("-") ;//식별키

		
		/*
		trace("개인정보접촉이력--ARS카드등록 고객정보조회 데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 고객정보조회 END==========="); 
		*/
		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
	
		if(ds_if_cust_common.getColumn(ds_if_cust_common.rowposition,"HTTP_RET_CODE") == '-1'){
				cf_Alert("COME0035", ds_if_cust_common.getColumn(ds_if_cust_common.rowposition,"HTTP_RET_MSG"));
			}else{
				if(ds_if_cust_header.getColumn(ds_if_cust_header.rowposition,"OT_RESPON_CODE") == '00000'){
					if(ds_if_cust_record.rowcount < 1){
						alert("고객정보가 존재하지않습니다.");
					}else{
						if(ds_if_cust_record.getColumn(0,"OT_INTG_CUST_NO") != ""){
							func_cardInsert(ds_if_cust_record.getColumn(0,"OT_CUST_NO"), edt_card_num.value);
						}else{
							alert("통합고객번호가 존재하지 않습니다.");
						}
					}
				}else{
					cf_Alert("COME0035", ds_if_cust_header.getColumn(ds_if_cust_header.rowposition,"OT_RES_MSG"));
				}
			}	
	break;
	
	case "IF_WAS_127" : 	//★재발급등록 후 처리
	
		//2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 재발급 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1003";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 재발급";  // 수행업무 상세내용
		var sCalFun = "func_cardInsert()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_if_rsv_std_data); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_if_rsv_std_data.getColumn(0,"in_cust_no") ;//식별키
		/*
		trace("개인정보접촉이력--ARS카드등록 재발급 데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 재발급 END==========="); 		
		*/

		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
	
	
		if(ds_if_rsv_std_common.getColumn(ds_if_rsv_std_common.rowposition,"HTTP_RET_CODE") == '-1'){
				cf_Alert("COME0035", ds_if_rsv_std_common.getColumn(ds_if_rsv_std_common.rowposition,"HTTP_RET_MSG"));
		}else{
			if(ds_if_rsv_std_header.getColumn(ds_if_rsv_std_header.rowposition,"OT_RESPON_CODE") == '00000'){
				//정상등록 완료
				ars_card_end_re();
				lp_sms_send();
		
			}else{
				cf_Alert("COME0002",ds_if_rsv_std_header.getColumn("0","OT_RES_MSG"));
				//LP_error_end_re();
			}
		}
	break;
	
	/*case "IF_WAS_314":
		
		if(ds_if_custnmck_record.getColumn(0,"CUST_NM") == edt_name.value)
		{
			cust_nm_upd();	//고객명 업데이트
		}
		else
		{
			alert("고객명이 잘못입력되었습니다.");
			//edt_name.setFocus();
		}
	break;*/
	
	
	case "Error" : 
	
		//cf_Alert("COME0002",ds_if_ars_card_record.getColumn("0","OT_RES_MSG"));
	    
	    //2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 실패 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 실패";  // 수행업무 상세내용
		var sCalFun = "LP_error_end()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_ars_card_pass); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_ars_card_pass.getColumn(0,"SEQ_NO") ;//식별키		
		/*
		trace("개인정보접촉이력--ARS카드등록 실패 데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 실패 END==========="); 
		*/

		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
	
	
		btn_srch_onclick();	
		setLP();		

	break;
	
	case "IF_CSC_ITRT_060_M" : 
	
	//alert("060  "+ arrLPS[i]);
	
		arrLPS_result[i] = ds_if_ars_card_record.getColumn("0","OT_RES_MSG") + "! 카드번호 : "+ ds_if_ars_card_data.getColumn("0","in_crd_no");
	
		if (ds_if_ars_card_record.getColumn("0","OT_RESPON_CODE")=="00000"){
				
			// 패스워드 인터페이스 호출
			ars_card_end_M();
			
		
		}else{
			//cf_Alert("COME0002",ds_if_ars_card_record.getColumn("0","OT_RES_MSG"));	
			LP_error_end_M();
		}		
	
	break;
	
	case "IF_CSC_ITRT_018_M" : 

		arrLPS_result[i] = ds_if_pw_init_record.getColumn("0","OT_RES_MSG") + "! 주민번호 : "+ ds_if_pw_init_data.getColumn(0,"in_req_data");
	
	//alert("018  "+ arrLPS[i]);		
		
		work_password_M();	
			
	break;	
	
	case "Error_M" : 
			
	//return;	
		
	break;
		
	case "End_M" : 
		
	//return;	
		
	break;	
	
	case "Pass_M" : 
	
		ars_card_end_M();	
			
	break;	
	
	case "S1" : 
		
		setLP();
	
			
	break;	
	/*
	case "DP" : 
	
	if(strErrMsg=="SUCCESS"){
	LP_no_stat(mi_crd_no);
	}else{
	alert("고객정보 삭제 오류발생 : 관리자에게 문의하세요.");
	}
	
	break;	
	*/
	case "IF_CSC_ITRT_063" :	
					
		if(ds_if_card_st_change_common.getColumn(0,"HTTP_RET_CODE")=="0"){
				
				if(ds_if_card_st_change_record.getColumn(0,"OT_RESPON_CODE")=="00000"){
				
					ars_info_delete();
					
					if(strErrMsg=="SUCCESS"){
						if(cmb_card_sta.value=="02"){
							alert("고객정보 삭제 및 카드 말소 처리되었습니다.");
						}else if(cmb_card_sta.value=="03"){
							alert("고객정보 삭제 및 카드 정지 처리되었습니다.");
						}
					}else{
						alert("고객정보 삭제 오류발생 : 관리자에게 문의하세요.");
					}
						
				}else{
		
				alert(ds_if_card_st_change_record.getColumn(0,"OT_RES_MSG"));						
				
				}			
		}else{
			cf_Alert("COME0035",ds_if_card_st_change_common.getColumn(0,"HTTP_RET_MSG"));
		}
		
		 //2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 카드정보변경 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1003";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 카드정보변경";  // 수행업무 상세내용
		var sCalFun = "LP_no_stat()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_if_card_st_change_data); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = ds_if_card_st_change_data.getColumn(0,"in_crd_no") ;//식별키
		/*
		trace("개인정보접촉이력--ARS카드등록 카드정보변경 데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 카드정보변경 END==========="); 
		*/

		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
				
		
		cmb_card_sta.value=1; //카드상태변경 콤보 초기값으로 세팅
		
	break;	
	
	case "Auto_sms" :
		
		 //2015.08.15 개인정보접촉이력
		//trace("=============개인정보접촉이력  ARS카드등록 SMS발송 Start===========");
		
		var sAccNo = "LPS010"; //개인정보접촉이력 일련번호
		var sPerTCd = "PT1001";  // 수행업무 코드
		var sPerTDt = "ICCS_CSC ARS카드등록 SMS발송";  // 수행업무 상세내용
		var sCalFun = "lp_sms_send()";  // 호출함수명 
		var sInqCon = gfn_getStringFromDataset(ds_SMS); //조회조건										
		var sInqCnt = 1;  // 조회건수
		var sInCustNo = "TR_PHONE="+ds_SMS.getColumn(0,"TR_PHONE") ;//식별키
		/*
		trace("개인정보접촉이력--ARS카드등록 SMS발송데이터 "+"    "+sAccNo 
														  +"    "+sPerTCd
														  +"    "+sPerTDt
														  +"    "+sCalFun
														  +"    "+sInqCon
														  +"    "+sInqCnt); 
										  
		trace("=============개인정보접촉이력 ARS카드등록 SMS발송 END==========="); 
		*/

		//fn_Privcnthis(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt);
		fn_Privcnthis_info(sAccNo, sPerTCd, sPerTDt, sCalFun, sInqCon, sInqCnt,sInCustNo);
	
	break;
	
	
	case "SS7":
	
	if(svcid =="SS7"){
		alert(ds_if_point_info_record.getColumn(0,"CUST_NM"));
	}
	break;
				
			
	default : break;		
		
	
	}
}

//
//LP즉시 삭제 카운트 이력 저장 
//월말 개인정보 삭제 배치 처리시 포함 하여 삭제 카운트 
function LP_del()
{
		
		ds_if_ars_del_data.clearData();
		
		var dat = getToday();
		fun_ds_srch(ds_if_ars_del_data, "I_WORK_DAY",  dat);	
		
		//trace("=====>"+ds_if_ars_del_data.saveXML());		
		
		var	strSvcID = "Ars_del";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = "PROCEDURE_0_IDATA=ds_if_ars_del_data:a"; 
		var	strOutDatasets = "";
		var	strArgument = "PROCEDURE_0_ID=LPS010.Prc_LP_MASTER_HIST_DEL";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;		
		
	   cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
				
}



//------------------------------------------------------------------------------------------
// 패스워드 진행전 상태 저장
//------------------------------------------------------------------------------------------

function work_password(){


	if (ds_if_ars_card_record.getColumn("0","OT_RESPON_CODE")=="00000" && ds_if_pw_init_record.getColumn("0","OT_RESPON_CODE")=="00000"){
		
	}else{
		
		ds_ars_card_end.clearData();
					
		//fun_ds_srch(ds_ars_card_pass, "RES_REG_NO",ds_out.getColumn(ds_out.rowposition,"RES_REG_NO"));
		fun_ds_srch(ds_ars_card_pass, "SEQ_NO",ds_out.getColumn(ds_out.rowposition,"SEQ_NO"));
		fun_ds_srch(ds_ars_card_pass, "JOB_ID", userID);
		fun_ds_srch(ds_ars_card_pass, "JOB_CPLT_YN", "P");					
		fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_MSG", "비밀번호저장실패");	
	
		//ds_out.clearData();			    
			    
		var	strSvcID = "Pass";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = "UPDATE_0_IDATA=ds_ars_card_pass:a"; 
		var	strOutDatasets = "";
		var	strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_pass";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;

		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
				
	}
}

//------------------------------------------------------------------------------------------
// 패스워드 진행전 상태 저장
//------------------------------------------------------------------------------------------

function work_password_M(){


	if (ds_if_pw_init_record.getColumn("0","OT_RESPON_CODE")=="00000"){
		
	}else{
		
		ds_ars_card_end.clearData();
					
		//fun_ds_srch(ds_ars_card_pass, "RES_REG_NO",ds_out.getColumn(ds_out.rowposition,"RES_REG_NO"));
		fun_ds_srch(ds_ars_card_pass, "SEQ_NO",ds_out.getColumn(ds_out.rowposition,"SEQ_NO"));
		fun_ds_srch(ds_ars_card_pass, "JOB_ID", userID);
		fun_ds_srch(ds_ars_card_pass, "JOB_CPLT_YN", "P");					
		fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_MSG", "비밀번호저장실패");	
	
		//ds_out.clearData();			    
			    
		var	strSvcID = "Pass_M";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = "UPDATE_0_IDATA=ds_ars_card_pass:a"; 
		var	strOutDatasets = "";
		var	strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_pass";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;

		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
				
	}
}

//------------------------------------------------------------------------------------------
// 실명확인 엔터처리 -- 사용안함
//------------------------------------------------------------------------------------------
function edt_name_onkeyup(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == "13" ) btn_inter00_onclick();		
}


//------------------------------------------------------------------------------------------
// 캡티브 에러결과 저장 - 신규등록용
//------------------------------------------------------------------------------------------
function LP_error_end(){

	ds_ars_card_pass.clearData();
					
	fun_ds_srch(ds_ars_card_pass, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO"));
	fun_ds_srch(ds_ars_card_pass, "JOB_ID", userID);
	fun_ds_srch(ds_ars_card_pass, "JOB_CPLT_YN", "N");
	
	//ds_out.clearData();
	if(ds_out.getColumn(ds_out.rowposition,"BIZ_CARD_YN") == "Y")
	{
		fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_MSG", ds_if_partcard_record.getColumn(0,"OT_RES_MSG"));	
		fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_CD", ds_if_partcard_record.getColumn(0,"OT_RESPON_CODE"));
	}
	else
	{
		fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_MSG", ds_if_ars_card_record.getColumn(0,"OT_RES_MSG"));	
		fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_CD", ds_if_ars_card_record.getColumn(0,"OT_RESPON_CODE"));
	}
		    
	var	strSvcID = "Error";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = ""; 
	var	strOutDatasets = "";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	if( Today() == ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8)){
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_pass:a";
		strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_error";
	}else{
		strInDatasets = "UPDATE_0_IDATA=ds_ars_card_pass:a UPDATE_1_IDATA=ds_ars_card_pass:a";
		strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_error UPDATE_1_ID=LPS010.Set_LPS_UPDATE_error_MIG";
	}
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
}


//------------------------------------------------------------------------------------------
// ★캡티브 에러결과 저장 - 재발급용
//------------------------------------------------------------------------------------------
function LP_error_end_re(){
		
	ds_ars_card_pass.clearData();
					
	fun_ds_srch(ds_ars_card_pass, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO"));
	fun_ds_srch(ds_ars_card_pass, "JOB_ID", userID);
	fun_ds_srch(ds_ars_card_pass, "JOB_CPLT_YN", "N");					
	fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_MSG", ds_if_rsv_std_header.getColumn(0,"OT_RES_MSG"));	
	fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_CD", ds_if_rsv_std_header.getColumn(0,"OT_RESPON_CODE"));	
	
	//alert(ds_out.getColumn(ds_out.rowposition,"SEQ_NO") + " === " + ds_if_rsv_std_header.getColumn(0,"OT_RESPON_CODE"));
	//ds_out.clearData();			    
		    
	var	strSvcID = "Error";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "UPDATE_0_IDATA=ds_ars_card_pass:a"; 
	var	strOutDatasets = "";
	var	strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_error";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);


}


//------------------------------------------------------------------------------------------
// 캡티브 에러결과 저장(전송중)
//------------------------------------------------------------------------------------------
function LP_error_end_M(){
		
	ds_ars_card_pass.clearData();
							
	fun_ds_srch(ds_ars_card_pass, "RES_REG_NO", ds_out.getColumn(ds_out.rowposition,"RES_REG_NO"));
	fun_ds_srch(ds_ars_card_pass, "JOB_ID", userID);
	fun_ds_srch(ds_ars_card_pass, "JOB_CPLT_YN", "N");					
	fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_MSG", ds_if_ars_card_record.getColumn(0,"OT_RES_MSG"));	
	fun_ds_srch(ds_ars_card_pass, "CATIVE_RSLT_CD", ds_if_ars_card_record.getColumn(0,"OT_RESPON_CODE"));	
	
	//ds_out.clearData();			    
			    
	var	strSvcID = "Error_M";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "UPDATE_0_IDATA=ds_ars_card_pass:a"; 
	var	strOutDatasets = "";
	var	strArgument = "UPDATE_0_ID=LPS010.Set_LPS_UPDATE_error";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);


}


//------------------------------------------------------------------------------------------
// 저장(IF) 작업상태체크
//------------------------------------------------------------------------------------------

function btn_up_save_onclick(obj:Button,  e:ClickEventInfo)
{
	Grid00.setFocus();
	//ARS에서 카드번호에 '#'인입되는건 때문에 잠시 추가2013.03.12
	var to_number = toNumber(edt_card_num.value,0);
	if(to_number==0){
		alert("카드번호를 확인 해주세요.");return;
	}
	
	if(ds_out.rowcount=="0"){
		cf_Alert("COME0002","등록할 데이터가 없습니다.");
		return;
	}
	
	if(edt_seq.value == "" || edt_seq.value == null){
		
		cf_Alert("LPSE0001");
		return;
	}
	
	if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="0" || ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="4") {
		cf_Alert("COME0002","등록된 카드 / 미할당 작업 입니다.");
		return;
	}
	
	if(getTrim(edt_name.value) == "" || getTrim(edt_name.value) == null){
		alert("고객성명을 입력해주세요");
		return;
	}
	
	if(getTrim(edt_cuik_bday.value) == "" || getTrim(edt_cuik_bday.value) == null){
		alert("생년월일을 입력해주세요");
		return;
	}
	
	if(getTrim(cmb_sex_cd.value) == "" || getTrim(cmb_sex_cd.value) == null){
		alert("성별을 입력해주세요");
		return;
	}
	
	
	
	//else if(ds_out.getColumn(ds_out.rowposition,"CUST_NM")=="" || ds_out.getColumn(ds_out.rowposition,"CUST_NM")==null){
	//	
	//	cf_Alert("COME0002","고객명이 존재하지 않습니다.");
	//	return;
	//}
	
	if (!cf_Confirm("COMI0012","카드등록"))	return;
	
	//작업 완료 여부 확인 
	if(ds_out.getColumn(ds_out.rowposition,'JOB_CPLT_YN')=='N'){
		
		cust_nm_upd();	//고객명 업데이트		
		
	}else{
	
		if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="0" || ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="4") {
		
			cf_Alert("COME0002","등록된 카드 / 미할당 작업 입니다.");
			return;
		
		}
		//else if(ds_out.getColumn(ds_out.rowposition,"CUST_NM")=="" || ds_out.getColumn(ds_out.rowposition,"CUST_NM")==null){
		//
		//	cf_Alert("COME0002","고객명이 필요합니다.");
		//	return;
		//
		//}
//		if (!cf_Confirm("COMI0012","비밀번호 등록"))	return;
		
//	password_onclick();
	}
	//return;
}

//제휴사 수신일시 
function fnCustNmCk()
{
	ds_if_custnmck_env.clearData();
	ds_if_custnmck_data.clearData();
	ds_if_custnmck_common.clearData();
	ds_if_custnmck_header.clearData();
	ds_if_custnmck_column.clearData();
	ds_if_custnmck_record.clearData();	

	fun_ds_srch(ds_if_custnmck_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_custnmck_env, "REQ_SERVICE_METHOD", 	"crTregcrdSelC01.do"); 
	fun_ds_srch(ds_if_custnmck_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_custnmck_env, "RES_HEADER_SECTION", 	"STP_CR_TREGCRD_SEL_C01_Rsp"); //xml상위 헤더항목
	fun_ds_srch(ds_if_custnmck_env, "RES_COLUMN_SECTION", 	""); 
	fun_ds_srch(ds_if_custnmck_env, "RES_RECORD_SECTION", 	"OT_OUT_CURSOR"); 

	fun_ds_srch(ds_if_custnmck_data,"req_chnl_code","610050");
	fun_ds_srch(ds_if_custnmck_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_custnmck_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_custnmck_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
	fun_ds_srch(ds_if_custnmck_data,"in_crd_no",edt_card_num.value);
	//fun_ds_srch(ds_if_ars_card_data,"in_bday",edt_cuik_bday.value);	//생년월일
	//fun_ds_srch(ds_if_ars_card_data,"in_sex_cd",cmb_sex_cd.value);	//성별
	
	fun_ds_srch(ds_if_custnmck_data,"in_chnl_cd","610050");    //채널코드		
	
	var	strSvcID = "IF_WAS_314";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_custnmck_env:a INTERFACE_DATA=ds_if_custnmck_data:a";
	var	strOutDatasets = "ds_if_custnmck_common=DS_COMMON ds_if_custnmck_header=DS_HEADER ds_if_custnmck_column=DS_COLUMN ds_if_custnmck_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
}

/// 제휴카드 사용 등록 
function part_card_save()
{
	ds_if_partcard_env.clearData();
	ds_if_partcard_data.clearData();
	ds_if_partcard_common.clearData();
	ds_if_partcard_header.clearData();
	ds_if_partcard_column.clearData();
	ds_if_partcard_record.clearData();	
	
	fun_ds_srch(ds_if_partcard_env, "IF_KIND", 			"WAS");
	fun_ds_srch(ds_if_partcard_env, "REQ_SERVICE_METHOD", 	"crTregcrdInsC01.do"); 
	fun_ds_srch(ds_if_partcard_env, "REQ_SERVICE_ID", 		"");
	fun_ds_srch(ds_if_partcard_env, "RES_HEADER_SECTION", 	""); //xml상위 헤더항목
	fun_ds_srch(ds_if_partcard_env, "RES_COLUMN_SECTION", 	""); 
	fun_ds_srch(ds_if_partcard_env, "RES_RECORD_SECTION", 	"STP_CR_TREGCRD_INS_C01_Rsp"); 

	fun_ds_srch(ds_if_partcard_data,"req_chnl_code","610050"); //gsc 610050   gsc ars 610060
	fun_ds_srch(ds_if_partcard_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
	fun_ds_srch(ds_if_partcard_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
	fun_ds_srch(ds_if_partcard_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
	fun_ds_srch(ds_if_partcard_data,"in_crd_no",edt_card_num.value);				//카드번호
	fun_ds_srch(ds_if_partcard_data,"in_cust_no",ds_if_ars_card_record.getColumn(0,"IN_CUST_NO"));	   						    //고객번호
	fun_ds_srch(ds_if_partcard_data,"in_user_id",getTrim(GetUserInfo("gUSR_ID")));	//입력사용자ID
	fun_ds_srch(ds_if_partcard_data,"in_work_dtime",ds_if_custnmck_record.getColumn(0,"WORK_DTIME"));	//제휴사 수신일시 : 콜센터 필수 , ARS NULL
	
	fun_ds_srch(ds_if_partcard_data,"in_chnl_cd","610050");    //채널코드		
	
	var	strSvcID = "IF_WAS_317";
	var	strURL = SVC_IF_URL;	
	var	strInDatasets = "INTERFACE_ENV=ds_if_partcard_env:a INTERFACE_DATA=ds_if_partcard_data:a";
	var	strOutDatasets = "ds_if_partcard_common=DS_COMMON ds_if_partcard_header=DS_HEADER ds_if_partcard_column=DS_COLUMN ds_if_partcard_record=DS_RECORD";
	var	strArgument = "";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
}

//------------------------------------------------------------------------------------------
// 재전송 -미사용 (2009년도에 임시사용)
//------------------------------------------------------------------------------------------

function btn_resend_onclick(obj:Button,  e:ClickEventInfo)
{

	if(ds_out.findRow("CHK","1")=="-1"){
	
		cf_Alert("COME0002","선택된 데이터가 없습니다.");
		return;
		
	}
	
	
	if (!cf_Confirm("COMI0012","재전송"))	return;
		
	
	for(i=0 ; ds_out.rowcount > i ; i++){
		
		arrLPS[i] = i;
		arrLPS_result[i] = "";
		//alert("start  "+ arrLPS[i]);
		
		if(ds_out.getColumn(i,"CHK")=="1"){
			ds_out.selectRow(i);
			
			
			//고객IF
			if(ds_out.getColumn(ds_out.rowposition,'JOB_CPLT_YN')=='N'){
	
				var objDate = new Date();
				var currentYear = objDate.getFullYear().toString();
				var currentMonth  = objDate.getMonth()+1;
				var currentDay = objDate.getDate();
				
				if (currentMonth<10){
				
					currentMonth="0"+currentMonth;
					
				}	
				
				if (currentDay<10){
				
					currentDay="0"+currentDay;
					
				}	
				
				var currentHour = objDate.getHours();
				
				if (currentHour<10){
				
					currentHour="0"+currentHour;
					
				}	
				
				var currentMin = objDate.getMinutes();
				
				if (currentMin<10){
				
					currentMin="0"+currentMin;
					
				}	
				
				var currentSec = objDate.getSeconds();
				
				if (currentSec<10){
				
					currentSec="0"+currentSec;
					
				}
				
				
				var nextNum = currentYear+currentMonth+currentDay+currentHour+currentMin+currentSec;
				var agrmNum = currentYear+currentMonth+currentDay;
					

					
				ds_if_ars_card_env.clearData();
				ds_if_ars_card_data.clearData();
				ds_if_ars_card_common.clearData();
				ds_if_ars_card_header.clearData();
				ds_if_ars_card_column.clearData();
				ds_if_ars_card_record.clearData();	
				
					
			
				fun_ds_srch(ds_if_ars_card_env, "IF_KIND", 			"WAS");
				fun_ds_srch(ds_if_ars_card_env, "REQ_SERVICE_METHOD", 	"arsCmCustInsC02.do"); 
				fun_ds_srch(ds_if_ars_card_env, "REQ_SERVICE_ID", 		"");
				fun_ds_srch(ds_if_ars_card_env, "RES_HEADER_SECTION", 	""); //xml상위 헤더항목
				fun_ds_srch(ds_if_ars_card_env, "RES_COLUMN_SECTION", 	""); 
				fun_ds_srch(ds_if_ars_card_env, "RES_RECORD_SECTION", 	"STP_ARS_CM_CUST_INS_C02_Rsp"); 

				fun_ds_srch(ds_if_ars_card_data,"req_chnl_code","610050");
				fun_ds_srch(ds_if_ars_card_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
				fun_ds_srch(ds_if_ars_card_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
				fun_ds_srch(ds_if_ars_card_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
				
				fun_ds_srch(ds_if_ars_card_data,"in_nxtt_seq",nextNum); //임시일련번호
				fun_ds_srch(ds_if_ars_card_data,"in_crd_no",ds_out.getColumn(ds_out.rowposition,"CRD_NO"));

				var NumJ = ds_out.getColumn(ds_out.rowposition,"RES_REG_NO");		
					
				
				//★20120625 주민번호 수집금지			
				//fun_ds_srch(ds_if_ars_card_data,"in_head_rsno",NumJ.substr(0,6));
				//fun_ds_srch(ds_if_ars_card_data,"in_tail_rsno",NumJ.substr(6,13));
				fun_ds_srch(ds_if_ars_card_data,"in_head_rsno","");
				fun_ds_srch(ds_if_ars_card_data,"in_tail_rsno","");
				
				fun_ds_srch(ds_if_ars_card_data,"in_bday",edt_in_cuik_bday.value);	//생년월일
				fun_ds_srch(ds_if_ars_card_data,"in_sex_cd",cmb_in_sex_cd.value);	//성별
				
	
				fun_ds_srch(ds_if_ars_card_data,"in_rlnm_authn_dtime",nextNum); //실명인증일시
				fun_ds_srch(ds_if_ars_card_data,"in_join_chnl_cd","610050"); //가입채널코드
				fun_ds_srch(ds_if_ars_card_data,"in_inpt_user_id",getTrim(GetUserInfo("gUSR_ID")));
				fun_ds_srch(ds_if_ars_card_data,"in_agrm_date",agrmNum);
				fun_ds_srch(ds_if_ars_card_data,"in_sms_rcv_yn",ds_out.getColumn(ds_out.rowposition,"SMS_AGRM_YN"));
				fun_ds_srch(ds_if_ars_card_data,"in_agrm_cd4",ds_out.getColumn(ds_out.rowposition,"INFO_CONJ_AGRM_YN"));
				fun_ds_srch(ds_if_ars_card_data,"in_sign_yn",ds_out.getColumn(ds_out.rowposition,"STPL_AGRM_YN"));
					
				var cvcvalue = ds_out.getColumn(ds_out.rowposition,"CRD_NO");
				var cvcData = cvcCheck(cvcvalue);		
					
				fun_ds_srch(ds_if_ars_card_data,"in_cvc_no",cvcData);
				fun_ds_srch(ds_if_ars_card_data,"in_cust_nm",ds_out.getColumn(ds_out.rowposition,"CUST_NM"));
					
				//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_FROM","20091001");
				//fun_ds_srch(ds_if_pw_init_data,"IN_JOING_ENFC_DTIME_TO","20101201");		
					
				fun_ds_srch(ds_if_ars_card_data,"in_use_pw",ds_out.getColumn(ds_out.rowposition,"CUST_PW"));
				fun_ds_srch(ds_if_ars_card_data,"in_inpt_ip",getTrim(GetUserInfo("gLGIN_IP")));	
						
				//★20120625 주민번호 수집금지	
				fun_ds_srch(ds_if_ars_card_data,"in_authn_sbjt_cd",cmb_authn_sbjt_cd.value); //인증_주체_코드
				fun_ds_srch(ds_if_ars_card_data,"in_com_co_div_cd",cmb_com_co_div_cd.value); //통신회사_구분_코드
				fun_ds_srch(ds_if_ars_card_data,"in_sms_authn_dtime",ds_out.getColumn(ds_out.rowposition,"SMS_AUTHN_DTM")); //인증일시
							
				var	strSvcID = "IF_CSC_ITRT_060_M";
				var	strURL = SVC_IF_URL;	
				var	strInDatasets = "INTERFACE_ENV=ds_if_ars_card_env:a INTERFACE_DATA=ds_if_ars_card_data:a";
				var	strOutDatasets = "ds_if_ars_card_common=DS_COMMON ds_if_ars_card_header=DS_HEADER ds_if_ars_card_column=DS_COLUMN ds_if_ars_card_record=DS_RECORD";
				var	strArgument = "";
				var strCallbackFunc = "fn_callBack";
				var strProcessBar = true;
					
				cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar,false);
		
			}
			
			//비밀번호IF
			else if(ds_out.getColumn(ds_out.rowposition,'JOB_CPLT_YN')=='P'){
		
				ds_if_pw_init_env.clearData();
				ds_if_pw_init_data.clearData();
				ds_if_pw_init_common.clearData();
				ds_if_pw_init_header.clearData();
				ds_if_pw_init_column.clearData();
				ds_if_pw_init_record.clearData();	
			
				
				//IF_BNS260_01 환경설정
				fun_ds_srch(ds_if_pw_init_env, "IF_KIND", 			"WAS");
				fun_ds_srch(ds_if_pw_init_env, "REQ_SERVICE_METHOD", 	"crCrdpwUpdC01.do"); //공통이 어디까지?
				fun_ds_srch(ds_if_pw_init_env, "REQ_SERVICE_ID", 		"");
				fun_ds_srch(ds_if_pw_init_env, "RES_HEADER_SECTION", 	""); //xml상위 헤더항목
				fun_ds_srch(ds_if_pw_init_env, "RES_COLUMN_SECTION", 	""); 
				fun_ds_srch(ds_if_pw_init_env, "RES_RECORD_SECTION", 	"STP_CR_CRDPW_UPD_C01_Rsp"); 

				fun_ds_srch(ds_if_pw_init_data,"req_chnl_code","610050");
				fun_ds_srch(ds_if_pw_init_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
				fun_ds_srch(ds_if_pw_init_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
				fun_ds_srch(ds_if_pw_init_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
				
				fun_ds_srch(ds_if_pw_init_data,"in_req_gbn","U");  // I 초기화
				fun_ds_srch(ds_if_pw_init_data,"in_req_flag","2"); // 1 고객번호 2 주민번호 3 카드번호
				fun_ds_srch(ds_if_pw_init_data,"in_req_data",ds_out.getColumn(ds_out.rowposition,"RES_REG_NO"));
				fun_ds_srch(ds_if_pw_init_data,"in_user_id",getTrim(GetUserInfo("gUSR_ID")));
				fun_ds_srch(ds_if_pw_init_data,"io_use_pw",ds_out.getColumn(ds_out.rowposition,"CUST_PW"));
				
				var	strSvcID = "IF_CSC_ITRT_018_M";
				var	strURL = SVC_IF_URL;	
				var	strInDatasets = "INTERFACE_ENV=ds_if_pw_init_env:a INTERFACE_DATA=ds_if_pw_init_data:a";
				var	strOutDatasets = "ds_if_pw_init_common=DS_COMMON ds_if_pw_init_header=DS_HEADER ds_if_pw_init_column=DS_COLUMN ds_if_pw_init_record=DS_RECORD";
				var	strArgument = "";
				var strCallbackFunc = "fn_callBack";
				var strProcessBar = true;
				
				cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar,false);	
								
			}
			
		}
			if(ds_out.getColumn(i,"CHK")=="1"){
			
				if(ds_out.rowcount > i+1){
					
					arrLPS_result_msg = arrLPS_result_msg+"선택 데이터 재전송결과 : "+arrLPS_result[i] + "\n";		
					arrLPS[i] = "";
					arrLPS_result[i] = "";
				}
			}
		}
		
		//형식경고..
		alert(arrLPS_result_msg);		
		
		arrLPS_result_msg="";
	}

	


function Button00_onclick(obj:Button,  e:ClickEventInfo)
{


var URL = "";
	//system.execShell("wmplayer");
	//try{
	//objPlayer.install();
		/*
		trace("objPlayer.codebase ::" + objPlayer.codebase);			
		objPlayer.codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,5,715";
		objPlayer.FileName="c://test.wav";		
		objPlayer.AutoStart="0";		
		*/
		//AXMSIE.codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=6,4,5,715";
			
	//var file=edt_name.value;

	var file=ds_out.getColumn(ds_out.rowposition,"FILE_NM");
	var path=ds_out.getColumn(ds_out.rowposition,"FILE_PATH");
	
	//alert(path+file);
	//return;
	//trace(path+file); mqadmin / gs!call2008
	
		//URL = "\\192.168.16.106/voice/record/20110202205947_100_100.wav"; //NAS			
		//system.execShell("");
	//	URL += "FilePath=" + fp + "&FileName=" + fn;
		//system.play("\\\\192.168.16.106\\voice\\record\\"+file);	
		
		
		//system.play("\\\\"+GetConfig("LP_NAS")+"\\voice\\record\\"+file);	
		
		//alert("\\\\"+GetConfig("LP_NAS")+"\\file\\record\\"+file);
		
		//system.play("\\\\"+GetConfig("LP_NAS")+"\\file\\record\\"+file);	//2012.05.09일 NAS교체 이후
		
		//AXMSIE00.Navigate2(URL,"", "_self","","");	
	
	

	ds_get_param.clearData();
	ds_set_param.clearData();
	

	fun_ds_srch(ds_get_param, "FILE_NM", 			file);
	fun_ds_srch(ds_get_param, "FILE_PATH", 	path);
	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};
	PopupDialog("COM014","COM::COM014.xfdl", -1, -1, 571, 345, false, -1, arrParam, true, false, true, false);			
}

function Cmb_SCRT_COMBO_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{

	//var ds_obj = eval(Cmb_SCRT_COMBO.innerdataset);
	var ds_obj = this.all[Cmb_SCRT_COMBO.innerdataset];
	Txa_MSG.value = ds_obj.getColumn(Cmb_SCRT_COMBO.index, "CODE1");	
	Txa_MSG_ontextchanged();	
	
}

function lp_sms_send(){

	
	ds_get_param.clearData();
	ds_set_param.clearData();
	ds_SMS.clearData();
	ds_SMS_copy1.clearData();
	ds_SMS_copy2.clearData();
		
	ds_get_param.setColumn(0,"TR_PHONE",	 edt_tel2.value);
	ds_get_param.setColumn(0,"TR_CALLBACK",	GetConfig("COM_2"));
		
	ds_get_param.setColumn(0,"TR_MSG",		"카드발급메세지");	
		
	
	ds_SMS.addRow();
	ds_SMS.setColumn(0, "TR_PHONE"          , edt_tel2.value);            //수신번호		
	ds_SMS.setColumn(0, "TR_CALLBACK"       , GetConfig("COM_2"));         //발신번호
	ds_SMS.setColumn(0, "TR_MSG"            , "[GS칼텍스]고객님의 카드가 정상등록 처리 되었습니다."); 		   //수신메세지
	ds_SMS.setColumn(0, "SNDR_ID"      		, "LP");    
	ds_SMS.setColumn(0, "TR_PHONE"          , getTrim(ds_SMS.getColumn(0,"TR_PHONE")).replace("-", ""));            //수신번호		
	ds_SMS.setColumn(0, "TR_CALLBACK"       , getTrim(ds_SMS.getColumn(0,"TR_CALLBACK")).replace("-", ""));         //발신번호
	ds_SMS.setColumn(0, "TR_MSG"            , getTrim(ds_SMS.getColumn(0,"TR_MSG")).replace("\r\n", " ")); 		   //수신메세지	

	var len_msg = ds_SMS.getColumn(0, "TR_MSG");	
	
	if (len_msg.length < 81) {
		
		var nRow = ds_SMS_copy1.addRow();
		ds_SMS_copy1.copyRow(nRow, ds_SMS , 0);
		
	}else{
		
		alert("MMS로 전송됩니다.");
		var nRow = ds_SMS_copy2.addRow();
		ds_SMS_copy2.copyRow(nRow, ds_SMS , 0);		
			
	}
			
	//alert(ds_SMS.getColumn(0, "TR_MSG"));
	//alert(ds_out_sms.rowcount);
	//trace(ds_SMS.saveXML());
	
	
	var	strSvcID = "Auto_sms";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "INSERT_0_IDATA=ds_SMS_copy1:a INSERT_1_IDATA=ds_SMS_copy2:a";
	var	strOutDatasets = "";
	var	strArgument = "INSERT_0_ID=COM170.Set_SMS_INSERT INSERT_1_ID=COM170.Set_MMS_INSERT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;				
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);		
}

// 2012.02.28 진정화 차장 / 김정미 파트장 요구로 휴대폰 번호 수정 기능 추가
function btn_update_onclick(obj:Button,  e:ClickEventInfo)
{
	if (!cf_Confirm("COMI0012","휴대폰번호를 변경"))	return;  
	
	ds_hp_save.clearData();		
						
	fun_ds_srch(ds_hp_save, "MBPH_NO", getTrim(edt_tel2.value).replace("-", ""));
	fun_ds_srch(ds_hp_save, "SEQ_NO", edt_seq.value);				
						
	var	strSvcID = "U_HP";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "UPDATE_0_IDATA=ds_hp_save:a"; 
	var	strOutDatasets = "";
	var	strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE_HP";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
	
}

function card_state_change(obj:Button,  e:ClickEventInfo)
{

//alert(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD"));

	if (ds_out.findRow("CHK","1")=="-1"){
	
		cf_Alert("LPSE0001");
		
	}else if(ds_out.getCaseCount("CHK =="+ '1')>1) {
	
		cf_Alert("LPSE0004");
		
	//}else if(Grid00.getCellValue(ds_out.findRow("CHK","1"),8)=="4"){
	}else if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="4"){
		alert("완료된건은 말소처리가 불가 합니다.");
	
	}else{
	
		if (!cf_Confirm("LPSI0001","고객삭제확인"))	return;  
					
		//mi_crd_no = 	Grid00.getCellValue(ds_out.findRow("CHK","1"),4);		
		//LP_no_stat(Grid00.getCellValue(ds_out.findRow("CHK","1"),6));    
		LP_no_stat(Grid00.getCellValue(ds_out.findRow("CHK","1"),5)); 
		
		//trace(">>>>>>"+Grid00.getCellValue(ds_out.findRow("CHK","1"),5));   
		
		
	}
	
}


//===========================================================
//	★고객 재발급 버튼 클릭시 처리
//===========================================================
function btn_re_save_onclick(obj:Button,  e:ClickEventInfo)
{
	
	Grid00.setFocus();
	
	if(edt_carddiv.value == "Y"){
		alert("제휴카드는 저장버튼을 이용하여 재발급 해주세요.");
		return;
	}
	
	if(ds_out.rowcount=="0"){
		cf_Alert("COME0002","등록할 데이터가 없습니다.");
		return;
	}
	
	if(edt_seq.value == "" || edt_seq.value == null){
		cf_Alert("LPSE0001");
		return;
	}
	
	if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="0" || ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="4") {
		cf_Alert("COME0002","등록된 카드 / 미할당 작업 입니다.");
		return;
	}
	
	if(getTrim(edt_name.value) == "" || getTrim(edt_name.value) == null){
		alert("고객성명을 입력해주세요");
		return;
	}
	
	if(getTrim(edt_cuik_bday.value) == "" || getTrim(edt_cuik_bday.value) == null){
		alert("생년월일을 입력해주세요");
		return;
	}
	
	if(getTrim(cmb_sex_cd.value) == "" || getTrim(cmb_sex_cd.value) == null){
		alert("성별을 입력해주세요");
		return;
	}
	
	if (!cf_Confirm("COMI0012","카드 재발급"))	return;
	
	
	
	if(ds_out.getColumn(ds_out.rowposition,'JOB_CPLT_YN')=='N'){
		
		cust_nm_upd_re();	//고객명 업데이트
	
	}else{
	
		if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="0" || ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD")=="4") {
		
			cf_Alert("COME0002","등록된 카드 / 미할당 작업 입니다.");
			return;
		
		}
	}
	
	
}

//===========================================================
// 카드등록전 고객 정보수정 - (신규등록용)
//===========================================================
function cust_nm_upd()
{
	ds_master_name_in.clearData();
	
	fun_ds_srch(ds_master_name_in, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO")); 
	fun_ds_srch(ds_master_name_in, "CUST_NM", edt_name.value); 
	fun_ds_srch(ds_master_name_in, "CUIK_BDAY", edt_cuik_bday.value); 
	fun_ds_srch(ds_master_name_in, "SEX_CD", cmb_sex_cd.value); 
	
	fun_ds_srch(ds_master_name_in, "JOB_ID", userID); 
	
	fun_ds_srch(ds_master_name_in, "ACNM_CNFM_RSLT_CD", ds_out_vf.getColumn(0,"YN")); 
	fun_ds_srch(ds_master_name_in, "ACNM_CNFM_DTM", edt_name.value); //실명확인일시
			    
	var	strSvcID = "SS2"; //신규용SS2
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "UPDATE_1_IDATA=ds_master_name_in:a"; 
	var	strOutDatasets = "";
	var	strArgument = "UPDATE_1_ID=LPS010.Set_LPS_master_name";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	return;
	
}


//===========================================================
// ★카드등록전 고객 정보수정 - (재발급용)
//===========================================================
function cust_nm_upd_re()
{
	ds_master_name_in.clearData();
	
	fun_ds_srch(ds_master_name_in, "SEQ_NO", ds_out.getColumn(ds_out.rowposition,"SEQ_NO")); 
	fun_ds_srch(ds_master_name_in, "CUST_NM", edt_name.value); 
	fun_ds_srch(ds_master_name_in, "CUIK_BDAY", edt_cuik_bday.value); 
	fun_ds_srch(ds_master_name_in, "SEX_CD", cmb_sex_cd.value); 
	
	fun_ds_srch(ds_master_name_in, "JOB_ID", userID); 
	
	fun_ds_srch(ds_master_name_in, "ACNM_CNFM_RSLT_CD", ds_out_vf.getColumn(0,"YN")); 
	fun_ds_srch(ds_master_name_in, "ACNM_CNFM_DTM", edt_name.value); //실명확인일시
					    
	var	strSvcID = "SS3";	//재발급용SS3
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "UPDATE_1_IDATA=ds_master_name_in:a"; 
	var	strOutDatasets = "";
	var	strArgument = "UPDATE_1_ID=LPS010.Set_LPS_master_name";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = true;

	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		
	return;
	
}


function LP_no_stat(crd_no_del){

		ds_if_card_st_change_env.clearData();
		ds_if_card_st_change_data.clearData();
		ds_if_card_st_change_common.clearData();
		ds_if_card_st_change_header.clearData();
		ds_if_card_st_change_column.clearData();
		ds_if_card_st_change_record.clearData();	
	
		
		//IF_BNS260_01 환경설정
		fun_ds_srch(ds_if_card_st_change_env, "IF_KIND", 			"WAS");
		fun_ds_srch(ds_if_card_st_change_env, "REQ_SERVICE_METHOD", 	"crCrdUpdC01.do"); //공통이 어디까지?
		fun_ds_srch(ds_if_card_st_change_env, "REQ_SERVICE_ID", 		"");
		fun_ds_srch(ds_if_card_st_change_env, "RES_HEADER_SECTION", 	""); //xml상위 헤더항목
		fun_ds_srch(ds_if_card_st_change_env, "RES_COLUMN_SECTION", 	""); 
		fun_ds_srch(ds_if_card_st_change_env, "RES_RECORD_SECTION", 	"STP_CR_CRD_UPD_C01_Rsp"); 

		fun_ds_srch(ds_if_card_st_change_data,"req_chnl_code","610050");
		fun_ds_srch(ds_if_card_st_change_data,"input_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_card_st_change_data,"input_user_nm",getTrim(GetUserInfo("gUSR_NM")));
		fun_ds_srch(ds_if_card_st_change_data,"input_user_ip",getTrim(GetUserInfo("gLGIN_IP")));
		
		/*
		fun_ds_srch(ds_if_card_st_change_data,"in_req_gbn","C");
		fun_ds_srch(ds_if_card_st_change_data,"in_req_chnl_cd","610050");
		fun_ds_srch(ds_if_card_st_change_data,"in_crd_no",crd_no_del);
		fun_ds_srch(ds_if_card_st_change_data,"in_user_id",getTrim(GetUserInfo("gUSR_ID")));
		*/
					
		fun_ds_srch(ds_if_card_st_change_data,"in_req_gbn","S");
		fun_ds_srch(ds_if_card_st_change_data,"in_req_chnl_cd","610050");
		fun_ds_srch(ds_if_card_st_change_data,"in_crd_no",crd_no_del);
		fun_ds_srch(ds_if_card_st_change_data,"in_user_id",getTrim(GetUserInfo("gUSR_ID")));
		fun_ds_srch(ds_if_card_st_change_data,"in_crd_st_cd",cmb_card_sta.value);
		//fun_ds_srch(ds_if_card_st_change_data,"in_stop_rsn_cd",cmb_change_rea.value); 취소사유 안받음
		//fun_ds_srch(ds_if_card_st_change_data,"in_ip",getTrim(GetUserInfo("gLGIN_IP"))); 로긴IP 안받음
		
		//ds_out.clearData();	
		
		var	strSvcID = "IF_CSC_ITRT_063";
		var	strURL = SVC_IF_URL;	
		var	strInDatasets = "INTERFACE_ENV=ds_if_card_st_change_env:a INTERFACE_DATA=ds_if_card_st_change_data:a";
		var	strOutDatasets = "ds_if_card_st_change_common=DS_COMMON ds_if_card_st_change_header=DS_HEADER ds_if_card_st_change_column=DS_COLUMN ds_if_card_st_change_record=DS_RECORD";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);	
				
}





function Edt_CelPhone_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
	var intLength = getTrim(obj.value).length;
	
	if(intLength == obj.getCaretPos()){
		obj.value = maskPhone(e.posttext);
		obj.setCaretPos(-1);		
	}else{
		var intIndx = obj.getCaretPos();	
		obj.value = maskPhone(e.posttext);
		obj.setCaretPos(intIndx);
	}	
}



//==================================================================================
// 마스크 포커스 처리
//==================================================================================
function Msk_SrchCrdNo_oneditclick(obj:MaskEdit,  e:EditClickEventInfo)
{
	if(getTrim(obj.value)==""){
		obj.setCaretPos(0);
	}	
}

function Msk_SrchTailRsBzNo_oneditclick(obj:MaskEdit,  e:EditClickEventInfo)
{	
	if(getTrim(obj.value)==""){
		obj.setCaretPos(0);
	}
}
function Msk_CuikBday_oneditclick(obj:MaskEdit,  e:EditClickEventInfo)
{
	if(getTrim(obj.value)==""){
		obj.setCaretPos(0);
	}
}

function Cal_CuikBday_oneditclick(obj:Calendar,  e:EditClickEventInfo)
{
	if(getTrim(obj.value)==""){
		obj.setCaretPos(0);
	}
}
//제휴 정보 화면 팝업
function btn_card_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_get_param.clearData();
    ds_set_param.clearData();
	fun_ds_srch(ds_get_param, "prg_mode", "POP");
	fun_ds_srch(ds_get_param, "cardNo", edt_card_num.value);      //카드번호

	var arrParam = {getDsArgument:ds_get_param, setDsArgument:ds_set_param};

	PopupDialog("BNS597","BNS::BNS597.xfdl", -1, -1, 974, 274, false, -1, arrParam, false, false, false, false);
}
function cmb_day_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	
}

function cmb_day_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == 13) btn_srch_onclick();
}

function cal_00_onkeyup(obj:Calendar, e:KeyEventInfo)
{
	if (e.keycode == 13) btn_srch_onclick();
}

function cal_01_onkeyup(obj:Calendar, e:KeyEventInfo)
{
	if (e.keycode == 13) btn_srch_onclick();
}

function cmb_call_result_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == 13) btn_srch_onclick();
}

function cmb_job_sta_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == 13) btn_srch_onclick();
}

function edt_card_num_srch_onkeydown(obj:MaskEdit, e:KeyEventInfo)
{
	if (e.keycode == 13) btn_srch_onclick();
}

function Edt_hphone_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13) btn_srch_onclick();
}
//제휴카드이면 카드상태 말소/정지  선택 불가능
function ds_out_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	if(ds_out.getColumn(ds_out.rowposition,"BIZ_CARD_YN") == "Y")
	{
		cmb_card_sta.value = "";
		cmb_card_sta.enable = false;
	}
	else
	{
		cmb_card_sta.enable = true;
	}
}
function Btn_Clear_onclick(obj:Button,  e:ClickEventInfo)
{
		//LPS010_onload();
	setDefaultValue();	
	cmb_job_sta.value=1;
		
	cmb_call_result2.value=10;
	//cmb_card_sta.value=3;
	
	edt_card_num_srch.value ="";
	Edt_hphone.value ="";
	
	cal_01.value 		= getToday();
	cal_00.value 	= AddMonth(getToday(),-1);	
		
	ds_srch1.clearData();
	ds_out.clearData();		
}
function Btn_SndObList_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_out.rowcount == 0 ){
		cf_Alert("COMI0006");
		return;
	}
	
	if(ds_out.getCaseCount("CHK =="+ '1')>1) {		
		alert("카드번호 조회는 한건만 가능 합니다.");
		return;
	}
	
	if(ds_out.findRow("CHK","1") == -1){
		cf_Alert("COME0006");
		return;
	}
	
	ds_sel_cust.clearData();
	
	
	
	for(var i = 0; i < ds_out.rowcount; i++)
	{
	//상담관리로 넘어갈 데이터 셋팅 
		if(ds_out.getColumn(i,"CHK") == "1"){
			ds_sel_cust.addRow();
			ds_sel_cust.setColumn(ds_sel_cust.rowposition,"CRD_NO",ds_out.getColumn(i,"CRD_NO"));		
		}
		
	}
	if (!getTopFrame().getFormOpenYn("BNS010")) {
//		if(!getTopFrame().formOpen("BNS010")) return;   //상담화면 프로그램 권한이 있는 경우 열린다.		
//		getTopFrame().formOpen("BNS010");   //상담화면열림
		cf_Alert("COMI0013","보너스카드 - 상담관리");  //!@ 화면이 열려있지 않아서 열어놓았습니다. 다시한번 호출해주세요..
//		FS_FRAME_MDI.all("SCH010").openstatus = "maximize";		
//		getTabFocus("SCH010");
		//getTabFocus("HOME");
		return;
	}
	//trace(ds_sel_cust.saveXML());
	var objParam 		= new Object();
	objParam.Edt_SrchCustNo = ds_sel_cust.getColumn(0,"CRD_NO");
	objParam.frmPgmId 	= "LPS010";	

	getTopFrame().setFormEvent("BNS010",objParam);	
	getTabFocus("BNS010");	
}


//상담원 배정
function Btn_CmpTgt_onclick(obj:Button,  e:ClickEventInfo)
{
		
		if(ds_out.getRowCount() > 0 ){
		//ds_out을 클리어하기 전에 해당로우의 등록date를 가져와서 변수에 저장해놓음
			dsOutCurRowDate = ds_out.getColumn(ds_out.rowposition,"ARS_REG_DTM").substr(0,8);
		}
		
				
		
		if(Cmb_SrchUsr.index == -1){
			alert("배정 상담원이 없습니다.");	
			return;
		}
		
		

		if(ds_out.getColumn(ds_out.rowposition,"JOB_PRGR_ST_CD") != "0"){
			cf_Alert("COME0002","할당이 불가능한 자료입니다.");
			return;
		}
	
		//선택할당기능
		ds_srch.clearData();
		ds_srch1.clearData();
		ds_srch2.clearData();
		ds_srch3.clearData();		
		
		
		userID = Cmb_SrchUsr.value;		

		fun_ds_srch(ds_srch3, "ROWNUM", cmb_num.text);
		fun_ds_srch(ds_srch3, "JOB_ID", userID);	
		fun_ds_srch(ds_srch, "JOB_ID", userID);
		fun_ds_srch(ds_srch2, "BUSER", userID);
		fun_ds_srch(ds_srch1, "B", userID);	
			
		
		
		//2012.12.13 MIG테이블에 UPDATE하기위해 변경
		var	strSvcID = "U1";
		var	strURL = SVC_USR_URL;
		var	strInDatasets = ""; 
		var	strOutDatasets = "ds_background=SELECT_1_ODATA ds_background2=SELECT_2_ODATA";
		var	strArgument = "";
		var strCallbackFunc = "fn_callBack";
		var strProcessBar = true;
		
		if( Today() == dsOutCurRowDate){
			strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch:a SELECT_2_IDATA=ds_srch2:a"; 
			strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE SELECT_1_ID=LPS010.Get_LPS_SELECT_background01 SELECT_2_ID=LPS010.Get_LPS_SELECT_background02";
						 
		}else{
			strInDatasets = "UPDATE_0_IDATA=ds_srch3:a SELECT_1_IDATA=ds_srch:a SELECT_2_IDATA=ds_srch2:a UPDATE_3_IDATA=ds_srch3:a"; 
			strArgument = "UPDATE_0_ID=LPS010.Get_LPS_UPDATE SELECT_1_ID=LPS010.Get_LPS_SELECT_background01 SELECT_2_ID=LPS010.Get_LPS_SELECT_background02 UPDATE_3_ID=LPS010.Get_LPS_UPDATE_MIG_SEL";
		}
		
		var dsOutCurRowDate;

		
		cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);
		return;
			
}


//상담사 세팅
function Cmb_SrchUser()
{
	
	// 상담사조회
	ds_srch.clearData();
	ds_user.clearData();	
	fun_ds_srch(ds_srch, "GRP_CD", 'BNS'); 
	/*
	fun_ds_srch(ds_srch, "PART_CD", 'BNS1');	//2021.03.26 김순화 채임 감성파트 상담원만 배정대성 -> 2022.07.26 김순화 책임 감성,사랑파트 상담원 배정
	*/
	var iterrate_chk = new Array();
		
	iterrate_chk.push("BNS1");
	iterrate_chk.push("BNS2");
	
	fun_ds_srch(ds_srch, "ITERATE_PART_CD", iterrate_chk.join(","));		
	
	//거래시작	
	var	strSvcID = "R3";
	var	strURL = SVC_USR_URL;
	var	strInDatasets = "SELECT_0_IDATA=ds_srch:a"; 
	var	strOutDatasets = "ds_user=SELECT_0_ODATA";
	var	strArgument = "SELECT_0_ID=Common.Get_PartUsrList_SELECT";
	var strCallbackFunc = "fn_callBack";
	var strProcessBar = false;
	
	cf_SVC(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,strProcessBar);				
}





]]></Script>
    <Layout>
      <Static id="Static00" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 329 699 1640 725" text=""/>
      <Static id="Static67" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 1068 599 1640 625" text=""/>
      <Static id="Static65" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 1050 549 1640 575" text=""/>
      <Static id="Static09" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 328 674 1640 700" text=""/>
      <Static id="Static66" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 1050 574 1640 600" text=""/>
      <Static id="Static51" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 510 599 1640 625" text=""/>
      <Static id="Static72" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 327 624 1640 650" text=""/>
      <Static id="Static08" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 323 649 1640 675" text=""/>
      <Static id="Static58" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 840 549 1614 575" text=""/>
      <Static id="Static68" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 1050 524 1640 550" text=""/>
      <Static id="Static60" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 876 599 1126 625" text=""/>
      <Static id="Static61" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 840 524 1640 550" text=""/>
      <Static id="Static49" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 606 524 896 550" text=""/>
      <Static id="Static52" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 510 574 1600 600" text=""/>
      <Static id="Static53" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 606 549 911 575" text=""/>
      <Static id="Static40" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 296 549 714 575" text=""/>
      <Static id="Static43" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 296 574 720 600" text=""/>
      <Static id="Static44" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 296 599 723 625" text=""/>
      <Static id="Static01" position="absolute 12 12 1640 44" class="sta_WFSA_BG" text="" onclick="Static01_onclick"/>
      <Static id="Static02" text="기간" position="absolute 29 22 89 34" class="sta_WFSA_label"/>
      <Static id="Static06" text="통화결과" class="sta_WFSA_label" position="absolute 500 22 560 34"/>
      <Combo id="cmb_day" taborder="0" position="absolute 72 18 177 38" class="cmb_WFSA" onkeydown="cmb_day_onkeydown"/>
      <Button id="btn_srch" taborder="8" text="조회" position="absolute 1570 18 1630 38" class="btn_WFSA_P" onclick="btn_srch_onclick"/>
      <Grid id="Grid00" taborder="9" position="absolute 12 80 1640 482" binddataset="ds_out" oncellclick="Grid00_oncellclick" cellsizingtype="both" onheadclick="Grid00_onheadclick">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="30"/>
              <Column size="120"/>
              <Column size="80"/>
              <Column size="58"/>
              <Column size="80"/>
              <Column size="130"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="80"/>
              <Column size="75"/>
              <Column size="220"/>
              <Column size="70"/>
              <Column size="0"/>
              <Column size="57"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="0"/>
              <Column size="115"/>
              <Column size="0"/>
              <Column size="80"/>
              <Column size="100"/>
              <Column size="80"/>
              <Column size="120"/>
              <Column size="0"/>
            </Columns>
            <Rows>
              <Row size="24" band="head"/>
              <Row size="24"/>
            </Rows>
            <Band id="head">
              <Cell displaytype="checkbox" edittype="checkbox"/>
              <Cell col="1" text="ARS등록일자"/>
              <Cell col="2" text="고객명"/>
              <Cell col="3" text="성별"/>
              <Cell col="4" text="구분"/>
              <Cell col="5" text="카드번호"/>
              <Cell col="6" text="작업일자"/>
              <Cell col="7" text="작업상태"/>
              <Cell col="8" text="작업자ID"/>
              <Cell col="9" text="통화결과"/>
              <Cell col="10" text="접촉이력"/>
              <Cell col="11" text="결과메세지"/>
              <Cell col="12" text="SMS전송"/>
              <Cell col="13" text="등록확인"/>
              <Cell col="14" text="SMS수신"/>
              <Cell col="15"/>
              <Cell col="16"/>
              <Cell col="17" text="휴대폰"/>
              <Cell col="18" text="seqNo"/>
              <Cell col="19" text="서비스약관"/>
              <Cell col="20" text="94번약관"/>
              <Cell col="21" text="GSMbiz약관"/>
              <Cell col="22" text="한국신용데이터약관"/>
              <Cell col="23" text="GSMbiz약관"/>
            </Band>
            <Band id="body">
              <Cell displaytype="checkbox" edittype="checkbox" text="bind:CHK"/>
              <Cell col="1" text="bind:ARS_REG_DTM" mask="####-##-## ##:##:##"/>
              <Cell col="2" text="bind:CUST_NM_1"/>
              <Cell col="3" text="bind:SEX_CDNM"/>
              <Cell col="4" text="expr:BIZ_CARD_YN =='Y'?'제휴':'일반'"/>
              <Cell col="5" text="bind:CRD_NO" mask="####-####-####-####"/>
              <Cell col="6" text="bind:JOB_DT" mask="####-##-##"/>
              <Cell col="7" text="bind:JOB_PRGR_ST_CDNM"/>
              <Cell col="8" text="bind:JOB_ID"/>
              <Cell col="9" text="bind:CUR_RSLT_CDNM"/>
              <Cell col="10" style="align:left;" text="bind:CNSL_CTT"/>
              <Cell col="11" text="bind:CATIVE_RSLT_MSG"/>
              <Cell col="12" text="bind:SMS_TRMS_YN"/>
              <Cell col="13" displaytype="button" edittype="button" text="확인"/>
              <Cell col="14" text="bind:SMS_AGRM_YN"/>
              <Cell col="15" text="bind:FILE_NM"/>
              <Cell col="16" text="bind:FILE_PATH"/>
              <Cell col="17" text="bind:MBPH_NO_1"/>
              <Cell col="18" text="bind:SEQ_NO"/>
              <Cell col="19" text="bind:AGRM_1_YN"/>
              <Cell col="20" text="bind:AGRM_4_YN"/>
              <Cell col="21" text="bind:AGRM_6_YN"/>
              <Cell col="22" text="bind:AGRM_7_YN"/>
              <Cell col="23" text="bind:AGRM_6_YN"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
      <Calendar id="cal_01" taborder="2" dateformat="yyyy-MM-dd" class="cal_WFSA" position="absolute 310 18 420 38" oneditclick="Cal_CuikBday_oneditclick" onkeydown="cal_01_onkeyup"/>
      <Static id="Static38" text="~" position="absolute 295 21 310 33"/>
      <Calendar id="cal_00" taborder="1" dateformat="yyyy-MM-dd" class="cal_WFSA" position="absolute 181 18 291 38" oneditclick="Cal_CuikBday_oneditclick" onkeydown="cal_00_onkeyup"/>
      <Combo id="cmb_call_result" taborder="3" class="cmb_WFSA" position="absolute 568 18 688 38" onkeydown="cmb_call_result_onkeydown"/>
      <Combo id="cmb_job_sta" taborder="4" class="cmb_WFSA" position="absolute 778 18 898 38" onitemchanged="cmb_job_sta_onitemchanged" onkeydown="cmb_job_sta_onkeydown"/>
      <Static id="Static04" text="작업상태" class="sta_WFSA_label" position="absolute 710 22 770 34"/>
      <Static id="Static05" text="카드번호" class="sta_WFSA_label" position="absolute 1112 22 1172 34"/>
      <MaskEdit id="edt_card_num_srch" taborder="5" text="Edit(일반)" class="edt_WFSA" position="absolute 1177 18 1302 38" imemode="alpha" inputfilter="dot,comma,sign,symbol,alpha,space" inputtype="number" maxlength="16" mask="####-####-####-####" type="string" maskchar=" " oneditclick="Msk_SrchCrdNo_oneditclick" style="align:left middle;" onkeydown="edt_card_num_srch_onkeydown"/>
      <Static id="Static03" text="주민번호" class="sta_WFSA_label" position="absolute 1664 21 1724 33" visible="false"/>
      <MaskEdit id="edt_jumin_srch" taborder="7" text="1234-1234-1234-1234" class="edt_WFSA" position="absolute 1729 17 1838 37" imemode="alpha" inputfilter="dot,comma,sign,symbol,alpha,space" inputtype="number" maxlength="13" mask="######-#{######}" type="string" maskchar=" " visible="false" style="align:left middle;" oneditclick="Msk_SrchTailRsBzNo_oneditclick"/>
      <Static id="Static07" text="잔여할당건 수 :      건" class="sta_WFDA_labelP" position="absolute 18 60 207 72"/>
      <Combo id="cmb_num" taborder="51" class="cmb_WFSA" position="absolute 183 56 250 76"/>
      <Static id="sta_lp_num" position="absolute 127 59 159 71" class="sta_WFDA_P" text=""/>
      <Button id="ars_add" taborder="52" text="할당받기" class="btn_WFDA_B" position="absolute 258 57 328 75" onclick="ars_add_onclick"/>
      <Button id="ars_return" taborder="53" text="반환하기" class="btn_WFDA_B" position="absolute 332 57 402 75" onclick="ars_return_onclick"/>
      <Button id="btn_resend" taborder="54" text="재전송" position="absolute 1213 808 1283 828" onclick="btn_resend_onclick" visible="false"/>
      <Static id="Static36" text="보너스카드 고객정보등록" class="sta_WF_subtitle" position="absolute 275 506 451 518"/>
      <Static id="Static37" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 296 524 704 550" text=""/>
      <Edit id="edt_name" taborder="57" text="Edit(일반)" position="absolute 380 527 473 547" onkeyup="edt_name_onkeyup" style="align:center middle;" maxlength="38"/>
      <Static id="Static39" text="고객명" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 284 524 377 550"/>
      <MaskEdit id="edt_jumin" taborder="58" text="Edit(일반)" position="absolute 681 495 867 515" readonly="true" mask="###### - {#######}" type="string" maskchar=" " visible="false"/>
      <Static id="Static41" text="생년월일" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 284 549 377 575"/>
      <MaskEdit id="edt_card_num" taborder="59" text="Edit(일반)" position="absolute 380 577 515 597" readonly="true" mask="####-####-####-####" type="string" maskchar=" " style="align:right middle;"/>
      <Static id="Static42" text="카드번호" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 284 574 377 600"/>
      <Edit id="edt_tel" taborder="60" text="Edit(일반)" position="absolute 380 602 566 622" readonly="true" inputtype="number" style="align:right middle;"/>
      <Static id="Static45" text="전화번호" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 284 599 377 625"/>
      <Static id="Static46" text="신규재발급" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 666 599 759 625"/>
      <Edit id="edt_newYN" taborder="61" text="Edit(일반)" position="absolute 762 602 872 622" readonly="true" style="align:center middle;"/>
      <Static id="Static47" text="거래주유소" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 666 574 759 600"/>
      <Edit id="edt_ss" taborder="62" text="Edit(일반)" position="absolute 762 577 872 597" readonly="true"/>
      <Static id="Static48" text="카드포인트" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 666 549 759 575"/>
      <Edit id="edt_card_point" taborder="63" text="Edit(일반)" position="absolute 762 552 872 572" readonly="true" style="align:right middle;"/>
      <Static id="Static54" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 666 524 759 550" text=""/>
      <Edit id="edt_job_id" taborder="65" text="Edit(일반)" position="absolute 380 677 566 697" readonly="true"/>
      <MaskEdit id="edt_job_day" taborder="66" text="Edit(일반)" position="absolute 762 677 872 697" readonly="true" type="string" mask="####-##-##" maskchar=" " style="align:center middle;"/>
      <Static id="Static55" text="작업일자" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 666 674 759 700"/>
      <Static id="Static57" text="통화결과" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 876 524 969 550"/>
      <Static id="Static62" text="작업자ID" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 284 674 377 700"/>
      <Edit id="edt_agreeYN" taborder="69" text="Edit(일반)" position="absolute 380 702 566 722" readonly="true" style="align:center middle;"/>
      <Static id="Static69" text="약관동의여부" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 284 699 377 725"/>
      <Edit id="edt_lp_context" taborder="73" text="Edit(일반)" position="absolute 1083 527 1535 547" maxlength="100"/>
      <Button id="btn_play" taborder="76" text="청취시작" class="btn_WFDA_B" position="absolute 476 528 541 546" onclick="btn_play_onclick"/>
      <Button id="btn_inter" taborder="77" text="실명확인" class="btn_WFDA_B" position="absolute 143 826 208 844" onclick="btn_inter_onclick" visible="false"/>
      <Button id="btn_contact_save" taborder="78" text="이력남기기" class="btn_WFDA_B" position="absolute 1547 528 1632 546" onclick="btn_contact_save_onclick"/>
      <Button id="btn_up_save" taborder="79" text="저장" class="btn_WFDA_B" position="absolute 544 528 606 546" style="color:#45798fff;font:dotum,8,bold;" onclick="btn_up_save_onclick"/>
      <Edit id="edt_tel2" taborder="80" position="absolute 481 627 566 647" inputtype="number" style="align:right middle;" readonly="true"/>
      <Button id="btn_tel" taborder="81" class="btn_WFDA_tel" position="absolute 572 604 590 621" onclick="btn_tel_onclick"/>
      <Button id="btn_hp_tel" taborder="82" class="btn_WFDA_mobile" position="absolute 572 629 590 646" onclick="btn_hp_tel_onclick"/>
      <Static id="Static10" text="할당 :" position="absolute 895 60 934 72" style="color:#4a7094ff;"/>
      <Static id="sta_sum1" class="sta_WFDA_P" position="absolute 934 60 966 72" onclick="Static12_onclick" text="" style="color:#325b81ff;"/>
      <Static id="sta_sum2" class="sta_WFDA_P" position="absolute 1047 60 1079 72" text="" style="color:#325b81ff;"/>
      <Static id="Static13" text="미할당 :" position="absolute 996 60 1049 72" style="color:#4a7094ff;"/>
      <Static id="sta_sum3" class="sta_WFDA_P" position="absolute 1165 60 1197 72" text="" style="color:#325b81ff;"/>
      <Static id="Static15" text="작업중 :" position="absolute 1114 60 1167 72" style="color:#4a7094ff;"/>
      <Static id="sta_sum4" class="sta_WFDA_P" position="absolute 1276 60 1308 72" text="" style="color:#325b81ff;"/>
      <Static id="Static17" text="전송중 :" position="absolute 1225 60 1278 72" style="color:#4a7094ff;"/>
      <Static id="sta_sum5" class="sta_WFDA_P" position="absolute 1377 60 1409 72" text="" style="color:#325b81ff;"/>
      <Static id="Static19" text="완료 :" position="absolute 1338 60 1377 72" style="color:#4a7094ff;"/>
      <Static id="sta_sum6" class="sta_WFDA_P" position="absolute 1487 60 1519 72" text="" style="color:#325b81ff;"/>
      <Static id="Static21" text="에러 :" position="absolute 1448 60 1487 72" style="color:#4a7094ff;"/>
      <Static id="sta_job_yn" class="sta_WFDA_P" position="absolute 512 57 544 69" visible="false" text=""/>
      <Combo id="cmb_call_result2" taborder="84" position="absolute 972 527 1080 547" style="buttonsize:-1;align:center middle;"/>
      <Combo id="cmb_usr" taborder="85" class="cmb_WFSA" position="absolute 1463 56 1542 76" visible="false"/>
      <Button id="ars_send_new_user" taborder="87" text="인수인계" class="btn_WFDA_B" position="absolute 1548 57 1618 75" onclick="ars_send_new_user_onclick" visible="false"/>
      <Combo id="cmb_usr_base" taborder="88" class="cmb_WFSA" position="absolute 1375 56 1454 76" visible="false"/>
      <Edit id="edt_job_run" taborder="72" text="Edit(일반)" position="absolute 380 652 566 672" ontextchanged="edt_job_run_ontextchanged" ondrop="edt_job_run_ondrop" readonly="true" style="align:center middle;"/>
      <Static id="Static64" text="작업진행상태" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 284 649 377 675"/>
      <Edit id="edt_smsYN" taborder="67" text="Edit(일반)" position="absolute 762 652 872 672" readonly="true" style="align:center middle;"/>
      <Static id="Static56" text="SMS전송여부" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 666 649 759 675"/>
      <Edit id="edt_job_end" taborder="70" text="Edit(일반)" position="absolute 762 627 872 647" readonly="true" style="align:center middle;"/>
      <Static id="Static63" text="작업완료여부" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 666 624 759 650"/>
      <Button id="btn_delete" taborder="41" text="삭제" position="absolute 723 733 791 753" onclick="btn_delete_onclick"/>
      <Edit id="edt_punch" taborder="71" text="Edit(일반)" position="absolute 762 702 872 722" readonly="true" style="align:center middle;"/>
      <Static id="Static70" text="펀치여부" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 666 699 759 725"/>
      <Static id="Static71" text="휴대폰번호" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 284 624 377 650"/>
      <Static id="Static11" text="SMS발송" class="sta_WF_subtitle" position="absolute 21 506 197 518"/>
      <Static id="Static14" text="00/80 Bytes" class="sta_WF_smsBG" position="absolute 27 524 230 691" style="background:transparent URL('images::sta_WF_smsBG.png') stretch 50 50; "/>
      <TextArea id="Txa_MSG" taborder="93" class="ta_WFDA_TP" position="absolute 48 553 203 659" wordwrap="both" ontextchanged="Txa_MSG_ontextchanged" maxlength="80" lengthunit="ascii"/>
      <Button id="btn_sms_load" taborder="95" text="SMS전송" position="absolute 150 754 230 774" onclick="btn_sms_load_onclick"/>
      <Button id="Button01" taborder="97" text="IF발급정보등록(test)" position="absolute 360 826 482 865" onclick="Button01_onclick" visible="false"/>
      <ActiveX id="AXMSIE" position="absolute 616 802 988 862" progid="{8856F961-340A-11D0-A96B-00C04FD705A2}" windowed="true" visible="false"/>
      <Button id="password" taborder="98" text="비밀번호업데이트(test)" position="absolute 484 826 604 865" onclick="password_onclick" visible="false"/>
      <Static id="Static12" onclick="Static10_onclick" class="sta_WFDA_B" position="absolute 876 549 1640 725" text=""/>
      <Grid id="Grid01" taborder="89" binddataset="ds_out_con" cellsizingtype="both" oncellclick="Grid00_oncellclick" onheadclick="Grid00_onheadclick" position="absolute 876 552 1632 722">
        <Formats>
          <Format id="default">
            <Columns>
              <Column size="120"/>
              <Column size="120"/>
              <Column size="400"/>
              <Column size="80"/>
            </Columns>
            <Rows>
              <Row size="24" band="head"/>
              <Row size="24"/>
            </Rows>
            <Band id="head">
              <Cell text="접촉일시"/>
              <Cell col="1" text="통화결과"/>
              <Cell col="2" text="접촉내용"/>
              <Cell col="3" text="작업자ID"/>
            </Band>
            <Band id="body">
              <Cell text="bind:CNTC_DTM" mask="####-##-##:##:##"/>
              <Cell col="1" style="align:left;" text="bind:CNSL_RSLT_CDNM"/>
              <Cell col="2" style="align:left middle;" text="bind:CNSL_CTT"/>
              <Cell col="3" text="bind:CNSLR_ID"/>
              <Cell col="4"/>
            </Band>
          </Format>
        </Formats>
      </Grid>
      <Static id="Static16" text="총         건" position="absolute 1567 65 1635 77"/>
      <Static id="sta_row" position="absolute 1581 65 1613 77" style="align:right top; " text=""/>
      <Button id="Button00" taborder="99" text="녹취 NAS 접근" position="absolute 228 822 365 869" onclick="Button00_onclick" visible="false"/>
      <ActiveX id="AXMSIE00" position="absolute 832 802 1204 862" progid="{8856F961-340A-11D0-A96B-00C04FD705A2}" windowed="true" visible="false"/>
      <Combo id="Cmb_SCRT_COMBO" taborder="100" onitemchanged="Cmb_SCRT_COMBO_onitemchanged" class="cmb_WFDA" position="absolute 93 695 229 718"/>
      <Static id="Static18" text="스크립트" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 28 695 93 718"/>
      <Static id="Static20" text="발신번호" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 28 719 93 742"/>
      <Edit id="Edt_HomePhone" taborder="101" inputtype="number" lengthunit="ascii" maxlength="13" onkeydown="Edt_HomePhone_onkeydown" ontextchanged="Edt_HomePhone_ontextchanged" position="absolute 93 718 229 742" value="1544-5151"/>
      <Edit id="Edt_hphone" taborder="6" ontextchanged="Edt_CelPhone_ontextchanged" class="edt_WFSA" position="absolute 1382 18 1482 38" onkeydown="Edt_hphone_onkeydown"/>
      <Static id="Static22" text="휴대폰" class="sta_WFSA_label" position="absolute 1318 22 1381 34"/>
      <Edit id="edt_seq" taborder="103" maxlength="60" position="absolute 580 495 673 515" style="align:center middle; " visible="false"/>
      <Button id="btn_update" taborder="104" text="저장" class="btn_WFDA_B" position="absolute 604 628 656 646" style="color:crimson;font:dotum,8,bold;" onclick="btn_update_onclick" visible="false"/>
      <Button id="btn_delete00" taborder="105" text="완삭" class="btn_WFDA_B" position="absolute 710 885 1037 912" style="color:coral;font:dotum,8,bold;" onclick="btn_delete00_onclick" visible="false"/>
      <Combo id="cmb_card_sta" taborder="106" position="absolute 517 577 566 597" style="align:center middle; "/>
      <Button id="btn_inter00" taborder="107" text="성명수정" class="btn_WFDA_B" position="absolute 144 848 207 866" visible="false"/>
      <Combo id="cmb_authn_sbjt_cd" taborder="108" position="absolute 380 627 428 647" readonly="true"/>
      <Combo id="cmb_sex_cd" taborder="109" position="absolute 517 552 566 572" style="buttonsize:-1;align:center middle;"/>
      <Combo id="cmb_com_co_div_cd" taborder="110" position="absolute 431 627 479 647" readonly="true"/>
      <MaskEdit id="edt_cuik_bday" taborder="111" text="    -    -    -    " type="string" mask="####-##-##" maskchar=" " position="absolute 380 552 515 572" style="align:right middle;"/>
      <Button id="btn_card" taborder="112" text="제휴" position="absolute 802 733 872 753" onclick="btn_card_onclick"/>
      <Button id="btn_re_save" taborder="59" text="재발급" class="btn_WFDA_B" position="absolute 608 528 664 546" style="color:#646566ff;" onclick="btn_re_save_onclick"/>
      <Edit id="edt_carddiv" taborder="113" maxlength="60" onkeyup="edt_name_onkeyup" position="absolute 388 805 481 825" style="align:center middle; " visible="false"/>
      <Static id="Static23" text="연속듣기" onclick="Static10_onclick" class="sta_WFDA_labelB" position="absolute 666 524 759 550"/>
      <CheckBox id="CheckBox00" taborder="114" text="CheckBox00" position="absolute 809 527 829 545"/>
      <Static id="Static24" text="할당여부" class="sta_WFSA_label" position="absolute 920 22 980 34"/>
      <Combo id="cmb_job_sel" taborder="1" class="cmb_WFSA" position="absolute 988 18 1084 38"/>
      <Button id="btn_srch00" taborder="1" text="초기화" onclick="Btn_Clear_onclick" class="btn_WFSA_P" position="absolute 1505 18 1565 38"/>
      <Button id="Btn_SndObList" taborder="116" text="카드번호조회" onclick="Btn_SndObList_onclick" class="btn_WFDA_B" position="absolute 408 57 501 75"/>
      <Combo id="Cmb_SrchUsr" taborder="1" innerdataset="ds_user" codecolumn="CODE" datacolumn="CODE_NM" onkeyup="Cmb_SrchUsr_onkeyup" class="cmb_WFSA" position="absolute 518 55 622 75"/>
      <Button id="ars_add00" taborder="1" text="배정하기" onclick="Btn_CmpTgt_onclick" class="btn_WFDA_B" position="absolute 634 57 704 75"/>
    </Layout>
    <Objects>
      <Dataset id="ds_srch" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true"/>
      <Dataset id="ds_out" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" onrowposchanged="ds_out_onrowposchanged">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="ARS_REG_DTM" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="RES_REG_NO" type="STRING" size="256"/>
          <Column id="CUIK_BDAY" type="STRING" size="256"/>
          <Column id="SEX_CDNM" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="JOB_DT" type="STRING" size="256"/>
          <Column id="JOB_PRGR_ST_CD" type="STRING" size="256"/>
          <Column id="JOB_PRGR_ST_CDNM" type="STRING" size="256"/>
          <Column id="JOB_ID" type="STRING" size="256"/>
          <Column id="CUR_RSLT_CD" type="STRING" size="256"/>
          <Column id="CNSL_CTT" type="STRING" size="256"/>
          <Column id="CATIVE_RSLT_MSG" type="STRING" size="256"/>
          <Column id="SMS_TRMS_YN" type="STRING" size="256"/>
          <Column id="JOB_YN" type="STRING" size="256"/>
          <Column id="STPL_AGRM_YN" type="STRING" size="256"/>
          <Column id="JOB_CPLT_YN" type="STRING" size="256"/>
          <Column id="PNCH_CUST_YN" type="STRING" size="256"/>
          <Column id="CRD_PINT" type="STRING" size="256"/>
          <Column id="MBPH_NO" type="STRING" size="256"/>
          <Column id="NEW_AGISSU_DV_CD" type="STRING" size="256"/>
          <Column id="CUR_RSLT_CDNM" type="STRING" size="256"/>
          <Column id="SMS_AGRM_YN" type="STRING" size="256"/>
          <Column id="INFO_CONJ_AGRM_YN" type="STRING" size="256"/>
          <Column id="FILE_NM" type="STRING" size="256"/>
          <Column id="FILE_PATH" type="STRING" size="256"/>
          <Column id="CUST_PW" type="STRING" size="256"/>
          <Column id="TEL_NO" type="STRING" size="256"/>
          <Column id="SEQ_NO" type="STRING" size="256"/>
          <Column id="TEMP" type="STRING" size="256"/>
          <Column id="CRD_ST_CD" type="STRING" size="256"/>
          <Column id="CRD_ST_CD_NM" type="STRING" size="256"/>
          <Column id="SEX_CD" type="STRING" size="256"/>
          <Column id="AUTHN_SBJT_CD" type="STRING" size="256"/>
          <Column id="COM_CO_DIV_CD" type="STRING" size="256"/>
          <Column id="SMS_AUTHN_DTM" type="STRING" size="256"/>
          <Column id="AGRM_1_YN" type="STRING" size="256"/>
          <Column id="AGRM_2_YN" type="STRING" size="256"/>
          <Column id="AGRM_3_YN" type="STRING" size="256"/>
          <Column id="AGRM_4_YN" type="STRING" size="256"/>
          <Column id="AGRM_5_YN" type="STRING" size="256"/>
          <Column id="AGRM_6_YN" type="STRING" size="256"/>
          <Column id="BIZ_CARD_YN" type="STRING" size="256"/>
          <Column id="CUST_NM_1" type="STRING" size="256"/>
          <Column id="MBPH_NO_1" type="STRING" size="256"/>
          <Column id="TEL_NO_1" type="STRING" size="256"/>
          <Column id="AGRM_7_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <FileDialog id="FileDialog00" filter="All(*.*)|*.*|" filterindex="0" defaultextention="false"/>
      <Dataset id="ds_set_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_get_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TR_PHONE" type="STRING" size="256"/>
          <Column id="TR_CALLBACK" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="TR_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_background" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="LP_NUM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_background2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="LP_sum1" type="STRING" size="256"/>
          <Column id="LP_sum2" type="STRING" size="256"/>
          <Column id="LP_sum3" type="STRING" size="256"/>
          <Column id="LP_sum4" type="STRING" size="256"/>
          <Column id="LP_sum5" type="STRING" size="256"/>
          <Column id="LP_sum6" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_srch2" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true"/>
      <Dataset id="ds_srch3" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true"/>
      <Dataset id="ds_srch1" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true"/>
      <Dataset id="ds_save" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_del_srch" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_out_sms" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_send" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_receive" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_code_array" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true">
        <ColumnInfo>
          <Column id="COMBO_NAME" type="STRING" size="256"/>
          <Column id="SQL_ID" type="STRING" size="256"/>
          <Column id="OPTION" type="STRING" size="256"/>
          <Column id="CODE1" type="STRING" size="256"/>
          <Column id="CODE2" type="STRING" size="256"/>
          <Column id="CODE3" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="COMBO_NAME">cmb_usr</Col>
            <Col id="SQL_ID">LPS070.Get_LPS_SELECT</Col>
            <Col id="OPTION">2</Col>
            <Col id="CODE1"/>
            <Col id="CODE2"/>
            <Col id="CODE3"/>
          </Row>
          <Row>
            <Col id="COMBO_NAME">cmb_usr_base</Col>
            <Col id="SQL_ID">LPS070.Get_LPS_SELECT</Col>
            <Col id="OPTION">2</Col>
            <Col id="CODE1"/>
            <Col id="CODE2"/>
            <Col id="CODE3"/>
          </Row>
          <Row>
            <Col id="COMBO_NAME">Cmb_SCRT_COMBO</Col>
            <Col id="SQL_ID">LPS010.Get_ScrtList_SELECT</Col>
            <Col id="OPTION">2</Col>
            <Col id="CODE1"/>
            <Col id="CODE2"/>
            <Col id="CODE3"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_out_new" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_new_save" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_srch_newchange" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_save_hist" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_srch_con" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true">
        <ColumnInfo>
          <Column id="A" type="STRING" size="256"/>
          <Column id="B" type="STRING" size="256"/>
          <Column id="C" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_out_con" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CNTC_DTM" type="STRING" size="256"/>
          <Column id="CNSL_RSLT_CDNM" type="STRING" size="256"/>
          <Column id="CNSL_CTT" type="STRING" size="256"/>
          <Column id="CNSLR_ID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SMS" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TR_PHONE" type="STRING" size="256"/>
          <Column id="TR_CALLBACK" type="STRING" size="256"/>
          <Column id="TR_MSG" type="STRING" size="256"/>
          <Column id="SINF_RSN" type="STRING" size="256"/>
          <Column id="DSFT_ACPN_SEQ_NO" type="STRING" size="256"/>
          <Column id="ASCT_SNDG_YN" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="SNDR_ID" type="STRING" size="256"/>
          <Column id="USR_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SMS_copy1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TR_PHONE" type="STRING" size="256"/>
          <Column id="TR_CALLBACK" type="STRING" size="256"/>
          <Column id="TR_MSG" type="STRING" size="256"/>
          <Column id="SINF_RSN" type="STRING" size="256"/>
          <Column id="DSFT_ACPN_SEQ_NO" type="STRING" size="256"/>
          <Column id="ASCT_SNDG_YN" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="SNDR_ID" type="STRING" size="256"/>
          <Column id="USR_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SMS_copy2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TR_PHONE" type="STRING" size="256"/>
          <Column id="TR_CALLBACK" type="STRING" size="256"/>
          <Column id="TR_MSG" type="STRING" size="256"/>
          <Column id="SINF_RSN" type="STRING" size="256"/>
          <Column id="DSFT_ACPN_SEQ_NO" type="STRING" size="256"/>
          <Column id="ASCT_SNDG_YN" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="SNDR_ID" type="STRING" size="256"/>
          <Column id="USR_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_out_temp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_scrt_load" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_scrt_out" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SMS_CTT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sms_yn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_in_vf" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_out_vf" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_ars_card_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_card_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_STATUS_CODE" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
          <Column id="IO_PRCD_ID" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_real_name" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_master_name_in" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_pw_init_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_pw_init_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_pw_init_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_pw_init_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_pw_init_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_pw_init_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ars_card_end" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_ars_card_pass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_update" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_send_update" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_hp_save" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true"/>
      <Dataset id="ds_if_card_st_change_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_card_st_change_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_card_st_change_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_card_st_change_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_card_st_change_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_card_st_change_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
          <Column id="OT_RESPON_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_cust_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CUST_NO" type="STRING" size="256"/>
          <Column id="HEAD_RS_BZ_NO" type="STRING" size="256"/>
          <Column id="TAIL_RS_BZ_NO" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="EML_ADDR" type="STRING" size="256"/>
          <Column id="INTG_CUST_NO" type="STRING" size="256"/>
          <Column id="WEB_ID" type="STRING" size="256"/>
          <Column id="HND_PHONE_DDD" type="STRING" size="256"/>
          <Column id="HND_PHONE_FSTNO" type="STRING" size="256"/>
          <Column id="HND_PHONE_LASTNO" type="STRING" size="256"/>
          <Column id="BDAY" type="STRING" size="256"/>
          <Column id="SEX_CD" type="STRING" size="256"/>
          <Column id="HND_PHONE_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_cust_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_cust_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_cust_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_cust_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ot_respon_code" type="STRING" size="256"/>
          <Column id="ot_res_msg" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_rsv_std_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_rsv_std_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_rsv_std_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_rsv_std_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_rsv_std_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_rsv_std_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHNL_DIV_CD" type="STRING" size="256"/>
          <Column id="CHNL_DIV_NM" type="STRING" size="256"/>
          <Column id="SALE_DTIME" type="STRING" size="256"/>
          <Column id="SALE_DTIME_UI" type="STRING" size="256"/>
          <Column id="APRV_SEQ" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_CD" type="STRING" size="256"/>
          <Column id="RSV_USE_DIV_NM" type="STRING" size="256"/>
          <Column id="PCKT_TP_CD" type="STRING" size="256"/>
          <Column id="PCKT_TP_NM" type="STRING" size="256"/>
          <Column id="FRCH_CD" type="STRING" size="256"/>
          <Column id="FRCH_NM" type="STRING" size="256"/>
          <Column id="ENTR_NO" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="CUST_NO" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="PAYM_TP_CD" type="STRING" size="256"/>
          <Column id="PAYM_TP_NM" type="STRING" size="256"/>
          <Column id="APRV_DT" type="STRING" size="256"/>
          <Column id="APRV_TMDAY" type="STRING" size="256"/>
          <Column id="APRV_NO" type="STRING" size="256"/>
          <Column id="OAPRV_DT" type="STRING" size="256"/>
          <Column id="OAPRV_NO" type="STRING" size="256"/>
          <Column id="PROD_CD" type="STRING" size="256"/>
          <Column id="PROD_CD_NM" type="STRING" size="256"/>
          <Column id="QTY" type="STRING" size="256"/>
          <Column id="UPRC" type="STRING" size="256"/>
          <Column id="AMT" type="STRING" size="256"/>
          <Column id="GNRL_PT" type="STRING" size="256"/>
          <Column id="SPCL_PT" type="STRING" size="256"/>
          <Column id="CPRT_PT" type="STRING" size="256"/>
          <Column id="BAL_PT" type="STRING" size="256"/>
          <Column id="USBL_PT" type="STRING" size="256"/>
          <Column id="TOT_ACUM_PT" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_CD" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_NM" type="STRING" size="256"/>
          <Column id="TR_OCUR_RSN_CNTT" type="STRING" size="256"/>
          <Column id="TRSF_APLY_NO" type="STRING" size="256"/>
          <Column id="ERR_OCUR_RSN_CD" type="STRING" size="256"/>
          <Column id="ERR_OCUR_RSN_NM" type="STRING" size="256"/>
          <Column id="SALE_DT" type="STRING" size="256"/>
          <Column id="SALE_TMDAY" type="STRING" size="256"/>
          <Column id="COM_PCKT_ORG_CD" type="STRING" size="256"/>
          <Column id="COM_PCKT_ORG_NM" type="STRING" size="256"/>
          <Column id="CHAS_NO" type="STRING" size="256"/>
          <Column id="CRD_REST_PT" type="STRING" size="256"/>
          <Column id="CUST_REST_PT" type="STRING" size="256"/>
          <Column id="RSNO_TR_YN" type="STRING" size="256"/>
          <Column id="INPT_DTIME" type="STRING" size="256"/>
          <Column id="INPT_DTIME_UI" type="STRING" size="256"/>
          <Column id="INPT_USER_ID" type="STRING" size="256"/>
          <Column id="INPT_IP" type="STRING" size="256"/>
          <Column id="MOD_DTIME" type="STRING" size="256"/>
          <Column id="MOD_DTIME_UI" type="STRING" size="256"/>
          <Column id="MOD_USER_ID" type="STRING" size="256"/>
          <Column id="MOD_IP" type="STRING" size="256"/>
          <Column id="DTL_SEQ" type="STRING" size="256"/>
          <Column id="OCUR_PT_DIV_CD" type="STRING" size="256"/>
          <Column id="OCUR_PT_DIV_NM" type="STRING" size="256"/>
          <Column id="CAMP_ID" type="STRING" size="256"/>
          <Column id="OFR_ID" type="STRING" size="256"/>
          <Column id="CAMP_PT" type="STRING" size="256"/>
          <Column id="WIN_RSULT_CD" type="STRING" size="256"/>
          <Column id="WIN_RSULT_NM" type="STRING" size="256"/>
          <Column id="DTL_CPRT_PT" type="STRING" size="256"/>
          <Column id="DTL_SPCL_PT" type="STRING" size="256"/>
          <Column id="SPCL_PT_CD" type="STRING" size="256"/>
          <Column id="SPCL_PT_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_custnmck_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_custnmck_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_custnmck_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_custnmck_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_custnmck_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_custnmck_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_partcard_record" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_partcard_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_partcard_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_partcard_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_partcard_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_partcard_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
          <Column id="RES_CODE_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG1_NAME" type="STRING" size="256"/>
          <Column id="RES_MSG2_NAME" type="STRING" size="256"/>
          <Column id="UPDATE_DATASET_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_PRIV_CNT_HIS" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ACC_NO" type="STRING" size="256"/>
          <Column id="SYS_CD" type="STRING" size="256"/>
          <Column id="SYS_IP" type="STRING" size="256"/>
          <Column id="USR_ID" type="STRING" size="256"/>
          <Column id="USR_CMP_ID" type="STRING" size="256"/>
          <Column id="USR_PART" type="STRING" size="256"/>
          <Column id="ACC_DAT" type="STRING" size="256"/>
          <Column id="ACC_IP" type="STRING" size="256"/>
          <Column id="ACC_URL" type="STRING" size="256"/>
          <Column id="PER_TSK_CD" type="STRING" size="256"/>
          <Column id="PER_TSK_DT" type="STRING" size="256"/>
          <Column id="PER_TSK_ID" type="STRING" size="256"/>
          <Column id="CAL_FUN" type="STRING" size="256"/>
          <Column id="INQ_CON" type="STRING" size="256"/>
          <Column id="INQ_CNT" type="STRING" size="256"/>
          <Column id="INQ_INFO_LIST" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_set_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_get_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_ars_del_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_info_header" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="RESULT_CODE" type="STRING" size="256"/>
          <Column id="RESULT_MSG" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_info_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="HTTP_RET_CODE" type="STRING" size="256"/>
          <Column id="HTTP_RET_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_info_data" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_info_env" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="IF_KIND" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_METHOD" type="STRING" size="256"/>
          <Column id="REQ_SERVICE_ID" type="STRING" size="256"/>
          <Column id="RES_HEADER_SECTION" type="STRING" size="256"/>
          <Column id="RES_COLUMN_SECTION" type="STRING" size="256"/>
          <Column id="RES_RECORD_SECTION" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_if_point_info_column" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_if_point_info_record" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FRCH_CD" type="STRING" size="256"/>
          <Column id="FRCH_NM" type="STRING" size="256"/>
          <Column id="cust_nm" type="STRING" size="256"/>
          <Column id="cust_no" type="STRING" size="256"/>
          <Column id="prod_cd" type="STRING" size="256"/>
          <Column id="prod_cd_nm" type="STRING" size="256"/>
          <Column id="gnrl_pt" type="STRING" size="256"/>
          <Column id="spcl_pt" type="STRING" size="256"/>
          <Column id="cprt_pt" type="STRING" size="256"/>
          <Column id="qty" type="STRING" size="256"/>
          <Column id="uprc" type="STRING" size="256"/>
          <Column id="amt" type="STRING" size="256"/>
          <Column id="SALE_DTIME" type="STRING" size="256"/>
          <Column id="sale_tmday" type="STRING" size="256"/>
          <Column id="CRD_NO" type="STRING" size="256"/>
          <Column id="OT_RES_MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sel_cust" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CRD_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_user" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_set" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="RECV_DTM" type="STRING" size="256"/>
          <Column id="CUST_ID" type="STRING" size="256"/>
          <Column id="CUST_NM" type="STRING" size="256"/>
          <Column id="CTFC" type="STRING" size="256"/>
          <Column id="TITE" type="STRING" size="256"/>
          <Column id="CTT" type="STRING" size="256"/>
          <Column id="HOPE_CNTC_CHNL_CD" type="STRING" size="256"/>
          <Column id="BIZ_DV_CD" type="STRING" size="256"/>
          <Column id="CUST_EML_ADDR" type="STRING" size="256"/>
          <Column id="TEL_HOPE_DTM" type="STRING" size="256"/>
          <Column id="CUST_MESE_SEQ" type="STRING" size="256"/>
          <Column id="HOPE_CTFC" type="STRING" size="256"/>
          <Column id="ASGN_DT" type="STRING" size="256"/>
          <Column id="ASGN_CNSLR_ID" type="STRING" size="256"/>
          <Column id="ASGN_REGR_ID" type="STRING" size="256"/>
          <Column id="RSV_SEQ_NO" type="STRING" size="256"/>
          <Column id="APND_FILE_ADDR" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CHK"/>
            <Col id="RECV_DTM"/>
            <Col id="CUST_ID"/>
            <Col id="CUST_NM"/>
            <Col id="CTFC"/>
            <Col id="TITE"/>
            <Col id="CTT"/>
            <Col id="HOPE_CNTC_CHNL_CD"/>
            <Col id="BIZ_DV_CD"/>
            <Col id="CUST_EML_ADDR"/>
          </Row>
          <Row>
            <Col id="CHK"/>
            <Col id="RECV_DTM"/>
            <Col id="CUST_ID"/>
            <Col id="CUST_NM"/>
            <Col id="CTFC"/>
            <Col id="TITE"/>
            <Col id="CTT"/>
            <Col id="HOPE_CNTC_CHNL_CD"/>
            <Col id="BIZ_DV_CD"/>
            <Col id="CUST_EML_ADDR"/>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="sta_lp_num" propid="text" datasetid="ds_background" columnid="LP_NUM"/>
      <BindItem id="item1" compid="sta_job_yn" propid="text" datasetid="ds_out" columnid="JOB_YN"/>
      <BindItem id="item2" compid="edt_tel2" propid="value" datasetid="ds_out" columnid="MBPH_NO"/>
      <BindItem id="item3" compid="edt_card_point" propid="value" datasetid="ds_out" columnid="CRD_PINT"/>
      <BindItem id="item4" compid="edt_agreeYN" propid="value" datasetid="ds_out" columnid="STPL_AGRM_YN"/>
      <BindItem id="item5" compid="edt_job_end" propid="value" datasetid="ds_out" columnid="JOB_CPLT_YN"/>
      <BindItem id="item6" compid="edt_punch" propid="value" datasetid="ds_out" columnid="PNCH_CUST_YN"/>
      <BindItem id="item7" compid="edt_job_run" propid="value" datasetid="ds_out" columnid="JOB_PRGR_ST_CDNM"/>
      <BindItem id="item8" compid="edt_jumin" propid="value" datasetid="ds_out" columnid="RES_REG_NO"/>
      <BindItem id="item9" compid="edt_card_num" propid="value" datasetid="ds_out" columnid="CRD_NO"/>
      <BindItem id="item11" compid="edt_newYN" propid="value" datasetid="ds_out" columnid="NEW_AGISSU_DV_CD"/>
      <BindItem id="item12" compid="edt_job_id" propid="value" datasetid="ds_out" columnid="JOB_ID"/>
      <BindItem id="item15" compid="edt_job_day" propid="value" datasetid="ds_out" columnid="JOB_DT"/>
      <BindItem id="item16" compid="edt_smsYN" propid="value" datasetid="ds_out" columnid="SMS_TRMS_YN"/>
      <BindItem id="item10" compid="edt_tel" propid="value" datasetid="ds_out" columnid="TEL_NO"/>
      <BindItem id="item17" compid="edt_ss" propid="value" datasetid="ds_out" columnid="TEMP"/>
      <BindItem id="item18" compid="cmb_num" propid="autoselect" datasetid="ds_save"/>
      <BindItem id="item14" compid="Edt_HomePhone" propid="value" datasetid="ds_cust_info" columnid="OT_HOME_PHONE_NO"/>
      <BindItem id="item19" compid="edt_seq" propid="value" datasetid="ds_out" columnid="SEQ_NO"/>
      <BindItem id="item20" compid="cmb_sex_cd" propid="value" datasetid="ds_out" columnid="SEX_CD"/>
      <BindItem id="item21" compid="cmb_authn_sbjt_cd" propid="value" datasetid="ds_out" columnid="AUTHN_SBJT_CD"/>
      <BindItem id="item22" compid="cmb_com_co_div_cd" propid="value" datasetid="ds_out" columnid="COM_CO_DIV_CD"/>
      <BindItem id="item13" compid="edt_cuik_bday" propid="value" datasetid="ds_out" columnid="CUIK_BDAY"/>
      <BindItem id="item23" compid="edt_carddiv" propid="value" datasetid="ds_out" columnid="BIZ_CARD_YN"/>
      <BindItem id="item24" compid="edt_name" propid="value" datasetid="ds_out" columnid="CUST_NM"/>
    </Bind>
  </Form>
</FDL>
