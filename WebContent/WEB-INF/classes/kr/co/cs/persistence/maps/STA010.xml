<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="STA010">
	
 	<select id="Get_MMAsesGrpCombo_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
		 SELECT GRP_SEQ_NO			AS CODE			<!-- 코드 -->
		      , TITE				AS CODE_NM		<!-- 이름 --> 
		   FROM TBL_MM_ASES_GRP
		  WHERE GRP_CD = #grp_cd# 
		    AND NVL(DEL_YN,'N') = 'N'
		    AND NVL(USE_YN,'Y') = 'Y'			    	
		  ORDER BY REG_DTM DESC
 	</select>
 	
 	<select id="Get_CmbBizDtls1_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
		SELECT     DISTINCT
				   BIZ_DV_CD				 AS HIG_CODE
		          ,BIZ_PROC_DTLS_CD1         AS CODE
		          ,BIZ_PROC_DTLS_CDNM1       AS CODE_NM
		FROM  TBL_BIZ_DV_CD
		WHERE USE_YN = 'Y' AND BIZ_PROC_DTLS_CD1 NOT IN ('BNSS')
		ORDER BY BIZ_PROC_DTLS_CD1
		  
 	</select>

 	<select id="Get_CmbBizDtls2_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
		SELECT     DISTINCT
				   BIZ_DV_CD				 AS HIG_CODE					
				  ,BIZ_PROC_DTLS_CD1		 AS HIG_CODE2
		          ,BIZ_PROC_DTLS_CD2         AS CODE
		          ,BIZ_PROC_DTLS_CDNM2       AS CODE_NM
		FROM  TBL_BIZ_DV_CD
		WHERE USE_YN = 'Y' AND BIZ_PROC_DTLS_CD1 NOT IN ('BNSS')
		ORDER BY BIZ_PROC_DTLS_CD2	  
 	</select>

	<!-- 업무구분|업무상세1|업무상세2 - 일별 -->
 	<select id="Get_ORD_CNSL_HIST_DD_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
	SELECT DATA_GB
	     , NM
	     , CNSL_DT_01
	     , CNSL_DT_02
	     , CNSL_DT_03
	     , CNSL_DT_04
	     , CNSL_DT_05
	     , CNSL_DT_06
	     , CNSL_DT_07
	     , CNSL_DT_08
	     , CNSL_DT_09
	     , CNSL_DT_10
	     , CNSL_DT_11
	     , CNSL_DT_12
	     , CNSL_DT_13
	     , CNSL_DT_14
	     , CNSL_DT_15
	     , CNSL_DT_16
	     , CNSL_DT_17
	     , CNSL_DT_18
	     , CNSL_DT_19
	     , CNSL_DT_20
	     , CNSL_DT_21
	     , CNSL_DT_22
	     , CNSL_DT_23
	     , CNSL_DT_24
	     , CNSL_DT_25
	     , CNSL_DT_26
	     , CNSL_DT_27
	     , CNSL_DT_28
	     , CNSL_DT_29
	     , CNSL_DT_30
	     , CNSL_DT_31
	     , CNSL_DT_TOT
	     , SUM_RATE
	FROM
		(
		SELECT CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'T'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'S'
		            ELSE 'D' END DATA_GB
		     , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN '합계'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN '(소계)'||MAX(BIZ_PROC_DTLS_CDNM1)
		            ELSE MAX(BIZ_PROC_DTLS_CDNM2) END NM
		     , SUM(CNSL_NCNT_SUM_01) AS CNSL_DT_01
		     , SUM(CNSL_NCNT_SUM_02) AS CNSL_DT_02
		     , SUM(CNSL_NCNT_SUM_03) AS CNSL_DT_03
		     , SUM(CNSL_NCNT_SUM_04) AS CNSL_DT_04
		     , SUM(CNSL_NCNT_SUM_05) AS CNSL_DT_05
		     , SUM(CNSL_NCNT_SUM_06) AS CNSL_DT_06
		     , SUM(CNSL_NCNT_SUM_07) AS CNSL_DT_07
		     , SUM(CNSL_NCNT_SUM_08) AS CNSL_DT_08
		     , SUM(CNSL_NCNT_SUM_09) AS CNSL_DT_09
		     , SUM(CNSL_NCNT_SUM_10) AS CNSL_DT_10
		     , SUM(CNSL_NCNT_SUM_11) AS CNSL_DT_11
		     , SUM(CNSL_NCNT_SUM_12) AS CNSL_DT_12
		     , SUM(CNSL_NCNT_SUM_13) AS CNSL_DT_13
		     , SUM(CNSL_NCNT_SUM_14) AS CNSL_DT_14
		     , SUM(CNSL_NCNT_SUM_15) AS CNSL_DT_15
		     , SUM(CNSL_NCNT_SUM_16) AS CNSL_DT_16
		     , SUM(CNSL_NCNT_SUM_17) AS CNSL_DT_17
		     , SUM(CNSL_NCNT_SUM_18) AS CNSL_DT_18
		     , SUM(CNSL_NCNT_SUM_19) AS CNSL_DT_19
		     , SUM(CNSL_NCNT_SUM_20) AS CNSL_DT_20
		     , SUM(CNSL_NCNT_SUM_21) AS CNSL_DT_21
		     , SUM(CNSL_NCNT_SUM_22) AS CNSL_DT_22
		     , SUM(CNSL_NCNT_SUM_23) AS CNSL_DT_23
		     , SUM(CNSL_NCNT_SUM_24) AS CNSL_DT_24
		     , SUM(CNSL_NCNT_SUM_25) AS CNSL_DT_25
		     , SUM(CNSL_NCNT_SUM_26) AS CNSL_DT_26
		     , SUM(CNSL_NCNT_SUM_27) AS CNSL_DT_27
		     , SUM(CNSL_NCNT_SUM_28) AS CNSL_DT_28
		     , SUM(CNSL_NCNT_SUM_29) AS CNSL_DT_29
		     , SUM(CNSL_NCNT_SUM_30) AS CNSL_DT_30
		     , SUM(CNSL_NCNT_SUM_31) AS CNSL_DT_31
		     , SUM(ROW_SUM) AS CNSL_DT_TOT
		     , ROUND(SUM(ROW_SUM)/MAX(TOTAL_SUM)*100, 2) AS SUM_RATE
		     , BIZ_PROC_DTLS_CD1 <!-- 합계역순 조회용 -->
		     , BIZ_PROC_DTLS_CD2 <!-- 합계역순 조회용 -->
			 , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN -1
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN MIN(DTL1_CNSL_NCNT_SUM)
		            ELSE SUM(DTL1_CNSL_NCNT_SUM)
		       END DATA_GB_SUM  <!-- 합계역순 조회용 -->
		     , SUM(DTL1_CNSL_NCNT_SUM) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
   		FROM
		(
			SELECT TT.BIZ_DV_CD
			     , TT.BIZ_PROC_DTLS_CD1
			     , TT.BIZ_PROC_DTLS_CDNM1
			     , TT.BIZ_PROC_DTLS_CD2
			     , TT.BIZ_PROC_DTLS_CDNM2
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '01', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_01
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '02', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_02
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '03', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_03
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '04', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_04
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '05', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_05
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '06', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_06
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '07', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_07
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '08', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_08
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '09', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_09
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '10', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_10
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '11', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_11
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '12', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_12
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '13', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_13
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '14', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_14
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '15', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_15
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '16', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_16
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '17', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_17
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '18', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_18
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '19', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_19
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '20', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_20
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '21', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_21
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '22', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_22
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '23', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_23
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '24', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_24
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '25', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_25
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '26', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_26
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '27', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_27
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '28', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_28
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '29', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_29
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '30', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_30
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '31', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_31
			     , SUM(CNSL_NCNT_SUM) AS ROW_SUM
			     , MAX(TOTAL_SUM) AS TOTAL_SUM
			     , NVL(MAX(DTL1_CNSL_NCNT_SUM), 0) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
			FROM
			(
			 SELECT T1.*
			      , NVL(T2.CNSL_NCNT_SUM, 0) AS CNSL_NCNT_SUM
			      , TOTAL_SUM  
			      , DTL1_CNSL_NCNT_SUM   <!-- 합계역순 조회용 -->
			 FROM
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_PROC_DTLS_CD1,
			  	       A.BIZ_PROC_DTLS_CDNM1,
			  	       A.BIZ_PROC_DTLS_CD2, 
			  	       A.BIZ_PROC_DTLS_CDNM2,
			  	       B.BASC_DT
			  	  FROM TBL_BIZ_DV_CD A,
			  	       TBL_BUSSDD_INFO B
			  	 WHERE A.BIZ_DV_CD = B.GRP_CD
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
				<isNotEmpty property="biz_proc_dtls_cd1">
			  	   AND A.BIZ_PROC_DTLS_CD1 = #biz_proc_dtls_cd1#
				</isNotEmpty>
				<isNotEmpty property="biz_proc_dtls_cd2">
			  	   AND A.BIZ_PROC_DTLS_CD2 = #biz_proc_dtls_cd2#
				</isNotEmpty>
			  	   AND A.USE_YN = 'Y'
			  	   AND B.BASC_DT BETWEEN #from# AND #to#
			  	ORDER BY A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, B.BASC_DT
			 ) T1,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       A.BIZ_DV_DTLS_CD2,
			  	       A.CNSL_DT,
			  	       SUM(A.CNSL_NCNT)       AS CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN #from# AND #to#
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, A.CNSL_DT
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, A.CNSL_DT
			 ) T2,
			 (
			   	SELECT A.BIZ_DV_CD,
			  	       SUM(A.CNSL_NCNT) AS TOTAL_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN #from# AND #to#
			  	GROUP BY A.BIZ_DV_CD
			 ) T3,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       SUM(A.CNSL_NCNT)       AS DTL1_CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN #from# AND #to#
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			 ) T4  <!-- 합계역순 조회용 -->
			 WHERE T1.BIZ_DV_CD = T2.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T3.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T4.BIZ_DV_CD(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T4.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T2.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD2 = T2.BIZ_DV_DTLS_CD2(+)
			   AND T1.BASC_DT           = T2.CNSL_DT(+)
			 ORDER BY T1.BIZ_PROC_DTLS_CD1, T1.BIZ_PROC_DTLS_CD2, T1.BASC_DT
			) TT
			GROUP BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
			ORDER BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
		)  
		GROUP BY ROLLUP(BIZ_PROC_DTLS_CD1, BIZ_PROC_DTLS_CD2)
	)
	<isNotEmpty property="order_gb">
	<isEqual property="order_gb" compareValue="01">
	ORDER BY BIZ_PROC_DTLS_CD1, DATA_GB, BIZ_PROC_DTLS_CD2 <!-- 업무상세순서  -->
	</isEqual>
	<isEqual property="order_gb" compareValue="02">
	ORDER BY DATA_GB_SUM DESC, BIZ_PROC_DTLS_CD1, DATA_GB, CNSL_DT_TOT DESC <!-- 업무상세1합계역순 AND 업무상세2 합계역순 -->
	</isEqual>
	</isNotEmpty>
	</select>
	
	<!-- 업무구분|업무상세1|업무상세2 - 일별 합계-->
 	<select id="Get_ORD_CNSL_HIST_DD_SUM_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
	SELECT DATA_GB
	     , NM
	     , CNSL_DT_01
	     , CNSL_DT_02
	     , CNSL_DT_03
	     , CNSL_DT_04
	     , CNSL_DT_05
	     , CNSL_DT_06
	     , CNSL_DT_07
	     , CNSL_DT_08
	     , CNSL_DT_09
	     , CNSL_DT_10
	     , CNSL_DT_11
	     , CNSL_DT_12
	     , CNSL_DT_13
	     , CNSL_DT_14
	     , CNSL_DT_15
	     , CNSL_DT_16
	     , CNSL_DT_17
	     , CNSL_DT_18
	     , CNSL_DT_19
	     , CNSL_DT_20
	     , CNSL_DT_21
	     , CNSL_DT_22
	     , CNSL_DT_23
	     , CNSL_DT_24
	     , CNSL_DT_25
	     , CNSL_DT_26
	     , CNSL_DT_27
	     , CNSL_DT_28
	     , CNSL_DT_29
	     , CNSL_DT_30
	     , CNSL_DT_31
	     , CNSL_DT_TOT
	     , SUM_RATE
	FROM
		(
		SELECT CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'T'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'S'
		            ELSE 'D' END DATA_GB
		     , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN '합계'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN MAX(BIZ_PROC_DTLS_CDNM1)
		            ELSE MAX(BIZ_PROC_DTLS_CDNM2) END NM
		     , SUM(CNSL_NCNT_SUM_01) AS CNSL_DT_01
		     , SUM(CNSL_NCNT_SUM_02) AS CNSL_DT_02
		     , SUM(CNSL_NCNT_SUM_03) AS CNSL_DT_03
		     , SUM(CNSL_NCNT_SUM_04) AS CNSL_DT_04
		     , SUM(CNSL_NCNT_SUM_05) AS CNSL_DT_05
		     , SUM(CNSL_NCNT_SUM_06) AS CNSL_DT_06
		     , SUM(CNSL_NCNT_SUM_07) AS CNSL_DT_07
		     , SUM(CNSL_NCNT_SUM_08) AS CNSL_DT_08
		     , SUM(CNSL_NCNT_SUM_09) AS CNSL_DT_09
		     , SUM(CNSL_NCNT_SUM_10) AS CNSL_DT_10
		     , SUM(CNSL_NCNT_SUM_11) AS CNSL_DT_11
		     , SUM(CNSL_NCNT_SUM_12) AS CNSL_DT_12
		     , SUM(CNSL_NCNT_SUM_13) AS CNSL_DT_13
		     , SUM(CNSL_NCNT_SUM_14) AS CNSL_DT_14
		     , SUM(CNSL_NCNT_SUM_15) AS CNSL_DT_15
		     , SUM(CNSL_NCNT_SUM_16) AS CNSL_DT_16
		     , SUM(CNSL_NCNT_SUM_17) AS CNSL_DT_17
		     , SUM(CNSL_NCNT_SUM_18) AS CNSL_DT_18
		     , SUM(CNSL_NCNT_SUM_19) AS CNSL_DT_19
		     , SUM(CNSL_NCNT_SUM_20) AS CNSL_DT_20
		     , SUM(CNSL_NCNT_SUM_21) AS CNSL_DT_21
		     , SUM(CNSL_NCNT_SUM_22) AS CNSL_DT_22
		     , SUM(CNSL_NCNT_SUM_23) AS CNSL_DT_23
		     , SUM(CNSL_NCNT_SUM_24) AS CNSL_DT_24
		     , SUM(CNSL_NCNT_SUM_25) AS CNSL_DT_25
		     , SUM(CNSL_NCNT_SUM_26) AS CNSL_DT_26
		     , SUM(CNSL_NCNT_SUM_27) AS CNSL_DT_27
		     , SUM(CNSL_NCNT_SUM_28) AS CNSL_DT_28
		     , SUM(CNSL_NCNT_SUM_29) AS CNSL_DT_29
		     , SUM(CNSL_NCNT_SUM_30) AS CNSL_DT_30
		     , SUM(CNSL_NCNT_SUM_31) AS CNSL_DT_31
		     , SUM(ROW_SUM) AS CNSL_DT_TOT
		     , ROUND(SUM(ROW_SUM)/MAX(TOTAL_SUM)*100, 2) AS SUM_RATE
		     , BIZ_PROC_DTLS_CD1 <!-- 합계역순 조회용 -->
		     , BIZ_PROC_DTLS_CD2 <!-- 합계역순 조회용 -->
			 , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN -1
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN MIN(DTL1_CNSL_NCNT_SUM)
		            ELSE SUM(DTL1_CNSL_NCNT_SUM)
		       END DATA_GB_SUM  <!-- 합계역순 조회용 -->
		     , SUM(DTL1_CNSL_NCNT_SUM) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
   		FROM
		(
			SELECT TT.BIZ_DV_CD
			     , TT.BIZ_PROC_DTLS_CD1
			     , TT.BIZ_PROC_DTLS_CDNM1
			     , TT.BIZ_PROC_DTLS_CD2
			     , TT.BIZ_PROC_DTLS_CDNM2
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '01', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_01
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '02', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_02
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '03', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_03
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '04', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_04
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '05', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_05
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '06', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_06
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '07', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_07
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '08', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_08
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '09', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_09
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '10', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_10
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '11', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_11
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '12', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_12
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '13', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_13
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '14', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_14
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '15', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_15
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '16', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_16
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '17', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_17
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '18', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_18
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '19', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_19
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '20', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_20
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '21', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_21
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '22', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_22
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '23', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_23
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '24', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_24
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '25', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_25
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '26', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_26
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '27', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_27
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '28', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_28
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '29', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_29
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '30', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_30
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '31', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_31
			     , SUM(CNSL_NCNT_SUM) AS ROW_SUM
			     , MAX(TOTAL_SUM) AS TOTAL_SUM
			     , NVL(MAX(DTL1_CNSL_NCNT_SUM), 0) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
			FROM
			(
			 SELECT T1.*
			      , NVL(T2.CNSL_NCNT_SUM, 0) AS CNSL_NCNT_SUM
			      , TOTAL_SUM  
			      , DTL1_CNSL_NCNT_SUM   <!-- 합계역순 조회용 -->
			 FROM
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_PROC_DTLS_CD1,
			  	       A.BIZ_PROC_DTLS_CDNM1,
			  	       A.BIZ_PROC_DTLS_CD2, 
			  	       A.BIZ_PROC_DTLS_CDNM2,
			  	       B.BASC_DT
			  	  FROM TBL_BIZ_DV_CD A,
			  	       TBL_BUSSDD_INFO B
			  	 WHERE A.BIZ_DV_CD = B.GRP_CD
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
				<isNotEmpty property="biz_proc_dtls_cd1">
			  	   AND A.BIZ_PROC_DTLS_CD1 = #biz_proc_dtls_cd1#
				</isNotEmpty>
				<isNotEmpty property="biz_proc_dtls_cd2">
			  	   AND A.BIZ_PROC_DTLS_CD2 = #biz_proc_dtls_cd2#
				</isNotEmpty>
				<isEqual property="biz_dv_cd" compareValue="BNS">
					AND A.SRT_SEQ  > 662   <!-- biz_proc_dtsl_cdnm1 이 H로 시작 하는것만-->
					AND A.BIZ_PROC_DTLS_CD1 NOT IN('HSIC', 'HSHX', 'HSHS', 'HSHT', 'HSHV','HSHU','HSHW')
				</isEqual>
			  	 <!-- AND A.USE_YN = 'Y'  사용여부 상관없이 모두 20180626 허선화D 요청-->
			  	   AND B.BASC_DT BETWEEN #from# AND #to#
			  	ORDER BY A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, B.BASC_DT
			 ) T1,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       A.BIZ_DV_DTLS_CD2,
			  	       A.CNSL_DT,
			  	       SUM(A.CNSL_NCNT)       AS CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN #from# AND #to#
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, A.CNSL_DT
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, A.CNSL_DT
			 ) T2,
			 (
			   	SELECT A.BIZ_DV_CD,
			  	       SUM(A.CNSL_NCNT) AS TOTAL_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN #from# AND #to#
			  	GROUP BY A.BIZ_DV_CD
			 ) T3,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       SUM(A.CNSL_NCNT)       AS DTL1_CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN #from# AND #to#
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			 ) T4  <!-- 합계역순 조회용 -->
			 WHERE T1.BIZ_DV_CD = T2.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T3.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T4.BIZ_DV_CD(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T4.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T2.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD2 = T2.BIZ_DV_DTLS_CD2(+)
			   AND T1.BASC_DT           = T2.CNSL_DT(+)
			 ORDER BY T1.BIZ_PROC_DTLS_CD1, T1.BIZ_PROC_DTLS_CD2, T1.BASC_DT
			) TT
			GROUP BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
			ORDER BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
		)  
		GROUP BY ROLLUP(BIZ_PROC_DTLS_CD1, BIZ_PROC_DTLS_CD2)
	) WHERE DATA_GB in( 'S','T')
	<isNotEmpty property="order_gb">
	<isEqual property="order_gb" compareValue="01">
	ORDER BY BIZ_PROC_DTLS_CD1, DATA_GB, BIZ_PROC_DTLS_CD2 <!-- 업무상세순서  -->
	</isEqual>
	<isEqual property="order_gb" compareValue="02">
	ORDER BY DATA_GB_SUM DESC, BIZ_PROC_DTLS_CD1, DATA_GB, CNSL_DT_TOT DESC <!-- 업무상세1합계역순 AND 업무상세2 합계역순 -->
	</isEqual>
	</isNotEmpty>
	</select>
	
	<!-- 업무구분|업무상세1|업무상세2 - 월별 -->
 	<select id="Get_ORD_CNSL_HIST_YM_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
	SELECT DATA_GB
	     , NM
	     , CNSL_YM_01
	     , CNSL_YM_02
	     , CNSL_YM_03
	     , CNSL_YM_04
	     , CNSL_YM_05
	     , CNSL_YM_06
	     , CNSL_YM_07
	     , CNSL_YM_08
	     , CNSL_YM_09
	     , CNSL_YM_10
	     , CNSL_YM_11
	     , CNSL_YM_12
	     , CNSL_YM_TOT
	     , SUM_RATE
	FROM
		(
		SELECT CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'T'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'S'
		            ELSE 'D' END DATA_GB
		     , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN '합계'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN '(소계)'||MAX(BIZ_PROC_DTLS_CDNM1)
		            ELSE MAX(BIZ_PROC_DTLS_CDNM2) END NM
		     , SUM(CNSL_NCNT_SUM_01) AS CNSL_YM_01
		     , SUM(CNSL_NCNT_SUM_02) AS CNSL_YM_02
		     , SUM(CNSL_NCNT_SUM_03) AS CNSL_YM_03
		     , SUM(CNSL_NCNT_SUM_04) AS CNSL_YM_04
		     , SUM(CNSL_NCNT_SUM_05) AS CNSL_YM_05
		     , SUM(CNSL_NCNT_SUM_06) AS CNSL_YM_06
		     , SUM(CNSL_NCNT_SUM_07) AS CNSL_YM_07
		     , SUM(CNSL_NCNT_SUM_08) AS CNSL_YM_08
		     , SUM(CNSL_NCNT_SUM_09) AS CNSL_YM_09
		     , SUM(CNSL_NCNT_SUM_10) AS CNSL_YM_10
		     , SUM(CNSL_NCNT_SUM_11) AS CNSL_YM_11
		     , SUM(CNSL_NCNT_SUM_12) AS CNSL_YM_12
		     , SUM(ROW_SUM) AS CNSL_YM_TOT
		     , ROUND(SUM(ROW_SUM)/MAX(TOTAL_SUM)*100, 2) AS SUM_RATE
		     , BIZ_PROC_DTLS_CD1 <!-- 합계역순 조회용 -->
		     , BIZ_PROC_DTLS_CD2 <!-- 합계역순 조회용 -->
			 , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN -1
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN MIN(DTL1_CNSL_NCNT_SUM)
		            ELSE SUM(DTL1_CNSL_NCNT_SUM)
		       END DATA_GB_SUM  <!-- 합계역순 조회용 -->
		     , SUM(DTL1_CNSL_NCNT_SUM) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
		FROM
		(
			SELECT TT.BIZ_DV_CD
			     , TT.BIZ_PROC_DTLS_CD1
			     , TT.BIZ_PROC_DTLS_CDNM1
			     , TT.BIZ_PROC_DTLS_CD2
			     , TT.BIZ_PROC_DTLS_CDNM2
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '01', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_01
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '02', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_02
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '03', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_03
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '04', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_04
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '05', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_05
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '06', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_06
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '07', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_07
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '08', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_08
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '09', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_09
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '10', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_10
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '11', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_11
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '12', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_12
			     , SUM(CNSL_NCNT_SUM) AS ROW_SUM
			     , MAX(TOTAL_SUM) AS TOTAL_SUM
			     , NVL(MAX(DTL1_CNSL_NCNT_SUM), 0) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
			FROM
			(
			 SELECT T1.*
			      , NVL(T2.CNSL_NCNT_SUM, 0) AS CNSL_NCNT_SUM
			      , TOTAL_SUM  
			      , DTL1_CNSL_NCNT_SUM   <!-- 합계역순 조회용 -->
			 FROM
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_PROC_DTLS_CD1,
			  	       MAX(A.BIZ_PROC_DTLS_CDNM1) BIZ_PROC_DTLS_CDNM1,
			  	       A.BIZ_PROC_DTLS_CD2, 
			  	       MAX(A.BIZ_PROC_DTLS_CDNM2) AS BIZ_PROC_DTLS_CDNM2,
			  	       SUBSTR(B.BASC_DT, 1, 6) AS BASC_YM
			  	  FROM TBL_BIZ_DV_CD A,
			  	       TBL_BUSSDD_INFO B
			  	 WHERE A.BIZ_DV_CD = B.GRP_CD
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
				<isNotEmpty property="biz_proc_dtls_cd1">
			  	   AND A.BIZ_PROC_DTLS_CD1 = #biz_proc_dtls_cd1#
				</isNotEmpty>
				<isNotEmpty property="biz_proc_dtls_cd2">
			  	   AND A.BIZ_PROC_DTLS_CD2 = #biz_proc_dtls_cd2#
				</isNotEmpty>
			  	   AND A.USE_YN = 'Y'
			  	   AND B.BASC_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#from#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, SUBSTR(B.BASC_DT, 1, 6)
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, SUBSTR(B.BASC_DT, 1, 6)
			 ) T1,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       A.BIZ_DV_DTLS_CD2,
			  	       SUBSTR(A.CNSL_DT, 1, 6) AS CNSL_YM,
			  	       SUM(A.CNSL_NCNT)       AS CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A  
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#from#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, SUBSTR(A.CNSL_DT, 1, 6)
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, SUBSTR(A.CNSL_DT, 1, 6) 
			 ) T2,
			 (
			   	SELECT A.BIZ_DV_CD,
			  	       SUM(A.CNSL_NCNT) AS TOTAL_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#from#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD
			 ) T3,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       SUM(A.CNSL_NCNT)       AS DTL1_CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#from#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			 ) T4  <!-- 합계역순 조회용 -->
			 WHERE T1.BIZ_DV_CD = T2.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T3.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T4.BIZ_DV_CD(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T4.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T2.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD2 = T2.BIZ_DV_DTLS_CD2(+)
			   AND T1.BASC_YM           = T2.CNSL_YM(+)
			 ORDER BY T1.BIZ_PROC_DTLS_CD1, T1.BIZ_PROC_DTLS_CD2, T1.BASC_YM
			) TT
			GROUP BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
			ORDER BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
		)  
		GROUP BY ROLLUP(BIZ_PROC_DTLS_CD1, BIZ_PROC_DTLS_CD2)
	)
	<isNotEmpty property="order_gb">
	<isEqual property="order_gb" compareValue="01">
	ORDER BY BIZ_PROC_DTLS_CD1, DATA_GB, BIZ_PROC_DTLS_CD2 <!-- 업무상세순서  -->
	</isEqual>
	<isEqual property="order_gb" compareValue="02">
	ORDER BY DATA_GB_SUM DESC, BIZ_PROC_DTLS_CD1, DATA_GB, CNSL_YM_TOT DESC <!-- 업무상세1합계역순 AND 업무상세2 합계역순 -->
	</isEqual>
	</isNotEmpty>
	</select>
	
	
	<!-- 업무구분|업무상세1|업무상세2 - 월별 합계 -->
 	<select id="Get_ORD_CNSL_HIST_YM_SUM_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
	SELECT DATA_GB
	     , NM
	    , CNSL_YM_01
		, CNSL_YM_02
		, CNSL_YM_03
		, CNSL_YM_04
		, CNSL_YM_05
		, CNSL_YM_06
		, CNSL_YM_07
		, CNSL_YM_08
		, CNSL_YM_09
		, CNSL_YM_10
		, CNSL_YM_11
		, CNSL_YM_12
		, CNSL_YM_TOT
	    , SUM_RATE
	   , NVL(CEIL(CNSL_YM_TOT/(SUBSTR(#to#,5,2)-SUBSTR(#from#,5,2)+1)),0) AS AVR
	FROM
		(
		SELECT CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'T'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'S'
		            ELSE 'D' END DATA_GB
		     , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN '합계'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN MAX(BIZ_PROC_DTLS_CDNM1)
		            ELSE MAX(BIZ_PROC_DTLS_CDNM2) END NM
		     , SUM(CNSL_NCNT_SUM_01) AS CNSL_YM_01
		     , SUM(CNSL_NCNT_SUM_02) AS CNSL_YM_02
		     , SUM(CNSL_NCNT_SUM_03) AS CNSL_YM_03
		     , SUM(CNSL_NCNT_SUM_04) AS CNSL_YM_04
		     , SUM(CNSL_NCNT_SUM_05) AS CNSL_YM_05
		     , SUM(CNSL_NCNT_SUM_06) AS CNSL_YM_06
		     , SUM(CNSL_NCNT_SUM_07) AS CNSL_YM_07
		     , SUM(CNSL_NCNT_SUM_08) AS CNSL_YM_08
		     , SUM(CNSL_NCNT_SUM_09) AS CNSL_YM_09
		     , SUM(CNSL_NCNT_SUM_10) AS CNSL_YM_10
		     , SUM(CNSL_NCNT_SUM_11) AS CNSL_YM_11
		     , SUM(CNSL_NCNT_SUM_12) AS CNSL_YM_12
		     , SUM(ROW_SUM) AS CNSL_YM_TOT
		     , ROUND(SUM(ROW_SUM)/MAX(TOTAL_SUM)*100, 2) AS SUM_RATE
		     , BIZ_PROC_DTLS_CD1 <!-- 합계역순 조회용 -->
		     , BIZ_PROC_DTLS_CD2 <!-- 합계역순 조회용 -->
			 , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN -1
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN MIN(DTL1_CNSL_NCNT_SUM)
		            ELSE SUM(DTL1_CNSL_NCNT_SUM)
		       END DATA_GB_SUM  <!-- 합계역순 조회용 -->
		     , SUM(DTL1_CNSL_NCNT_SUM) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
		FROM
		(
			SELECT TT.BIZ_DV_CD
			     , TT.BIZ_PROC_DTLS_CD1
			     , TT.BIZ_PROC_DTLS_CDNM1
			     , TT.BIZ_PROC_DTLS_CD2
			     , TT.BIZ_PROC_DTLS_CDNM2
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '01', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_01
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '02', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_02
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '03', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_03
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '04', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_04
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '05', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_05
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '06', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_06
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '07', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_07
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '08', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_08
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '09', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_09
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '10', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_10
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '11', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_11
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '12', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_12
			     , SUM(CNSL_NCNT_SUM) AS ROW_SUM
			     , MAX(TOTAL_SUM) AS TOTAL_SUM
			     , NVL(MAX(DTL1_CNSL_NCNT_SUM), 0) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
			FROM
			(
			 SELECT T1.*
			      , NVL(T2.CNSL_NCNT_SUM, 0) AS CNSL_NCNT_SUM
			      , TOTAL_SUM  
			      , DTL1_CNSL_NCNT_SUM   <!-- 합계역순 조회용 -->
			 FROM
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_PROC_DTLS_CD1,
			  	       MAX(A.BIZ_PROC_DTLS_CDNM1) BIZ_PROC_DTLS_CDNM1,
			  	       A.BIZ_PROC_DTLS_CD2, 
			  	       MAX(A.BIZ_PROC_DTLS_CDNM2) AS BIZ_PROC_DTLS_CDNM2,
			  	       SUBSTR(B.BASC_DT, 1, 6) AS BASC_YM
			  	  FROM TBL_BIZ_DV_CD A,
			  	       TBL_BUSSDD_INFO B
			  	 WHERE A.BIZ_DV_CD = B.GRP_CD
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
				<isNotEmpty property="biz_proc_dtls_cd1">
			  	   AND A.BIZ_PROC_DTLS_CD1 = #biz_proc_dtls_cd1#
				</isNotEmpty>
				<isNotEmpty property="biz_proc_dtls_cd2">
			  	   AND A.BIZ_PROC_DTLS_CD2 = #biz_proc_dtls_cd2#
				</isNotEmpty>
					<isEqual property="biz_dv_cd" compareValue="BNS">
					AND A.SRT_SEQ  > 662   <!-- biz_proc_dtsl_cdnm1 이 H로 시작 하는것만....... -->
					AND A.BIZ_PROC_DTLS_CD1 NOT IN('HSIC', 'HSHX', 'HSHS', 'HSHT', 'HSHV','HSHU','HSHW')
				</isEqual>
			  	   <!-- AND A.USE_YN = 'Y'  사용여부 상관없이 모두 20180626 허선화D 요청-->
			  	   AND B.BASC_DT BETWEEN SUBSTR(#from#,0,6)||'00' AND SUBSTR(#to#,0,6)||'32'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, SUBSTR(B.BASC_DT, 1, 6)
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, SUBSTR(B.BASC_DT, 1, 6)
			 ) T1,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       A.BIZ_DV_DTLS_CD2,
			  	       SUBSTR(A.CNSL_DT, 1, 6) AS CNSL_YM,
			  	       SUM(A.CNSL_NCNT)       AS CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A  
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,0,6)||'00' AND SUBSTR(#to#,0,6)||'32'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, SUBSTR(A.CNSL_DT, 1, 6)
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, SUBSTR(A.CNSL_DT, 1, 6) 
			 ) T2,
			 (
			   	SELECT A.BIZ_DV_CD,
			  	       SUM(A.CNSL_NCNT) AS TOTAL_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN  SUBSTR(#from#,0,6)||'00' AND SUBSTR(#to#,0,6)||'32'
			  	GROUP BY A.BIZ_DV_CD
			 ) T3,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       SUM(A.CNSL_NCNT)       AS DTL1_CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN  SUBSTR(#from#,0,6)||'00' AND SUBSTR(#to#,0,6)||'32'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			 ) T4  <!-- 합계역순 조회용 -->
			 WHERE T1.BIZ_DV_CD = T2.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T3.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T4.BIZ_DV_CD(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T4.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T2.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD2 = T2.BIZ_DV_DTLS_CD2(+)
			   AND T1.BASC_YM           = T2.CNSL_YM(+)
			 ORDER BY T1.BIZ_PROC_DTLS_CD1, T1.BIZ_PROC_DTLS_CD2, T1.BASC_YM
			) TT
			GROUP BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
			ORDER BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
		)  
		GROUP BY ROLLUP(BIZ_PROC_DTLS_CD1, BIZ_PROC_DTLS_CD2)
	)
	WHERE DATA_GB IN ( 'S','T')  <!-- 합계만 표시 -->
	<isNotEmpty property="order_gb">
	<isEqual property="order_gb" compareValue="01">
	ORDER BY BIZ_PROC_DTLS_CD1, DATA_GB, BIZ_PROC_DTLS_CD2 <!-- 업무상세순서  -->
	</isEqual>
	<isEqual property="order_gb" compareValue="02">
	ORDER BY DATA_GB_SUM DESC, BIZ_PROC_DTLS_CD1, DATA_GB, CNSL_YM_TOT DESC <!-- 업무상세1합계역순 AND 업무상세2 합계역순 -->
	</isEqual>
	</isNotEmpty>
	</select>
	

	<!-- 업무구분|업무상세1|업무상세2 - 년도별 -->
 	<select id="Get_ORD_CNSL_HIST_YEAR_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
	SELECT DATA_GB
	     , NM
	     , CNSL_YEAR_01
	     , CNSL_YEAR_02
	     , CNSL_YEAR_03
	     , CNSL_YEAR_04
	     , CNSL_YEAR_05
	     , CNSL_YEAR_06
	     , CNSL_YEAR_07
	     , CNSL_YEAR_08
	     , CNSL_YEAR_09
	     , CNSL_YEAR_10
	     , CNSL_YEAR_TOT
	     , SUM_RATE
	FROM
		(
		SELECT CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'T'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'S'
		            ELSE 'D' END DATA_GB
		     , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN '합계'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN '(소계)'||MAX(BIZ_PROC_DTLS_CDNM1)
		            ELSE MAX(BIZ_PROC_DTLS_CDNM2) END NM
		     , SUM(CNSL_NCNT_SUM_01) AS CNSL_YEAR_01
		     , SUM(CNSL_NCNT_SUM_02) AS CNSL_YEAR_02
		     , SUM(CNSL_NCNT_SUM_03) AS CNSL_YEAR_03
		     , SUM(CNSL_NCNT_SUM_04) AS CNSL_YEAR_04
		     , SUM(CNSL_NCNT_SUM_05) AS CNSL_YEAR_05
		     , SUM(CNSL_NCNT_SUM_06) AS CNSL_YEAR_06
		     , SUM(CNSL_NCNT_SUM_07) AS CNSL_YEAR_07
		     , SUM(CNSL_NCNT_SUM_08) AS CNSL_YEAR_08
		     , SUM(CNSL_NCNT_SUM_09) AS CNSL_YEAR_09
		     , SUM(CNSL_NCNT_SUM_10) AS CNSL_YEAR_10
		     , SUM(ROW_SUM) AS CNSL_YEAR_TOT
		     , ROUND(SUM(ROW_SUM)/MAX(TOTAL_SUM)*100, 2) AS SUM_RATE
		     , BIZ_PROC_DTLS_CD1 <!-- 합계역순 조회용 -->
		     , BIZ_PROC_DTLS_CD2 <!-- 합계역순 조회용 -->
			 , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN -1
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN MIN(DTL1_CNSL_NCNT_SUM)
		            ELSE SUM(DTL1_CNSL_NCNT_SUM)
		       END DATA_GB_SUM  <!-- 합계역순 조회용 -->
		     , SUM(DTL1_CNSL_NCNT_SUM) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
		FROM
		(
			SELECT TT.BIZ_DV_CD
			     , TT.BIZ_PROC_DTLS_CD1
			     , TT.BIZ_PROC_DTLS_CDNM1
			     , TT.BIZ_PROC_DTLS_CD2
			     , TT.BIZ_PROC_DTLS_CDNM2
			     , CASE WHEN MAX(TT.YEAR_CNT) - 1 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 0, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_01
			     , CASE WHEN MAX(TT.YEAR_CNT) - 2 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 1, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_02
			     , CASE WHEN MAX(TT.YEAR_CNT) - 3 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 2, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_03
			     , CASE WHEN MAX(TT.YEAR_CNT) - 4 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 3, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_04
			     , CASE WHEN MAX(TT.YEAR_CNT) - 5 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 4, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_05
			     , CASE WHEN MAX(TT.YEAR_CNT) - 6 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 5, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_06
			     , CASE WHEN MAX(TT.YEAR_CNT) - 7 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 6, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_07
			     , CASE WHEN MAX(TT.YEAR_CNT) - 8 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 7, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_08
			     , CASE WHEN MAX(TT.YEAR_CNT) - 9 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 8, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_09
			     , CASE WHEN MAX(TT.YEAR_CNT) -10 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 9, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_10
			     , SUM(CNSL_NCNT_SUM) AS ROW_SUM
			     , MAX(TOTAL_SUM) AS TOTAL_SUM
			     , NVL(MAX(DTL1_CNSL_NCNT_SUM), 0) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
			FROM
			(
			 SELECT T1.*
			      , NVL(T2.CNSL_NCNT_SUM, 0) AS CNSL_NCNT_SUM
			      , T3.TOTAL_SUM
			      , T3.YEAR_CNT
			      , DTL1_CNSL_NCNT_SUM   <!-- 합계역순 조회용 -->
			 FROM
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_PROC_DTLS_CD1,
			  	       MAX(A.BIZ_PROC_DTLS_CDNM1) BIZ_PROC_DTLS_CDNM1,
			  	       A.BIZ_PROC_DTLS_CD2, 
			  	       MAX(A.BIZ_PROC_DTLS_CDNM2) AS BIZ_PROC_DTLS_CDNM2,
			  	       SUBSTR(B.BASC_DT, 1, 4) AS BASC_YEAR
			  	  FROM TBL_BIZ_DV_CD A,
			  	       TBL_BUSSDD_INFO B
			  	 WHERE A.BIZ_DV_CD = B.GRP_CD
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
				<isNotEmpty property="biz_proc_dtls_cd1">
			  	   AND A.BIZ_PROC_DTLS_CD1 = #biz_proc_dtls_cd1#
				</isNotEmpty>
				<isNotEmpty property="biz_proc_dtls_cd2">
			  	   AND A.BIZ_PROC_DTLS_CD2 = #biz_proc_dtls_cd2#
				</isNotEmpty>
			  	   AND A.USE_YN = 'Y'
			  	   AND B.BASC_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, SUBSTR(B.BASC_DT, 1, 4)
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, SUBSTR(B.BASC_DT, 1, 4)
			 ) T1,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       A.BIZ_DV_DTLS_CD2,
			  	       SUBSTR(A.CNSL_DT, 1, 4) AS CNSL_YEAR,
			  	       SUM(A.CNSL_NCNT)       AS CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A  
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, SUBSTR(A.CNSL_DT, 1, 4)
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, SUBSTR(A.CNSL_DT, 1, 4) 
			 ) T2,
			 (
			   	SELECT A.BIZ_DV_CD,
			  	       SUM(A.CNSL_NCNT) AS TOTAL_SUM,
			  	       TO_NUMBER(SUBSTR(#to#,1,4)) - TO_NUMBER(SUBSTR(#from#,1,4)) + 1 AS YEAR_CNT
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD
			 ) T3,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       SUM(A.CNSL_NCNT)       AS DTL1_CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			 ) T4  <!-- 합계역순 조회용 -->
			 WHERE T1.BIZ_DV_CD = T2.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T3.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T4.BIZ_DV_CD(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T4.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T2.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD2 = T2.BIZ_DV_DTLS_CD2(+)
			   AND T1.BASC_YEAR         = T2.CNSL_YEAR(+)
			 ORDER BY T1.BIZ_PROC_DTLS_CD1, T1.BIZ_PROC_DTLS_CD2, T1.BASC_YEAR
			) TT
			GROUP BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
			ORDER BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
		)  
		GROUP BY ROLLUP(BIZ_PROC_DTLS_CD1, BIZ_PROC_DTLS_CD2)
	)
	<isNotEmpty property="order_gb">
	<isEqual property="order_gb" compareValue="01">
	ORDER BY BIZ_PROC_DTLS_CD1, DATA_GB, BIZ_PROC_DTLS_CD2 <!-- 업무상세순서  -->
	</isEqual>
	<isEqual property="order_gb" compareValue="02">
	ORDER BY DATA_GB_SUM DESC, BIZ_PROC_DTLS_CD1, DATA_GB, CNSL_YEAR_TOT DESC <!-- 업무상세1합계역순 AND 업무상세2 합계역순 -->
	</isEqual>
	</isNotEmpty>
	</select>

<!-- 업무구분|업무상세1|업무상세2 - 년도별 -->
 	<select id="Get_ORD_CNSL_HIST_YEAR_SUM_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
	SELECT DATA_GB
	     , NM
	     , NVL(CNSL_YEAR_01,0) AS CNSL_YEAR_01
	     , NVL(CNSL_YEAR_02,0) AS CNSL_YEAR_02
	     , NVL(CNSL_YEAR_03,0) AS CNSL_YEAR_03
	     , NVL(CNSL_YEAR_04,0) AS CNSL_YEAR_04
	     , NVL(CNSL_YEAR_05,0) AS CNSL_YEAR_05
	     , NVL(CNSL_YEAR_06,0) AS CNSL_YEAR_06
	     , NVL(CNSL_YEAR_07,0) AS CNSL_YEAR_07
	     , NVL(CNSL_YEAR_08,0) AS CNSL_YEAR_08
	     , NVL(CNSL_YEAR_09,0) AS CNSL_YEAR_09
	     , NVL(CNSL_YEAR_10,0) AS CNSL_YEAR_10
	     , CNSL_YEAR_TOT
	     , SUM_RATE
	     , NVL(CEIL(CNSL_YEAR_TOT/12),0) AS AVR    <!-- 년도별 평균 -->
	FROM
		(
		SELECT CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'T'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN 'S'
		            ELSE 'D' END DATA_GB
		     , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN '합계'
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN MAX(BIZ_PROC_DTLS_CDNM1)
		            ELSE MAX(BIZ_PROC_DTLS_CDNM2) END NM
		     , SUM(CNSL_NCNT_SUM_01) AS CNSL_YEAR_01
		     , SUM(CNSL_NCNT_SUM_02) AS CNSL_YEAR_02
		     , SUM(CNSL_NCNT_SUM_03) AS CNSL_YEAR_03
		     , SUM(CNSL_NCNT_SUM_04) AS CNSL_YEAR_04
		     , SUM(CNSL_NCNT_SUM_05) AS CNSL_YEAR_05
		     , SUM(CNSL_NCNT_SUM_06) AS CNSL_YEAR_06
		     , SUM(CNSL_NCNT_SUM_07) AS CNSL_YEAR_07
		     , SUM(CNSL_NCNT_SUM_08) AS CNSL_YEAR_08
		     , SUM(CNSL_NCNT_SUM_09) AS CNSL_YEAR_09
		     , SUM(CNSL_NCNT_SUM_10) AS CNSL_YEAR_10
		     , SUM(ROW_SUM) AS CNSL_YEAR_TOT
		     , ROUND(SUM(ROW_SUM)/MAX(TOTAL_SUM)*100, 2) AS SUM_RATE
		     , BIZ_PROC_DTLS_CD1 <!-- 합계역순 조회용 -->
		     , BIZ_PROC_DTLS_CD2 <!-- 합계역순 조회용 -->
			 , CASE WHEN BIZ_PROC_DTLS_CD1 IS NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN -1
		            WHEN BIZ_PROC_DTLS_CD1 IS NOT NULL AND BIZ_PROC_DTLS_CD2 IS NULL THEN MIN(DTL1_CNSL_NCNT_SUM)
		            ELSE SUM(DTL1_CNSL_NCNT_SUM)
		       END DATA_GB_SUM  <!-- 합계역순 조회용 -->
		     , SUM(DTL1_CNSL_NCNT_SUM) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
		FROM
		(
			SELECT TT.BIZ_DV_CD
			     , TT.BIZ_PROC_DTLS_CD1
			     , TT.BIZ_PROC_DTLS_CDNM1
			     , TT.BIZ_PROC_DTLS_CD2
			     , TT.BIZ_PROC_DTLS_CDNM2
			     , CASE WHEN MAX(TT.YEAR_CNT) - 1 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 0, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_01
			     , CASE WHEN MAX(TT.YEAR_CNT) - 2 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 1, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_02
			     , CASE WHEN MAX(TT.YEAR_CNT) - 3 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 2, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_03
			     , CASE WHEN MAX(TT.YEAR_CNT) - 4 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 3, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_04
			     , CASE WHEN MAX(TT.YEAR_CNT) - 5 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 4, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_05
			     , CASE WHEN MAX(TT.YEAR_CNT) - 6 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 5, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_06
			     , CASE WHEN MAX(TT.YEAR_CNT) - 7 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 6, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_07
			     , CASE WHEN MAX(TT.YEAR_CNT) - 8 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 7, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_08
			     , CASE WHEN MAX(TT.YEAR_CNT) - 9 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 8, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_09
			     , CASE WHEN MAX(TT.YEAR_CNT) -10 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 9, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_10
			     , SUM(CNSL_NCNT_SUM) AS ROW_SUM
			     , MAX(TOTAL_SUM) AS TOTAL_SUM
			     , NVL(MAX(DTL1_CNSL_NCNT_SUM), 0) AS DTL1_CNSL_NCNT_SUM  <!-- 합계역순 조회용 -->
			FROM
			(
			 SELECT T1.*
			      , NVL(T2.CNSL_NCNT_SUM, 0) AS CNSL_NCNT_SUM
			      , T3.TOTAL_SUM
			      , T3.YEAR_CNT
			      , DTL1_CNSL_NCNT_SUM   <!-- 합계역순 조회용 -->
			 FROM
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_PROC_DTLS_CD1,
			  	       MAX(A.BIZ_PROC_DTLS_CDNM1) BIZ_PROC_DTLS_CDNM1,
			  	       A.BIZ_PROC_DTLS_CD2, 
			  	       MAX(A.BIZ_PROC_DTLS_CDNM2) AS BIZ_PROC_DTLS_CDNM2,
			  	       SUBSTR(B.BASC_DT, 1, 4) AS BASC_YEAR
			  	  FROM TBL_BIZ_DV_CD A,
			  	       TBL_BUSSDD_INFO B
			  	 WHERE A.BIZ_DV_CD = B.GRP_CD
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
				<isNotEmpty property="biz_proc_dtls_cd1">
			  	   AND A.BIZ_PROC_DTLS_CD1 = #biz_proc_dtls_cd1#
				</isNotEmpty>
				<isNotEmpty property="biz_proc_dtls_cd2">
			  	   AND A.BIZ_PROC_DTLS_CD2 = #biz_proc_dtls_cd2#
				</isNotEmpty>
				<isEqual property="biz_dv_cd" compareValue="BNS">
					AND A.SRT_SEQ  > 662   <!-- biz_proc_dtsl_cdnm1 이 H로 시작 하는것만 -->
					  AND A.BIZ_PROC_DTLS_CD1 NOT IN('HSIC', 'HSHX', 'HSHS', 'HSHT', 'HSHV','HSHU','HSHW')
				</isEqual>
			  	   <!-- AND A.USE_YN = 'Y'  사용여부 상관없이 모든 코드 조회-->
			  	   AND B.BASC_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, SUBSTR(B.BASC_DT, 1, 4)
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_PROC_DTLS_CD1, A.BIZ_PROC_DTLS_CD2, SUBSTR(B.BASC_DT, 1, 4)
			 ) T1,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       A.BIZ_DV_DTLS_CD2,
			  	       SUBSTR(A.CNSL_DT, 1, 4) AS CNSL_YEAR,
			  	       SUM(A.CNSL_NCNT)       AS CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A  
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, SUBSTR(A.CNSL_DT, 1, 4)
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1, A.BIZ_DV_DTLS_CD2, SUBSTR(A.CNSL_DT, 1, 4) 
			 ) T2,
			 (
			   	SELECT A.BIZ_DV_CD,
			  	       SUM(A.CNSL_NCNT) AS TOTAL_SUM,
			  	       TO_NUMBER(SUBSTR(#to#,1,4)) - TO_NUMBER(SUBSTR(#from#,1,4)) + 1 AS YEAR_CNT
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD
			 ) T3,
			 (
			  	SELECT A.BIZ_DV_CD,
			  	       A.BIZ_DV_DTLS_CD1,
			  	       SUM(A.CNSL_NCNT)       AS DTL1_CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #biz_dv_cd#
			  	   AND A.BIZ_DV_CD = #biz_dv_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			  	ORDER BY A.BIZ_DV_CD, A.BIZ_DV_DTLS_CD1
			 ) T4  <!-- 합계역순 조회용 -->
			 WHERE T1.BIZ_DV_CD = T2.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T3.BIZ_DV_CD(+)
			   AND T1.BIZ_DV_CD = T4.BIZ_DV_CD(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T4.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD1 = T2.BIZ_DV_DTLS_CD1(+)
			   AND T1.BIZ_PROC_DTLS_CD2 = T2.BIZ_DV_DTLS_CD2(+)
			   AND T1.BASC_YEAR         = T2.CNSL_YEAR(+)
			 ORDER BY T1.BIZ_PROC_DTLS_CD1, T1.BIZ_PROC_DTLS_CD2, T1.BASC_YEAR
			) TT
			GROUP BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
			ORDER BY TT.BIZ_DV_CD, TT.BIZ_PROC_DTLS_CD1, TT.BIZ_PROC_DTLS_CDNM1, TT.BIZ_PROC_DTLS_CD2, TT.BIZ_PROC_DTLS_CDNM2
		)  
		GROUP BY ROLLUP(BIZ_PROC_DTLS_CD1, BIZ_PROC_DTLS_CD2)
	) WHERE DATA_GB IN ('S','T')
	<isNotEmpty property="order_gb">
	<isEqual property="order_gb" compareValue="01">
	ORDER BY BIZ_PROC_DTLS_CD1, DATA_GB, BIZ_PROC_DTLS_CD2 <!-- 업무상세순서  -->
	</isEqual>
	<isEqual property="order_gb" compareValue="02">
	ORDER BY DATA_GB_SUM DESC, BIZ_PROC_DTLS_CD1, DATA_GB, CNSL_YEAR_TOT DESC <!-- 업무상세1합계역순 AND 업무상세2 합계역순 -->
	</isEqual>
	</isNotEmpty>
	</select>


	<!-- 그룹|파트 -  일별 -->
 	<select id="Get_GRP_CNSL_HIST_DD_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
		SELECT CASE WHEN GRP_CD IS NULL AND PART_CD IS NULL THEN 'T'
		            WHEN GRP_CD IS NOT NULL AND PART_CD IS NULL THEN 'S'
		            ELSE 'D' END DATA_GB
		     , CASE WHEN GRP_CD IS NULL AND PART_CD IS NULL THEN '합계'
		            WHEN GRP_CD IS NOT NULL AND PART_CD IS NULL THEN '(소계)'||MAX(GRP_CDNM)
		            ELSE MAX(PART_CDNM) END NM
		     , SUM(CNSL_NCNT_SUM_01) AS CNSL_DT_01
		     , SUM(CNSL_NCNT_SUM_02) AS CNSL_DT_02
		     , SUM(CNSL_NCNT_SUM_03) AS CNSL_DT_03
		     , SUM(CNSL_NCNT_SUM_04) AS CNSL_DT_04
		     , SUM(CNSL_NCNT_SUM_05) AS CNSL_DT_05
		     , SUM(CNSL_NCNT_SUM_06) AS CNSL_DT_06
		     , SUM(CNSL_NCNT_SUM_07) AS CNSL_DT_07
		     , SUM(CNSL_NCNT_SUM_08) AS CNSL_DT_08
		     , SUM(CNSL_NCNT_SUM_09) AS CNSL_DT_09
		     , SUM(CNSL_NCNT_SUM_10) AS CNSL_DT_10
		     , SUM(CNSL_NCNT_SUM_11) AS CNSL_DT_11
		     , SUM(CNSL_NCNT_SUM_12) AS CNSL_DT_12
		     , SUM(CNSL_NCNT_SUM_13) AS CNSL_DT_13
		     , SUM(CNSL_NCNT_SUM_14) AS CNSL_DT_14
		     , SUM(CNSL_NCNT_SUM_15) AS CNSL_DT_15
		     , SUM(CNSL_NCNT_SUM_16) AS CNSL_DT_16
		     , SUM(CNSL_NCNT_SUM_17) AS CNSL_DT_17
		     , SUM(CNSL_NCNT_SUM_18) AS CNSL_DT_18
		     , SUM(CNSL_NCNT_SUM_19) AS CNSL_DT_19
		     , SUM(CNSL_NCNT_SUM_20) AS CNSL_DT_20
		     , SUM(CNSL_NCNT_SUM_21) AS CNSL_DT_21
		     , SUM(CNSL_NCNT_SUM_22) AS CNSL_DT_22
		     , SUM(CNSL_NCNT_SUM_23) AS CNSL_DT_23
		     , SUM(CNSL_NCNT_SUM_24) AS CNSL_DT_24
		     , SUM(CNSL_NCNT_SUM_25) AS CNSL_DT_25
		     , SUM(CNSL_NCNT_SUM_26) AS CNSL_DT_26
		     , SUM(CNSL_NCNT_SUM_27) AS CNSL_DT_27
		     , SUM(CNSL_NCNT_SUM_28) AS CNSL_DT_28
		     , SUM(CNSL_NCNT_SUM_29) AS CNSL_DT_29
		     , SUM(CNSL_NCNT_SUM_30) AS CNSL_DT_30
		     , SUM(CNSL_NCNT_SUM_31) AS CNSL_DT_31
		     , SUM(ROW_SUM) AS CNSL_DT_TOT
		     , ROUND(SUM(ROW_SUM)/MAX(TOTAL_SUM)*100, 2) AS SUM_RATE
		   
		FROM
		(
			SELECT TT.GRP_CD
			     , TT.GRP_CDNM
			     , TT.PART_CD
			     , TT.PART_CDNM
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '01', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_01
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '02', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_02
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '03', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_03
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '04', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_04
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '05', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_05
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '06', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_06
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '07', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_07
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '08', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_08
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '09', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_09
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '10', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_10
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '11', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_11
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '12', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_12
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '13', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_13
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '14', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_14
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '15', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_15
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '16', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_16
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '17', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_17
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '18', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_18
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '19', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_19
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '20', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_20
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '21', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_21
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '22', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_22
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '23', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_23
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '24', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_24
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '25', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_25
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '26', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_26
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '27', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_27
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '28', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_28
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '29', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_29
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '30', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_30
			     , SUM(DECODE(SUBSTR(TT.BASC_DT,7,2), '31', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_31
			     , SUM(CNSL_NCNT_SUM) AS ROW_SUM
			     , MAX(TOTAL_SUM) AS TOTAL_SUM
			FROM
			(
			 SELECT T1.*
			      , NVL(T2.CNSL_NCNT_SUM, 0) AS CNSL_NCNT_SUM
			      , TOTAL_SUM  
			 FROM
			 (
			  	SELECT A.GRP_CD,
			  	       A.GRP_CDNM,
			  	       B.PART_CD, 
			  	       B.PART_CDNM,
			  	       C.BASC_DT
			  	  FROM TBL_GRP_CD A,
			  	       TBL_PART_CD B,
			  	       TBL_BUSSDD_INFO C
			  	 WHERE A.GRP_CD = B.GRP_CD
			  	   AND B.GRP_CD = C.GRP_CD
			  	   AND A.GRP_CD = #grp_cd#
				<isNotEmpty property="part_cd">
			  	   AND B.PART_CD = #part_cd#
				</isNotEmpty>
			  	   AND A.USE_YN = 'Y'
			  	   AND B.USE_YN = 'Y'
			  	   AND C.BASC_DT BETWEEN #from# AND #to#
			  	ORDER BY A.GRP_CD, B.PART_CD, C.BASC_DT
			 ) T1,
			 (
			  	SELECT A.GRP_CD,
			  	       A.PART_CD,
			  	       A.CNSL_DT,
			  	       SUM(A.CNSL_NCNT)       AS CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #grp_cd#
			  	   AND A.CNSL_DT BETWEEN #from# AND #to#
			  	GROUP BY A.GRP_CD, A.PART_CD, A.CNSL_DT
			  	ORDER BY A.GRP_CD, A.PART_CD, A.CNSL_DT
			 ) T2,
			 (
			   	SELECT A.GRP_CD,
			  	       SUM(A.CNSL_NCNT) AS TOTAL_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #grp_cd#
			  	   AND A.CNSL_DT BETWEEN #from# AND #to#
			  	GROUP BY A.GRP_CD
			 ) T3
			 WHERE T1.GRP_CD  = T2.GRP_CD(+)
			   AND T1.PART_CD = T2.PART_CD(+)
			   AND T1.GRP_CD  = T3.GRP_CD(+)
			   AND T1.BASC_DT = T2.CNSL_DT(+)
			 ORDER BY T1.GRP_CD, T1.PART_CD, T1.BASC_DT
			) TT 
			GROUP BY TT.GRP_CD, TT.GRP_CDNM, TT.PART_CD, TT.PART_CDNM
			ORDER BY TT.GRP_CD, TT.GRP_CDNM, TT.PART_CD, TT.PART_CDNM
		)  
		GROUP BY ROLLUP(GRP_CD, PART_CD)
	</select>
	<!-- 그룹|파트 -  월별 -->
 	<select id="Get_GRP_CNSL_HIST_YM_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
		SELECT CASE WHEN GRP_CD IS NULL AND PART_CD IS NULL THEN 'T'
		            WHEN GRP_CD IS NOT NULL AND PART_CD IS NULL THEN 'S'
		            ELSE 'D' END DATA_GB
		     , CASE WHEN GRP_CD IS NULL AND PART_CD IS NULL THEN '합계'
		            WHEN GRP_CD IS NOT NULL AND PART_CD IS NULL THEN '(소계)'||MAX(GRP_CDNM)
		            ELSE MAX(PART_CDNM) END NM
		     , SUM(CNSL_NCNT_SUM_01) AS CNSL_YM_01
		     , SUM(CNSL_NCNT_SUM_02) AS CNSL_YM_02
		     , SUM(CNSL_NCNT_SUM_03) AS CNSL_YM_03
		     , SUM(CNSL_NCNT_SUM_04) AS CNSL_YM_04
		     , SUM(CNSL_NCNT_SUM_05) AS CNSL_YM_05
		     , SUM(CNSL_NCNT_SUM_06) AS CNSL_YM_06
		     , SUM(CNSL_NCNT_SUM_07) AS CNSL_YM_07
		     , SUM(CNSL_NCNT_SUM_08) AS CNSL_YM_08
		     , SUM(CNSL_NCNT_SUM_09) AS CNSL_YM_09
		     , SUM(CNSL_NCNT_SUM_10) AS CNSL_YM_10
		     , SUM(CNSL_NCNT_SUM_11) AS CNSL_YM_11
		     , SUM(CNSL_NCNT_SUM_12) AS CNSL_YM_12
		     , SUM(ROW_SUM) AS CNSL_YM_TOT
		     , ROUND(SUM(ROW_SUM)/MAX(TOTAL_SUM)*100, 2) AS SUM_RATE
		FROM
		(
			SELECT TT.GRP_CD
			     , TT.GRP_CDNM
			     , TT.PART_CD
			     , TT.PART_CDNM
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '01', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_01
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '02', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_02
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '03', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_03
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '04', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_04
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '05', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_05
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '06', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_06
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '07', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_07
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '08', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_08
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '09', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_09
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '10', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_10
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '11', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_11
			     , SUM(DECODE(SUBSTR(TT.BASC_YM,5,2), '12', CNSL_NCNT_SUM, 0)) AS CNSL_NCNT_SUM_12
			     , SUM(CNSL_NCNT_SUM) AS ROW_SUM
			     , MAX(TOTAL_SUM) AS TOTAL_SUM
			FROM
			(
			 SELECT T1.*
			      , NVL(T2.CNSL_NCNT_SUM, 0) AS CNSL_NCNT_SUM
			      , TOTAL_SUM  
			 FROM
			 (
			  	SELECT A.GRP_CD,
			  	       MAX(A.GRP_CDNM) GRP_CDNM,
			  	       B.PART_CD, 
			  	       MAX(B.PART_CDNM) AS PART_CDNM,
			  	       SUBSTR(C.BASC_DT, 1, 6) AS BASC_YM
			  	  FROM TBL_GRP_CD A,
			  	       TBL_PART_CD B,
			  	       TBL_BUSSDD_INFO C
			  	 WHERE A.GRP_CD = B.GRP_CD
			  	   AND B.GRP_CD = C.GRP_CD
				<isNotEmpty property="part_cd">
			  	   AND B.PART_CD = #part_cd#
				</isNotEmpty>
			  	   AND A.GRP_CD = #grp_cd#
			  	   AND A.USE_YN = 'Y'
			  	   AND B.USE_YN = 'Y'
			  	   AND C.BASC_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#from#,1,4)||'1231'
			  	GROUP BY A.GRP_CD, B.PART_CD, SUBSTR(C.BASC_DT, 1, 6)
			  	ORDER BY A.GRP_CD, B.PART_CD, SUBSTR(C.BASC_DT, 1, 6)
			 ) T1,
			 (
			  	SELECT A.GRP_CD,
			  	       A.PART_CD,
			  	       SUBSTR(A.CNSL_DT, 1, 6) AS CNSL_YM,
			  	       SUM(A.CNSL_NCNT)       AS CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A  
			  	 WHERE A.GRP_CD    = #grp_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#from#,1,4)||'1231'
			  	GROUP BY A.GRP_CD, A.PART_CD, SUBSTR(A.CNSL_DT, 1, 6)
			  	ORDER BY A.GRP_CD, A.PART_CD, SUBSTR(A.CNSL_DT, 1, 6) 
			 ) T2,
			 (
			   	SELECT A.GRP_CD,
			  	       SUM(A.CNSL_NCNT) AS TOTAL_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #grp_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#from#,1,4)||'1231'
			  	GROUP BY A.GRP_CD
			 ) T3
			 WHERE T1.GRP_CD  = T2.GRP_CD(+)
			   AND T1.PART_CD = T2.PART_CD(+)
			   AND T1.GRP_CD  = T3.GRP_CD(+)
			   AND T1.BASC_YM = T2.CNSL_YM(+)
			 ORDER BY T1.GRP_CD, T1.PART_CD, T1.BASC_YM
			) TT
			GROUP BY TT.GRP_CD, TT.GRP_CDNM, TT.PART_CD, TT.PART_CDNM
			ORDER BY TT.GRP_CD, TT.GRP_CDNM, TT.PART_CD, TT.PART_CDNM
		)  
		GROUP BY ROLLUP(GRP_CD, PART_CD)
	</select>
	<!-- 그룹|파트 -  년도별 -->
 	<select id="Get_GRP_CNSL_HIST_YEAR_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
		SELECT CASE WHEN GRP_CD IS NULL AND PART_CD IS NULL THEN 'T'
		            WHEN GRP_CD IS NOT NULL AND PART_CD IS NULL THEN 'S'
		            ELSE 'D' END DATA_GB
		     , CASE WHEN GRP_CD IS NULL AND PART_CD IS NULL THEN '합계'
		            WHEN GRP_CD IS NOT NULL AND PART_CD IS NULL THEN '(소계)'||MAX(GRP_CDNM)
		            ELSE MAX(PART_CDNM) END NM
		     , SUM(CNSL_NCNT_SUM_01) AS CNSL_YEAR_01
		     , SUM(CNSL_NCNT_SUM_02) AS CNSL_YEAR_02
		     , SUM(CNSL_NCNT_SUM_03) AS CNSL_YEAR_03
		     , SUM(CNSL_NCNT_SUM_04) AS CNSL_YEAR_04
		     , SUM(CNSL_NCNT_SUM_05) AS CNSL_YEAR_05
		     , SUM(CNSL_NCNT_SUM_06) AS CNSL_YEAR_06
		     , SUM(CNSL_NCNT_SUM_07) AS CNSL_YEAR_07
		     , SUM(CNSL_NCNT_SUM_08) AS CNSL_YEAR_08
		     , SUM(CNSL_NCNT_SUM_09) AS CNSL_YEAR_09
		     , SUM(CNSL_NCNT_SUM_10) AS CNSL_YEAR_10
		     , SUM(ROW_SUM) AS CNSL_YEAR_TOT
		     , ROUND(SUM(ROW_SUM)/MAX(TOTAL_SUM)*100, 2) AS SUM_RATE
		FROM
		(
			SELECT TT.GRP_CD
			     , TT.GRP_CDNM
			     , TT.PART_CD
			     , TT.PART_CDNM
			     , CASE WHEN MAX(TT.YEAR_CNT) - 1 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 0, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_01
			     , CASE WHEN MAX(TT.YEAR_CNT) - 2 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 1, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_02
			     , CASE WHEN MAX(TT.YEAR_CNT) - 3 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 2, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_03
			     , CASE WHEN MAX(TT.YEAR_CNT) - 4 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 3, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_04
			     , CASE WHEN MAX(TT.YEAR_CNT) - 5 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 4, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_05
			     , CASE WHEN MAX(TT.YEAR_CNT) - 6 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 5, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_06
			     , CASE WHEN MAX(TT.YEAR_CNT) - 7 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 6, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_07
			     , CASE WHEN MAX(TT.YEAR_CNT) - 8 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 7, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_08
			     , CASE WHEN MAX(TT.YEAR_CNT) - 9 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 8, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_09
			     , CASE WHEN MAX(TT.YEAR_CNT) -10 >= 0 THEN SUM(DECODE(TO_NUMBER(TT.BASC_YEAR), TO_NUMBER(SUBSTR(#from#,1,4)) + 9, CNSL_NCNT_SUM, 0)) ELSE NULL END AS CNSL_NCNT_SUM_10
			     , SUM(CNSL_NCNT_SUM) AS ROW_SUM
			     , MAX(TOTAL_SUM) AS TOTAL_SUM
			FROM
			(
			 SELECT T1.*
			      , NVL(T2.CNSL_NCNT_SUM, 0) AS CNSL_NCNT_SUM
			      , T3.TOTAL_SUM
			      , T3.YEAR_CNT
			 FROM
			 (
			  	SELECT A.GRP_CD,
			  	       MAX(A.GRP_CDNM) GRP_CDNM,
			  	       B.PART_CD, 
			  	       MAX(B.PART_CDNM) AS PART_CDNM,
			  	       SUBSTR(C.BASC_DT, 1, 4) AS BASC_YEAR
			  	  FROM TBL_GRP_CD A,
			  	       TBL_PART_CD B,
			  	       TBL_BUSSDD_INFO C
			  	 WHERE A.GRP_CD = B.GRP_CD
			  	   AND B.GRP_CD = C.GRP_CD
				<isNotEmpty property="part_cd">
			  	   AND B.PART_CD = #part_cd#
				</isNotEmpty>
			  	   AND A.GRP_CD = #grp_cd#
			  	   AND A.USE_YN = 'Y'
			  	   AND B.USE_YN = 'Y'
			  	   AND C.BASC_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.GRP_CD, B.PART_CD, SUBSTR(C.BASC_DT, 1, 4)
			  	ORDER BY A.GRP_CD, B.PART_CD, SUBSTR(C.BASC_DT, 1, 4)
			 ) T1,
			 (
			  	SELECT A.GRP_CD,
			  	       A.PART_CD,
			  	       SUBSTR(A.CNSL_DT, 1, 4) AS CNSL_YEAR,
			  	       SUM(A.CNSL_NCNT)       AS CNSL_NCNT_SUM
			  	  FROM TBL_BT_CNSL_HIST_DD A  
			  	 WHERE A.GRP_CD    = #grp_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.GRP_CD, A.PART_CD, SUBSTR(A.CNSL_DT, 1, 4)
			  	ORDER BY A.GRP_CD, A.PART_CD, SUBSTR(A.CNSL_DT, 1, 4) 
			 ) T2,
			 (
			   	SELECT A.GRP_CD,
			  	       SUM(A.CNSL_NCNT) AS TOTAL_SUM,
			  	       TO_NUMBER(SUBSTR(#to#,1,4)) - TO_NUMBER(SUBSTR(#from#,1,4)) + 1 AS YEAR_CNT
			  	  FROM TBL_BT_CNSL_HIST_DD A
			  	 WHERE A.GRP_CD    = #grp_cd#
			  	   AND A.CNSL_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	GROUP BY A.GRP_CD
			 ) T3
			 WHERE T1.GRP_CD    = T2.GRP_CD(+)
			   AND T1.PART_CD   = T2.PART_CD(+)
			   AND T1.GRP_CD    = T3.GRP_CD(+)
			   AND T1.BASC_YEAR = T2.CNSL_YEAR(+)
			 ORDER BY T1.GRP_CD, T1.PART_CD, T1.BASC_YEAR
			) TT
			GROUP BY TT.GRP_CD, TT.GRP_CDNM, TT.PART_CD, TT.PART_CDNM
			ORDER BY TT.GRP_CD, TT.GRP_CDNM, TT.PART_CD, TT.PART_CDNM
		)  
		GROUP BY ROLLUP(GRP_CD, PART_CD)
	</select>

	<!-- 그리드 헤더표시용(년도) -->
 	<select id="Get_BT_CNSL_HIST_YEAR_HEAD_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
 	   SELECT NVL(MAX(DECODE(T.CNT, 1, T.BASC_YEAR)),' ') AS YEAR_1
		    , NVL(MAX(DECODE(T.CNT, 2, T.BASC_YEAR)),' ') AS YEAR_2
		    , NVL(MAX(DECODE(T.CNT, 3, T.BASC_YEAR)),' ') AS YEAR_3
		    , NVL(MAX(DECODE(T.CNT, 4, T.BASC_YEAR)),' ') AS YEAR_4
		    , NVL(MAX(DECODE(T.CNT, 5, T.BASC_YEAR)),' ') AS YEAR_5
		    , NVL(MAX(DECODE(T.CNT, 6, T.BASC_YEAR)),' ') AS YEAR_6
		    , NVL(MAX(DECODE(T.CNT, 7, T.BASC_YEAR)),' ') AS YEAR_7
		    , NVL(MAX(DECODE(T.CNT, 8, T.BASC_YEAR)),' ') AS YEAR_8
		    , NVL(MAX(DECODE(T.CNT, 9, T.BASC_YEAR)),' ') AS YEAR_9
		    , NVL(MAX(DECODE(T.CNT,10, T.BASC_YEAR)),' ') AS YEAR_10
		FROM (
		      SELECT A.BASC_YEAR
		        , RANK() OVER(ORDER BY BASC_YEAR) AS CNT
		      FROM (
		                SELECT SUBSTR(BASC_DT, 1, 4) AS BASC_YEAR
			  	          FROM TBL_BUSSDD_INFO
			  	         WHERE GRP_CD = 'ORD'
			  	           AND BASC_DT BETWEEN SUBSTR(#from#,1,4)||'0101' AND SUBSTR(#to#,1,4)||'1231'
			  	      GROUP BY SUBSTR(BASC_DT, 1, 4)
			  	      ORDER BY SUBSTR(BASC_DT, 1, 4)
		      ) A
		      GROUP BY A.BASC_YEAR
		      ORDER BY A.BASC_YEAR
		)T
    </select>
    
    <!-- 그리드 헤더표시용(월) -->
 	<select id="Get_BT_CNSL_HIST_MONTH_HEAD_SELECT" resultClass="java.util.HashMap"  parameterClass="java.util.HashMap">
 	   SELECT NVL(MAX(DECODE(T.CNT, 1, T.BASC_MONTH)),' ') AS YEAR_1
		    , NVL(MAX(DECODE(T.CNT, 2, T.BASC_MONTH)),' ') AS YEAR_2
		    , NVL(MAX(DECODE(T.CNT, 3, T.BASC_MONTH)),' ') AS YEAR_3
		    , NVL(MAX(DECODE(T.CNT, 4, T.BASC_MONTH)),' ') AS YEAR_4
		    , NVL(MAX(DECODE(T.CNT, 5, T.BASC_MONTH)),' ') AS YEAR_5
		    , NVL(MAX(DECODE(T.CNT, 6, T.BASC_MONTH)),' ') AS YEAR_6
		    , NVL(MAX(DECODE(T.CNT, 7, T.BASC_MONTH)),' ') AS YEAR_7
		    , NVL(MAX(DECODE(T.CNT, 8, T.BASC_MONTH)),' ') AS YEAR_8
		    , NVL(MAX(DECODE(T.CNT, 9, T.BASC_MONTH)),' ') AS YEAR_9
		    , NVL(MAX(DECODE(T.CNT,10, T.BASC_MONTH)),' ') AS YEAR_10
		    , NVL(MAX(DECODE(T.CNT,11, T.BASC_MONTH)),' ') AS YEAR_11
		    , NVL(MAX(DECODE(T.CNT,12, T.BASC_MONTH)),' ') AS YEAR_12
		FROM (
		      SELECT A.BASC_MONTH
		        , RANK() OVER(ORDER BY BASC_MONTH) AS CNT
		      FROM (
		                SELECT SUBSTR(BASC_DT, 5, 2) AS BASC_MONTH
			  	          FROM TBL_BUSSDD_INFO
			  	         WHERE GRP_CD = 'ORD'
			  	           AND BASC_DT BETWEEN #from#  AND #to#
			  	      GROUP BY BASC_DT
			  	      ORDER BY BASC_DT
		      ) A
		      GROUP BY A.BASC_MONTH
		      ORDER BY A.BASC_MONTH
		)T
    </select>
</sqlMap>
